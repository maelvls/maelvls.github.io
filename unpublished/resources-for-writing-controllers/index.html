<!DOCTYPE html>
<html lang="en"><head>

  <meta name="generator" content="Hugo 0.64.0" />
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="keywords" content="kubernetes,go"><meta property="og:title" content="Resources for learning how to write Kubernetes controllers" />
<meta property="og:description" content="A &ldquo;Kubernetes controller&rdquo; is a binary that runs reconciliation loops. A reconciliation loop watches the objects stored in Kubernetes. When it notices a discrepency between what the object specifies (e.g. 4 replicas) and the observed reality (e.g., the reconcialiation loop asks kubelet, and it answers there are only 2 replicas), the reconcialiation loop will take actions in order to satisfy what is specified in the object. The &ldquo;controller&rdquo; binary is run as a simple Kubernetes Deployment." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://maelvls.dev/unpublished/resources-for-writing-controllers/" />
<meta property="article:published_time" content="2020-04-14T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-04-14T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Resources for learning how to write Kubernetes controllers"/>
<meta name="twitter:description" content="A &ldquo;Kubernetes controller&rdquo; is a binary that runs reconciliation loops. A reconciliation loop watches the objects stored in Kubernetes. When it notices a discrepency between what the object specifies (e.g. 4 replicas) and the observed reality (e.g., the reconcialiation loop asks kubelet, and it answers there are only 2 replicas), the reconcialiation loop will take actions in order to satisfy what is specified in the object. The &ldquo;controller&rdquo; binary is run as a simple Kubernetes Deployment."/>

  <link rel="stylesheet" type="text/css" media="screen" href="https://maelvls.dev/unpublished/css/normalize.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="https://maelvls.dev/unpublished/css/main.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="https://maelvls.dev/unpublished/css/all.css" />
<link rel="stylesheet" type="text/css" media="screen" href="https://maelvls.dev/unpublished/css/maelvls.css" /><title>Resources for learning how to write Kubernetes controllers | maelvls dev blog</title></head>
<body>

<header>

  <div id="avatar">
    <a href="https://maelvls.dev/unpublished/">
      <img src="/img/mael.jpg" alt="maelvls dev blog">
    </a>
  </div>

  <div id="titletext"><h2 id="title"><a href="https://maelvls.dev/unpublished/">maelvls dev blog</a></h2></div>
  <div id="title-description"><p id="subtitle">Systems software engineer. I write mostly about Kubernetes and Go. <a href="/about">About</a></p><div id=social>
    <nav>
      <ul><li><a href="https://github.com/maelvls"><i title="Github" class="icons fab fa-github"></i></a></li><li><a href="https://twitter.com/maelvls"><i title="Twitter" class="icons fab fa-twitter"></i></a></li></ul>
    </nav>
  </div>
  </div>
  <div id="mainmenu">
	
  </div>
</header>
<main><div class="post">
<div class="author">

</div>
<div class="post-header">

<div class="meta">
<div class="date">
<span class="day">14</span>
<span class="rest">Apr 2020</span>
</div>
</div>

<div class="matter">
<h1 class="title">Resources for learning how to write Kubernetes controllers</h1>
</div>
</div>
<div class="markdown">
<blockquote>
<p>A &ldquo;Kubernetes controller&rdquo; is a binary that runs reconciliation loops. A
reconciliation loop watches the objects stored in Kubernetes. When it
notices a discrepency between what the object specifies (e.g. 4 replicas)
and the observed reality (e.g., the reconcialiation loop asks kubelet,
and it answers there are only 2 replicas), the reconcialiation loop will
take actions in order to satisfy what is specified in the object. The
&ldquo;controller&rdquo; binary is run as a simple Kubernetes Deployment. Sometimes,
when the Kubernetes API is not enough, it may also come with some
CustomResourceDefinitions YAML files.</p>
</blockquote>
<p>I use interchangeably the term &ldquo;sync loop&rdquo; and &ldquo;controller&rdquo;. The word
&ldquo;controller&rdquo; is quite overloaded: we use to qualify the binary that runs in
a pod and watches for objects (&ldquo;Kubernetes controller&rdquo;), but we also use it
to mean &ldquo;one sync loop&rdquo; that is running inside this binary.</p>
<p>Anyone writing Kubernetes controllers might want to take a look at the
following resources.
One controller</p>
<p><strong><a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md">Kubernetes API conventions</a></strong></p>
<blockquote>
<p>When a new version of an object is POSTed or PUT, the &ldquo;spec&rdquo; is updated
and available immediately. Over time the system will work to bring the
&ldquo;status&rdquo; into line with the &ldquo;spec&rdquo;. The system will drive toward the most
recent &ldquo;spec&rdquo; regardless of previous versions of that stanza. In other
words, if a value is changed from 2 to 5 in one PUT and then back down to
3 in another PUT the system is not required to &lsquo;touch base&rsquo; at 5 before
changing the &ldquo;status&rdquo; to 3. In other words, the system&rsquo;s behavior is
level-based rather than edge-based. This enables robust behavior in the
presence of missed intermediate state changes.</p>
</blockquote>
<script src="https://utteranc.es/client.js"
        repo="maelvls/maelvls.github.io"
        issue-term="pathname"
        label="ðŸ’¬"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

</div>
<div class="tags">









<div class="taxosfloating_left">
<p>Tags</p>
</div>
<div class="termsfloating_right">
<p>















<a href="/tags/go/"> go </a>























<a href="/tags/kubernetes/"> kubernetes </a>



































</div>
<div class="clearit"></div>





</div></div>
</div>

</main><footer>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-88710120-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</footer>
</body>
</html>
