<!DOCTYPE html>
<html lang="en"><head>

  <meta name="generator" content="Hugo 0.64.0" />
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="author" content="Ma√´l Valais"><meta name="keywords" content="go,software-engineering"><meta name="description" content="We often talk about avoiding unecessary comments that needlessly paraphrase
what the code does. In this article, I gathered some thoughts about why
writing comments is as important as writing the code itself.
"><meta property="og:title" content="You should write comments" />
<meta property="og:description" content="We often talk about avoiding unecessary comments that needlessly paraphrase
what the code does. In this article, I gathered some thoughts about why
writing comments is as important as writing the code itself.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://maelvls.dev/do-not-share-yet/you-should-write-comments/" />
<meta property="og:image" content="https://maelvls.dev/do-not-share-yet/you-should-write-comments/cover-you-should-write-comments.png" />
<meta property="article:published_time" content="2020-02-27T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-02-27T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://maelvls.dev/do-not-share-yet/you-should-write-comments/cover-you-should-write-comments.png"/>

<meta name="twitter:title" content="You should write comments"/>
<meta name="twitter:description" content="We often talk about avoiding unecessary comments that needlessly paraphrase
what the code does. In this article, I gathered some thoughts about why
writing comments is as important as writing the code itself.
"/>
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
  <link rel="stylesheet" type="text/css" media="screen" href="https://maelvls.dev/do-not-share-yet/css/normalize.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="https://maelvls.dev/do-not-share-yet/css/main.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="https://maelvls.dev/do-not-share-yet/css/all.css" />
<link rel="stylesheet" type="text/css" media="screen" href="https://maelvls.dev/do-not-share-yet/css/maelvls.css" /><title>You should write comments | maelvls dev blog</title></head>
<body>

<header>

  <div id="avatar">
    <a href="https://maelvls.dev/do-not-share-yet/">
      <img src="/img/mael.jpg" alt="maelvls dev blog">
    </a>
  </div>

  <div id="titletext"><h2 id="title"><a href="https://maelvls.dev/do-not-share-yet/">maelvls dev blog</a></h2></div>
  <div id="title-description"><p id="subtitle">Systems software engineer. I write mostly about Kubernetes and Go. <a href="/about">About</a></p><div id=social>
    <nav>
      <ul><li><a href="https://github.com/maelvls"><i title="Github" class="icons fab fa-github"></i></a></li><li><a href="https://twitter.com/maelvls"><i title="Twitter" class="icons fab fa-twitter"></i></a></li></ul>
    </nav>
  </div>
  </div>
  <div id="mainmenu">
	
  </div>
</header>
<main><div class="post">
<div class="author">

</div>
<div class="post-header">

<div class="meta">
<div class="date">
<span class="day">27</span>
<span class="rest">Feb 2020</span>
</div>
</div>

<div class="matter">
<h1 class="title">You should write comments</h1>
</div>
</div>
<div class="markdown">
<p>Comments are one of these topics that we seem to never agree on (<a href="https://softwareengineering.stackexchange.com/questions/1/comments-are-a-code-smell">stackoverflow</a> says so). I often hear that comments add noise to the code and that comments never get properly updated.</p>
<p>The solution seems to be to properly self-document code. And I love Go for that; one of the Go proverbs even <a href="https://go-proverbs.github.io/">says</a>:</p>
<blockquote>
<p>Clear is better than clever.</p>
</blockquote>
<p>It is true that Go favors easy-to-read code rather than smart-but-hard-to-parse code, which really helps to keep the level of comments low. But there are still many reasons comments are still needed.</p>
<h3 id="fighting-tribal-knowledge">Fighting tribal knowledge</h3>
<p>Excellent naming and structure cannot help with the &ldquo;why&rdquo; of a piece of code. Complex math operations is a typical example of code that needs to be thougouly commented. Teams want to keep the amount of &ldquo;tribal knowledge&rdquo; as low as possible, and the only way in this kind of situation is to write comments. Take a look at <a href="https://github.com/haproxy/haproxy/blob/530408f976e5fe2f2f2b4b733b39da36770b566f/include/proto/freq_ctr.h#L138-L248">this</a> for example.</p>
<h3 id="good-naming-takes-time">Good naming takes time</h3>
<p>Finding a good name that properly carries the exact intent and help self-documenting takes time. It always takes a few iterations before the code becomes self-documenting enough to be able to remove comments.</p>
<p><img src="chart-comments-over-time.svg" alt="Number of comments lowers with time"></p>
<p>As shown by the diagram, the amount of comments for a given codebase decreases thanks to PR reviews and refactorings. The more we learn and understand our codebase, the better we become at self-documenting.</p>
<h3 id="comments-are-disposable-dont-copy-them-over">Comments are disposable, don&rsquo;t copy them over</h3>
<p>Now, let&rsquo;s talk about the issue of comments becoming outdated. Over time, comments start lying. That&rsquo;s where my second point comes into play: deleting and rewriting comments is part of our job. I would even say that it takes around 40% of my time spent coding.</p>
<p>During code reviews, I pay extra attention to these comments. And yes, very often, comments don&rsquo;t make sense anymore because of some copy-paste of code. We must delete any copy-pasted comment and rewrite it. Spreading copy-pasted comments that we don&rsquo;t really know why they were added in the first place is a plague.</p>
<hr>
<p>As a final word, I want us to remember that yes, maintaining comments is a pain. Comments will eventually start lying if you don&rsquo;t delete and rewrite them. But would you rather have no comments at all and let the amount of tribal knowledge creep in every part of your codebase, making it harder and harder for new engineers to join the team?</p>
<p>I think we all enjoy reading good comments. Well commented code is an art. Some projects like HAProxy, Git or the Linux kernel have done an amazing job at keeping knowledge accessible as opposed to knowledge locked in and scattered across many brains. Just take a look at <a href="https://github.com/haproxy/haproxy/blob/530408f976e5fe2f2f2b4b733b39da36770b566f/ebtree/ebtree.h#L23"><code>ebtree/ebtree.h</code></a> (HAProxy), <a href="https://github.com/git/git/blob/2d2118b814c11f509e1aa76cb07110f7231668dc/unpack-trees.c#L821-L836"><code>unpack-trees.c</code></a> (Git) and <a href="https://github.com/torvalds/linux/blob/bfdc6d91a25f4545bcd1b12e3219af4838142ef1/kernel/sched/core.c#L157-L171"><code>kernel/sched/core.c</code></a> (Linux kernel). Absolute delights.</p>
<!--
Join the discussion on Twitter:

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">I know I know comments always end up outdated and so on. But I really think we should still write beautiful comments! üòá<a href="https://t.co/704lUCDzo2">https://t.co/704lUCDzo2</a></p>&mdash; Ma√´l Valais (@maelvls) <a href="https://twitter.com/maelvls/status/1233140530017644544?ref_src=twsrc%5Etfw">February 27, 2020</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

\--><blockquote>
</blockquote>

</div>
<a href="https://github.com/maelvls/maelvls.github.io/edit/source/content/2020/you-should-write-comments/index.md">üìù Edit this page and propose a change!</a>
<div class="tags">










<div style="float: right;">
<p>Tags:











































<a href="/tags/go/"> go </a>



















































































<a href="/tags/software-engineering/"> software-engineering </a>















</div>
<div class="clearit"></div>





</div>

<script
  src="https://utteranc.es/client.js"
  repo="maelvls/maelvls.github.io"
  issue-term="pathname"
  label="üí¨"
  theme="github-light"
  crossorigin="anonymous"
  async
></script>
</div>

</main><footer>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-88710120-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</footer>
</body>
</html>
