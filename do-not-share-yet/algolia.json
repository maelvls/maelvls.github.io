[{"authors":null,"categories":null,"content":"\u003cp\u003eHi! My name is Maël, I am a software engineer based in \u003ca href=\"https://www.google.com/maps/place/Toulouse/@46.6763781,0.1867932,5.46z/data=!4m5!3m4!1s0x12aebb6fec7552ff:0x406f69c2f411030!8m2!3d43.604652!4d1.444209\"\u003eToulouse, France\u003c/a\u003e. I mostly write Go, Kubernetes controllers and network-related components. I like details.\u003c/p\u003e\n\u003cp\u003eI currently work on \u003ca href=\"https://github.com/jetstack/cert-manager\"\u003ecert-manager\u003c/a\u003e, an open-souce CNCF incubated X.509 lifecycle manager that my employer, \u003ca href=\"https://www.jetstack.io/\"\u003eCyberArk\u003c/a\u003e, helps maintaining. See my resume at \u003ca href=\"https://github.com/maelvls\"\u003ehttps://github.com/maelvls\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003ePreviously: Jetstack, Venafi, Ori Industries.\u003c/p\u003e\n\u003cp\u003eI completed a PhD in logic in 2019 (\u003ca href=\"https://scholar.google.com/citations?user=0BrmuaAAAAAJ\u0026amp;hl=en\u0026amp;oi=ao\"\u003epapers\u003c/a\u003e).\u003c/p\u003e\n","date":1748344636,"description":"","dir":"/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1748344636,"objectID":"6083a88ee3411b0d17ce02d738f69d47","permalink":"https://maelvls.dev/do-not-share-yet/about/","publishdate":"2025-05-27T11:17:16Z","readingtime":1,"relpermalink":"/do-not-share-yet/about/","section":"","summary":"\u003cp\u003eHi! My name is Maël, I am a software engineer based in \u003ca href=\"https://www.google.com/maps/place/Toulouse/@46.6763781,0.1867932,5.46z/data=!4m5!3m4!1s0x12aebb6fec7552ff:0x406f69c2f411030!8m2!3d43.604652!4d1.444209\"\u003eToulouse, France\u003c/a\u003e. I mostly write Go, Kubernetes controllers and network-related components. I like details.\u003c/p\u003e\n\u003cp\u003eI currently work on \u003ca href=\"https://github.com/jetstack/cert-manager\"\u003ecert-manager\u003c/a\u003e, an open-souce CNCF incubated X.509 lifecycle manager that my employer, \u003ca href=\"https://www.jetstack.io/\"\u003eCyberArk\u003c/a\u003e, helps maintaining. See my resume at \u003ca href=\"https://github.com/maelvls\"\u003ehttps://github.com/maelvls\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003ePreviously: Jetstack, Venafi, Ori Industries.\u003c/p\u003e\n\u003cp\u003eI completed a PhD in logic in 2019 (\u003ca href=\"https://scholar.google.com/citations?user=0BrmuaAAAAAJ\u0026amp;hl=en\u0026amp;oi=ao\"\u003epapers\u003c/a\u003e).\u003c/p\u003e","tags":null,"title":"About","type":"page","url":"https://maelvls.dev/do-not-share-yet/about/","weight":0,"wordcount":63},{"authors":null,"categories":null,"content":"","date":1748344636,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"home","lang":"en","lastmod":1748344636,"objectID":"https://maelvls.dev/do-not-share-yet/","permalink":"https://maelvls.dev/do-not-share-yet/","publishdate":"2025-05-27T11:17:16Z","readingtime":0,"relpermalink":"/do-not-share-yet/","section":"","summary":"","tags":null,"title":"maelvls dev blog","type":"page","url":"https://maelvls.dev/do-not-share-yet/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cscript\u003e\n  // Old:\n  //  https://maelvls.dev/print-your-cert?asn1=MIICXDCCAgOgAwIBAgIQdPaTuGSUDeosii4dbdLBgTAKBggqhkjOPQQDAjAnMSUwIwYDVQQDExxUaGUgY2VydC1tYW5hZ2VyIG1haW50YWluZXJzMB4XDTIyMDUxNjEzMDkwMFoXDTIyMDgxNDEzMDkwMFowLDEqMCgGA1UEAwwhZm9vIGJhciBmb28gYmFyIDxmb28uYmFyQGJhci5mb28%2BMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtmGM5lil9Vw%2Fy5LhpgO8t5gSb5oUo%2BDp5vWw0Z5C7rjvifi0%2FeD9MbVFkxb%2B%2BhmOaaNCVgqDUio1OBOZyL90KzdnGW7nz1fRM2KCNrDF5Y1mO7uv1ZTZa8cVBjF67KjFuNkvvHp74m65bKwXeCHXJBmO3Z1FH8hudICU74%2BNl6tyjlMOsTHv%2BLY0jPfmAtO6eR%2BEf%2FHvgzwsjKds12vdlRCdHSS6u5zlrZZxF3zTO7YuAM7mN8Wbjq94YcpgsJ5ssNOtMu9FwZtPGQDHPaQyVQ86FfjhmMi1IUOUAAGwh%2FQRv8ksX%2BOupHTNdH06WmIDCaGBjWFgPkwicavMZgZG3QIDAQABo0EwPzAOBgNVHQ8BAf8EBAMCBaAwDAYDVR0TAQH%2FBAIwADAfBgNVHSMEGDAWgBQG5XQnDhOUa748L9H7TWZN2avluTAKBggqhkjOPQQDAgNHADBEAiBXmyJ24PTG76pEyq6AQtCo6TXEidqJhsmK9O5WjGBw7wIgaPbcFI5iMMgfPGEATH2AGGutZ6MlxBmwhEO7pAkqhQc%3D\n  // New:\n  //  https://cert-manager.github.io/print-your-cert/?asn1=MIICXDCCAgOgAwIBAgIQdPaTuGSUDeosii4dbdLBgTAKBggqhkjOPQQDAjAnMSUwIwYDVQQDExxUaGUgY2VydC1tYW5hZ2VyIG1haW50YWluZXJzMB4XDTIyMDUxNjEzMDkwMFoXDTIyMDgxNDEzMDkwMFowLDEqMCgGA1UEAwwhZm9vIGJhciBmb28gYmFyIDxmb28uYmFyQGJhci5mb28%2BMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtmGM5lil9Vw%2Fy5LhpgO8t5gSb5oUo%2BDp5vWw0Z5C7rjvifi0%2FeD9MbVFkxb%2B%2BhmOaaNCVgqDUio1OBOZyL90KzdnGW7nz1fRM2KCNrDF5Y1mO7uv1ZTZa8cVBjF67KjFuNkvvHp74m65bKwXeCHXJBmO3Z1FH8hudICU74%2BNl6tyjlMOsTHv%2BLY0jPfmAtO6eR%2BEf%2FHvgzwsjKds12vdlRCdHSS6u5zlrZZxF3zTO7YuAM7mN8Wbjq94YcpgsJ5ssNOtMu9FwZtPGQDHPaQyVQ86FfjhmMi1IUOUAAGwh%2FQRv8ksX%2BOupHTNdH06WmIDCaGBjWFgPkwicavMZgZG3QIDAQABo0EwPzAOBgNVHQ8BAf8EBAMCBaAwDAYDVR0TAQH%2FBAIwADAfBgNVHSMEGDAWgBQG5XQnDhOUa748L9H7TWZN2avluTAKBggqhkjOPQQDAgNHADBEAiBXmyJ24PTG76pEyq6AQtCo6TXEidqJhsmK9O5WjGBw7wIgaPbcFI5iMMgfPGEATH2AGGutZ6MlxBmwhEO7pAkqhQc%3D\n  window.location.replace(\n    \"https://cert-manager.github.io/print-your-cert/\" + location.search\n  );\n\u003c/script\u003e\n","date":1748344636,"description":"","dir":"/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1748344636,"objectID":"26c4855b6a252495e29f7b1a24c0d668","permalink":"https://maelvls.dev/do-not-share-yet/print-your-cert/","publishdate":"2025-05-27T11:17:16Z","readingtime":0,"relpermalink":"/do-not-share-yet/print-your-cert/","section":"","summary":"\u003cscript\u003e\n  // Old:\n  //  https://maelvls.dev/print-your-cert?asn1=MIICXDCCAgOgAwIBAgIQdPaTuGSUDeosii4dbdLBgTAKBggqhkjOPQQDAjAnMSUwIwYDVQQDExxUaGUgY2VydC1tYW5hZ2VyIG1haW50YWluZXJzMB4XDTIyMDUxNjEzMDkwMFoXDTIyMDgxNDEzMDkwMFowLDEqMCgGA1UEAwwhZm9vIGJhciBmb28gYmFyIDxmb28uYmFyQGJhci5mb28%2BMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtmGM5lil9Vw%2Fy5LhpgO8t5gSb5oUo%2BDp5vWw0Z5C7rjvifi0%2FeD9MbVFkxb%2B%2BhmOaaNCVgqDUio1OBOZyL90KzdnGW7nz1fRM2KCNrDF5Y1mO7uv1ZTZa8cVBjF67KjFuNkvvHp74m65bKwXeCHXJBmO3Z1FH8hudICU74%2BNl6tyjlMOsTHv%2BLY0jPfmAtO6eR%2BEf%2FHvgzwsjKds12vdlRCdHSS6u5zlrZZxF3zTO7YuAM7mN8Wbjq94YcpgsJ5ssNOtMu9FwZtPGQDHPaQyVQ86FfjhmMi1IUOUAAGwh%2FQRv8ksX%2BOupHTNdH06WmIDCaGBjWFgPkwicavMZgZG3QIDAQABo0EwPzAOBgNVHQ8BAf8EBAMCBaAwDAYDVR0TAQH%2FBAIwADAfBgNVHSMEGDAWgBQG5XQnDhOUa748L9H7TWZN2avluTAKBggqhkjOPQQDAgNHADBEAiBXmyJ24PTG76pEyq6AQtCo6TXEidqJhsmK9O5WjGBw7wIgaPbcFI5iMMgfPGEATH2AGGutZ6MlxBmwhEO7pAkqhQc%3D\n  // New:\n  //  https://cert-manager.github.io/print-your-cert/?asn1=MIICXDCCAgOgAwIBAgIQdPaTuGSUDeosii4dbdLBgTAKBggqhkjOPQQDAjAnMSUwIwYDVQQDExxUaGUgY2VydC1tYW5hZ2VyIG1haW50YWluZXJzMB4XDTIyMDUxNjEzMDkwMFoXDTIyMDgxNDEzMDkwMFowLDEqMCgGA1UEAwwhZm9vIGJhciBmb28gYmFyIDxmb28uYmFyQGJhci5mb28%2BMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtmGM5lil9Vw%2Fy5LhpgO8t5gSb5oUo%2BDp5vWw0Z5C7rjvifi0%2FeD9MbVFkxb%2B%2BhmOaaNCVgqDUio1OBOZyL90KzdnGW7nz1fRM2KCNrDF5Y1mO7uv1ZTZa8cVBjF67KjFuNkvvHp74m65bKwXeCHXJBmO3Z1FH8hudICU74%2BNl6tyjlMOsTHv%2BLY0jPfmAtO6eR%2BEf%2FHvgzwsjKds12vdlRCdHSS6u5zlrZZxF3zTO7YuAM7mN8Wbjq94YcpgsJ5ssNOtMu9FwZtPGQDHPaQyVQ86FfjhmMi1IUOUAAGwh%2FQRv8ksX%2BOupHTNdH06WmIDCaGBjWFgPkwicavMZgZG3QIDAQABo0EwPzAOBgNVHQ8BAf8EBAMCBaAwDAYDVR0TAQH%2FBAIwADAfBgNVHSMEGDAWgBQG5XQnDhOUa748L9H7TWZN2avluTAKBggqhkjOPQQDAgNHADBEAiBXmyJ24PTG76pEyq6AQtCo6TXEidqJhsmK9O5WjGBw7wIgaPbcFI5iMMgfPGEATH2AGGutZ6MlxBmwhEO7pAkqhQc%3D\n  window.location.replace(\n    \"https://cert-manager.github.io/print-your-cert/\" + location.search\n  );\n\u003c/script\u003e","tags":null,"title":"print-your-cert redirect","type":"page","url":"https://maelvls.dev/do-not-share-yet/print-your-cert/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1713376233,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"section","lang":"en","lastmod":1713376233,"objectID":"https://maelvls.dev/do-not-share-yet/2024/","permalink":"https://maelvls.dev/do-not-share-yet/2024/","publishdate":"2024-04-17T19:50:33+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/2024/","section":"2024","summary":"","tags":null,"title":"2024s","type":"2024","url":"https://maelvls.dev/do-not-share-yet/2024/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1713376233,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1713376233,"objectID":"https://maelvls.dev/do-not-share-yet/tags/google/","permalink":"https://maelvls.dev/do-not-share-yet/tags/google/","publishdate":"2024-04-17T19:50:33+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/google/","section":"tags","summary":"","tags":null,"title":"Google","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/google/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eMy parents and I share a DS923+. We mainly use it for storing photos. To save energy, the NAS is stopped at night and restarted in the morning. Restarting the NAS means that you need to log in to the UI at least once every day.\u003c/p\u003e\n\u003cp\u003eAnd since my parents don\u0026rsquo;t use the Synology often, they would first struggle remembering what the username thing is about. And then, they would forget about their password, which would lead to me having to reset it because Synology hasn\u0026rsquo;t implemented a way to reset the password over email:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"syno-login-username-1.jpeg\" alt=\"Synology login screen where you are asked for your username but don\u0026rsquo;t remember it\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"syno-login-username-2.jpeg\" alt=\"Synology login screen where you are asked to enter your password after having entered your username\"\u003e\u003c/p\u003e\n\u003cp\u003eOver the past two years, my parents forgot their passwords a couple of times. It led me to look for an alternative way to log into the NAS\u0026hellip; why not use their Google accounts using the single sign-on mechanism?\u003c/p\u003e\n\u003ch2 id=\"challenges-with-local-accounts-and-sso\"\u003eChallenges with Local Accounts and SSO\u003c/h2\u003e\n\u003cp\u003eA couple of years ago, Synology introduced SSO (single sign-on). Since 7.2, DSM supports generic OIDC providers, and supports logging into local users (it used to be only possible for LDAP users).\u003c/p\u003e\n\u003cp\u003eSince my parents are always signed in into their Google account, I figured it would be possible to use OIDC with Google\u0026hellip; Except it won\u0026rsquo;t work with local accounts.\u003c/p\u003e\n\u003cp\u003eHere is what I tried: I created a My OIDC configuration for Google looked like this:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"credentials-page-in-api-and-services-gcp-console.png\" alt=\"Credentials page in API and Services in GCP\u0026rsquo;s Console\"\u003e\u003c/p\u003e\n\u003cp\u003eThen, I configured my Synology to use Google\u0026rsquo;s OIDC endpoint:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"config-sso-client-using-google-oidc.png\" alt=\"Configuration of the SSO Client using Google OIDC in DSM\"\u003e\u003c/p\u003e\n\u003cp\u003eThe problem arose with the \u0026ldquo;Username claim\u0026rdquo;. I want to log into my local account \u003ccode\u003emael.valais\u003c/code\u003e, but none of the claims in Google\u0026rsquo;s ID tokens contain that username. Here is an example of a Google ID token:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;iss\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;https://accounts.google.com\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;aud\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1234987819200.apps.googleusercontent.com\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;sub\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;10769150350006150715113082367\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;email\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;jsmith@example.com\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;email_verified\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;iat\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1353601026\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;exp\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1353604926\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"forking-dex-to-use-it-as-an-oidc-middleware-for-google-oidc\"\u003eForking Dex to use it as an OIDC middleware for Google OIDC\u003c/h2\u003e\n\u003cp\u003eI figured I could use Dex to act as a middleware between Synology\u0026rsquo;s OIDC client and Google\u0026rsquo;s OIDC server. My goal was to \u0026ldquo;augment\u0026rdquo; Google\u0026rsquo;s JWTs with Synology\u0026rsquo;s usernames by looking up the user by email.\u003c/p\u003e\n\u003cp\u003eDex isn\u0026rsquo;t as flexible as I would have hoped. To make it work, I had to fork it to change the internals of the Google OIDC connector.\u003c/p\u003e\n\u003cp\u003eFork: \u003ca href=\"https://github.com/maelvls/dex/tree/google-to-synology-sso\"\u003ehttps://github.com/maelvls/dex/tree/google-to-synology-sso\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThis fork is a fork of the fork presented in \u003ca href=\"https://github.com/dexidp/dex/pull/2954\"\u003ehttps://github.com/dexidp/dex/pull/2954\u003c/a\u003e. It builds on the idea of the \u003ccode\u003eExtendPayload\u003c/code\u003e interface, which I slightly adjusted to pass the original claims since I needed access to the email contained in the JWT provided by Google.\u003c/p\u003e\n\u003cp\u003eWith this fork, you will need to set three more environment variables:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSYNO_PASSWD\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eredacted\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSYNO_USER\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003emael.valais\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eSYNO_URL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttp://127.0.0.1:5000\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWhen the OIDC flow with Google is done and before Dex issues its own JWT, I added some code to add the claim \u003ccode\u003eusername\u003c/code\u003e. With this modified Dex, the JWT looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;at_hash\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;-j6HZYvzDaqkQB2KxIgSyw\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;aud\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;caddy\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;c_hash\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;8SK3tobDYgaI3cnDzkmi5g\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;email\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;mael65@gmail.com\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;email_verified\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;exp\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1713387587\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;iat\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1713301187\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;iss\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;https://login.mysynodomain.dev/dex\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Maël Valais\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;nonce\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;MFZFSkESL1XqdQmbvr0T43Kn7v0CzLap\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;sub\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ChUxMDAzNjk3OTQzNjg3MDAwOTk5MTISBmdvb2dsZQ\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;username\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;mael.valais\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHere is the updated configuration in DSM:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"./config-sso-client-with-dex-in-dsm.png\" alt=\"Configuration of the SSO Client using Dex in DSM\"\u003e\u003c/p\u003e\n\u003ch2 id=\"using-the-fork-of-dex\"\u003eUsing the fork of Dex\u003c/h2\u003e\n\u003cp\u003eCreate a file \u003ccode\u003edex.yaml\u003c/code\u003e on your NAS:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eissuer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttps://login.mysynodomain.dev/dex\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estorage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003esqlite3\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003edex.sqlite\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eweb\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ehttp\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e0.0.0.0\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e5556\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003elevel\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003edebug\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eoauth2\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"nt\"\u003eskipApprovalScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"nt\"\u003ealwaysShowLoginScreen\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estaticClients\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e- \u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003esynology\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Synology\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eredirectURIs\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e- \u003cspan class=\"s1\"\u003e\u0026#39;https://mysynodomain.dev/\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003esecret\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003efoo\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# Use openssl rand -hex 16 to generate this.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003econnectors\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003egoogle\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eid\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003egoogle\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eGoogle\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econfig\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eissuer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttps://accounts.google.com\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eclientID\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e$GOOGLE_CLIENT_ID\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eclientSecret\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e$GOOGLE_CLIENT_SECRET\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eredirectURI\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttps://login.mysynodomain.dev/dex/callback\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"c\"\u003e# I have disabled email login.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eenablePasswordDB\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFinally, run Dex:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWith this command, you will be using Dex images that I built:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-text\" data-lang=\"text\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eghcr.io/maelvls/dex\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eI wouldn\u0026rsquo;t recommend using random Docker images from the internet, especially since this is about authentication. I might be a malicious actor trying to steal your Synology credentials! But if you still want to proceed, here is an image! Note that I am not monitoring the image for security vulnerabilities, and do not guarantee that it is secure. Use at your own risk!\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run --name dex -d \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -v \u003cspan class=\"nv\"\u003e$HOME\u003c/span\u003e/dex.yaml:/dex.yaml \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -v \u003cspan class=\"nv\"\u003e$HOME\u003c/span\u003e/dex.sqlite:/dex.sqlite \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -e \u003cspan class=\"nv\"\u003eSYNO_PASSWD\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eredacted \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -e \u003cspan class=\"nv\"\u003eSYNO_USER\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003emael.valais \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -e \u003cspan class=\"nv\"\u003eSYNO_URL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttp://127.0.0.1:5000 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -e \u003cspan class=\"nv\"\u003eGOOGLE_CLIENT_ID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e207842732284-l7nhetlsvimmds80fa2knir8fundp3h4.apps.googleusercontent.com \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -e \u003cspan class=\"nv\"\u003eGOOGLE_CLIENT_SECRET\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eredacted \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -p 5556:5556 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  ghcr.io/maelvls/dex:google-to-synology-sso-v1@sha256:345c8fec6b222c308759f21864c6af3b16c373801fd5e0b7ad4b131a743d3b07 serve /dex.yaml\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"rebuilding-the-image-yourself-and-pushing-it-to-your-synology-nas\"\u003eRebuilding the image yourself and pushing it to your Synology NAS\u003c/h2\u003e\n\u003cp\u003eFirst, install \u003ccode\u003ezig\u003c/code\u003e and \u003ccode\u003eko\u003c/code\u003e. That will allow you to cross-compile Dex to \u003ccode\u003elinux/amd64\u003c/code\u003e on macOS without Buildx (cross-compiling is required because Dex\u0026rsquo;s sqlite library needs CGO)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install ko zig\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eClone the fork:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clone https://github.com/maelvls/dex --branch google-to-synology-sso\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThen, build the image:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eCC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;zig cc -target x86_64-linux\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eCXX\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;zig c++ -target x86_64-linux\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eCGO_ENABLED\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"nv\"\u003eKO_DOCKER_REPO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eghcr.io/maelvls/dex \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"nv\"\u003eKO_DEFAULTBASEIMAGE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ealpine \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  ko build ./cmd/dex --bare --tarball /tmp/out.tar --push\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThen, copy the image to your NAS:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh yournas /usr/local/bin/docker load \u0026lt;/tmp/out.tar\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"just-so-that-i-dont-forget-here-is-how-i-pushed-ghcriomaelvlsdex-to-github-container-registry\"\u003e(Just so that I don\u0026rsquo;t forget) Here is how I pushed \u003ccode\u003eghcr.io/maelvls/dex\u003c/code\u003e to GitHub Container Registry\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit tag google-to-synology-sso-v1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit push maelvls google-to-synology-sso-v1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThen, I built and pushed the image with \u003ccode\u003eko\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eCC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;zig cc -target x86_64-linux\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eCXX\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;zig c++ -target x86_64-linux\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eCGO_ENABLED\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"nv\"\u003eKO_DOCKER_REPO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eghcr.io/maelvls/dex \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"nv\"\u003eKO_DEFAULTBASEIMAGE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ealpine \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  ko build ./cmd/dex --bare --push\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003etrue\u003c/span\u003e --tags google-to-synology-sso-v1 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    --image-annotation \u003cspan class=\"s2\"\u003e\u0026#34;org.opencontainers.image.description=Google to Synology SSO\u0026#34;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    --image-annotation \u003cspan class=\"s2\"\u003e\u0026#34;org.opencontainers.image.source=https://github.com/maelvls/dex\u0026#34;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    --image-annotation \u003cspan class=\"s2\"\u003e\u0026#34;org.opencontainers.image.revision=\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003egit rev-parse HEAD\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    --image-annotation \u003cspan class=\"s2\"\u003e\u0026#34;org.opencontainers.image.documentation=https://maelvls.dev/synology-sso-with-personal-google-account/\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe image (with hash) is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-text\" data-lang=\"text\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eghcr.io/maelvls/dex:google-to-synology-sso-v1@sha256:345c8fec6b222c308759f21864c6af3b16c373801fd5e0b7ad4b131a743d3b07\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eWith this method, my parents can log into the NAS with their Google account and no longer have to remember their Synology username and password.\u003c/p\u003e\n\u003cp\u003eAlthough it works, I wish I didn\u0026rsquo;t have to fork Dex to customize the claims it puts into the JWT payload. I came across a couple of designs that would aim to make Dex more extendable, but none have been implemented yet.\u003c/p\u003e\n\u003cp\u003eThe login flow is much smoother now: click \u0026ldquo;Login with Google\u0026rdquo;, select the Google account, and you\u0026rsquo;re in! Just two screens:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"syno-login-sso-google-account-1.jpeg\" alt=\"Synology login screen that shows a button that says Login with Google\"\u003e\n\u003cimg src=\"syno-login-sso-google-account-2.jpeg\" alt=\"Google screen allowing you to select a Google account\"\u003e\u003c/p\u003e\n","date":1713376233,"description":"Learn how to simplify access to your Synology NAS by enabling single sign-on (SSO) with personal Google accounts.","dir":"2024/synology-sso-with-personal-google-account/","expirydate":-62135596800,"fuzzywordcount":1000,"images":["synology-sso-with-personal-google-account/cover-synology-sso-with-personal-google-account.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1713376233,"objectID":"511883a81310386900e67736cbfeddde","permalink":"https://maelvls.dev/do-not-share-yet/synology-sso-with-personal-google-account/","publishdate":"2024-04-17T19:50:33+02:00","readingtime":5,"relpermalink":"/do-not-share-yet/synology-sso-with-personal-google-account/","section":"2024","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eMy parents and I share a DS923+. We mainly use it for storing photos. To save energy, the NAS is stopped at night and restarted in the morning. Restarting the NAS means that you need to log in to the UI at least once every day.\u003c/p\u003e\n\u003cp\u003eAnd since my parents don\u0026rsquo;t use the Synology often, they would first struggle remembering what the username thing is about. And then, they would forget about their password, which would lead to me having to reset it because Synology hasn\u0026rsquo;t implemented a way to reset the password over email:\u003c/p\u003e","tags":["Synology","NAS","Single Sign-On","Google","OIDC"],"title":"Logging into Synology NAS with Personal Google Accounts","type":"2024","url":"https://maelvls.dev/do-not-share-yet/synology-sso-with-personal-google-account/","weight":0,"wordcount":923},{"authors":null,"categories":null,"content":"","date":1713376233,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1713376233,"objectID":"https://maelvls.dev/do-not-share-yet/tags/nas/","permalink":"https://maelvls.dev/do-not-share-yet/tags/nas/","publishdate":"2024-04-17T19:50:33+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/nas/","section":"tags","summary":"","tags":null,"title":"NAS","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/nas/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1713376233,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1713376233,"objectID":"https://maelvls.dev/do-not-share-yet/tags/oidc/","permalink":"https://maelvls.dev/do-not-share-yet/tags/oidc/","publishdate":"2024-04-17T19:50:33+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/oidc/","section":"tags","summary":"","tags":null,"title":"OIDC","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/oidc/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1713376233,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1713376233,"objectID":"https://maelvls.dev/do-not-share-yet/tags/single-sign-on/","permalink":"https://maelvls.dev/do-not-share-yet/tags/single-sign-on/","publishdate":"2024-04-17T19:50:33+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/single-sign-on/","section":"tags","summary":"","tags":null,"title":"Single Sign-On","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/single-sign-on/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1713376233,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1713376233,"objectID":"https://maelvls.dev/do-not-share-yet/tags/synology/","permalink":"https://maelvls.dev/do-not-share-yet/tags/synology/","publishdate":"2024-04-17T19:50:33+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/synology/","section":"tags","summary":"","tags":null,"title":"Synology","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/synology/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1713376233,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"taxonomy","lang":"en","lastmod":1713376233,"objectID":"https://maelvls.dev/do-not-share-yet/tags/","permalink":"https://maelvls.dev/do-not-share-yet/tags/","publishdate":"2024-04-17T19:50:33+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/","section":"tags","summary":"","tags":null,"title":"Tags","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1686644166,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"section","lang":"en","lastmod":1686644166,"objectID":"https://maelvls.dev/do-not-share-yet/2023/","permalink":"https://maelvls.dev/do-not-share-yet/2023/","publishdate":"2023-06-13T10:16:06+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/2023/","section":"2023","summary":"","tags":null,"title":"2023s","type":"2023","url":"https://maelvls.dev/do-not-share-yet/2023/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003c!--\n\nhttps://github.com/maelvls/hack-your-controller-in-bash\n\n--\u003e\n\u003ch2 id=\"step-1-controlling-a-built-in-resource-example-with-secret\"\u003eStep 1: Controlling a built-in resource: Example With Secret\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl get externalsecret --watch -ojson \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e jq \u003cspan class=\"s1\"\u003e\u0026#39;select(.status.conditions[]?.reason == \u0026#34;SecretSyncedError\u0026#34;)\u0026#39;\u003c/span\u003e --unbuffered \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e jq \u003cspan class=\"s1\"\u003e\u0026#39;.spec.data[0].remoteRef | \u0026#34;\\(.key) \\(.property)\u0026#34;\u0026#39;\u003c/span\u003e -r --unbuffered \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"nb\"\u003eread\u003c/span\u003e key property\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    vault kv put \u003cspan class=\"nv\"\u003e$key\u003c/span\u003e \u003cspan class=\"nv\"\u003e$property\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003esomerandomvalue\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"step-2-controlling-an-external-resource-with-a-crd-example-with\"\u003eStep 2: Controlling an external resource with a CRD: Example With\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eapiextensions.k8s.io/v1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eCustomResourceDefinition\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c\"\u003e# name must be in the form: \u0026lt;plural\u0026gt;.\u0026lt;group\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eposts.maelvls.dev\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003egroup\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003emaelvls.dev\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003escope\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eNamespaced\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003enames\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e{\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003ekind: Post, singular: post, plural\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eposts }\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eversions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eserved\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estorage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"nt\"\u003eopenAPIV3Schema\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eobject\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e              \u003c/span\u003e\u003cspan class=\"nt\"\u003ex-kubernetes-preserve-unknown-fields\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1686644166,"description":"","dir":"2023/quick-kubernetes-controller-in-bash/","expirydate":-62135596800,"fuzzywordcount":100,"images":["quick-kubernetes-controller-in-bash/cover-quick-kubernetes-controller-in-bash.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1686644166,"objectID":"de7a1165b2ef7c50837042e2aa476cb9","permalink":"https://maelvls.dev/do-not-share-yet/quick-kubernetes-controller-in-bash/","publishdate":"2023-06-13T10:16:06+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/quick-kubernetes-controller-in-bash/","section":"2023","summary":"\u003c!--\n\nhttps://github.com/maelvls/hack-your-controller-in-bash\n\n--\u003e\n\u003ch2 id=\"step-1-controlling-a-built-in-resource-example-with-secret\"\u003eStep 1: Controlling a built-in resource: Example With Secret\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl get externalsecret --watch -ojson \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e jq \u003cspan class=\"s1\"\u003e\u0026#39;select(.status.conditions[]?.reason == \u0026#34;SecretSyncedError\u0026#34;)\u0026#39;\u003c/span\u003e --unbuffered \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e jq \u003cspan class=\"s1\"\u003e\u0026#39;.spec.data[0].remoteRef | \u0026#34;\\(.key) \\(.property)\u0026#34;\u0026#39;\u003c/span\u003e -r --unbuffered \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"nb\"\u003eread\u003c/span\u003e key property\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    vault kv put \u003cspan class=\"nv\"\u003e$key\u003c/span\u003e \u003cspan class=\"nv\"\u003e$property\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003esomerandomvalue\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003edone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"step-2-controlling-an-external-resource-with-a-crd-example-with\"\u003eStep 2: Controlling an external resource with a CRD: Example With\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eapiextensions.k8s.io/v1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eCustomResourceDefinition\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"c\"\u003e# name must be in the form: \u0026lt;plural\u0026gt;.\u0026lt;group\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eposts.maelvls.dev\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003egroup\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003emaelvls.dev\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003escope\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eNamespaced\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003enames\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e{\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003ekind: Post, singular: post, plural\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eposts }\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eversions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eserved\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estorage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"nt\"\u003eopenAPIV3Schema\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eobject\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003eproperties\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e              \u003c/span\u003e\u003cspan class=\"nt\"\u003ex-kubernetes-preserve-unknown-fields\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[],"title":"Quick Kubernetes Controller in Bash","type":"2023","url":"https://maelvls.dev/do-not-share-yet/quick-kubernetes-controller-in-bash/","weight":0,"wordcount":99},{"authors":null,"categories":null,"content":"","date":1635598417,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"section","lang":"en","lastmod":1635598417,"objectID":"https://maelvls.dev/do-not-share-yet/2021/","permalink":"https://maelvls.dev/do-not-share-yet/2021/","publishdate":"2021-10-30T14:53:37+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/2021/","section":"2021","summary":"","tags":null,"title":"2021s","type":"2021","url":"https://maelvls.dev/do-not-share-yet/2021/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003ch1 id=\"access-private-ips-from-kubernetes-with-tailscale\"\u003eAccess Private IPs From Kubernetes With Tailscale\u003c/h1\u003e\n\u003cp\u003eI want to give all my Kubernetes pods access to my PC that is on a private network. The plan is to use a GCP VM as a \u0026ldquo;relay\u0026rdquo; where Tailscale is running and configure the VPC to forward traffic to the relay.\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eMachine\u003c/th\u003e\n          \u003cth\u003eGCP IPs\u003c/th\u003e\n          \u003cth\u003eTailscale IPs\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eaorus (my PC)\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e100.127.221.57\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003erelay\u003c/td\u003e\n          \u003ctd\u003e10.132.0.16\u003c/td\u003e\n          \u003ctd\u003e100.82.245.178\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003etest\u003c/td\u003e\n          \u003ctd\u003e10.132.0.17\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eThe first step is to get an ephemeral token on Tailscale:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"tailscale-get-token.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eNow, let us create the relay VM:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eTOKEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud compute instances create relay --machine-type f1-micro --zone europe-west1-c \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    --project jetstack-mael-valais --can-ip-forward \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    --metadata\u003cspan class=\"o\"\u003e=\u003c/span\u003estartup-script\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;sudo tee -a /etc/sysctl.conf \u0026lt;\u0026lt;\u0026lt;\u003c/span\u003e$\u003cspan class=\"s2\"\u003e\u0026#39;net.ipv4.ip_forward=1\\nnet.ipv6.conf.all.forwarding=1\u0026#39; \u0026amp;\u0026amp; tee .profile -a \u0026lt;\u0026lt;\u0026lt;\u0026#39;PATH=\\$PATH:/sbin:/usr/sbin\u0026#39; \u0026amp;\u0026amp; sudo update-alternatives --set iptables /usr/sbin/iptables-legacy \u0026amp;\u0026amp; curl -fsSL https://pkgs.tailscale.com/stable/ubuntu/focal.gpg | sudo apt-key add - \u0026amp;\u0026amp; curl -fsSL https://pkgs.tailscale.com/stable/ubuntu/focal.list | sudo tee /etc/apt/sources.list.d/tailscale.list \u0026amp;\u0026amp; sudo apt-get update \u0026amp;\u0026amp; sudo apt-get install tailscale \u0026amp;\u0026amp; sudo tailscale up --authkey \u003c/span\u003e\u003cspan class=\"nv\"\u003e$TOKEN\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eNote: the \u003ccode\u003eupdate-alternatives\u003c/code\u003e trick above is due to the fact that we are using Debian 10 that defaults \u003ccode\u003eiptables\u003c/code\u003e to its NF version. Here, we want to be using the legacy way.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eNow, let us make sure that all traffic that has the Tailscale IP as destination on my GCP project get routed to the relay VM:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud compute routes create tailscale --destination-range\u003cspan class=\"o\"\u003e=\u003c/span\u003e100.64.0.0/10 \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e    --next-hop-instance\u003cspan class=\"o\"\u003e=\u003c/span\u003erelay --project jetstack-mael-valais\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ gcloud compute ssh relay -- tailscale status\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e100.82.245.178  hit-me               maelvls@     linux   -\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e100.127.221.57  aorus                maelvls@     linux   idle, tx \u003cspan class=\"m\"\u003e4396\u003c/span\u003e rx \u003cspan class=\"m\"\u003e3076\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAt this point, I thought I was done, but I wasn\u0026rsquo;t. I created a test VM on my\nproject to test the setup:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud compute instances create \u003cspan class=\"nb\"\u003etest\u003c/span\u003e --machine-type f1-micro --zone europe-west1-c --project jetstack-mael-valais\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud compute ssh \u003cspan class=\"nb\"\u003etest\u003c/span\u003e -- sudo apt install netcat -y\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIt seems like my PC is not reachable from the test VM:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ gcloud compute ssh \u003cspan class=\"nb\"\u003etest\u003c/span\u003e -- nc -v 100.127.221.57 \u003cspan class=\"m\"\u003e22\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003eUNKNOWN\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003e100.127.221.57\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"m\"\u003e22\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003essh\u003cspan class=\"o\"\u003e)\u003c/span\u003e : Connection timed out\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud compute ssh relay --command \u003cspan class=\"s2\"\u003e\u0026#34;sudo tcpdump -U -i tailscale0 -w -\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e wireshark -k -y RAW -i -\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"wireshark-relay-tailscale0.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eThe packets seem to be sent correctly to my PC, but nothing is received. Let us see on my PC if anything gets received:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"wireshark-aorus-tailscale0.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eNo surprise, no packet is received. If we look closer to the packet that the relay is trying to send to my PC, we can see that the source address isn\u0026rsquo;t routable from my PC:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"wireshark-relay-tailscale0-annotated.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eMy guess is that the relay VM was able to send its packet, but my PC wouldn\u0026rsquo;t know how to send it back. I figured it needed changing the source IP:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Won\u0026#39;t be saved after a reboot of the VM!\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud compute ssh relay -- sudo iptables -t nat -A POSTROUTING -j SNAT --to-source 100.82.245.178\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eRetrying the test, it works:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ gcloud compute ssh \u003cspan class=\"nb\"\u003etest\u003c/span\u003e -- nc -v 100.127.221.57 \u003cspan class=\"m\"\u003e22\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e100.127.221.57: inverse host lookup failed: Unknown host\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003eUNKNOWN\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003e100.127.221.57\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"m\"\u003e22\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003essh\u003cspan class=\"o\"\u003e)\u003c/span\u003e open\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSSH-2.0-OpenSSH_8.4p1 Ubuntu-5ubuntu1.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e In order to reset the in-memory iptables rules, you can run:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -P INPUT ACCEPT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -P OUTPUT ACCEPT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -P FORWARD ACCEPT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -F\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -X\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -t nat -F\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -t nat -X\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -t mangle -F\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -t mangle -X\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eLet us see if we can reach my PC from a GKE cluster:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ gcloud container clusters create foo --project\u003cspan class=\"o\"\u003e=\u003c/span\u003ejetstack-mael-valais --zone\u003cspan class=\"o\"\u003e=\u003c/span\u003eeurope-west2-b\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ gcloud container clusters get-credentials foo --project\u003cspan class=\"o\"\u003e=\u003c/span\u003ejetstack-mael-valais --zone\u003cspan class=\"o\"\u003e=\u003c/span\u003eeurope-west2-b\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ kubectl run c -it --rm --restart\u003cspan class=\"o\"\u003e=\u003c/span\u003eNever -q --image\u003cspan class=\"o\"\u003e=\u003c/span\u003enicolaka/netshoot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc -v 100.127.221.57 \u003cspan class=\"m\"\u003e22\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eConnection to 100.127.221.57 \u003cspan class=\"m\"\u003e22\u003c/span\u003e port \u003cspan class=\"o\"\u003e[\u003c/span\u003etcp/ssh\u003cspan class=\"o\"\u003e]\u003c/span\u003e succeeded!\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSSH-2.0-OpenSSH_8.4p1 Ubuntu-5ubuntu1.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eExcellent!\u003c/p\u003e\n\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eAlthough pods can access Tailscale IPs, it does not work with the MagicDNS feature. The only way (I mean, the only \u0026ldquo;easy\u0026rdquo; way) would be to have a container sidecar with \u003ccode\u003eCAP_NET_ADMIN\u003c/code\u003e with Tailscale running along with the pod that requires access to the Tailscale IPs.\u003c/p\u003e\n","date":1635598417,"description":"","dir":"2021/access-private-ips-from-kubernetes-with-tailscale/","expirydate":-62135596800,"fuzzywordcount":700,"images":["access-private-ips-from-kubernetes-with-tailscale/cover-access-private-ips-from-kubernetes-with-tailscale.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1635598417,"objectID":"fb7831770f4a6ed8243f12d0f1ab9969","permalink":"https://maelvls.dev/do-not-share-yet/access-private-ips-from-kubernetes-with-tailscale/","publishdate":"2021-10-30T14:53:37+02:00","readingtime":3,"relpermalink":"/do-not-share-yet/access-private-ips-from-kubernetes-with-tailscale/","section":"2021","summary":"\u003ch1 id=\"access-private-ips-from-kubernetes-with-tailscale\"\u003eAccess Private IPs From Kubernetes With Tailscale\u003c/h1\u003e\n\u003cp\u003eI want to give all my Kubernetes pods access to my PC that is on a private network. The plan is to use a GCP VM as a \u0026ldquo;relay\u0026rdquo; where Tailscale is running and configure the VPC to forward traffic to the relay.\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eMachine\u003c/th\u003e\n          \u003cth\u003eGCP IPs\u003c/th\u003e\n          \u003cth\u003eTailscale IPs\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eaorus (my PC)\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e100.127.221.57\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003erelay\u003c/td\u003e\n          \u003ctd\u003e10.132.0.16\u003c/td\u003e\n          \u003ctd\u003e100.82.245.178\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003etest\u003c/td\u003e\n          \u003ctd\u003e10.132.0.17\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eThe first step is to get an ephemeral token on Tailscale:\u003c/p\u003e","tags":[],"title":"Access Private IPs From Kubernetes With Tailscale","type":"2021","url":"https://maelvls.dev/do-not-share-yet/access-private-ips-from-kubernetes-with-tailscale/","weight":0,"wordcount":624},{"authors":null,"categories":null,"content":"","date":1632558679,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1632558679,"objectID":"https://maelvls.dev/do-not-share-yet/tags/debugging/","permalink":"https://maelvls.dev/do-not-share-yet/tags/debugging/","publishdate":"2021-09-25T10:31:19+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/debugging/","section":"tags","summary":"","tags":null,"title":"Debugging","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/debugging/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1632558679,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1632558679,"objectID":"https://maelvls.dev/do-not-share-yet/tags/mitmproxy/","permalink":"https://maelvls.dev/do-not-share-yet/tags/mitmproxy/","publishdate":"2021-09-25T10:31:19+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/mitmproxy/","section":"tags","summary":"","tags":null,"title":"Mitmproxy","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/mitmproxy/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eI frequently use mitmproxy to inspect what HTTP requests and responses look like under the hood. Inspecting HTTP flows comes in handy with tools that tend to hide the actual JSON error messages.\u003c/p\u003e\n\u003cp\u003eOne tool I have been using a lot is \u003ca href=\"https://github.com/Venafi/vcert\"\u003e\u003ccode\u003evcert\u003c/code\u003e\u003c/a\u003e. \u003ccode\u003evcert\u003c/code\u003e allows you to request X.509 certificates from Venafi Trust Protection Platform (TTP) as well as Venafi Cloud.\u003c/p\u003e\n\u003cp\u003eIn the following example, I give an unknown client ID \u003ccode\u003eduh\u003c/code\u003e. \u003ccode\u003evcert\u003c/code\u003e just tells me about the error in the initial HTTP header:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ vcert getcred --username foo --password bar --client-id\u003cspan class=\"o\"\u003e=\u003c/span\u003eduh --verbose\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evCert: 2021/09/19 19:23:56 Getting credentials...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evCert: 2021/09/19 19:23:56 Got \u003cspan class=\"m\"\u003e400\u003c/span\u003e Bad Request status \u003cspan class=\"k\"\u003efor\u003c/span\u003e POST https://venafi-tpp.platform-ops.jetstack.net/vedauth/authorize/oauth\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evCert: 2021/09/19 19:24:05 unexpected status code on TPP Authorize. Status: \u003cspan class=\"m\"\u003e400\u003c/span\u003e Bad Request\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eI am sure that the HTTP API is returning more than just the HTTP header \u003ccode\u003e400 Bad Request\u003c/code\u003e!\u003c/p\u003e\n\u003cp\u003eBut when I try using mitmproxy, I get the following error:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ HTTPS_PROXY=:9090 vcert getcred --username foo --password bar --client-id=duh --verbose\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evCert: 2021/09/19 19:29:20 Getting credentials...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003evCert: 2021/09/19 19:29:50 Post \u0026#34;https://venafi-tpp.platform-ops.jetstack.net/vedauth/authorize/oauth\u0026#34;: context deadline exceeded (Client.Timeout exceeded while awaiting headers)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"vcert-hanging.png\" alt=\"vcert-hanging\"\u003e\u003c/p\u003e\n\u003cp\u003eLooking at the \u0026ldquo;Detail\u0026rdquo; tab for the HTTP call recorded in mitmproxy, I can see that the HTTP request was acknowledged by the TPP server (see the \u0026ldquo;Request complete\u0026rdquo; time). For some reason, the response never arrives.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"mitmproxy-request-received.png\" alt=\"mitmproxy-request-received\"\u003e\u003c/p\u003e\n\u003cp\u003eLet us dig a bit deeper and see what is the difference between \u0026ldquo;with\u0026rdquo; and \u0026ldquo;without\u0026rdquo; mitmproxy using \u003ca href=\"https://www.wireshark.org/\"\u003eWireShark\u003c/a\u003e. Without mitmproxy, \u003ccode\u003evcert\u003c/code\u003e succeeds:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"vcert-without-mitmproxy-encrypted.png\" alt=\"vcert-without-mitmproxy-encrypted\"\u003e\u003c/p\u003e\n\u003cp\u003eBut with mitmproxy, \u003ccode\u003evcert\u003c/code\u003e hangs:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"vcert-with-mitmproxy-encrypted.png\" alt=\"vcert-with-mitmproxy-encrypted\"\u003e\u003c/p\u003e\n\u003cp\u003eThe difference between both flows seems to be the \u0026ldquo;Encrypted Handshake Message\u0026rdquo; that occurs right after the HTTP requests has been sent.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNote that you can see the above two PCAP traces by downloading \u003ca href=\"vcert-with-and-without-mitmproxy-through-iap.pcapng\"\u003evcert-with-and-without-mitmproxy-through-iap.pcapng\u003c/a\u003e.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eNow, let us decrypt this TLS flow. WireShark being a passive capture tool (unlike mitmproxy), it won\u0026rsquo;t be able to decrypt traffic. Fortunately, mitmproxy is able to dump the master secret (see the page \u003ca href=\"https://docs.mitmproxy.org/stable/howto-wireshark-tls/\"\u003eWireshark and SSL/TLS Master Secrets\u003c/a\u003e. After giving the master secret to WireShark, we can see the decrypted traffic:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"vcert-with-mitmproxy-decrypted.png\" alt=\"vcert-with-mitmproxy-decrypted\"\u003e\u003c/p\u003e\n\u003cp\u003eThe above screenshot validates the fact that the \u0026ldquo;Application Data\u0026rdquo; that we could see in the previous two screenshots was in fact the HTTP request.\u003c/p\u003e\n\u003cp\u003eWe also notice that the mysterious \u0026ldquo;Encrypted Handshake Message\u0026rdquo; is a Hello Request, signifying a TLS renegotiation as described in \u003ca href=\"https://datatracker.ietf.org/doc/html/rfc5246#section-7.4.1.1\"\u003eRFC 5246\u003c/a\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAs a side note, here is what the master secret look like when mitmproxy records it (that\u0026rsquo;s the file I passed to WireShark):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Content of sslkeylogfile\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCLIENT_RANDOM 5bdb7b7d88a325a08ee922a89b7b8acbbcda36f7d800c4e2f763b4689cfd870b 083f22af3099558997f784c47c4145dd9155c20f97fa5701bffe7003d80c7ad31801cfabb9be5838bf8f4f58e6b971f7\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSERVER_HANDSHAKE_TRAFFIC_SECRET caa526a0b8e35551a2feee9de685e74547a7b0abc3ae5422a4bebe42d74132b4 7ac126e6a9b651ee9585a902248ac5bc5cdfa3a8989852f491b52ec013a9be170dce24076c305c5b9e7209c325a9f530\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCLIENT_HANDSHAKE_TRAFFIC_SECRET caa526a0b8e35551a2feee9de685e74547a7b0abc3ae5422a4bebe42d74132b4 37fa20e94a385b79901a0615ef7c2de091e98757e85958deb9a242a3b0bed74e3be290d816555a3da816dd60d4f0c9f3\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEXPORTER_SECRET caa526a0b8e35551a2feee9de685e74547a7b0abc3ae5422a4bebe42d74132b4 d436ff8840245be887e15d11000a98d971df4f1f0d825b7eb470a37fe2e9f7d1759967fe52e055cb9b5e74373e36f276\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSERVER_TRAFFIC_SECRET_0 caa526a0b8e35551a2feee9de685e74547a7b0abc3ae5422a4bebe42d74132b4 615847eb91285a78981cf5072a9597e2ef4549c92d695818b9e05c270950b5ec88fcb62969b353b38ea2cd18597ee01d\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCLIENT_TRAFFIC_SECRET_0 caa526a0b8e35551a2feee9de685e74547a7b0abc3ae5422a4bebe42d74132b4 4705201529b85b5cbdcbd74dfdf5cf2019ff9e520de551d2aaaa14962668ed3aa0a79416d1795d5eb53be93ddeb077de\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe master secret is comprised of 96 hexadecimal characters, which corresponds to 48 bytes.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eIt seems like mitmproxy does not support server-side initiated TLS renegotiation. Looking at its source code, it seems like everything after the end of the first handshake is considered to be data, and subsequent Handshake Messages make mitmproxy \u0026ldquo;hang\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003eNow, why would TLS renegotiation be necessary after the HTTP request is sent? The issue named \u003ca href=\"https://github.com/Venafi/vcert/issues/148\"\u003eVenafi Issuer error when configuring cert-manager. \u0026ldquo;local error: tls: no renegotiation\u0026rdquo;\u003c/a\u003e gives us a clue: Microsoft IIS, which is the web server used by Venafi TPP, is capable of authenticating an incoming connection using a client certificate depending on the HTTP request\u0026rsquo;s URL path. Looking at the IIS configuration, we can see that the \u003ccode\u003e/vedauth\u003c/code\u003e endpoint has its \u0026ldquo;client certificate\u0026rdquo; settings configured to \u0026ldquo;Accept\u0026rdquo;:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"ssl-settings-accept.png\" alt=\"ssl-settings-accept\"\u003e\u003c/p\u003e\n\u003cp\u003eLet us see this behavior in action by creating a TLS tunnel using openssl. With the path \u003ccode\u003e/vedsdk\u003c/code\u003e, we can see that openssl does the initial TLS handshake and no renegotiation seem to happen after sending the HTTP request:\u003c/p\u003e\n\u003cscript id=\"asciicast-438003\" src=\"https://asciinema.org/a/438003.js\" async\u003e\u003c/script\u003e\n\u003c!-- https://asciinema.org/a/cAS7XfBwpKby1F7vHZOXRAqZK --\u003e\n\u003cp\u003eThe HTTP request I made was:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eHTTP /vedsdk/ HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eHost: venafi-tpp.platform-ops.jetstack.net\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eContent-Length: 0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWith the endpoint \u003ccode\u003e/vedauth\u003c/code\u003e, which is the one for which mitmproxy is hanging on, openssl does the initial TLS handshake, sends the HTTP request and then a TLS renegotiation is triggered:\u003c/p\u003e\n\u003cscript id=\"asciicast-438004\" src=\"https://asciinema.org/a/438004.js\" async\u003e\u003c/script\u003e\n\u003c!-- https://asciinema.org/a/nrlOK86ycQ8Legbz7wtYaoUWA --\u003e\n\u003cp\u003eThe request was:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eHTTP /vedauth/ HTTP/1.1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eHost: venafi-tpp.platform-ops.jetstack.net\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003eContent-Length: 0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn the first example (\u003ccode\u003e/vedsdk\u003c/code\u003e), the HTTP response is sent immediately without any TLS negotiation. In the second example (\u003ccode\u003e/vedauth\u003c/code\u003e), a TLS renegotiation is performed right after the HTTP request is sent, and the HTTP response is sent over this new TLS session.\u003c/p\u003e\n\u003cp\u003eThe only explanation for this behavior is that this allows IIS to refuse clients that present an invalid client certificates only for paths for which client certificates are enabled, instead of refusing to serve all paths. I would need to learn a bit more about TLS and how IIS is able to give the information about the identity of a client certificate to the HTTP layer to know whether it should look for an \u003ccode\u003eAuthorization: Bearer foo\u003c/code\u003e HTTP header.\u003c/p\u003e\n\u003cp\u003eThe only workaround I have come up with is to turn the client certificate option to \u0026ldquo;Ignore\u0026rdquo;:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"ssl-settings-ignore.png\" alt=\"ssl-settings-ignore\"\u003e\u003c/p\u003e\n\u003cp\u003eThis time, vcert over mitmproxy works!\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"vcert-working.png\" alt=\"vcert-working\"\u003e\u003c/p\u003e\n\u003cp\u003eOne thing I would like to do in the future is to add support for TLS renegotiation to mitmproxy!\u003c/p\u003e\n","date":1632558679,"description":"I often use mitmproxy in order to see the HTTP calls that programs are making under the hood. vcert, a tool used for operating Venafi TPP and Venafi Cloud, did not seem to be working with mitmproxy. This post presents the steps I took to discover that the issue comes from an unsupported feature of mitmproxy: TLS renegotiation.","dir":"2021/mitmproxy-tls-renegotiation-debugging-story/","expirydate":-62135596800,"fuzzywordcount":900,"images":["/mitmproxy-tls-renegotiation-debugging-story/vcert-with-mitmproxy-decrypted.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1632558679,"objectID":"fc5aec1c3cb70588cdd9290bb5b45a52","permalink":"https://maelvls.dev/do-not-share-yet/mitmproxy-tls-renegotiation-debugging-story/","publishdate":"2021-09-25T10:31:19+02:00","readingtime":4,"relpermalink":"/do-not-share-yet/mitmproxy-tls-renegotiation-debugging-story/","section":"2021","summary":"\u003cp\u003eI frequently use mitmproxy to inspect what HTTP requests and responses look like under the hood. Inspecting HTTP flows comes in handy with tools that tend to hide the actual JSON error messages.\u003c/p\u003e\n\u003cp\u003eOne tool I have been using a lot is \u003ca href=\"https://github.com/Venafi/vcert\"\u003e\u003ccode\u003evcert\u003c/code\u003e\u003c/a\u003e. \u003ccode\u003evcert\u003c/code\u003e allows you to request X.509 certificates from Venafi Trust Protection Platform (TTP) as well as Venafi Cloud.\u003c/p\u003e\n\u003cp\u003eIn the following example, I give an unknown client ID \u003ccode\u003eduh\u003c/code\u003e. \u003ccode\u003evcert\u003c/code\u003e just tells me about the error in the initial HTTP header:\u003c/p\u003e","tags":["mitmproxy","tls","debugging","wireshark"],"title":"mitmproxy hangs on TLS renegotiation: a debugging story","type":"2021","url":"https://maelvls.dev/do-not-share-yet/mitmproxy-tls-renegotiation-debugging-story/","weight":0,"wordcount":813},{"authors":null,"categories":null,"content":"","date":1632558679,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1632558679,"objectID":"https://maelvls.dev/do-not-share-yet/tags/tls/","permalink":"https://maelvls.dev/do-not-share-yet/tags/tls/","publishdate":"2021-09-25T10:31:19+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/tls/","section":"tags","summary":"","tags":null,"title":"Tls","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/tls/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1632558679,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1632558679,"objectID":"https://maelvls.dev/do-not-share-yet/tags/wireshark/","permalink":"https://maelvls.dev/do-not-share-yet/tags/wireshark/","publishdate":"2021-09-25T10:31:19+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/wireshark/","section":"tags","summary":"","tags":null,"title":"Wireshark","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/wireshark/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efailed calling webhook \u0026#34;webhook.cert-manager.io\u0026#34;: Post \u0026#34;https://cert-manager-webhook.cert-manager.svc:443/mutate?timeout=10s\u0026#34;: dial tcp 10.43.183.232:443: connect: connection refused\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis happens when the \u003ccode\u003eSYN\u003c/code\u003e packet is answered with \u003ccode\u003eRST\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.43  -\u0026gt;  34.142.22.43   TCP   59466 → 442 [SYN]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e34.142.22.43  -\u0026gt;  34.142.22.43   TCP   442 → 59466 [RST, ACK]\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis error message is quite rare. In most cases, the \u003ccode\u003eSYN\u003c/code\u003e packet is dropped by\nsome firewall; this error message indicates that the \u003ccode\u003eSYN\u003c/code\u003e packet was able to\nreach the webhook pod. The webhook deployment is likely misconfigured (e.g.,\nlistening on the wrong port).\u003c/p\u003e\n\u003cp\u003eIssues:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/jetstack/cert-manager/issues/3445\"\u003ehttps://github.com/jetstack/cert-manager/issues/3445\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/jetstack/cert-manager/issues/3133\"\u003ehttps://github.com/jetstack/cert-manager/issues/3133\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://serverfault.com/questions/1076563/creating-issuer-for-kubernetes-cert-manager-is-causing-404-and-500-error\"\u003ehttps://serverfault.com/questions/1076563/creating-issuer-for-kubernetes-cert-manager-is-causing-404-and-500-error\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/jetstack/cert-manager/issues/3195\"\u003ehttps://github.com/jetstack/cert-manager/issues/3195\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/jetstack/cert-manager/issues/2736\"\u003ehttps://github.com/jetstack/cert-manager/issues/2736\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eMy answer to \u003ca href=\"https://github.com/jetstack/cert-manager/issues/3133\"\u003ehttps://github.com/jetstack/cert-manager/issues/3133\u003c/a\u003e:\u003c/p\u003e\n\u003cp\u003eHi!\u003c/p\u003e\n\u003cp\u003eThe error message \u003ccode\u003econnect: connection refused\u003c/code\u003e suggests that the apiserver is able to hit the webhook pod\u0026rsquo;s TCP stack since the \u003ccode\u003eSYN\u003c/code\u003e packet was answered with \u003ccode\u003eRST, ACK\u003c/code\u003e, which means that nothing is listening on port 443 (if it was a firewall issue, the \u003ccode\u003eSYN\u003c/code\u003e would have been dropped).\u003c/p\u003e\n\u003cp\u003eThe Helm chart creates a Service that redirects traffic from \u003ccode\u003ecluster-ip:443\u003c/code\u003e to \u003ccode\u003epod-ip:10250\u003c/code\u003e, and we can confirm by reading the logs that the webhook is listening on port 10250:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0925 14:18:30.749655       1 server.go:159] cert-manager/webhook \u0026#34;msg\u0026#34;=\u0026#34;listening for secure connections\u0026#34;  \u0026#34;address\u0026#34;=\u0026#34;:10250\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAt this point, the only thing that I could think of is that there is no pod IP associated with this service IP, as described by @r0bnet in \u003ca href=\"https://github.com/jetstack/cert-manager/issues/3445#issue-738472291\"\u003ehttps://github.com/jetstack/cert-manager/issues/3445#issue-738472291\u003c/a\u003e.\u003c/p\u003e\u003c/blockquote\u003e\n\u003chr\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efailed calling webhook \u0026#34;webhook.cert-manager.io\u0026#34;: Post \u0026#34;https://cert-manager-webhook.cert-manager.svc:443/mutate?timeout=10s\u0026#34;: dial tcp 10.43.183.232:443: i/o timeout\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis time, the \u003ccode\u003eSYN\u003c/code\u003e packet is never answered, and the connection times out:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.43  -\u0026gt;  34.142.22.43   TCP   44772 → 442 [SYN]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.43  -\u0026gt;  34.142.22.43   TCP   [TCP Retransmission] 44772 → 442 [SYN]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.43  -\u0026gt;  34.142.22.43   TCP   [TCP Retransmission] 44772 → 442 [SYN]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.43  -\u0026gt;  34.142.22.43   TCP   [TCP Retransmission] 44772 → 442 [SYN]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis issue is caused by the \u003ccode\u003eSYN\u003c/code\u003e packet being dropped by the firewall. The\npacket drop may have happened in many possible ways. One reason may be that the\ncluster is configured with a network policy controller such as Calico, but there\nis no policy allowing traffic from the apiserver to the webhook.\u003c/p\u003e\n","date":1631611039,"description":"","dir":"2021/cert-manager-webhook-debug-guide/","expirydate":-62135596800,"fuzzywordcount":400,"images":["cert-manager-webhook-debug-guide/cover-cert-manager-webhook-debug-guide.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1631611039,"objectID":"aa52a84fbd6fdc8c0d29fd3abdfbc123","permalink":"https://maelvls.dev/do-not-share-yet/cert-manager-webhook-debug-guide/","publishdate":"2021-09-14T11:17:19+02:00","readingtime":2,"relpermalink":"/do-not-share-yet/cert-manager-webhook-debug-guide/","section":"2021","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efailed calling webhook \u0026#34;webhook.cert-manager.io\u0026#34;: Post \u0026#34;https://cert-manager-webhook.cert-manager.svc:443/mutate?timeout=10s\u0026#34;: dial tcp 10.43.183.232:443: connect: connection refused\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis happens when the \u003ccode\u003eSYN\u003c/code\u003e packet is answered with \u003ccode\u003eRST\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e192.168.1.43  -\u0026gt;  34.142.22.43   TCP   59466 → 442 [SYN]\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e34.142.22.43  -\u0026gt;  34.142.22.43   TCP   442 → 59466 [RST, ACK]\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis error message is quite rare. In most cases, the \u003ccode\u003eSYN\u003c/code\u003e packet is dropped by\nsome firewall; this error message indicates that the \u003ccode\u003eSYN\u003c/code\u003e packet was able to\nreach the webhook pod. The webhook deployment is likely misconfigured (e.g.,\nlistening on the wrong port).\u003c/p\u003e","tags":[],"title":"Cert Manager Webhook Debug Guide","type":"2021","url":"https://maelvls.dev/do-not-share-yet/cert-manager-webhook-debug-guide/","weight":0,"wordcount":327},{"authors":null,"categories":null,"content":"\u003ch2 id=\"debugging-a-flaky-test\"\u003eDebugging a flaky test\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ego test\u003c/code\u003e does not allow you to run a single test many times in parallel. If\nyour test takes 10 seconds (in our case, it had to spin up an apiserver for\nevery test case), and that you want to run this test 100 times, it will take\n16 minutes. The flags \u003ccode\u003e-count\u003c/code\u003e, \u003ccode\u003e-cpu\u003c/code\u003e, \u003ccode\u003e-parallel\u003c/code\u003e and the function\n\u003ccode\u003et.Parallel\u003c/code\u003e only work for tests in separate packages. Multiple instances of a\nsingle test never run in parallel with each other.\u003c/li\u003e\n\u003cli\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eparallel \u003cspan class=\"s2\"\u003e\u0026#34;go test ./test/integration/ -count=1\u0026#34;\u003c/span\u003e ::: \u003cspan class=\"o\"\u003e{\u003c/span\u003e1..100\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","date":1630588058,"description":"","dir":"2021/go-flaky-test/","expirydate":-62135596800,"fuzzywordcount":100,"images":["go-flaky-test/cover-go-flaky-test.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1630588058,"objectID":"9525f16e838bace577fa7dd4197d9bd4","permalink":"https://maelvls.dev/do-not-share-yet/go-flaky-test/","publishdate":"2021-09-02T15:07:38+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/go-flaky-test/","section":"2021","summary":"\u003ch2 id=\"debugging-a-flaky-test\"\u003eDebugging a flaky test\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ego test\u003c/code\u003e does not allow you to run a single test many times in parallel. If\nyour test takes 10 seconds (in our case, it had to spin up an apiserver for\nevery test case), and that you want to run this test 100 times, it will take\n16 minutes. The flags \u003ccode\u003e-count\u003c/code\u003e, \u003ccode\u003e-cpu\u003c/code\u003e, \u003ccode\u003e-parallel\u003c/code\u003e and the function\n\u003ccode\u003et.Parallel\u003c/code\u003e only work for tests in separate packages. Multiple instances of a\nsingle test never run in parallel with each other.\u003c/li\u003e\n\u003cli\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eparallel \u003cspan class=\"s2\"\u003e\u0026#34;go test ./test/integration/ -count=1\u0026#34;\u003c/span\u003e ::: \u003cspan class=\"o\"\u003e{\u003c/span\u003e1..100\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":[],"title":"Go Flaky Test","type":"2021","url":"https://maelvls.dev/do-not-share-yet/go-flaky-test/","weight":0,"wordcount":90},{"authors":null,"categories":null,"content":"","date":1622851200,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"section","lang":"en","lastmod":1622851200,"objectID":"https://maelvls.dev/do-not-share-yet/2020/","permalink":"https://maelvls.dev/do-not-share-yet/2020/","publishdate":"2021-06-05T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/2020/","section":"2020","summary":"","tags":null,"title":"2020s","type":"2020","url":"https://maelvls.dev/do-not-share-yet/2020/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1622851200,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1622851200,"objectID":"https://maelvls.dev/do-not-share-yet/tags/go/","permalink":"https://maelvls.dev/do-not-share-yet/tags/go/","publishdate":"2021-06-05T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/tags/go/","section":"tags","summary":"","tags":null,"title":"Go","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/go/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1622851200,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1622851200,"objectID":"https://maelvls.dev/do-not-share-yet/tags/software-engineering/","permalink":"https://maelvls.dev/do-not-share-yet/tags/software-engineering/","publishdate":"2021-06-05T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/tags/software-engineering/","section":"tags","summary":"","tags":null,"title":"Software-Engineering","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/software-engineering/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eIn his book \u003cem\u003e\u003ca href=\"https://www.oreilly.com/library/view/clean-code-a/9780136083238/\"\u003eClean Code\u003c/a\u003e\u003c/em\u003e, Robert C. Martin makes a strong case against comments:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eYou don\u0026rsquo;t need comments if you write clean code.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eLike any blanket statement, Martin is partially true. Although code clarity increases readability and decreases the need for comments, code has never been able to convey the whole context to the reader.\u003c/p\u003e\n\u003cp\u003eProgramming patterns are often cited as a way to convey this context on a codebase scale. Well named functions and variables also convey some form of context. But most of the time, the context (the \u0026ldquo;why\u0026rdquo;) never gets written anywhere.\u003c/p\u003e\n\u003cp\u003eIn this article, I present a few examples meant to showcase how comments may be written to convey the context around code.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eContents:\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"#code-example-1\"\u003eCode example 1\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#code-example-2\"\u003eCode example 2\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#code-example-3\"\u003eCode example 3\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#code-example-4\"\u003eCode example 4\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#shaping-comments\"\u003eShaping comments\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#conclusion\"\u003eConclusion\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"code-example-1\"\u003eCode example 1\u003c/h2\u003e\n\u003cp\u003eI call \u0026ldquo;in-flight comments\u0026rdquo; comments that we write to ease the process of writing code. In-flight comments help us articulate what we are trying to achieve.\u003c/p\u003e\n\u003cp\u003eIn the following example taken from the \u003ca href=\"https://developers.google.com/tech-writing/two/code-comments\"\u003eGoogle\u0026rsquo;s Technical Writing\u003c/a\u003e, the developer wrote a comment as they were writing an algorithm for randomly shuffling a slice of integers:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eShuffle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eslice\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003ecurIndex\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eslice\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// If the current index is 0, return directly.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecurIndex\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis comment is a typical in-flight comment: it only focuses on what the code does. This comment does not give context as to why this \u003ccode\u003eif\u003c/code\u003e statement exists. We can refactor this comment by focusing on the \u0026ldquo;why\u0026rdquo;:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eShuffle\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eslice\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003ecurIndex\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eslice\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// No need to shuffle an array with zero elements.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecurIndex\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe reader now understand why this \u003ccode\u003eif\u003c/code\u003e exists, and does not have to dig further. Starting with the \u0026ldquo;why\u0026rdquo; helps glanceability: the reader only needs to read the first few words to get the idea.\u003c/p\u003e\n\u003cp\u003eHere is how I would diffenciate the \u0026ldquo;why\u0026rdquo; from the \u0026ldquo;what\u0026rdquo;:\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eContent in a comment\u003c/th\u003e\n          \u003cth\u003eDescription\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eThe \u0026ldquo;why\u0026rdquo;\u003c/td\u003e\n          \u003ctd\u003eHelps you understand how this piece of code came to life.\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eThe \u0026ldquo;what\u0026rdquo;\u003c/td\u003e\n          \u003ctd\u003eParaphrases* what is being done in a human-readable format.\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e*Sometimes, the \u0026ldquo;what\u0026rdquo; may be valuable for readability purposes. I see three reasons to comment on the \u0026ldquo;what\u0026rdquo;:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eWhen the code is not self-explanatory, a \u0026ldquo;what\u0026rdquo; comment may avoid the reader the struggle of googling;\u003c/li\u003e\n\u003cli\u003eWhen a block of code is lenghy, adding \u0026ldquo;what\u0026rdquo; comments may help create \u0026ldquo;sections\u0026rdquo;, helping the reader quicly find the part they are interested in.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"code-example-2\"\u003eCode example 2\u003c/h2\u003e\n\u003cp\u003eOur next example comes from the cert-manager codebase:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// If the certificate request has been denied, set the last failure time to\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// now, and set the Issuing status condition to False with reason. We only\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// perform this check if the request also doesn\u0026#39;t have a Ready condition,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// since some issuers may not honor a Denied condition, and will sign and\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// set the Ready condition to True anyway. We would still want to complete\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// issuance for requests where the issuer doesn\u0026#39;t respect approval.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003econd\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eapiutil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCertificateRequestCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecmapi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCertificateRequestConditionReady\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003econd\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eapiutil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCertificateRequestIsDenied\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efailIssueCertificate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecrt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eapiutil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCertificateRequestCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecmapi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCertificateRequestConditionDenied\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAfter looking at the \u003ccode\u003eif\u003c/code\u003e statement, the reader wonders: why do we need this \u003ccode\u003eif\u003c/code\u003e statement?\u003c/p\u003e\n\u003cp\u003eTheir first reaction will probably be to take a look at the comment right above. Unfortunately, the comment starts with even more confusing implementation details. The reader has to keep reading until the 6th line to find out why the code is doing what it is doing.\u003c/p\u003e\n\u003cp\u003eLet us rate each individual information that the comment conveys:\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eParagraph\u003c/th\u003e\n          \u003cth\u003eUsefulness\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003cstrong\u003e(A)\u003c/strong\u003e If the certificate request has been denied, set the last failure time to now, and set the Issuing status condition to False with reason.\u003c/td\u003e\n          \u003ctd\u003e⭐\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003cstrong\u003e(B)\u003c/strong\u003e We only perform this check if the request also doesn\u0026rsquo;t have a Ready condition.\u003c/td\u003e\n          \u003ctd\u003e⭐⭐\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003cstrong\u003e(C)\u003c/strong\u003e Some issuers may not honor a Denied condition, and will sign and set the Ready condition to True anyway.\u003c/td\u003e\n          \u003ctd\u003e⭐⭐⭐\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003cstrong\u003e(D)\u003c/strong\u003e We would still want to complete issuance for requests where the issuer doesn\u0026rsquo;t respect approval.\u003c/td\u003e\n          \u003ctd\u003e⭐⭐⭐⭐\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eFrom the reader\u0026rsquo;s perspective, the paragraphs (D) and (C) are the most useful. They give a high-level overview of why this \u003ccode\u003eif\u003c/code\u003e statement exists. We can merge the two paragraphs into one:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e(C, D)\u003c/strong\u003e External issuers may ignore the approval API. An issuer ignores the approval API when it proceeds with the issuance even though the \u0026ldquo;Denied=True\u0026rdquo; condition is present on the CertificateRequest. To avoid breaking the issuers that are ignoring the approval API, we want to detect when CertificateRequests has ignored the Denied=True condition; when it is the case, we skip bubbling-up the (possible) Denied condition.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eParagraphs (B) and (A) may also be useful: they give the context about paragraph (C). The sentence lacks precision though, and \u0026ldquo;this check\u0026rdquo; may confuse the reader. Let us rephrase it:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e(A, B)\u003c/strong\u003e To know when the Denied=True condition was ignored by the issuer, we look at the CertificateRequest\u0026rsquo;s Ready condition. If both the Ready and Denied\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Some issuers won\u0026#39;t honor the \u0026#34;Denied=True\u0026#34; condition, and we don\u0026#39;t want\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// to break these issuers. To avoid breaking these issuers, we skip bubbling\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// up the \u0026#34;Denied=True\u0026#34; condition from the certificate request object to the\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// certificate object when the issuer ignores the \u0026#34;Denied\u0026#34; state.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// To know whether or not an issuer ignores the \u0026#34;Denied\u0026#34; state, we pay\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// attention to the \u0026#34;Ready\u0026#34; condition on the certificate request. If a\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// certificate request is \u0026#34;Denied=True\u0026#34; and that the issuer still proceeds\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// to adding the \u0026#34;Ready\u0026#34; condition (to either true or false), then we\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// consider that this issuer has ignored the \u0026#34;Denied\u0026#34; state.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003econd\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eapiutil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCertificateRequestCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecmapi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCertificateRequestConditionReady\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003econd\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eapiutil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCertificateRequestIsDenied\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003efailIssueCertificate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ectx\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecrt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eapiutil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetCertificateRequestCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecmapi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eCertificateRequestConditionDenied\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"code-example-3\"\u003eCode example 3\u003c/h2\u003e\n\u003cp\u003eAnother example \u003ca href=\"https://github.com/jetstack/cert-manager/blob/1dad685e/pkg/controller/ingress-shim/sync.go#L145\"\u003einspired\u003c/a\u003e by the cert-manager codebase:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eerrs\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nf\"\u003evalidateIngressTLSBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etls\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// if this tls entry is invalid, record an error event on Ingress object and continue to the next tls entry\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerrs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003erec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEventf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eingress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Warning\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;BadConfig\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;TLS entry %d is invalid: %s\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerrs\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eOnce again, the in-flight comment can be rewritten to focus on the \u0026ldquo;why\u0026rdquo;:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Let the user know that an TLS entry has been skipped due to being invalid.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eerrs\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nf\"\u003evalidateIngressTLSBlock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etls\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerrs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003erec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEventf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eingress\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Warning\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;BadConfig\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;TLS entry %d is invalid: %s\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerrs\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"code-example-4\"\u003eCode example 4\u003c/h2\u003e\n\u003cp\u003eThe next example \u003ca href=\"https://github.com/jetstack/cert-manager/blob/1dad685e4/pkg/controller/ingress-shim/sync.go#L180-L209\"\u003eis inspired\u003c/a\u003e by an other place in cert-manager.\u003c/p\u003e\n\u003cp\u003eThis is another example of in-flight comment focusing on the \u0026ldquo;what\u0026rdquo;. The context around this block of code is not obvious, which means this comment should refactored to focus on the \u0026ldquo;why\u0026rdquo;.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// check if a Certificate for this secret name exists, and if it\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// does then skip this secret name.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eexpectedCrt\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nf\"\u003eexpectedCrt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eingress\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eexistingCrt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCertificates\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003enamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eingress\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003esecretName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eexistingCrt\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"nf\"\u003ecertMatchesUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eexistingCrt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecrt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003etoBeUpdated\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etoBeUpdated\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nf\"\u003eupdateToMatchExpected\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eexpectedCrt\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003etoBeCreated\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etoBeCreated\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecrt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn this case, the code itself would benefit from a bit of refactoring. Regarding the comment, we start with the \u0026ldquo;why\u0026rdquo;:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// The secretName has an associated Certificate that has the same name. We want\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// to make sure that this Certificate exists and that it matches the expected\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Certificate spec.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eexistingCrt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCertificates\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003enamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003esecretName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eexpectedCrt\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nf\"\u003eexpectedCrt\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eexistingCrt\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003etoBeCreated\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etoBeCreated\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eexpectedCrt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nf\"\u003ecertMatchesExpected\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eexistingCrt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eexpectedCrt\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003etoBeUpdated\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etoBeUpdated\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nf\"\u003eupdateToMatchExpected\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eexpectedCrt\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote that we removed the \u003ccode\u003eelse\u003c/code\u003e statement for the purpose of readability. The happy path is now clearly \u0026ldquo;updating the certificate\u0026rdquo;.\u003c/p\u003e\n\u003ch2 id=\"shaping-comments\"\u003eShaping comments\u003c/h2\u003e\n\u003cp\u003eTo help with readability, I suggest hard-wrapping comments at 80 characters. Above 80 characters, the comments will become hard to read in PR suggestion comments. Take this example comment:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// To reduce the memory footprint of the controller-manager,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// we do not cache Secrets.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// We only cache the metadata of Secrets\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// which is enough to allow the EnqueueRequestsFromMapFunc to lookup the associated Issuer or ClusterIssuer.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// In NewManager we also use the option ClientDisableCache\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// to configure the client to not cache Secrets\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// when the token manager Gets and Lists them.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eEach sentence is started on a new line. This sort of style is fine in a Markdown document where these soft breaks are rendered as a single paragraph.\u003c/p\u003e\n\u003cp\u003eThe problem with the \u0026ldquo;random\u0026rdquo; length of each line is that the reader has to do more work while parsing the text. It is also less aesthetic than a well-wrapped 80 characters comment. Rewrapping the above comment at 80 chars looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// To reduce the memory footprint of the controller-manager, we do not\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// cache Secrets. We only cache the metadata of Secrets which is enough to\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// allow the EnqueueRequestsFromMapFunc to lookup the associated Issuer or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ClusterIssuer. In NewManager we also use the option ClientDisableCache\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// to configure the client to not cache Secrets when the token manager Gets\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// and Lists them.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eYou can obtain the re-wrapping by using the \u003ccode\u003eqq\u003c/code\u003e command on Vim, or the \u003ca href=\"https://github.com/stkb/Rewrap\"\u003eRewrap\u003c/a\u003e extension on VSCode.\u003c/p\u003e\n\u003cp\u003eIf you still want to do separate paragraphs, I\u0026rsquo;d recommend separating each paragraph with two new line breaks:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// To reduce the memory footprint of the controller-manager, we do not\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// cache Secrets. We only cache the metadata of Secrets which is enough to\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// allow the EnqueueRequestsFromMapFunc to lookup the associated Issuer or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ClusterIssuer.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// We use this option along with ClientDisableCache in NewManager to\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// configure the client to not cache Secrets when the token manager Gets\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// and Lists them.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eAs a developer, I want to write code that is readable and maintainable, and keeping track of the \u0026ldquo;why\u0026rdquo; (i.e., the context) in a codebase is essential for readability and maintainability. I found that putting myself in the place of the future reader helps me write comments that focus on the \u0026ldquo;why\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003eHAProxy, Git or the Linux kernel are great examples of projects where there is a great focus on well-documented code:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/haproxy/haproxy/blob/530408f976e5fe2f2f2b4b733b39da36770b566f/ebtree/ebtree.h#L23\"\u003e\u003ccode\u003eebtree/ebtree.h\u003c/code\u003e\u003c/a\u003e (HAProxy)\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/git/git/blob/2d2118b814c11f509e1aa76cb07110f7231668dc/unpack-trees.c#L821-L836\"\u003e\u003ccode\u003eunpack-trees.c\u003c/code\u003e\u003c/a\u003e (Git)\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/torvalds/linux/blob/bfdc6d91a25f4545bcd1b12e3219af4838142ef1/kernel/sched/core.c#L157-L171\"\u003e\u003ccode\u003ekernel/sched/core.c\u003c/code\u003e\u003c/a\u003e (Linux kernel).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!--\n\n## Discussion\n\nBill Kennedy [shared](https://changelog.com/gotime/172) the importance of making a concious effort towards having a common set of values that help a team write good software. Like anything, the team probably needs to find their own set of values, but the two values that Bill talked about in the Gotime episode seem valuable to me:\n\n1. Be precise. Letting uncertainty and inprecision creep into variable names, function names and package mames greatly decreases the chance for someone to understand the concepts captured by your code.\n2. Don’t make things easy to do; instead, make things easy to understand. That's an other\n3. Early use of abstractions and other sorts of indirection hurt.\n\nIn my mind, being precise also applies to comments. Precision in comments avoid the reader having to wonder \"is that what they really meant?\". I think that the values and ideas contained in a design philosophy not only apply to code, but also to comments.\n\n### Good naming takes time\n\nFinding a good name that properly carries the exact intent and help self-documenting takes time. It always takes a few iterations before the code becomes self-documenting enough to be able to remove comments.\n\n![Number of comments lowers with time](chart-comments-over-time.svg)\n\nAs shown by the diagram, the amount of comments for a given codebase decreases thanks to PR reviews and refactorings. The more we learn and understand our codebase, the better we become at self-documenting.\n\n### Comments are disposable, don't copy them over\n\nNow, let's talk about the issue of comments becoming outdated. Over time, comments start lying. That's where my second point comes into play: deleting and rewriting comments is part of our job. I would even say that it takes around 40% of my time spent coding.\n\nDuring code reviews, I pay extra attention to these comments. And yes, very often, comments don't make sense anymore because of some copy-paste of code. We must delete any copy-pasted comment and rewrite it. Spreading copy-pasted comments that we don't really know why they were added in the first place is a plague.\n\n## Conclusion\n\nAs a final word, I want us to remember that yes, maintaining comments is a pain. Comments will eventually start lying if you don't delete and rewrite them. But would you rather have no comments at all and let the amount of tribal knowledge creep in every part of your codebase, making it harder and harder for new engineers to join the team?\n\n--\u003e\n\u003c!--\nJoin the discussion on Twitter:\n\n\u003cblockquote class=\"twitter-tweet\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eI know I know comments always end up outdated and so on. But I really think we should still write beautiful comments! 😇\u003ca href=\"https://t.co/704lUCDzo2\"\u003ehttps://t.co/704lUCDzo2\u003c/a\u003e\u003c/p\u003e\u0026mdash; Maël Valais (@maelvls) \u003ca href=\"https://twitter.com/maelvls/status/1233140530017644544?ref_src=twsrc%5Etfw\"\u003eFebruary 27, 2020\u003c/a\u003e\u003c/blockquote\u003e\n\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\n\n\\--\u003e\n\u003cp\u003eUpdates:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e24 Feb 2022\u003c/strong\u003e: add the section \u0026ldquo;Shaping comments\u0026rdquo;.\u003c/li\u003e\n\u003c/ul\u003e\n","date":1622851200,"description":"We often talk about avoiding unnecessary comments that needlessly paraphrase what the code does. In this article, I gathered some thoughts about why writing comments is as important as writing the code itself, and how to spot comments that should be refactored using the 'what' and the 'why'.","dir":"2020/you-should-write-comments/","expirydate":-62135596800,"fuzzywordcount":1700,"images":["writing-useful-comments/cover-writing-useful-comments.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1622851200,"objectID":"289dd098e6b45927cb25a77a40c14ac1","permalink":"https://maelvls.dev/do-not-share-yet/writing-useful-comments/","publishdate":"2021-06-05T00:00:00Z","readingtime":8,"relpermalink":"/do-not-share-yet/writing-useful-comments/","section":"2020","summary":"\u003cp\u003eIn his book \u003cem\u003e\u003ca href=\"https://www.oreilly.com/library/view/clean-code-a/9780136083238/\"\u003eClean Code\u003c/a\u003e\u003c/em\u003e, Robert C. Martin makes a strong case against comments:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eYou don\u0026rsquo;t need comments if you write clean code.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eLike any blanket statement, Martin is partially true. Although code clarity increases readability and decreases the need for comments, code has never been able to convey the whole context to the reader.\u003c/p\u003e\n\u003cp\u003eProgramming patterns are often cited as a way to convey this context on a codebase scale. Well named functions and variables also convey some form of context. But most of the time, the context (the \u0026ldquo;why\u0026rdquo;) never gets written anywhere.\u003c/p\u003e","tags":["go","software-engineering"],"title":"Writing useful comments","type":"2020","url":"https://maelvls.dev/do-not-share-yet/writing-useful-comments/","weight":0,"wordcount":1687},{"authors":null,"categories":null,"content":"\u003cp\u003eDon\u0026rsquo;t over-use pointers\u0026quot;:\nLeftmost align: \u003ca href=\"https://github.com/inlets/inlets-operator/blob/c7d1106084d6b4996c7b0ed4ea94e2244e1453a8/controller.go#L351-L402\"\u003ehttps://github.com/inlets/inlets-operator/blob/c7d1106084d6b4996c7b0ed4ea94e2244e1453a8/controller.go#L351-L402\u003c/a\u003e\nDeal with errors: \u003ca href=\"https://github.com/inlets/inlets-operator/pull/119#discussion_r633550836\"\u003ehttps://github.com/inlets/inlets-operator/pull/119#discussion_r633550836\u003c/a\u003e\u003c/p\u003e\n","date":1620663189,"description":"","dir":"2021/go-good-practices/","expirydate":-62135596800,"fuzzywordcount":100,"images":["go-good-practices/cover-go-good-practices.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1620663189,"objectID":"fb7e698165fd8c26627caf22beb27a2a","permalink":"https://maelvls.dev/do-not-share-yet/go-good-practices/","publishdate":"2021-05-10T18:13:09+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/go-good-practices/","section":"2021","summary":"\u003cp\u003eDon\u0026rsquo;t over-use pointers\u0026quot;:\nLeftmost align: \u003ca href=\"https://github.com/inlets/inlets-operator/blob/c7d1106084d6b4996c7b0ed4ea94e2244e1453a8/controller.go#L351-L402\"\u003ehttps://github.com/inlets/inlets-operator/blob/c7d1106084d6b4996c7b0ed4ea94e2244e1453a8/controller.go#L351-L402\u003c/a\u003e\nDeal with errors: \u003ca href=\"https://github.com/inlets/inlets-operator/pull/119#discussion_r633550836\"\u003ehttps://github.com/inlets/inlets-operator/pull/119#discussion_r633550836\u003c/a\u003e\u003c/p\u003e","tags":["go"],"title":"Go Good Practices","type":"2021","url":"https://maelvls.dev/do-not-share-yet/go-good-practices/","weight":0,"wordcount":10},{"authors":null,"categories":null,"content":"\u003cp\u003eThis is a summary of the official\n\u003ca href=\"https://kubernetes.io/docs/reference/using-api/api-concepts/\"\u003eapi-concepts\u003c/a\u003e\nthat I wrote to remember the difference between the various terms used to\ndesignate \u0026ldquo;objects\u0026rdquo; in Kubernetes.\u003c/p\u003e\n\u003cp\u003eIn Kubernetes, the term \u0026ldquo;resource\u0026rdquo; is a term coming from the RESTful\nterminology. Let us have a YAML manifest example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# (1)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eacme.cert-manager.io/v1alpha2\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eChallenge\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eexample-1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003enamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003efoo\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe resource corresponding would be:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGET /apis/acme.cert-manager.io/v1alpha2/namespaces/foo/challenges/example-1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#           \u0026lt;---------------\u0026gt; \u0026lt;-(2)--\u0026gt;                \u0026lt;--(1)---\u0026gt; \u0026lt;--(5)--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#           \u0026lt;-------------------------(2) resource--------------------------\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn the following table, I focus on the \u0026ldquo;object\u0026rdquo; class of resource types. For\nexample, the resource type \u003ccode\u003epods\u003c/code\u003e belongs to the \u0026ldquo;object\u0026rdquo; class of resource\ntypes like most resource types in Kubernetes. The other possible resource type\ncategory in Kubernetes is the \u0026ldquo;virtual\u0026rdquo; class of resource types, for example\n\u003ccode\u003esubjectaccessreviews\u003c/code\u003e.\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eTerm\u003c/th\u003e\n          \u003cth\u003e\u003c/th\u003e\n          \u003cth\u003eExample\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e(1) object resource type\u003c/td\u003e\n          \u003ctd\u003eLower-case plural noun that appears in the URL\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003echallenges\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e(2) object resource\u003c/td\u003e\n          \u003ctd\u003eURL of one instance of the resource type\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e/apis/acme.cert-manager.io/v1alpha2/namespaces/foo/challenges/example-1\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e(3) object resource name\u003c/td\u003e\n          \u003ctd\u003eName of one instance of the resource type\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eexample-1\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e(4) object\u003c/td\u003e\n          \u003ctd\u003eone concrete representation of a resource\u003c/td\u003e\n          \u003ctd\u003eThe above YAML manifest\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekind\u003c/td\u003e\n          \u003ctd\u003erepresents the object schema of the resource\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eChallenge\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eapiVersion\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eacme.cert-manager.io/v1alpha2\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eversion\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003eacme.cert-manager.io/v1alpha2\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ecollection\u003c/td\u003e\n          \u003ctd\u003eall instance of the resource type\u003c/td\u003e\n          \u003ctd\u003e\u003ccode\u003e/apis/acme.cert-manager.io/v1alpha2/challenges\u003c/code\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n","date":1617962650,"description":"","dir":"2021/kubernetes-kind-vs-resource-type/","expirydate":-62135596800,"fuzzywordcount":200,"images":["kubernetes-kind-vs-resource-type/cover-kubernetes-kind-vs-resource-type.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1617962650,"objectID":"9a606180162ea3c06c76bf83fb05d2ec","permalink":"https://maelvls.dev/do-not-share-yet/kubernetes-kind-vs-resource-type/","publishdate":"2021-04-09T12:04:10+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/kubernetes-kind-vs-resource-type/","section":"2021","summary":"\u003cp\u003eThis is a summary of the official\n\u003ca href=\"https://kubernetes.io/docs/reference/using-api/api-concepts/\"\u003eapi-concepts\u003c/a\u003e\nthat I wrote to remember the difference between the various terms used to\ndesignate \u0026ldquo;objects\u0026rdquo; in Kubernetes.\u003c/p\u003e\n\u003cp\u003eIn Kubernetes, the term \u0026ldquo;resource\u0026rdquo; is a term coming from the RESTful\nterminology. Let us have a YAML manifest example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# (1)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eacme.cert-manager.io/v1alpha2\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eChallenge\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eexample-1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003enamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003efoo\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe resource corresponding would be:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGET /apis/acme.cert-manager.io/v1alpha2/namespaces/foo/challenges/example-1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#           \u0026lt;---------------\u0026gt; \u0026lt;-(2)--\u0026gt;                \u0026lt;--(1)---\u0026gt; \u0026lt;--(5)--\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#           \u0026lt;-------------------------(2) resource--------------------------\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn the following table, I focus on the \u0026ldquo;object\u0026rdquo; class of resource types. For\nexample, the resource type \u003ccode\u003epods\u003c/code\u003e belongs to the \u0026ldquo;object\u0026rdquo; class of resource\ntypes like most resource types in Kubernetes. The other possible resource type\ncategory in Kubernetes is the \u0026ldquo;virtual\u0026rdquo; class of resource types, for example\n\u003ccode\u003esubjectaccessreviews\u003c/code\u003e.\u003c/p\u003e","tags":[],"title":"Kubernetes Kind vs Resource Type","type":"2021","url":"https://maelvls.dev/do-not-share-yet/kubernetes-kind-vs-resource-type/","weight":0,"wordcount":195},{"authors":null,"categories":null,"content":"\u003cblockquote\u003e\n\u003cp\u003eEach one of these controllers actually only manages a very specific subset of the Certificate status\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eThat\u0026rsquo;s something I have always been wary about: although it is recommended that each part of the status is only managed by a single controller, we currently have multiple controllers operating on the same \u003ccode\u003eIssuing\u003c/code\u003e condition.\u003c/p\u003e\n\u003cp\u003eThis idea will seem a bit far-fetched, but why wouldn\u0026rsquo;t we use the notion of \u0026ldquo;one state-level = one condition\u0026rdquo;? (as in \u0026ldquo;\u003ca href=\"https://stackoverflow.com/questions/31041766/what-does-edge-based-and-level-based-mean\"\u003eKubernetes is level-based\u003c/a\u003e\u0026rdquo;)\u003c/p\u003e\n\u003cp\u003eIf we want to keep the controller loops separated, they should all clearly rely on waiting for different levels instead of having the level muddled like we have right now:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eif trigger controller sees         Issuing=False         and         lastFailure set              →           set Issuing=True\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eif issuing controller sees        Issuing=False         and         lastFailure set              →           set Issuing=True\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1617195080,"description":"","dir":"2021/optimistic-locking-is-hard/","expirydate":-62135596800,"fuzzywordcount":200,"images":["optimistic-locking-is-hard/cover-optimistic-locking-is-hard.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1617195080,"objectID":"0118542876c45c6a2c07967bf73dc537","permalink":"https://maelvls.dev/do-not-share-yet/optimistic-locking-is-hard/","publishdate":"2021-03-31T14:51:20+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/optimistic-locking-is-hard/","section":"2021","summary":"\u003cblockquote\u003e\n\u003cp\u003eEach one of these controllers actually only manages a very specific subset of the Certificate status\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eThat\u0026rsquo;s something I have always been wary about: although it is recommended that each part of the status is only managed by a single controller, we currently have multiple controllers operating on the same \u003ccode\u003eIssuing\u003c/code\u003e condition.\u003c/p\u003e\n\u003cp\u003eThis idea will seem a bit far-fetched, but why wouldn\u0026rsquo;t we use the notion of \u0026ldquo;one state-level = one condition\u0026rdquo;? (as in \u0026ldquo;\u003ca href=\"https://stackoverflow.com/questions/31041766/what-does-edge-based-and-level-based-mean\"\u003eKubernetes is level-based\u003c/a\u003e\u0026rdquo;)\u003c/p\u003e","tags":[],"title":"Optimistic Locking Is Hard","type":"2021","url":"https://maelvls.dev/do-not-share-yet/optimistic-locking-is-hard/","weight":0,"wordcount":129},{"authors":null,"categories":null,"content":"\u003cp\u003epacket was coming as\u003c/p\u003e\n\u003cp\u003eIncoming packet:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esrc: 10.8.8.10\ndst: 10.4.0.2\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe Windows VM receives the packet on \u003ccode\u003enic2\u003c/code\u003e. IIS, which is listening on all\ninterfaces, handles the connection and sends the response to 10.8.8.10.\u003c/p\u003e\n\u003cp\u003eThe Windows IP stack looks at its routes:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC:\\\u0026gt; route print\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4 Route Table\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e===========================================================================\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eActive Routes:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNetwork Destination        Netmask          Gateway       Interface  Metric\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          0.0.0.0          0.0.0.0       10.132.0.1      10.132.0.13      5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          0.0.0.0          0.0.0.0         10.4.0.1         10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         10.4.0.0    255.255.240.0         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         10.4.0.2  255.255.255.255         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      10.4.15.255  255.255.255.255         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       10.132.0.0    255.255.240.0       10.132.0.1      10.132.0.13      6\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       10.132.0.1  255.255.255.255         On-link       10.132.0.13      6\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      10.132.0.13  255.255.255.255         On-link       10.132.0.13    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e===========================================================================\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePersistent Routes:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Network Address          Netmask  Gateway Address  Metric\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  169.254.169.254  255.255.255.255         On-link        1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          0.0.0.0          0.0.0.0         10.4.0.1  Default\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e===========================================================================\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"remmina_Quick%20Connect_localhost_2021812-2141.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eThe response IP headers:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esrc: 10.4.0.2\ndst: 10.8.8.10\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSince the address \u003ccode\u003e10.8.8.10\u003c/code\u003e is\u003c/p\u003e\n\u003cp\u003eWhen the nic 2 has an empty gateway:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC:\\\u0026gt; route print\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4 Route Table\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e===========================================================================\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eActive Routes:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNetwork Destination        Netmask          Gateway       Interface  Metric\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          0.0.0.0          0.0.0.0       10.132.0.1      10.132.0.13      5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         10.4.0.0    255.255.240.0         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         10.4.0.2  255.255.255.255         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      10.4.15.255  255.255.255.255         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       10.132.0.0    255.255.240.0       10.132.0.1      10.132.0.13      6\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       10.132.0.1  255.255.255.255         On-link       10.132.0.13      6\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      10.132.0.13  255.255.255.255         On-link       10.132.0.13    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        127.0.0.0        255.0.0.0         On-link         127.0.0.1    331\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        127.0.0.1  255.255.255.255         On-link         127.0.0.1    331\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  127.255.255.255  255.255.255.255         On-link         127.0.0.1    331\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  169.254.169.254  255.255.255.255         On-link       10.132.0.13      6\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  169.254.169.254  255.255.255.255         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        224.0.0.0        240.0.0.0         On-link         127.0.0.1    331\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        224.0.0.0        240.0.0.0         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        224.0.0.0        240.0.0.0         On-link       10.132.0.13    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  255.255.255.255  255.255.255.255         On-link         127.0.0.1    331\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  255.255.255.255  255.255.255.255         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  255.255.255.255  255.255.255.255         On-link       10.132.0.13    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e===========================================================================\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePersistent Routes:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Network Address          Netmask  Gateway Address  Metric\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  169.254.169.254  255.255.255.255         On-link        1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e===========================================================================\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"remmina_Quick%20Connect_localhost_2021812-21538.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eHypotheses:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe packet arrives into the VM but the TCP connection cannot be initiated.\u003c/li\u003e\n\u003cli\u003eThe reason the TCP connection cannot be initiated is that Windows fails sending an ACK packet because it does not have a gateway IP set for this network card.\u003c/li\u003e\n\u003cli\u003eThe ACK cannot be sent because Windows does not find an entry for 10.8.8.10 in its ARP table, and since no gateway is set, it cannot figure out to which MAC address the ACK packet should be addressed.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eIs it the same on Linux?\u003c/p\u003e\n","date":1614428421,"description":"","dir":"2021/windows-missing-gateway/","expirydate":-62135596800,"fuzzywordcount":400,"images":["missing-gateway-windows/cover-missing-gateway-windows.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1614428421,"objectID":"c4369a6ad28e214de246db789ffac60b","permalink":"https://maelvls.dev/do-not-share-yet/missing-gateway-windows/","publishdate":"2021-02-27T14:20:21+02:00","readingtime":2,"relpermalink":"/do-not-share-yet/missing-gateway-windows/","section":"2021","summary":"\u003cp\u003epacket was coming as\u003c/p\u003e\n\u003cp\u003eIncoming packet:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esrc: 10.8.8.10\ndst: 10.4.0.2\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe Windows VM receives the packet on \u003ccode\u003enic2\u003c/code\u003e. IIS, which is listening on all\ninterfaces, handles the connection and sends the response to 10.8.8.10.\u003c/p\u003e\n\u003cp\u003eThe Windows IP stack looks at its routes:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eC:\\\u0026gt; route print\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4 Route Table\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e===========================================================================\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eActive Routes:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNetwork Destination        Netmask          Gateway       Interface  Metric\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          0.0.0.0          0.0.0.0       10.132.0.1      10.132.0.13      5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          0.0.0.0          0.0.0.0         10.4.0.1         10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         10.4.0.0    255.255.240.0         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         10.4.0.2  255.255.255.255         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      10.4.15.255  255.255.255.255         On-link          10.4.0.2    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       10.132.0.0    255.255.240.0       10.132.0.1      10.132.0.13      6\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       10.132.0.1  255.255.255.255         On-link       10.132.0.13      6\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      10.132.0.13  255.255.255.255         On-link       10.132.0.13    261\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e===========================================================================\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePersistent Routes:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Network Address          Netmask  Gateway Address  Metric\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  169.254.169.254  255.255.255.255         On-link        1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          0.0.0.0          0.0.0.0         10.4.0.1  Default\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e===========================================================================\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cimg src=\"remmina_Quick%20Connect_localhost_2021812-2141.png\" alt=\"\"\u003e\u003c/p\u003e","tags":["networking","windows"],"title":"Missing Gateway on Windows","type":"2021","url":"https://maelvls.dev/do-not-share-yet/missing-gateway-windows/","weight":0,"wordcount":342},{"authors":null,"categories":null,"content":"","date":1614428421,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1614428421,"objectID":"https://maelvls.dev/do-not-share-yet/tags/networking/","permalink":"https://maelvls.dev/do-not-share-yet/tags/networking/","publishdate":"2021-02-27T14:20:21+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/networking/","section":"tags","summary":"","tags":null,"title":"Networking","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/networking/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1614428421,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1614428421,"objectID":"https://maelvls.dev/do-not-share-yet/tags/windows/","permalink":"https://maelvls.dev/do-not-share-yet/tags/windows/","publishdate":"2021-02-27T14:20:21+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/windows/","section":"tags","summary":"","tags":null,"title":"Windows","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/windows/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eIngress group and version\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eFirst Kubernetes version\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eLast Kubernetes version\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eextension/v1beta1\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1.0\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1.19\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003enetworking.k8s.io/v1beta\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1.14\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1.21\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003enetworking.k8s.io/v1\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1.19\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eongoing\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n","date":1614349325,"description":"","dir":"2020/kubernetes-api-deprecation-timeline/","expirydate":-62135596800,"fuzzywordcount":100,"images":["kubernetes-api-deprecation-timeline/cover-kubernetes-api-deprecation-timeline.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1614349325,"objectID":"3ecadc5e0cdf81355ffc9c2363343ddc","permalink":"https://maelvls.dev/do-not-share-yet/kubernetes-api-deprecation-timeline/","publishdate":"2021-02-26T15:22:05+01:00","readingtime":1,"relpermalink":"/do-not-share-yet/kubernetes-api-deprecation-timeline/","section":"2020","summary":"\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eIngress group and version\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eFirst Kubernetes version\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eLast Kubernetes version\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eextension/v1beta1\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1.0\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1.19\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003enetworking.k8s.io/v1beta\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1.14\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1.21\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003enetworking.k8s.io/v1\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e1.19\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003eongoing\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e","tags":[],"title":"Kubernetes Api Deprecation Timeline","type":"2020","url":"https://maelvls.dev/do-not-share-yet/kubernetes-api-deprecation-timeline/","weight":0,"wordcount":19},{"authors":null,"categories":null,"content":"\u003cp\u003e/Users/mvalais/code/maelvls.github.io/content/2020/custom-ingresses-and-helm-charts\u003c/p\u003e\n","date":1607099467,"description":"","dir":"2020/custom-ingresses-and-helm-charts/","expirydate":-62135596800,"fuzzywordcount":100,"images":["custom-ingresses-and-helm-charts/cover-custom-ingresses-and-helm-charts.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1607099467,"objectID":"e2006e9146bd9060645edc7581d052eb","permalink":"https://maelvls.dev/do-not-share-yet/custom-ingresses-and-helm-charts/","publishdate":"2020-12-04T17:31:07+01:00","readingtime":1,"relpermalink":"/do-not-share-yet/custom-ingresses-and-helm-charts/","section":"2020","summary":"\u003cp\u003e/Users/mvalais/code/maelvls.github.io/content/2020/custom-ingresses-and-helm-charts\u003c/p\u003e","tags":[],"title":"Custom Ingresses and Helm Charts","type":"2020","url":"https://maelvls.dev/do-not-share-yet/custom-ingresses-and-helm-charts/","weight":0,"wordcount":1},{"authors":null,"categories":null,"content":"\u003cp\u003eExample 1:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- \u003cspan class=\"nt\"\u003eexample\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003edescription\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003efoo\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eand\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- \u003cspan class=\"nt\"\u003eexample\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003edescription\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003efoo\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1604328404,"description":"","dir":"2020/yaml-isnt-that-good/","expirydate":-62135596800,"fuzzywordcount":100,"images":["yaml-isnt-that-good/cover-yaml-isnt-that-good.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1604328404,"objectID":"1db73e8dbf5e441c58414445cd1b43cf","permalink":"https://maelvls.dev/do-not-share-yet/yaml-isnt-that-good/","publishdate":"2020-11-02T15:46:44+01:00","readingtime":1,"relpermalink":"/do-not-share-yet/yaml-isnt-that-good/","section":"2020","summary":"\u003cp\u003eExample 1:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- \u003cspan class=\"nt\"\u003eexample\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003edescription\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003efoo\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eand\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- \u003cspan class=\"nt\"\u003eexample\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003edescription\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003efoo\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[],"title":"Yaml Isnt That Good","type":"2020","url":"https://maelvls.dev/do-not-share-yet/yaml-isnt-that-good/","weight":0,"wordcount":13},{"authors":null,"categories":null,"content":"\u003ch2 id=\"terms\"\u003eTerms\u003c/h2\u003e\n\u003cp\u003eA domain name (or just \u0026ldquo;domain\u0026rdquo;) is a string the form \u003ccode\u003ebar.foo.com.\u003c/code\u003e. Not all domains refer to physical machines; for example, one of my domains, \u003ccode\u003ek.maelvls.dev.\u003c/code\u003e, do not point to any physical machine.\u003c/p\u003e\n\u003cp\u003eWe often represent the domain name space using a tree. Each node is a domain. Leaves and nodes may have \u003ccode\u003eA\u003c/code\u003e records. Here is a simple example of the domain space represented as a tree:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e├── com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e├── dev.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e│  └── maelvls.dev.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e│     └── k.maelvls.dev.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e└── io.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA \u003ca href=\"https://tools.ietf.org/html/rfc1034#section-2.4\" title=\"Elements of a DNS\"\u003ezone\u003c/a\u003e is a subtree of the domain space that is under the authority of a given name server. In the following, I will use \u0026ldquo;subtree\u0026rdquo; and \u0026ldquo;zone\u0026rdquo; interchangeably and I identify a zone (or subtree) by its apex domain; the apex is domain name at the root of a zone.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eI decided to put domain names directly in each node; note that the \u003ca href=\"https://tools.ietf.org/html/rfc1034#section-3.1\" title=\"Domain space\"\u003eRFC 1034\u003c/a\u003e represents the domain space as a tree of labels (a label is of the form \u003ccode\u003efoo\u003c/code\u003e or \u003ccode\u003efoo-bar\u003c/code\u003e). In this tree, the domain name of a node has to be reconstructed by concatenating the labels starting from the node and ending with the root of the domain space tree.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eFrom the above example, my zone is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e└── k.maelvls.dev.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA zone has \u0026ldquo;authority\u0026rdquo; over its subtree as long as one of its parent domains has an \u003ccode\u003eNS\u003c/code\u003e record to a name server that has the records for that zone. I told my registrar (Google Domains) to use the Google DNS name servers, which means that the \u003ccode\u003edev.\u003c/code\u003e name servers now have \u003ccode\u003eNS\u003c/code\u003e records that point to Google DNS\u0026rsquo; name servers. With this \u003ccode\u003eNS\u003c/code\u003e record, the \u003ccode\u003edev.\u003c/code\u003e zone \u0026ldquo;delegates\u0026rdquo; the \u003ccode\u003emaelvls.dev.\u003c/code\u003e zone to Google DNS\u0026rsquo; name servers.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNote: recursivity and delegation are different: a recursive DNS makes the subsequent calls on behalf of its client, while delegating a DNS zone means that a certain domain of a zone is \u0026ldquo;forwarded\u0026rdquo; to another name server using the \u003ccode\u003eNS\u003c/code\u003e record.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eFor example, let us use \u003ccode\u003edig\u003c/code\u003e to see all intermediate DNS queries at once:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% dig +trace minio.k.maelvls.dev\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# I omitted the DNSSEC-related records (RRSIG, DS and NSEC3 records).\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# I also omitted some NS records when there was too many of them.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.                              \u003cspan class=\"m\"\u003e342831\u003c/span\u003e  IN  NS     a.root-servers.net.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.                              \u003cspan class=\"m\"\u003e342831\u003c/span\u003e  IN  NS     b.root-servers.net.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edev.                           \u003cspan class=\"m\"\u003e172800\u003c/span\u003e  IN  NS     ns-tld1.charlestonroadregistry.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edev.                           \u003cspan class=\"m\"\u003e172800\u003c/span\u003e  IN  NS     ns-tld2.charlestonroadregistry.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.                   \u003cspan class=\"m\"\u003e10800\u003c/span\u003e   IN  NS     ns-cloud-a1.googledomains.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.                   \u003cspan class=\"m\"\u003e10800\u003c/span\u003e   IN  NS     ns-cloud-a2.googledomains.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.                   \u003cspan class=\"m\"\u003e300\u003c/span\u003e     IN  SOA   ns-cloud-a1.googledomains.com. ...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eminio.k.maelvls.dev.           \u003cspan class=\"m\"\u003e300\u003c/span\u003e     IN  A       91.211.152.190\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"client-side-name-guessing\"\u003eClient-side name guessing\u003c/h2\u003e\n\u003cp\u003eIn some cases, the DNS query may omit the right-most part of the domain. For example, in Kubernetes, you may either use the fully-qualified domain name (FQDN, which is a domain that contains the \u003ccode\u003e.\u003c/code\u003e root domain), or just use a part of the domain name:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enslookup kubernetes.default.svc.cluster.local    \u003cspan class=\"c1\"\u003e# works (FQDN)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enslookup kubernetes.default.svc.cluster          \u003cspan class=\"c1\"\u003e# doesn\u0026#39;t work\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enslookup kubernetes.default.svc                  \u003cspan class=\"c1\"\u003e# works\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enslookup kubernetes.default                      \u003cspan class=\"c1\"\u003e# works\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enslookup kubernetes                              \u003cspan class=\"c1\"\u003e# works (guesses namespace)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn CoreDNS, you can give the apex domain name (by default, in Kubernetes, the apex is \u003ccode\u003ecluster.local.\u003c/code\u003e). The Corefile needs to load the \u003ca href=\"https://github.com/coredns/coredns/tree/master/plugin/kubernetes\"\u003ekubernetes plugin\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.:53 \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    kubernetes cluster.local\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eNote that \u003ccode\u003ekubernetes.default\u003c/code\u003e is not a subdomain; a \u003ca href=\"https://tools.ietf.org/html/rfc7719\" title=\"DNS terminology\"\u003esubdomain\u003c/a\u003e of a domain is a domain that contains the domain itself on it right-most side.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eminio.k.maelvls.dev   is subdomain of     k.maelvls.dev\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eminio.k.maelvls.dev   is subdomain of       maelvls.dev\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ek.maelvls.dev         is subdomain of       maelvls.dev\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eWhenever a container is given to resolve any kind of name (even one that looks like an FQDN; the client doesn\u0026rsquo;t known, really), it will go through the \u0026ldquo;search domain names\u0026rdquo; list configured in \u003ccode\u003e/etc/resolv.conf\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% cat /etc/resolv.conf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esearch default.svc.cluster.local svc.cluster.local cluster.local\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enameserver 10.96.0.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eoptions ndots:5\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLet\u0026rsquo;s try with \u003ccode\u003ekubernetes.default\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% tcpdump \u003cspan class=\"s2\"\u003e\u0026#34;udp port 53\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nslookup kubernetes.default\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12:01:17.430931 IP foo.39435 \u0026gt; kube-dns.kube-system.svc.cluster.local.53: 32862+ A? kubernetes.default.default.svc.cluster.local. \u003cspan class=\"o\"\u003e(\u003c/span\u003e62\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12:01:17.431573 IP kube-dns.kube-system.svc.cluster.local.53 \u0026gt; foo.39435: \u003cspan class=\"m\"\u003e32862\u003c/span\u003e NXDomain*- 0/1/0 \u003cspan class=\"o\"\u003e(\u003c/span\u003e155\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12:01:17.431987 IP foo.35023 \u0026gt; kube-dns.kube-system.svc.cluster.local.53: 39314+ A? kubernetes.default.svc.cluster.local. \u003cspan class=\"o\"\u003e(\u003c/span\u003e54\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12:01:17.433258 IP kube-dns.kube-system.svc.cluster.local.53 \u0026gt; foo.35023: 39314*- 1/0/0 A 10.96.0.1 \u003cspan class=\"o\"\u003e(\u003c/span\u003e106\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eServer:\t\t10.96.0.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAddress:\t10.96.0.10#53\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eName:\tkubernetes.default.svc.cluster.local\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAddress: 10.96.0.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe client (the container \u003ccode\u003efoo\u003c/code\u003e) has to do two consecutive queries in order to get an answer; as you can see, the way partial domain name guessing is done is quite dumb and relies on many client-side queries:\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003equeried name\u003c/th\u003e\n          \u003cth\u003equeries count\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekubernetes\u003c/td\u003e\n          \u003ctd\u003e1\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekubernetes.default\u003c/td\u003e\n          \u003ctd\u003e2\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekubernetes.default.svc\u003c/td\u003e\n          \u003ctd\u003e3\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekubernetes.default.svc.cluster\u003c/td\u003e\n          \u003ctd\u003e(*)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekubernetes.default.svc.cluster.local\u003c/td\u003e\n          \u003ctd\u003e4\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003efoo (the container\u0026rsquo;s name)\u003c/td\u003e\n          \u003ctd\u003e4\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003egoogle.com\u003c/td\u003e\n          \u003ctd\u003e4\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(*) since the search domain name \u003ccode\u003ecluster\u003c/code\u003e doesn\u0026rsquo;t exist in \u003ccode\u003e/etc/resolv.conf\u003c/code\u003e, this name can\u0026rsquo;t be resolved.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eI noticed something unexpected when querying \u003ccode\u003efoo\u003c/code\u003e (which is the container\u0026rsquo;s name). I was expecting the name to be picked from \u003ccode\u003e/etc/hosts\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% cat /etc/hosts\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Kubernetes-managed hosts file.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e127.0.0.1\tlocalhost\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e::1\tlocalhost ip6-localhost ip6-loopback\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efe00::0\tip6-localnet\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efe00::0\tip6-mcastprefix\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efe00::1\tip6-allnodes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efe00::2\tip6-allrouters\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.244.0.14\tfoo                     \u003cspan class=\"c1\"\u003e# this!\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBut weirdly enough, \u003ccode\u003efoo\u003c/code\u003e is resolved by the name server:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% hostname\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efoo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% tcpdump \u003cspan class=\"s2\"\u003e\u0026#34;udp port 53\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nslookup foo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:35:09.052394 IP foo.58416 \u0026gt; kube-dns.kube-system.svc.cluster.local.53: 39460+ A? foo.default.svc.cluster.local. \u003cspan class=\"o\"\u003e(\u003c/span\u003e47\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:35:09.052993 IP kube-dns.kube-system.svc.cluster.local.53 \u0026gt; foo.58416: \u003cspan class=\"m\"\u003e39460\u003c/span\u003e NXDomain*- 0/1/0 \u003cspan class=\"o\"\u003e(\u003c/span\u003e140\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:35:09.053708 IP foo.53273 \u0026gt; kube-dns.kube-system.svc.cluster.local.53: 3313+ A? foo.svc.cluster.local. \u003cspan class=\"o\"\u003e(\u003c/span\u003e39\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:35:09.054315 IP kube-dns.kube-system.svc.cluster.local.53 \u0026gt; foo.53273: \u003cspan class=\"m\"\u003e3313\u003c/span\u003e NXDomain*- 0/1/0 \u003cspan class=\"o\"\u003e(\u003c/span\u003e132\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:35:09.055023 IP foo.44989 \u0026gt; kube-dns.kube-system.svc.cluster.local.53: 19225+ A? foo.cluster.local. \u003cspan class=\"o\"\u003e(\u003c/span\u003e35\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:35:09.056578 IP kube-dns.kube-system.svc.cluster.local.53 \u0026gt; foo.44989: \u003cspan class=\"m\"\u003e19225\u003c/span\u003e NXDomain*- 0/1/0 \u003cspan class=\"o\"\u003e(\u003c/span\u003e128\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:35:09.057185 IP foo.39326 \u0026gt; kube-dns.kube-system.svc.cluster.local.53: 2052+ A? foo. \u003cspan class=\"o\"\u003e(\u003c/span\u003e21\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:35:09.060754 IP kube-dns.kube-system.svc.cluster.local.53 \u0026gt; foo.39326: \u003cspan class=\"m\"\u003e2052\u003c/span\u003e 1/0/0 A 127.0.0.1 \u003cspan class=\"o\"\u003e(\u003c/span\u003e40\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eServer:\t\t10.96.0.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAddress:\t10.96.0.10#53\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNon-authoritative answer:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eName:\tfoo\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAddress: 127.0.0.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWhenever a container queries a name that is outside of Kubernetes, it has to go through all these four NSDOMA ` before actually getting a response:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% tcpdump \u003cspan class=\"s2\"\u003e\u0026#34;udp port 53\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nslookup google.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:40:12.569439 IP foo.49028 \u0026gt; kube-dns.kube-system.svc.cluster.local.53: 33319+ A? google.com.default.svc.cluster.local. \u003cspan class=\"o\"\u003e(\u003c/span\u003e54\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:40:12.572349 IP kube-dns.kube-system.svc.cluster.local.53 \u0026gt; foo.49028: \u003cspan class=\"m\"\u003e33319\u003c/span\u003e NXDomain*- 0/1/0 \u003cspan class=\"o\"\u003e(\u003c/span\u003e147\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:40:12.572970 IP foo.54948 \u0026gt; kube-dns.kube-system.svc.cluster.local.53: 48254+ A? google.com.svc.cluster.local. \u003cspan class=\"o\"\u003e(\u003c/span\u003e46\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:40:12.573828 IP kube-dns.kube-system.svc.cluster.local.53 \u0026gt; foo.54948: \u003cspan class=\"m\"\u003e48254\u003c/span\u003e NXDomain*- 0/1/0 \u003cspan class=\"o\"\u003e(\u003c/span\u003e139\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:40:12.574303 IP foo.56236 \u0026gt; kube-dns.kube-system.svc.cluster.local.53: 26722+ A? google.com.cluster.local. \u003cspan class=\"o\"\u003e(\u003c/span\u003e42\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:40:12.574865 IP kube-dns.kube-system.svc.cluster.local.53 \u0026gt; foo.56236: \u003cspan class=\"m\"\u003e26722\u003c/span\u003e NXDomain*- 0/1/0 \u003cspan class=\"o\"\u003e(\u003c/span\u003e135\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:40:12.576272 IP foo.48021 \u0026gt; kube-dns.kube-system.svc.cluster.local.53: 2652+ A? google.com. \u003cspan class=\"o\"\u003e(\u003c/span\u003e28\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10:40:12.609035 IP kube-dns.kube-system.svc.cluster.local.53 \u0026gt; foo.48021: \u003cspan class=\"m\"\u003e2652\u003c/span\u003e 1/0/0 A 172.217.18.206 \u003cspan class=\"o\"\u003e(\u003c/span\u003e54\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eServer:\t\t10.96.0.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAddress:\t10.96.0.10#53\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNon-authoritative answer:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eName:\tgoogle.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAddress: 172.217.18.206\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe DHCP answer from my router contains the \u003ca href=\"https://tools.ietf.org/html/rfc2132#section-3.17\"\u003eoption header 15\u003c/a\u003e \u0026ldquo;Domain Name\u0026rdquo;; in my case, the only domain name returned is \u003ccode\u003ehome\u003c/code\u003e. Which means that anytime the client (my machine) wants to query a name, say \u003ccode\u003emacbook-pro\u003c/code\u003e, it will try in this order:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emacbook-pro.home.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emacbook-pro.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHere is a capture of my machine trying to figure out the name \u003ccode\u003emacbook-pro\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% tcpdump -ien0 \u003cspan class=\"s1\"\u003e\u0026#39;(udp port 53 \u0026amp;\u0026amp; (src 192.168.1.1 || dst 192.168.1.1))\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elistening on en0, link-type EN10MB \u003cspan class=\"o\"\u003e(\u003c/span\u003eEthernet\u003cspan class=\"o\"\u003e)\u003c/span\u003e, capture size \u003cspan class=\"m\"\u003e262144\u003c/span\u003e bytes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12:04:34.873178 IP 192.168.1.14.58108 \u0026gt; 192.168.1.1.domain: 1698+ A? macbook-pro.home. \u003cspan class=\"o\"\u003e(\u003c/span\u003e41\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12:04:34.924824 IP 192.168.1.1.domain \u0026gt; 192.168.1.14.58108: \u003cspan class=\"m\"\u003e1698\u003c/span\u003e NXDomain 0/1/0 \u003cspan class=\"o\"\u003e(\u003c/span\u003e116\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12:04:34.925217 IP 192.168.1.14.53531 \u0026gt; 192.168.1.1.domain: 9166+ A? macbook-pro. \u003cspan class=\"o\"\u003e(\u003c/span\u003e39\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e12:04:34.948013 IP 192.168.1.1.domain \u0026gt; 192.168.1.14.53531: 9166* 2/0/0 A 192.168.1.14, A 192.168.1.21 \u003cspan class=\"o\"\u003e(\u003c/span\u003e71\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003ea hierarchical DNS (also called DNS chaining or DNS delegation) is when a DNS has a record \u003ccode\u003eNS\u003c/code\u003e to another DNS server.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOne single \u003ca href=\"https://simpledns.plus/help/soa-records\"\u003eSOA record\u003c/a\u003e (start of authority) exists for every given zone. As you can see here, my zone is \u003ccode\u003emaelvls.dev.\u003c/code\u003e.\u003c/p\u003e\n\u003ch2 id=\"playing-with-k8s_gateway\"\u003ePlaying with \u003ccode\u003ek8s_gateway\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eThe Corefile is available \u003ca href=\"https://github.com/maelvls/k.maelvls.dev/blob/0e77a838251b209646f433a2b1d5e1a440f8e856/helm/ext-coredns.yaml#L13-L31\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eBefore, my top-level DNS would be littered with records created by ExternalDNS:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud dns record-sets list --zone\u003cspan class=\"o\"\u003e=\u003c/span\u003emaelvls\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME                      TYPE   TTL    DATA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.              A      \u003cspan class=\"m\"\u003e300\u003c/span\u003e    185.199.108.153,185.199.109.153,185.199.110.153,185.199.111.153\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.              MX     \u003cspan class=\"m\"\u003e300\u003c/span\u003e    \u003cspan class=\"m\"\u003e1\u003c/span\u003e aspmx.l.google.com.,5 alt1.aspmx.l.google.com.,5 alt2.aspmx.l.google.com.,10 alt3.aspmx.l.google.com.,10 alt4.aspmx.l.google.com.,15 pdquboxtbnqki2zinxaksc3jnnluefibfdbqhi7ghbhfbg7ef47q.mx-verification.google.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.              NS     \u003cspan class=\"m\"\u003e21600\u003c/span\u003e  ns-cloud-a1.googledomains.com.,ns-cloud-a2.googledomains.com.,ns-cloud-a3.googledomains.com.,ns-cloud-a4.googledomains.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.              SOA    \u003cspan class=\"m\"\u003e21600\u003c/span\u003e  ns-cloud-a1.googledomains.com. cloud-dns-hostmaster.google.com. \u003cspan class=\"m\"\u003e12\u003c/span\u003e \u003cspan class=\"m\"\u003e21600\u003c/span\u003e \u003cspan class=\"m\"\u003e3600\u003c/span\u003e \u003cspan class=\"m\"\u003e259200\u003c/span\u003e \u003cspan class=\"m\"\u003e300\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.              TXT    \u003cspan class=\"m\"\u003e300\u003c/span\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;keybase-site-verification=PnIWsZlbzCGwYrc5J_VCVphBOMHCVjcIx6nMSkeCZzI\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econcourse.k.maelvls.dev.  A      \u003cspan class=\"m\"\u003e300\u003c/span\u003e    91.211.152.190\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econcourse.k.maelvls.dev.  TXT    \u003cspan class=\"m\"\u003e300\u003c/span\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;heritage=external-dns,external-dns/owner=k8s,external-dns/resource=ingress/concourse/cm-acme-http-solver-xlvtk\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edrone.k.maelvls.dev.      A      \u003cspan class=\"m\"\u003e300\u003c/span\u003e    91.211.152.190\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edrone.k.maelvls.dev.      TXT    \u003cspan class=\"m\"\u003e300\u003c/span\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;heritage=external-dns,external-dns/owner=k8s,external-dns/resource=ingress/drone/cm-acme-http-solver-xv5cs\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eminio.k.maelvls.dev.      A      \u003cspan class=\"m\"\u003e300\u003c/span\u003e    91.211.152.190\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eminio.k.maelvls.dev.      TXT    \u003cspan class=\"m\"\u003e300\u003c/span\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;heritage=external-dns,external-dns/owner=k8s,external-dns/resource=ingress/minio/cm-acme-http-solver-82slp\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e*.minio.k.maelvls.dev.    A      \u003cspan class=\"m\"\u003e300\u003c/span\u003e    91.211.152.190\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e*.minio.k.maelvls.dev.    TXT    \u003cspan class=\"m\"\u003e300\u003c/span\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;heritage=external-dns,external-dns/owner=k8s,external-dns/resource=ingress/minio/minio\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ens.k.maelvls.dev.         A      \u003cspan class=\"m\"\u003e300\u003c/span\u003e    91.211.152.190\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ens.k.maelvls.dev.         TXT    \u003cspan class=\"m\"\u003e300\u003c/span\u003e    \u003cspan class=\"s2\"\u003e\u0026#34;heritage=external-dns,external-dns/owner=k8s,external-dns/resource=service/ext-coredns/ext-coredns\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAfter:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud dns record-sets list --zone=maelvls\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME               TYPE  TTL    DATA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.       A     300    185.199.108.153,185.199.109.153,185.199.110.153,185.199.111.153\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.       MX    300    1 aspmx.l.google.com.,5 alt1.aspmx.l.google.com.,5 alt2.aspmx.l.google.com.,10 alt3.aspmx.l.google.com.,10 alt4.aspmx.l.google.com.,15 pdquboxtbnqki2zinxaksc3jnnluefibfdbqhi7ghbhfbg7ef47q.mx-verification.google.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.       NS    21600  ns-cloud-a1.googledomains.com.,ns-cloud-a2.googledomains.com.,ns-cloud-a3.googledomains.com.,ns-cloud-a4.googledomains.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.       SOA   21600  ns-cloud-a1.googledomains.com. cloud-dns-hostmaster.google.com. 13 21600 3600 259200 300\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.       TXT   300    \u0026#34;keybase-site-verification=PnIWsZlbzCGwYrc5J_VCVphBOMHCVjcIx6nMSkeCZzI\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ek.maelvls.dev.     NS    300    ns.k.maelvls.dev.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ens.k.maelvls.dev.  A     300    91.211.152.190\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ens.k.maelvls.dev.  TXT   300    \u0026#34;heritage=external-dns,external-dns/owner=k8s,external-dns/resource=service/ext-coredns/ext-coredns\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIt works!\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% dig +trace minio.k.maelvls.dev\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.                     \u003cspan class=\"m\"\u003e407578\u003c/span\u003e  IN  NS  a.root-servers.net.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.                     \u003cspan class=\"m\"\u003e407578\u003c/span\u003e  IN  NS  b.root-servers.net.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.                     \u003cspan class=\"m\"\u003e407578\u003c/span\u003e  IN  NS  c.root-servers.net.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edev.                  \u003cspan class=\"m\"\u003e172800\u003c/span\u003e  IN  NS  ns-tld1.charlestonroadregistry.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edev.                  \u003cspan class=\"m\"\u003e172800\u003c/span\u003e  IN  NS  ns-tld2.charlestonroadregistry.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.          \u003cspan class=\"m\"\u003e10800\u003c/span\u003e   IN  NS  ns-cloud-a1.googledomains.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emaelvls.dev.          \u003cspan class=\"m\"\u003e10800\u003c/span\u003e   IN  NS  ns-cloud-a2.googledomains.com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ek.maelvls.dev.        \u003cspan class=\"m\"\u003e300\u003c/span\u003e     IN  NS  ns.k.maelvls.dev.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eminio.k.maelvls.dev.  \u003cspan class=\"m\"\u003e5\u003c/span\u003e       IN  A   91.211.152.190\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1595635200,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":1400,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1595635200,"objectID":"40e53b9499468aa27bb5336ea4e44dbc","permalink":"https://maelvls.dev/do-not-share-yet/notes/dns/","publishdate":"2020-07-25T00:00:00Z","readingtime":7,"relpermalink":"/do-not-share-yet/notes/dns/","section":"notes","summary":"\u003ch2 id=\"terms\"\u003eTerms\u003c/h2\u003e\n\u003cp\u003eA domain name (or just \u0026ldquo;domain\u0026rdquo;) is a string the form \u003ccode\u003ebar.foo.com.\u003c/code\u003e. Not all domains refer to physical machines; for example, one of my domains, \u003ccode\u003ek.maelvls.dev.\u003c/code\u003e, do not point to any physical machine.\u003c/p\u003e\n\u003cp\u003eWe often represent the domain name space using a tree. Each node is a domain. Leaves and nodes may have \u003ccode\u003eA\u003c/code\u003e records. Here is a simple example of the domain space represented as a tree:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e├── com.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e├── dev.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e│  └── maelvls.dev.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e│     └── k.maelvls.dev.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e└── io.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA \u003ca href=\"https://tools.ietf.org/html/rfc1034#section-2.4\" title=\"Elements of a DNS\"\u003ezone\u003c/a\u003e is a subtree of the domain space that is under the authority of a given name server. In the following, I will use \u0026ldquo;subtree\u0026rdquo; and \u0026ldquo;zone\u0026rdquo; interchangeably and I identify a zone (or subtree) by its apex domain; the apex is domain name at the root of a zone.\u003c/p\u003e","tags":["networking"],"title":"It's always the DNS' fault","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/dns/","weight":0,"wordcount":1369},{"authors":null,"categories":null,"content":"","date":1595635200,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"section","lang":"en","lastmod":1595635200,"objectID":"https://maelvls.dev/do-not-share-yet/notes/","permalink":"https://maelvls.dev/do-not-share-yet/notes/","publishdate":"2020-07-25T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/notes/","section":"notes","summary":"","tags":null,"title":"Notes","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003e\u003ca href=\"https://github.com/sshuttle/sshuttle\"\u003eSshuttle\u003c/a\u003e is a tool that lets you proxy traffic for an IP range (using iptables on Linux or pf on BSD derivatives including macOS) to a host through ssh.\u003c/p\u003e\n\u003cp\u003eI use Telepresence which makes sshuttle easier to use with Kubernetes. But I wondered: what happens under the hood? How come I am able to expose a service type=LoadBalancer using MetalLB on macOS using \u003ca href=\"https://github.com/kubernetes-sigs/kind\"\u003eKind\u003c/a\u003e?\u003c/p\u003e\n\u003cp\u003eThe idea is to have a Kind cluster (right box) in which we run a service type=LoadBalancer controller (MetalLB) and a simple pod. Making an HTTP request from the host should hit the pod thanks to sshuttle:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      |                              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e curl http://172.17.0.200             |  +-----------------------+   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |                         |  | metallb speaker (arp) |   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |                         |  +-----------------------+   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |172.17.0.0/16            |   range 172.17.0.{200-250}   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |                         |                              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            v                         |                              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      +------------+                  |    +------------------+      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |host\u0026#39;s      |                  |    | pod nginx:alpine |      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |iptables/pf |                  |    +------------------+      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      +------------+                  |             ^                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |                         |             |new tcp         |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |                         |             |connection      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |                         |             |172.17.0.200:80 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            v                         |             |                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        tcp + udp     (raw over ssh)  |    +------------------+      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       proxy server ---------------------\u0026gt; |   sshuttle pod   |      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        (sshuttle)                    |    +------------------+      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!-- https://textik.com/#19fa729cd40cd953 --\u003e\n\u003cp\u003eLet\u0026rsquo;s create a Kind cluster and setup MetalLB in L2 mode. MetalLB will advertize services of type LoadBalancer by picking up an IP on the range \u003ccode\u003e172.17.0.200-172.17.0.250\u003c/code\u003e and will advertize this IP using the ARP protocol.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eKUBECONFIG\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/tmp/kind-kubeconfig\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekind create cluster\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl apply -f https://raw.githubusercontent.com/metallb/metallb/v0.9.3/manifests/namespace.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl apply -f https://raw.githubusercontent.com/metallb/metallb/v0.9.3/manifests/metallb.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl -n metallb-system create secret generic memberlist --from-literal\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003esecretkey\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003eopenssl rand -base64 128\u003cspan class=\"k\"\u003e)\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl -n metallb-system delete configmap config\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eNET\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003edocker network inspect bridge \u003cspan class=\"p\"\u003e|\u003c/span\u003e jq \u003cspan class=\"s1\"\u003e\u0026#39;.[].IPAM.Config[0] | select(.Gateway) | .Subnet\u0026#39;\u003c/span\u003e -r \u003cspan class=\"p\"\u003e|\u003c/span\u003e sed \u003cspan class=\"s1\"\u003e\u0026#39;s|/16||\u0026#39;\u003c/span\u003e\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl -n metallb-system create configmap config --from-file\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003econfig\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/dev/stdin \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt;EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eaddress-pools:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e- name: default\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  protocol: layer2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  addresses:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  - ${NET/%.0/.200}-${NET/%.0/.250}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, let\u0026rsquo;s create a pod and a service type=LoadBalancer:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ePod\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003enginx\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econtainers\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003enginx\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003enginx:alpine\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eports\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e- \u003cspan class=\"nt\"\u003econtainerPort\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e80\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nn\"\u003e---\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eService\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003enginx\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eLoadBalancer\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eports\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e80\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003etargetPort\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e80\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFinally, let\u0026rsquo;s run sshuttle:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install sshuttle\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003e⚠️ I\u0026rsquo;m stuck here since \u003ccode\u003essh\u003c/code\u003e on the host can\u0026rsquo;t reach any sshd\u0026hellip; What telepresence does is to have an sshd running in some pod, run \u003ccode\u003ekubectl port-forward\u003c/code\u003e so that \u003ccode\u003essh\u003c/code\u003e can work from the host.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"packet-tunneling-using-sshuttle\"\u003ePacket tunneling using sshuttle\u003c/h2\u003e\n\u003cp\u003eSshuttle runs a TCP/UDP proxy on the host on port 12300. The traffic that goes to \u003ccode\u003e172.17.0.0/16\u003c/code\u003e is then forwarded to that port (src and dst headers are left unchanged). Note that the 12300 port deals with both TCP and UDP packets at the same time!\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eOn macOS:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epfctl -a sshuttle6-12300 -f /dev/stdin\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epfctl -a sshuttle-12300 -f /dev/stdin\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epfctl -E\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eOn Linux:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiptables -t nat -N sshuttle-12300\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiptables -t nat -F sshuttle-12300\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiptables -t nat -I OUTPUT \u003cspan class=\"m\"\u003e1\u003c/span\u003e -j sshuttle-12300\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiptables -t nat -I PREROUTING \u003cspan class=\"m\"\u003e1\u003c/span\u003e -j sshuttle-12300\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiptables -t nat -A sshuttle-12300 -j RETURN --dest 172.17.0.0/16 -p tcp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiptables -t nat -A sshuttle-12300 -j REDIRECT --dest 172.17.0.0/16 -p tcp --to-ports \u003cspan class=\"m\"\u003e12300\u003c/span\u003e -m ttl \u003cspan class=\"s1\"\u003e\u0026#39;!\u0026#39;\u003c/span\u003e --ttl \u003cspan class=\"m\"\u003e42\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eiptables -t nat -A sshuttle-12300 -j REDIRECT --dest 172.17.0.0/16 -p udp -dport \u003cspan class=\"m\"\u003e53\u003c/span\u003e --to-ports \u003cspan class=\"m\"\u003e12300\u003c/span\u003e -m ttl \u003cspan class=\"s1\"\u003e\u0026#39;!\u0026#39;\u003c/span\u003e --ttl \u003cspan class=\"m\"\u003e42\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","date":1595318831,"description":"","dir":"2020/expose-service-using-kind-on-macos/","expirydate":-62135596800,"fuzzywordcount":600,"images":["expose-service-using-kind-on-macos/cover-expose-service-using-kind-on-macos.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1595318831,"objectID":"de8a69b306d4d76ca4a3dd4bf86237ac","permalink":"https://maelvls.dev/do-not-share-yet/expose-service-using-kind-on-macos/","publishdate":"2020-07-21T10:07:11+02:00","readingtime":3,"relpermalink":"/do-not-share-yet/expose-service-using-kind-on-macos/","section":"2020","summary":"\u003cp\u003e\u003ca href=\"https://github.com/sshuttle/sshuttle\"\u003eSshuttle\u003c/a\u003e is a tool that lets you proxy traffic for an IP range (using iptables on Linux or pf on BSD derivatives including macOS) to a host through ssh.\u003c/p\u003e\n\u003cp\u003eI use Telepresence which makes sshuttle easier to use with Kubernetes. But I wondered: what happens under the hood? How come I am able to expose a service type=LoadBalancer using MetalLB on macOS using \u003ca href=\"https://github.com/kubernetes-sigs/kind\"\u003eKind\u003c/a\u003e?\u003c/p\u003e\n\u003cp\u003eThe idea is to have a Kind cluster (right box) in which we run a service type=LoadBalancer controller (MetalLB) and a simple pod. Making an HTTP request from the host should hit the pod thanks to sshuttle:\u003c/p\u003e","tags":["networking","sshuttle"],"title":"Expose Service Using Kind on Macos","type":"2020","url":"https://maelvls.dev/do-not-share-yet/expose-service-using-kind-on-macos/","weight":0,"wordcount":519},{"authors":null,"categories":null,"content":"","date":1595318831,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1595318831,"objectID":"https://maelvls.dev/do-not-share-yet/tags/sshuttle/","permalink":"https://maelvls.dev/do-not-share-yet/tags/sshuttle/","publishdate":"2020-07-21T10:07:11+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/sshuttle/","section":"tags","summary":"","tags":null,"title":"Sshuttle","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/sshuttle/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1595318805,"description":"","dir":"2020/kind-and-service-loadbalancer/","expirydate":-62135596800,"fuzzywordcount":100,"images":["kind-and-service-loadbalancer/cover-kind-and-service-loadbalancer.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1595318805,"objectID":"39364df3d42fac936c442830aaa5bf17","permalink":"https://maelvls.dev/do-not-share-yet/kind-and-service-loadbalancer/","publishdate":"2020-07-21T10:06:45+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/kind-and-service-loadbalancer/","section":"2020","summary":"","tags":[],"title":"Kind and Service Loadbalancer","type":"2020","url":"https://maelvls.dev/do-not-share-yet/kind-and-service-loadbalancer/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eA proxy is something (most of the time software, but sometimes also hardware like a dedicated FPGA) that forwards traffic from a place to another.\u003c/p\u003e\n\u003cp\u003eMost of the time, when someone talks about a \u0026ldquo;proxy\u0026rdquo;, they mean an HTTP proxy that would allow this person to access the internet behind a corporate firewall.\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eLayer\u003c/th\u003e\n          \u003cth\u003eProxies\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eL7\u003c/td\u003e\n          \u003ctd\u003eplain HTTP, HTTP \u003ccode\u003eCONNECT\u003c/code\u003e, SOCKS, SOCKS5, HTTPS/SNI proxies\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eL4\u003c/td\u003e\n          \u003ctd\u003eTCP proxies\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eL3\u003c/td\u003e\n          \u003ctd\u003eVPNs\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eTerms:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003etunnel\u003c/li\u003e\n\u003cli\u003etransparent proxy = doesn\u0026rsquo;t temper with packets; only redirects them\u003c/li\u003e\n\u003cli\u003eVPN\u003c/li\u003e\n\u003cli\u003eforwarding\u003c/li\u003e\n\u003cli\u003ereverse proxy\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"layer-7-http-connect-tcp-tunnel\"\u003eLayer 7: HTTP CONNECT (TCP tunnel)\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003eCONNECT\u003c/span\u003e \u003cspan class=\"nn\"\u003estreamline.t-mobile.com:22\u003c/span\u003e \u003cspan class=\"kr\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eProxy-Authorization\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"l\"\u003eBasic encoded-credentials\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"layer-3-the-vpn\"\u003eLayer 3: the VPN\u003c/h2\u003e\n\u003cp\u003eA VPN often acts at L3. For example, Telepresence sets a packet filter on BSD (or iptable rule on Linux) which redirects all packets to a given TCP proxy which then forwards traffic to into the pod.\u003c/p\u003e\n\u003cp\u003eSome VPNs have to use a higher protocol in order to work around network limitations (e.g., corporate firewall or country-wide censorship), such as OpenVPN which opens a TLS connection (L7) and then use the ciphered TCP connection to forward all TCP traffic; that\u0026rsquo;s L3-into-L7 tunneling (watch out for the MTU!)\u003c/p\u003e\n\u003ch2 id=\"layer-4-the-tcp-proxy\"\u003eLayer 4: the TCP proxy\u003c/h2\u003e\n\u003cp\u003eI am particularly interested in two different kinds of TCP proxies.\u003c/p\u003e\n\u003ch2 id=\"layer-7-the-standard-http-proxy\"\u003eLayer 7: the standard HTTP proxy\u003c/h2\u003e\n\u003cp\u003eThere are many available HTTP proxies like Squid, tinyproxy, cntlm and mitmproxy. Let\u0026rsquo;s try mitmproxy and handcraft an HTTP request:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Open that in one shell session:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emitmproxy -p \u003cspan class=\"m\"\u003e9000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# And this in another shell session:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc 127.0.0.1 \u003cspan class=\"m\"\u003e9000\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s1\"\u003e$\u0026#39;\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eGET http://httpbin.org/ HTTP/1.1\\r\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eHost: httpbin.org\\r\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\\r\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdetails\u003e\n\u003csummary\u003eNote on escaping \u003ccode\u003e\\r\\n\u003c/code\u003e in your shell\u003c/summary\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe tricky part when crafting an HTTP request for \u003ccode\u003enc\u003c/code\u003e in the shell is the backslash-escaped charaters expansion. Using a here-document does not work since backslash-escaped characters like \u003ccode\u003e\\r\u003c/code\u003e and \u003ccode\u003e\\n\u003c/code\u003e are not replaced with their actual value as per the ANSI C standard ([ISO/IEC \u0026gt; 9899:201x][] § 5.2.2 Character display semantics, p. 23)\u003c/p\u003e\n\u003cp\u003eI use \u003ccode\u003e$'text'\u003c/code\u003e which is a feature of bash that replaces \u003ccode\u003e\\\u003c/code\u003e sequences with their byte representation. Another possibility is to use \u003ccode\u003eprintf\u003c/code\u003e or \u003ccode\u003eecho -e\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eprintf\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;GET http://httpbin.org/ HTTP/1.1\\r\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003eHost: httpbin.org\\r\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\\r\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e nc 127.0.0.1 \u003cspan class=\"m\"\u003e9000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/blockquote\u003e\n\u003c/details\u003e\n\u003cp\u003eThe HTTP proxy uses the exact same protocol as HTTP; you can pass some special headers like \u003ccode\u003eProxy-Authorization: Basic ...\u003c/code\u003e which are not going to be forwarded.\u003c/p\u003e\n\u003ch2 id=\"layer-7-the-https--sni-proxy\"\u003eLayer 7: the HTTPS + SNI proxy\u003c/h2\u003e\n\u003cp\u003etbd\u003c/p\u003e\n\u003ch2 id=\"layer-7-the-reverse-http-proxy\"\u003eLayer 7: the reverse HTTP proxy\u003c/h2\u003e\n\u003ch2 id=\"examples-of-proxies\"\u003eExamples of proxies\u003c/h2\u003e\n\u003cp\u003eBy remote dialer, I mean something that exposes a port on a local machine, and everything that goes through this port is forwarded to a distant host; the distant host \u0026ldquo;dials\u0026rdquo; the destination host (we could say \u0026ldquo;proxies\u0026rdquo; the TCP connection, but I like the \u0026ldquo;dial\u0026rdquo; word 😅)\u003c/p\u003e\n\u003c!-- https://textik.com/#216b639e0aaa6953 --\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                   local host                    remote host\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e PHASE 1:             |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e tunnel setup         |   create tcp connection       |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |   (e.g. ssh port forwarding,  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |   websockets...)              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |------------------------------\u0026gt;|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |   tcp connection established  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |\u0026lt;-----------------------------\u0026gt;|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |    configure 80 -\u0026gt; 8000       |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |-----------------------------\u0026gt; |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                        +-------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                        |listen on 80 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                        +-------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e PHASE 2:             |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e remote port          |                               |  remote:80\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e forwarding           |                               |\u0026lt;---------\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |      forwards tcp packets     |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |\u0026lt;------------------------------|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e dials localhost:8000 |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       \u0026lt;--------------|                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                      |                               |\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd by reverse remote dialer,\u003c/p\u003e\n\u003cp\u003eBy tunnel we mean one local port that a process binds to and every TCP opened to that port gets forwarded to a remote dialer.\u003c/p\u003e\n\u003cp\u003eTCP tunnel vs. TCP proxy vs. reverse proxy = they are all the same in the end? Except for how things are captured on the local host (simple port binding) and to where the thing is forwarded to.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/klsecservices/rpivot\"\u003eRpivot\u003c/a\u003e is a python tool used for penetration testing. It acts as a \u0026ldquo;remote dialer\u0026rdquo;:\u003c/p\u003e\n\u003ch2 id=\"what-is-socat\"\u003eWhat is socat\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://book.hacktricks.xyz/tunneling-and-port-forwarding#socat\"\u003esocat\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFrom \u003ca href=\"https://github.com/rancher/k3s/blob/fe7337937155af41f1aebeb87d1acd07091b71de/scripts/provision/generic/alpine310/vagrant#L25\"\u003erancher/k3s\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d -v /var/run/docker.sock:/var/run/docker.sock -p 127.0.0.1:2375:2375 alpine/socat TCP-LISTEN:2375,fork UNIX-CONNECT:/var/run/docker.sock\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eProbably a massive workaround for exposing \u003ccode\u003edocker.sock\u003c/code\u003e on \u003ccode\u003elocalhost:2375\u003c/code\u003e when the only thing you have in hand is docker \u0026amp; you can’t run \u003ccode\u003esocat\u003c/code\u003e locally (or don’t want to bother installing it lol).\u003c/p\u003e\n\u003ch2 id=\"reverseremote-tcp-connection-remote-dialer\"\u003eReverse/remote TCP connection (remote dialer)\u003c/h2\u003e\n\u003cp\u003eLet\u0026rsquo;s expose port 80 on the remote and that will forward traffic to localhost:8080 on my local machine:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# From local\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh -R 42345:22 remote -p \u003cspan class=\"m\"\u003e22\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh -R 80:8080 localhost -p \u003cspan class=\"m\"\u003e42345\u003c/span\u003e      \u003cspan class=\"c1\"\u003e# the reverse port-forwarding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eDiagram of that:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      REMOTE TCP TUNNEL\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      Forwards TCP connections from the remote to the\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      local host, but the initial TCP connection is\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      made from local to remote.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e           local host             remote host\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                       |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                       |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |    ssh port-forward   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |----------------------\u0026gt;|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                       |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |    ssh port-forward   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\u0026lt;------(80:8080)-------|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                       |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                 +-----|------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                 |listen on 80|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                 +-----|------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                       |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                       |    host:80\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |   dial backend:8080   |\u0026lt;----------\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          dials |\u0026lt;----------------------|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e fixedhost:8080 |                       |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u0026lt;--------------|                       |\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1594642720,"description":"","dir":"2020/what-are-proxies/","expirydate":-62135596800,"fuzzywordcount":800,"images":["what-are-proxies/cover-what-are-proxies.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1594642720,"objectID":"ab81d58e8dd13090cd14fa9e63c7cf8c","permalink":"https://maelvls.dev/do-not-share-yet/what-are-proxies/","publishdate":"2020-07-13T14:18:40+02:00","readingtime":4,"relpermalink":"/do-not-share-yet/what-are-proxies/","section":"2020","summary":"\u003cp\u003eA proxy is something (most of the time software, but sometimes also hardware like a dedicated FPGA) that forwards traffic from a place to another.\u003c/p\u003e\n\u003cp\u003eMost of the time, when someone talks about a \u0026ldquo;proxy\u0026rdquo;, they mean an HTTP proxy that would allow this person to access the internet behind a corporate firewall.\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eLayer\u003c/th\u003e\n          \u003cth\u003eProxies\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eL7\u003c/td\u003e\n          \u003ctd\u003eplain HTTP, HTTP \u003ccode\u003eCONNECT\u003c/code\u003e, SOCKS, SOCKS5, HTTPS/SNI proxies\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eL4\u003c/td\u003e\n          \u003ctd\u003eTCP proxies\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eL3\u003c/td\u003e\n          \u003ctd\u003eVPNs\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eTerms:\u003c/p\u003e","tags":[],"title":"What Are Proxies","type":"2020","url":"https://maelvls.dev/do-not-share-yet/what-are-proxies/","weight":0,"wordcount":787},{"authors":null,"categories":null,"content":"\u003c!--\nFrom https://github.com/ori-edge/deploy-controllers/pull/14#discussion_r432398876\n--\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e \u003cspan class=\"nx\"\u003emain_test\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;reflect\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;testing\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e \u003cspan class=\"kd\"\u003estruct\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eAvailable\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003es1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eAvailable\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;87.35.9.18\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;87.34.9.11\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;some.tld.org\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eAvailable\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;87.35.9.18\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;87.34.9.11\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;some1.tld.org\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eBenchmarkDeepEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003etesting\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ereflect\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDeepEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eBenchmarkFastEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003etesting\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eFastEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eFastEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es1\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es2\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"nx\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAvailable\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"nx\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAvailable\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es1addr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"nx\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003es1addr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"nx\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% go \u003cspan class=\"nb\"\u003etest\u003c/span\u003e -bench .\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBenchmarkDeepEqual-8   \u003cspan class=\"m\"\u003e12256587\u003c/span\u003e        96.6 ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBenchmarkFastEqual-8    \u003cspan class=\"m\"\u003e135698862\u003c/span\u003e      8.75 ns/op\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1594278168,"description":"","dir":"2020/deepequal-is-slow/","expirydate":-62135596800,"fuzzywordcount":200,"images":["deepequal-is-slow/cover-deepequal-is-slow.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1594278168,"objectID":"ca800fbd2e4f53c8cc021f9ec296eeac","permalink":"https://maelvls.dev/do-not-share-yet/deepequal-is-slow/","publishdate":"2020-07-09T09:02:48+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/deepequal-is-slow/","section":"2020","summary":"\u003c!--\nFrom https://github.com/ori-edge/deploy-controllers/pull/14#discussion_r432398876\n--\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e \u003cspan class=\"nx\"\u003emain_test\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;reflect\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;testing\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e \u003cspan class=\"kd\"\u003estruct\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eAvailable\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003es1\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eAvailable\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;87.35.9.18\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;87.34.9.11\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;some.tld.org\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003es2\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eAvailable\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;87.35.9.18\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;87.34.9.11\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;some1.tld.org\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eBenchmarkDeepEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003etesting\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ereflect\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDeepEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eBenchmarkFastEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003etesting\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nf\"\u003eFastEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eFastEqual\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es1\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es2\u003c/span\u003e \u003cspan class=\"nx\"\u003eStatus\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"nx\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAvailable\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"nx\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAvailable\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003es1addr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"nx\"\u003es1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003es1addr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"nx\"\u003es2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAddresses\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% go \u003cspan class=\"nb\"\u003etest\u003c/span\u003e -bench .\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBenchmarkDeepEqual-8   \u003cspan class=\"m\"\u003e12256587\u003c/span\u003e        96.6 ns/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBenchmarkFastEqual-8    \u003cspan class=\"m\"\u003e135698862\u003c/span\u003e      8.75 ns/op\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[],"title":"Deepequal Is Slow","type":"2020","url":"https://maelvls.dev/do-not-share-yet/deepequal-is-slow/","weight":0,"wordcount":128},{"authors":null,"categories":null,"content":"\u003cp\u003eIn Kubernetes, the replica set controller uses a hashing mechanism to compare objects. Pods that are owned by a replica set have a label that is used to remember what the hash of the pod template that led to this pod spec:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ePod\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003elabels\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003epod-template-hash\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e775855699b\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn this post, I want to present the advantages and limitations of using a hash function in this context.\u003c/p\u003e\n\u003cp\u003e✅ \u003cstrong\u003ePros\u003c/strong\u003e: works around the fact that child object might get mutated or defaulted, which means the \u003ccode\u003ereflect.DeepEqual\u003c/code\u003e can\u0026rsquo;t work (\u003cstrong\u003ewhat about performance???\u003c/strong\u003e)\u003c/p\u003e\n\u003cp\u003e❌ \u003cstrong\u003eCons\u003c/strong\u003e: if the child gets updated, the parent cannot know that it has been changed since the hash only works in one way. (\u003cstrong\u003etalk about replica set mapping to multiple pods\u003c/strong\u003e)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ewhy is it a label and not an annotation?\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLooks like the hash is created \u003ca href=\"https://github.com/kubernetes/kubernetes/blob/7e75a5ef/pkg/controller/deployment/sync.go#L189\"\u003ein the replicaset sync func\u003c/a\u003e and it uses the \u003ca href=\"https://github.com/kubernetes/kubernetes/blob/7e75a5ef/pkg/controller/controller_utils.go#L1130-L1145\"\u003e\u003ccode\u003eComputeHash\u003c/code\u003e\u003c/a\u003e func which uses \u003ca href=\"https://golang.org/pkg/hash/fnv/#New32\"\u003efnv.New32a\u003c/a\u003e from the std lib:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ComputeHash returns a hash value calculated from pod template and\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// a collisionCount to avoid hash collision. The hash will be safe encoded to\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// avoid bad words.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eComputeHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003etemplate\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003ev1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ePodTemplateSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecollisionCount\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"kt\"\u003eint32\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003epodTemplateSpecHasher\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003efnv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNew32a\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ehashutil\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDeepHashObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epodTemplateSpecHasher\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// Add collisionCount in the hash if it exists.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003ecollisionCount\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003ecollisionCountBytes\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nb\"\u003emake\u003c/span\u003e\u003cspan class=\"p\"\u003e([]\u003c/span\u003e\u003cspan class=\"kt\"\u003ebyte\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e8\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003ebinary\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eLittleEndian\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePutUint32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecollisionCountBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nb\"\u003euint32\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003ecollisionCount\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003epodTemplateSpecHasher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecollisionCountBytes\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003erand\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSafeEncodeString\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epodTemplateSpecHasher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSum32\u003c/span\u003e\u003cspan class=\"p\"\u003e()))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eand the \u003ca href=\"https://github.com/kubernetes/kubernetes/blob/7e75a5ef/pkg/util/hash/hash.go#L25-L37\"\u003e\u003ccode\u003eDeepHashObject\u003c/code\u003e\u003c/a\u003e looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// DeepHashObject writes specified object to hash using the spew library\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// which follows pointers and prints actual values of the nested objects\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ensuring the hash does not change when a pointer changes.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eDeepHashObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehasher\u003c/span\u003e \u003cspan class=\"nx\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eHash\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eobjectToWrite\u003c/span\u003e \u003cspan class=\"kd\"\u003einterface\u003c/span\u003e\u003cspan class=\"p\"\u003e{})\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ehasher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReset\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eprinter\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003espew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eConfigState\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eIndent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e         \u003cspan class=\"s\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eSortKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eDisableMethods\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eSpewKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eprinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehasher\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;%#v\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eobjectToWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSo the hashing mechanism uses \u003ca href=\"https://github.com/davecgh/go-spew\"\u003edavecgh/go-spew\u003c/a\u003e to turn the object into a string, and then uses the \u003ccode\u003efnv\u003c/code\u003e std library to hash that string.\u003c/p\u003e\n\u003ch2 id=\"benchmarking-two-hashing-functions\"\u003eBenchmarking two hashing functions\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e \u003cspan class=\"nx\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;hash\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;hash/fnv\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;testing\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;github.com/davecgh/go-spew/spew\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;github.com/mitchellh/hashstructure\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e \u003cspan class=\"nx\"\u003eComplexStruct\u003c/span\u003e \u003cspan class=\"kd\"\u003estruct\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eName\u003c/span\u003e     \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eAge\u003c/span\u003e      \u003cspan class=\"kt\"\u003euint\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eMetadata\u003c/span\u003e \u003cspan class=\"kd\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"kd\"\u003einterface\u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ev\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eComplexStruct\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;mitchellh\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eAge\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e  \u003cspan class=\"mi\"\u003e64\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eMetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003emap\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"kd\"\u003einterface\u003c/span\u003e\u003cspan class=\"p\"\u003e{}{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s\"\u003e\u0026#34;car\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e      \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s\"\u003e\u0026#34;location\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;California\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s\"\u003e\u0026#34;siblings\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Bob\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;John\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eBenchmarkMitchellhHashstructure\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003etesting\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ehashstructure\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eBenchmarkKubernetesComputeHash\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eb\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003etesting\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"nx\"\u003eb\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003ehasher\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003efnv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNew32a\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nf\"\u003eDeepHashObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehasher\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ev\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ehasher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSum32\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// From https://github.com/kubernetes/kubernetes/blob/7e75a5ef/pkg/util/hash/hash.go#L25-L37\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eDeepHashObject\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehasher\u003c/span\u003e \u003cspan class=\"nx\"\u003ehash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eHash\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eobjectToWrite\u003c/span\u003e \u003cspan class=\"kd\"\u003einterface\u003c/span\u003e\u003cspan class=\"p\"\u003e{})\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ehasher\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eReset\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eprinter\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003espew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eConfigState\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eIndent\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e         \u003cspan class=\"s\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eSortKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eDisableMethods\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eSpewKeys\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eprinter\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehasher\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;%#v\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eobjectToWrite\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe winner seems to be the Kubernetes\u0026rsquo; ComputeHash function, although it relies on spew to generate a string. I guess most of the time spent by hashstructure.Hash is due to the reflect package?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% go \u003cspan class=\"nb\"\u003etest\u003c/span\u003e -bench .\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBenchmarkMitchellhHashstructure-8         \u003cspan class=\"m\"\u003e368101\u003c/span\u003e              3.127 µs/op\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBenchmarkKubernetesComputeHash-8          \u003cspan class=\"m\"\u003e456028\u003c/span\u003e              2.704 µs/op\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"other-clues\"\u003eOther clues\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003e  controller-revision-hash: 6f7768f569\n  k8s-app: kube-proxy\n  pod-template-generation: \u0026quot;7\u0026quot;\n\n  k3s.io/node-config-hash\n\u003c/code\u003e\u003c/pre\u003e\n","date":1594202127,"description":"","dir":"2020/why-kubernetes-compares-with-hash/","expirydate":-62135596800,"fuzzywordcount":500,"images":["why-kubernetes-compares-with-hash/cover-why-kubernetes-compares-with-hash.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1594202127,"objectID":"c37677a75e4da700cb1c657ff28d4be7","permalink":"https://maelvls.dev/do-not-share-yet/why-kubernetes-compares-with-hash/","publishdate":"2020-07-08T11:55:27+02:00","readingtime":3,"relpermalink":"/do-not-share-yet/why-kubernetes-compares-with-hash/","section":"2020","summary":"\u003cp\u003eIn Kubernetes, the replica set controller uses a hashing mechanism to compare objects. Pods that are owned by a replica set have a label that is used to remember what the hash of the pod template that led to this pod spec:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ePod\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003elabels\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003epod-template-hash\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e775855699b\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn this post, I want to present the advantages and limitations of using a hash function in this context.\u003c/p\u003e\n\u003cp\u003e✅ \u003cstrong\u003ePros\u003c/strong\u003e: works around the fact that child object might get mutated or defaulted, which means the \u003ccode\u003ereflect.DeepEqual\u003c/code\u003e can\u0026rsquo;t work (\u003cstrong\u003ewhat about performance???\u003c/strong\u003e)\u003c/p\u003e","tags":[],"title":"Why Kubernetes Compares With Hash","type":"2020","url":"https://maelvls.dev/do-not-share-yet/why-kubernetes-compares-with-hash/","weight":0,"wordcount":478},{"authors":null,"categories":null,"content":"\u003cp\u003eNot sure if this addresses your issue, but symbol characters (\u003ca href=\"https://copychar.cc/symbols/\"\u003ehttps://copychar.cc/symbols/\u003c/a\u003e) are useful where emojis aren\u0026rsquo;t always compatible, and will match your color:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e✓\u003c/li\u003e\n\u003cli\u003e✗\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ethat\u0026rsquo;s an excellent point, ✗ and ✓ (which are UTF-8 \u0026ldquo;symbols\u0026rdquo; as opposed to \u0026ldquo;emojis\u0026rdquo;) can be displayed in pretty much all the fonts\u003c/p\u003e\n\u003cp\u003eWhat I could do:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ered color + \u003ccode\u003e✗\u003c/code\u003e (✗ = U+2717 : BALLOT X, I looked it up \u003ca href=\"https://www.babelstone.co.uk/Unicode/whatisit.html\"\u003ehere\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003egreen color + \u003ccode\u003e✓\u003c/code\u003e (✓ = U+2713 = CHECK MARK)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBut since today\u0026rsquo;s terminal emulators all support UTF-8 emojis, I prefer keeping my emojis 😅\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eUsing the macOS \u0026ldquo;emoji picker\u0026rdquo; (⌃⌘+space), I realized that Unicode and UTF-8 are different. For example, searching for \u0026ldquo;space\u0026rdquo; would yield:\u003c/p\u003e\n\u003cp\u003e|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;-|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;|\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026mdash;\u0026ndash;| | NO-BREAK SPACE | Unicode: U+00A0 | UTF-8: C2 A0 | | EN SPACE | Unicode: U+2002 | UTF-8: E2 80 82 | | EM SPACE | Unicode: U+2003 | UTF-8: E2 80 83 |\u003c/p\u003e\n\u003cp\u003eWhat is \u003ccode\u003eU+XXXX\u003c/code\u003e?? And what is \u003ccode\u003eC2 A0\u003c/code\u003e??\u003c/p\u003e\n\u003cp\u003eAnd why does the author of \u003ca href=\"https://stackoverflow.com/a/58532995/3808537\"\u003ethis stackoverflow question\u003c/a\u003e say that EM SPACE is \u0026ldquo;8195 in UTF-8\u0026rdquo; since UTF-8 is usually given in hexadecimal format?\u003c/p\u003e\n","date":1594196218,"description":"","dir":"2020/digging-into-utf-8/","expirydate":-62135596800,"fuzzywordcount":200,"images":["digging-into-utf-8/cover-digging-into-utf-8.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1594196218,"objectID":"43a0e67517e7292d9dc65949750ce445","permalink":"https://maelvls.dev/do-not-share-yet/digging-into-utf-8/","publishdate":"2020-07-08T10:16:58+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/digging-into-utf-8/","section":"2020","summary":"\u003cp\u003eNot sure if this addresses your issue, but symbol characters (\u003ca href=\"https://copychar.cc/symbols/\"\u003ehttps://copychar.cc/symbols/\u003c/a\u003e) are useful where emojis aren\u0026rsquo;t always compatible, and will match your color:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e✓\u003c/li\u003e\n\u003cli\u003e✗\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ethat\u0026rsquo;s an excellent point, ✗ and ✓ (which are UTF-8 \u0026ldquo;symbols\u0026rdquo; as opposed to \u0026ldquo;emojis\u0026rdquo;) can be displayed in pretty much all the fonts\u003c/p\u003e\n\u003cp\u003eWhat I could do:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ered color + \u003ccode\u003e✗\u003c/code\u003e (✗ = U+2717 : BALLOT X, I looked it up \u003ca href=\"https://www.babelstone.co.uk/Unicode/whatisit.html\"\u003ehere\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003egreen color + \u003ccode\u003e✓\u003c/code\u003e (✓ = U+2713 = CHECK MARK)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBut since today\u0026rsquo;s terminal emulators all support UTF-8 emojis, I prefer keeping my emojis 😅\u003c/p\u003e","tags":[],"title":"Digging Into Utf 8","type":"2020","url":"https://maelvls.dev/do-not-share-yet/digging-into-utf-8/","weight":0,"wordcount":183},{"authors":null,"categories":null,"content":"","date":1594132435,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1594132435,"objectID":"https://maelvls.dev/do-not-share-yet/tags/conditions/","permalink":"https://maelvls.dev/do-not-share-yet/tags/conditions/","publishdate":"2020-07-07T16:33:55+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/conditions/","section":"tags","summary":"","tags":null,"title":"Conditions","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/conditions/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1594132435,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1594132435,"objectID":"https://maelvls.dev/do-not-share-yet/tags/kubernetes/","permalink":"https://maelvls.dev/do-not-share-yet/tags/kubernetes/","publishdate":"2020-07-07T16:33:55+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/kubernetes/","section":"tags","summary":"","tags":null,"title":"Kubernetes","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/kubernetes/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eThe various conditions that may appear in a deployment status are not documented in the \u003ca href=\"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/\"\u003eAPI reference\u003c/a\u003e. For example, we can see what are the fields for \u003ca href=\"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#deploymentcondition-v1-apps\"\u003eDeploymentConditions\u003c/a\u003e, but it lacks the description of what conditions can appear in this field.\u003c/p\u003e\n\u003cp\u003eIn this post, I dig into what the \u003ccode\u003eAvailable\u003c/code\u003e condition type is about and how it is computed.\u003c/p\u003e\n\u003cp\u003eSince the \u003ca href=\"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/\"\u003eAPI reference\u003c/a\u003e does not contain any information about conditions, the only way to learn more is to dig into the Kubernetes codebase; quite deep into the code, \u003ca href=\"https://github.com/kubernetes/kubernetes/blob/3615291/pkg/apis/apps/types.go#L461-L473\"\u003ewe can read some comments\u003c/a\u003e about the three possible conditions for a deployment:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Available means the deployment is available, ie. at least the minimum available\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// replicas required are up and running for at least minReadySeconds.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eDeploymentAvailable\u003c/span\u003e \u003cspan class=\"nx\"\u003eDeploymentConditionType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Available\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Progressing means the deployment is progressing. Progress for a deployment is\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// considered when a new replica set is created or adopted, and when new pods scale\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// up or old pods scale down. Progress is not estimated for paused deployments or\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// when progressDeadlineSeconds is not specified.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eDeploymentProgressing\u003c/span\u003e \u003cspan class=\"nx\"\u003eDeploymentConditionType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Progressing\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ReplicaFailure is added in a deployment when one of its pods fails to be created\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// or deleted.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eDeploymentReplicaFailure\u003c/span\u003e \u003cspan class=\"nx\"\u003eDeploymentConditionType\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;ReplicaFailure\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe description given to the \u003ccode\u003eAvailable\u003c/code\u003e condition type is quite mysterious:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAt least the minimum available replicas required are up.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eWhat does \u0026ldquo;minimum available replicas\u0026rdquo; mean? Is this minimum 1? I cannot see any \u003ccode\u003eminAvailable\u003c/code\u003e field in the deployment spec, so my initial guess was that it would be 1.\u003c/p\u003e\n\u003cp\u003eBefore going further, let\u0026rsquo;s the description attached to the reason \u003ca href=\"https://github.com/kubernetes/kubernetes/blob/3615291/pkg/controller/deployment/util/deployment_util.go#L96-L97\"\u003e\u003ccode\u003eMinimumReplicasAvailable\u003c/code\u003e\u003c/a\u003e. Apparently, this reason is the only reason for the \u003ccode\u003eAvailable\u003c/code\u003e condition type.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// MinimumReplicasAvailable is added in a deployment when it has its minimum\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// replicas required available.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eMinimumReplicasAvailable\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;MinimumReplicasAvailable\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe description doesn\u0026rsquo;t help either. Let\u0026rsquo;s see what the \u003ca href=\"https://github.com/kubernetes/kubernetes/blob/3615291/pkg/controller/deployment/sync.go#L513-L516\"\u003edeployment sync\u003c/a\u003e function does:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eavailableReplicas\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"nx\"\u003edeploy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMaxUnavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"nx\"\u003edeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eReplicas\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eminAvailability\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003edeploy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Available\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;True\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;MinimumReplicasAvailable\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Deployment has minimum availability.\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003edeploy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eminAvailability\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eNote: in the real code, the max unavailable is on the right side of the inequality. I find it easier to reason about this inequality when the single value to the right is the desired replica number.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eAhhh, the actual logic being \u003ccode\u003eAvailable\u003c/code\u003e! If \u003ccode\u003emaxUnavailable\u003c/code\u003e is 0, then it becomes obvious: the \u0026ldquo;minimum availability\u0026rdquo; means that number of available replicas is greater or equal to the number of replicas in the spec; the deployment has minimum availability if and only if the following inequality holds:\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: center\"\u003eavailable\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e+\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003eacceptable unavailable\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e≥\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003edesired\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e1️⃣\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e2️⃣\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e3️⃣\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eLet\u0026rsquo;s take an example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eDeployment\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ereplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# 3️⃣ desired\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003estrategy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003erollingUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003emaxUnavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# 2️⃣ acceptable unavailable\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eavailableReplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# 1️⃣ available\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Available\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;True\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn this example, the inequality holds which means this deployment has \u0026ldquo;minimum availability\u0026rdquo; (= \u003ccode\u003eAvailable = True\u003c/code\u003e):\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: center\"\u003e\u003ccode\u003eavailableReplicas\u003c/code\u003e\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e+\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e\u003ccode\u003emaxUnavailable\u003c/code\u003e\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e≥\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e\u003ccode\u003ereplicas\u003c/code\u003e\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e8\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e2\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e10\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"default-value-for-maxunavailable-is-25\"\u003eDefault value for \u003ccode\u003emaxUnavailable\u003c/code\u003e is 25%\u003c/h2\u003e\n\u003cp\u003eNow, what happens when \u003ccode\u003emaxUnavailable\u003c/code\u003e is not set? The official documentation \u003ca href=\"https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#max-unavailable\"\u003emaxUnavailable\u003c/a\u003e says:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003emaxUnavailable\u003c/code\u003e is an optional field that specifies the maximum number of Pods that can be unavailable during the update process. The value can be an absolute number (for example, 5) or a percentage of desired Pods (for example, 10%). The absolute number is calculated from percentage by rounding down. The value cannot be 0 if \u003ccode\u003emaxSurge\u003c/code\u003e is 0. \u003cstrong\u003eThe default value is 25%\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eFor example, when this value is set to 30%, the old ReplicaSet can be scaled down to 70% of desired Pods immediately when the rolling update starts. Once new Pods are ready, old ReplicaSet can be scaled down further, followed by scaling up the new ReplicaSet, ensuring that the total number of Pods available at all times during the update is at least 70% of the desired Pods.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eLet\u0026rsquo;s take an example with a deployment that has no \u003ccode\u003emaxUnavailable\u003c/code\u003e field set, and imagine that 4 pods are unavailable due to a resource quota that only allows for 5 pods to start:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eDeployment\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ereplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eavailableReplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eunavailableReplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Available\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;False\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis time, the inequality does not hold:\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: right\"\u003e\u003ccode\u003estatus.availableReplicas\u003c/code\u003e\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e+\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e\u003ccode\u003espec.strategy.rollingUpdate.maxUnavailable\u003c/code\u003e\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e≱\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e\u003ccode\u003espec.replicas\u003c/code\u003e\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: right\"\u003e5\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003elower(25% * 10) = 2\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e10\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eLet\u0026rsquo;s dig a bit more and see how \u003ca href=\"https://github.com/kubernetes/kubernetes/blob/3615291/pkg/controller/deployment/util/deployment_util.go#L434-L445\"\u003e\u003ccode\u003eMaxAvailable\u003c/code\u003e\u003c/a\u003e is defined:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// MaxUnavailable returns the maximum unavailable pods a rolling deployment\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// can take.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eMaxUnavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edeployment\u003c/span\u003e \u003cspan class=\"nx\"\u003eapps\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eDeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsRollingUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003edeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"nx\"\u003edeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eReplicas\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003e_\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emaxUnavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nf\"\u003eResolveFenceposts\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eStrategy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eRollingUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eMaxSurge\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eStrategy\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eRollingUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eMaxUnavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eReplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003emaxUnavailable\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003edeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eReplicas\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003edeployment\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eReplicas\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003emaxUnavailable\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe core of the logic behind maxUnavailable is in \u003ca href=\"https://github.com/kubernetes/kubernetes/blob/3615291/pkg/controller/deployment/util/deployment_util.go#L874-L902\"\u003e\u003ccode\u003eResolveFenceposts\u003c/code\u003e\u003c/a\u003e (note: I simplified the code a bit to make it more readable):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ResolveFenceposts resolves both maxSurge and maxUnavailable. This needs to happen in one\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// step. For example:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 2 desired, max unavailable 1%, surge 0% - should scale old(-1), then new(+1), then old(-1), then new(+1)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 1 desired, max unavailable 1%, surge 0% - should scale old(-1), then new(+1)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 2 desired, max unavailable 25%, surge 1% - should scale new(+1), then old(-1), then new(+1), then old(-1)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 1 desired, max unavailable 25%, surge 1% - should scale new(+1), then old(-1)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 2 desired, max unavailable 0%, surge 1% - should scale new(+1), then old(-1), then new(+1), then old(-1)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 1 desired, max unavailable 0%, surge 1% - should scale new(+1), then old(-1)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eResolveFenceposts\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003emaxSurge\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emaxUnavailable\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003einstr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eIntOrString\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edesired\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003esurge\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e       \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003einstr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValueFromIntOrPercent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einstr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eValueOrDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003emaxSurge\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003einstr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e \u003cspan class=\"nx\"\u003edesired\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eunavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003e_\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003einstr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetValueFromIntOrPercent\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einstr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eValueOrDefault\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003emaxUnavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003einstr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)),\u003c/span\u003e \u003cspan class=\"nx\"\u003edesired\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003esurge\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eunavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe \u003ccode\u003efalse\u003c/code\u003e boolean turns the integer rounding \u0026ldquo;up\u0026rdquo;, which means \u003ccode\u003e0.5\u003c/code\u003e will be rounded to \u003ccode\u003e0\u003c/code\u003e instead of \u003ccode\u003e1\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThe \u003ccode\u003emaxUnavailable\u003c/code\u003e and \u003ccode\u003emaxSurge\u003c/code\u003e (they call them \u0026ldquo;fenceposts\u0026rdquo; values) are simply read from the deployment\u0026rsquo;s spec. In the following example, the deployment will become \u003ccode\u003eAvailable = True\u003c/code\u003e only if there are at least 5 replicas available:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eDeployment\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ereplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003estrategy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003erollingUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003emaxUnavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"l\"\u003e%\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# 🔰 10 * 0.0 = 0 replicas\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"hands-on-example-with-the-available-condition\"\u003eHands-on example with the \u003ccode\u003eAvailable\u003c/code\u003e condition\u003c/h2\u003e\n\u003cp\u003eImagine that we have a namespace named \u003ccode\u003erestricted\u003c/code\u003e that only allows for 200 MiB, and our pod requires 50 MiB. The first 4 pods will be successfully created, but the fifth one will fail.\u003c/p\u003e\n\u003cp\u003eLet us first apply the following manifest:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eNamespace\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003erestricted\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nn\"\u003e---\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eResourceQuota\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003enamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003erestricted\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003emem-cpu-demo\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ehard\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003erequests.memory\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e200Mi\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nn\"\u003e---\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eapps/v1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eDeployment\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003enamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003erestricted\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003etest\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ereplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003estrategy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003erollingUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003emaxUnavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# 🔰\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eselector\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003ematchLabels\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eapp\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003etest\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003elabels\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"nt\"\u003eapp\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003etest\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003econtainers\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e- \u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003etest\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003enginx:alpine\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003eresources\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e\u003cspan class=\"nt\"\u003erequests\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e              \u003c/span\u003e\u003cspan class=\"nt\"\u003ememory\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;50Mi\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# the 5th pod will fail (on purpose)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003eports\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e            \u003c/span\u003e- \u003cspan class=\"nt\"\u003econtainerPort\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e80\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAfter a few seconds, the \u003ccode\u003eAvailable\u003c/code\u003e condition stabilizes to \u003ccode\u003eFalse\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# kubectl -n restricted get deploy test -oyaml\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eDeployment\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ereplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003estrategy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003erollingUpdate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003emaxUnavailable\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# 🔰\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003elastTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-07T14:04:27Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003elastUpdateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-07T14:04:27Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eDeployment does not have minimum availability.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003ereason\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eMinimumReplicasUnavailable\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;False\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eAvailable\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003elastTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-07T14:04:27Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003elastUpdateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-07T14:04:27Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;pods \u0026#34;test-7df57bd99d-5qw47\u0026#34; is forbidden: exceeded quota: mem-cpu-demo, requested: requests.memory=50Mi, used: requests.memory=200Mi, limited: requests.memory=200Mi\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003ereason\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eFailedCreate\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;True\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eReplicaFailure\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003elastTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-07T14:04:27Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003elastUpdateTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-07T14:04:38Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eReplicaSet \u0026#34;test-7df57bd99d\u0026#34; is progressing.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003ereason\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eReplicaSetUpdated\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;True\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eProgressing\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ereplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eavailableReplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ereadyReplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eunavailableReplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eupdatedReplicas\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe are asking for at most 0 unavailable replicas and there is 1 unavailable replica (due to the resource quota). Thus, the \u0026ldquo;minimum availability\u0026rdquo; inequality does not hold which means the deployment has the condition \u003ccode\u003eAvailable = False\u003c/code\u003e:\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: center\"\u003e\u003ccode\u003eavailableReplicas\u003c/code\u003e\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e+\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e\u003ccode\u003erollingUpdate.maxUnavailable\u003c/code\u003e\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e≱\u003c/th\u003e\n          \u003cth style=\"text-align: center\"\u003e\u003ccode\u003ereplicas\u003c/code\u003e\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: center\"\u003e4\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e0\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e\u003c/td\u003e\n          \u003ctd style=\"text-align: center\"\u003e5\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e\u003cstrong\u003eUpdate 9 July 2020:\u003c/strong\u003e added a paragraph on the default value for \u003ca href=\"https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#max-unavailable\"\u003emaxUnavailable\u003c/a\u003e, and fixed the yaml example where I had mixed \u003ccode\u003eunavailableReplicas\u003c/code\u003e with \u003ccode\u003emaxUnavailable\u003c/code\u003e.\u003c/p\u003e\n","date":1594132435,"description":"Although the Kubernetes documentation is excellent, the API reference does not document the conditions that can be found in a deployment's status. The Available condition has always eluded me!","dir":"2020/deployment-available-condition/","expirydate":-62135596800,"fuzzywordcount":1300,"images":["deployment-available-condition/cover-deployment-available-condition.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1594132435,"objectID":"a4f5b54c58869e148d298323954f544b","permalink":"https://maelvls.dev/do-not-share-yet/deployment-available-condition/","publishdate":"2020-07-07T16:33:55+02:00","readingtime":7,"relpermalink":"/do-not-share-yet/deployment-available-condition/","section":"2020","summary":"\u003cp\u003eThe various conditions that may appear in a deployment status are not documented in the \u003ca href=\"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/\"\u003eAPI reference\u003c/a\u003e. For example, we can see what are the fields for \u003ca href=\"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#deploymentcondition-v1-apps\"\u003eDeploymentConditions\u003c/a\u003e, but it lacks the description of what conditions can appear in this field.\u003c/p\u003e\n\u003cp\u003eIn this post, I dig into what the \u003ccode\u003eAvailable\u003c/code\u003e condition type is about and how it is computed.\u003c/p\u003e\n\u003cp\u003eSince the \u003ca href=\"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/\"\u003eAPI reference\u003c/a\u003e does not contain any information about conditions, the only way to learn more is to dig into the Kubernetes codebase; quite deep into the code, \u003ca href=\"https://github.com/kubernetes/kubernetes/blob/3615291/pkg/apis/apps/types.go#L461-L473\"\u003ewe can read some comments\u003c/a\u003e about the three possible conditions for a deployment:\u003c/p\u003e","tags":["kubernetes","conditions"],"title":"Understanding the Available condition of a Kubernetes deployment","type":"2020","url":"https://maelvls.dev/do-not-share-yet/deployment-available-condition/","weight":0,"wordcount":1282},{"authors":null,"categories":null,"content":"","date":1593782019,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1593782019,"objectID":"https://maelvls.dev/do-not-share-yet/tags/dns/","permalink":"https://maelvls.dev/do-not-share-yet/tags/dns/","publishdate":"2020-07-03T15:13:39+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/dns/","section":"tags","summary":"","tags":null,"title":"Dns","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/dns/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1593782019,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1593782019,"objectID":"https://maelvls.dev/do-not-share-yet/tags/docker/","permalink":"https://maelvls.dev/do-not-share-yet/tags/docker/","publishdate":"2020-07-03T15:13:39+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/docker/","section":"tags","summary":"","tags":null,"title":"Docker","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/docker/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1593782019,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1593782019,"objectID":"https://maelvls.dev/do-not-share-yet/tags/kind/","permalink":"https://maelvls.dev/do-not-share-yet/tags/kind/","publishdate":"2020-07-03T15:13:39+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/kind/","section":"tags","summary":"","tags":null,"title":"Kind","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/kind/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003c!--\nDiagram on macOS + Docker: https://textik.com/#b185c1a72a6e782d\n--\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e \u003cem\u003e(August 2023)\u003c/em\u003e As mentioned by Wolfgang Schnerring \u003ca href=\"https://github.com/maelvls/maelvls.github.io/issues/7#issuecomment-688277166\"\u003ein this comment\u003c/a\u003e, the method presented in this document is very limited: many images are still being pulled directly and it only proxies a single \u0026ldquo;upstream\u0026rdquo; registry. Nowadays, \u003ccode\u003edocker-registry-proxy\u003c/code\u003e is a better alternative: \u003ca href=\"https://github.com/rpardini/docker-registry-proxy#kind-cluster\"\u003ehttps://github.com/rpardini/docker-registry-proxy#kind-cluster\u003c/a\u003e.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003eTL;DR:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eto create a local pull-through registry to speed up image pulling in a \u003ca href=\"https://kind.sigs.k8s.io/\"\u003eKind\u003c/a\u003e cluster, run:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d --name proxy --restart\u003cspan class=\"o\"\u003e=\u003c/span\u003ealways --net\u003cspan class=\"o\"\u003e=\u003c/span\u003ekind \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -e \u003cspan class=\"nv\"\u003eREGISTRY_PROXY_REMOTEURL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttps://registry-1.docker.io registry:2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekind create cluster --config /dev/stdin \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt;EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ekind: Cluster\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eapiVersion: kind.x-k8s.io/v1alpha4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003econtainerdConfigPatches:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  - |-\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    [plugins.\u0026#34;io.containerd.grpc.v1.cri\u0026#34;.registry.mirrors.\u0026#34;docker.io\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e      endpoint = [\u0026#34;http://proxy:5000\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://docs.docker.com/registry/configuration/#proxy\"\u003eyou can\u0026rsquo;t\u003c/a\u003e use this pull-through proxy registry to push your own images (e.g. to \u003ca href=\"https://github.com/tilt-dev/kind-local\"\u003espeed up Tilt builds\u003c/a\u003e), but you can create two registries (one for caching, the other for local images). See \u003ca href=\"#docker-proxy-vs-local-registry\"\u003ethis section\u003c/a\u003e for more context; the lines are:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d --name proxy --restart\u003cspan class=\"o\"\u003e=\u003c/span\u003ealways --net\u003cspan class=\"o\"\u003e=\u003c/span\u003ekind \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -e \u003cspan class=\"nv\"\u003eREGISTRY_PROXY_REMOTEURL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttps://registry-1.docker.io registry:2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d --name registry --restart\u003cspan class=\"o\"\u003e=\u003c/span\u003ealways --net\u003cspan class=\"o\"\u003e=\u003c/span\u003ekind \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -p 5000:5000 registry:2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekind create cluster --config /dev/stdin \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt;EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ekind: Cluster\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eapiVersion: kind.x-k8s.io/v1alpha4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003econtainerdConfigPatches:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  - |-\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    [plugins.\u0026#34;io.containerd.grpc.v1.cri\u0026#34;.registry.mirrors.\u0026#34;docker.io\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e      endpoint = [\u0026#34;http://proxy:5000\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    [plugins.\u0026#34;io.containerd.grpc.v1.cri\u0026#34;.registry.mirrors.\u0026#34;localhost:5000\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e      endpoint = [\u0026#34;http://registry:5000\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ein case you often create \u0026amp; delete Kind clusters, using a local registry that serves as a proxy avoids redundant downloads\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eKIND_EXPERIMENTAL_DOCKER_NETWORK\u003c/code\u003e is useful but remember that the default network (\u003ccode\u003ebridge\u003c/code\u003e) doesn\u0026rsquo;t have DNS resolution for container hostnames\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethe Docker default network (\u003ccode\u003ebridge\u003c/code\u003e) \u003ca href=\"https://stackoverflow.com/questions/41400603/dockers-embedded-dns-on-the-default-bridged-network\"\u003ehas limitations\u003c/a\u003e as \u003ca href=\"https://docs.docker.com/network/bridge/#use-the-default-bridge-network\"\u003edetailed by Docker\u003c/a\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIf you play with \u003ca href=\"https://cluster-api.sigs.k8s.io/\"\u003eClusterAPI\u003c/a\u003e with its \u003ca href=\"https://github.com/kubernetes-sigs/cluster-api/tree/master/test/infrastructure/docker\"\u003eDocker provider\u003c/a\u003e, you might not be able to use a local registry due to the clusters being created on the default network, which means the \u0026ldquo;proxy\u0026rdquo; hostname won\u0026rsquo;t be resolved (but we could work around that).\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003e\u003ca href=\"https://kind.sigs.k8s.io/\"\u003eKind\u003c/a\u003e is an awesome tool that allows you to spin up local Kubernetes clusters locally in seconds. It is perfect for Kubernetes developers or anyone who wants to play with controllers.\u003c/p\u003e\n\u003cp\u003eOne thing I hate about Kind is that images are not cached between two Kind containers. Even worse: when deleting and re-creating a cluster, all the downloaded images disappear.\u003c/p\u003e\n\u003cp\u003eIn this post, I detail my discoveries around local registries and why the default Docker network is a trap.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eContents:\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"#kind-has-no-image-caching-mechanism\"\u003eKind has no image caching mechanism\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#creating-a-caching-proxy-registry\"\u003eCreating a caching proxy registry\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#creating-a-kind-cluster-that-knows-about-this-caching-proxy-registry\"\u003eCreating a Kind cluster that knows about this caching proxy registry\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#check-that-the-caching-proxy-registry-works\"\u003eCheck that the caching proxy registry works\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#docker-proxy-vs-local-registry\"\u003eDocker proxy vs. local registry\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#improving-the-clusterapi-docker-provider-to-use-a-given-network\"\u003eImproving the ClusterAPI docker provider to use a given network\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch2 id=\"kind-has-no-image-caching-mechanism\"\u003eKind has no image caching mechanism\u003c/h2\u003e\n\u003cp\u003eWhenever I re-create a Kind cluster and try to install ClusterAPI, all the (quite heavy) images have to be re-downloaded. Just take a look at all the images that get re-downloaded:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# That\u0026#39;s the cluster created using \u0026#39;kind create cluster\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e -it kind-control-plane crictl images\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIMAGE                                                                      TAG      SIZE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003equay.io/jetstack/cert-manager-cainjector                                   v0.11.0  11.1MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003equay.io/jetstack/cert-manager-controller                                   v0.11.0  14MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003equay.io/jetstack/cert-manager-webhook                                      v0.11.0  14.3MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eus.gcr.io/k8s-staging-capi-docker/capd-manager/capd-manager-amd64          dev      53.5MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eus.gcr.io/k8s-artifacts-prod/cluster-api/cluster-api-controller            v0.3.0   20.3MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eus.gcr.io/k8s-artifacts-prod/cluster-api/kubeadm-bootstrap-controller      v0.3.0   19.6MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eus.gcr.io/k8s-artifacts-prod/cluster-api/kubeadm-control-plane-controller  v0.3.0   21.1MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# I also use a ClusterAPI-created cluster (relying on CAPD):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e -it capd-capd-control-plane-l4tx7 crictl images ls\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker.io/calico/cni                  v3.12.2             8b42391a46731       77.5MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker.io/calico/kube-controllers     v3.12.2             5ca01eb356b9a       23.1MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker.io/calico/node                 v3.12.2             4d501404ee9fa       89.7MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker.io/calico/pod2daemon-flexvol   v3.12.2             2abcc890ae54f       37.5MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker.io/metallb/controller          v0.9.3              4715cbeb69289       17.1MB\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker.io/metallb/speaker             v0.9.3              f241be9dae666       19.2MB\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThat\u0026rsquo;s a total of 418 MB that get re-downloaded every time I restart both clusters!\u003c/p\u003e\n\u003cp\u003eUnfortunately, there is no way to re-use the image registry built into your default Docker engine (both on Linux and on macOS). One solution to this problem is to \u003ca href=\"https://kind.sigs.k8s.io/docs/user/local-registry/\"\u003espin up an intermediary Docker registry\u003c/a\u003e in a side container; as long as this container exists, all the images that have already been downloaded once can be served from cache.\u003c/p\u003e\n\u003ch2 id=\"creating-a-caching-proxy-registry\"\u003eCreating a caching proxy registry\u003c/h2\u003e\n\u003cp\u003eWe want to create a registry with a simple Kind cluster; let\u0026rsquo;s start with the registry:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d --name proxy --restart\u003cspan class=\"o\"\u003e=\u003c/span\u003ealways --net\u003cspan class=\"o\"\u003e=\u003c/span\u003ekind -e \u003cspan class=\"nv\"\u003eREGISTRY_PROXY_REMOTEURL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttps://registry-1.docker.io registry:2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eDetails:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e--net kind\u003c/code\u003e is required because Kind creates its containers in a separate network; it does that the because the \u0026ldquo;bridge\u0026rdquo; has \u003ca href=\"https://docs.docker.com/network/bridge/#use-the-default-bridge-network\"\u003elimitations\u003c/a\u003e and \u003ca href=\"https://docs.docker.com/config/containers/container-networking/#dns-services\"\u003edoesn\u0026rsquo;t allow you\u003c/a\u003e to use container names as DNS names:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eBy default, a container inherits the DNS settings of the host, as defined in the \u003ccode\u003e/etc/resolv.conf\u003c/code\u003e configuration file. Containers that use the default bridge network get a copy of this file, whereas containers that use a custom network use Docker’s embedded DNS server, which forwards external DNS lookups to the DNS servers configured on the host.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003ewhich means that the container runtime (containerd) that runs our Kind cluster won\u0026rsquo;t be able to resove the address \u003ccode\u003eproxy:5000\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eREGISTRY_PROXY_REMOTEURL\u003c/code\u003e is required due to the fact that by default, the registry won\u0026rsquo;t forward requests. It simply tries to find the image in \u003ccode\u003e/var/lib/registry/docker/registry/v2/repositories\u003c/code\u003e and returns 404 if it doesn\u0026rsquo;t find it.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eUsing the \u003ca href=\"https://docs.docker.com/registry/configuration/#proxy\"\u003epull-through\u003c/a\u003e feature (I call it \u0026ldquo;caching proxy\u0026rdquo;), the registry will proxy all requests coming from all mirror prefixes and cache the blobs and manifests locally. To enable this feature, we set \u003ccode\u003eREGISTRY_PROXY_REMOTEURL\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eOther interesting bit about \u003ccode\u003eREGISTRY_PROXY_REMOTEURL\u003c/code\u003e: this environement variable name is mapped from \u003ca href=\"https://docs.docker.com/registry/configuration/#proxy\"\u003ethe registry YAML config API\u003c/a\u003e. The variable\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eREGISTRY_PROXY_REMOTEURL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttps://registry-1.docker.io\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eis equivalent to the following YAML config:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eproxy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eremoteurl\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttps://registry-1.docker.io\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003e⚠️ The registry can\u0026rsquo;t be both in normal mode (\u0026ldquo;local proxy\u0026rdquo;) and in caching proxy mode at the same time, see \u003ca href=\"#docker-proxy-vs-local-registry\"\u003ebelow\u003c/a\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"creating-a-kind-cluster-that-knows-about-this-caching-proxy-registry\"\u003eCreating a Kind cluster that knows about this caching proxy registry\u003c/h2\u003e\n\u003cp\u003eThe second step is to create a Kind cluster and tell the container runtime to use a specific registry; here is the command to create it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekind create cluster --config /dev/stdin \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt;EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ekind: Cluster\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eapiVersion: kind.x-k8s.io/v1alpha4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003econtainerdConfigPatches:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  - |-\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    [plugins.\u0026#34;io.containerd.grpc.v1.cri\u0026#34;.registry.mirrors.\u0026#34;docker.io\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e      endpoint = [\u0026#34;http://proxy:5000\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e \u003ccode\u003econtainerdConfigPatches\u003c/code\u003e is a way to semantically patch \u003ccode\u003e/etc/containerd/config.conf\u003c/code\u003e. By default, this file looks like:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e -it kind-control-plane cat /etc/containerd/config.toml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e.registry\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e.registry.mirrors\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e.registry.mirrors.\u003cspan class=\"s2\"\u003e\u0026#34;docker.io\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e          \u003cspan class=\"nv\"\u003eendpoint\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;https://registry-1.docker.io\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eNote 2:\u003c/strong\u003e the mirror prefix (\u003ccode\u003edocker.io\u003c/code\u003e) can be omitted for images stored on Docker Hub. For other registries such as \u003ccode\u003egcr.io\u003c/code\u003e, this mirror prefix has to be given. Here is a table with some examples of image names that are first prepended with \u0026ldquo;docker.io\u0026rdquo; if the mirror prefix is not present, and we get the final address by mapping these mirror prefixes with mirror entries:\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eimage name\u003c/th\u003e\n          \u003cth\u003e\u0026ldquo;actual\u0026rdquo; image name\u003c/th\u003e\n          \u003cth\u003eregistry address w.r.t. mirrors\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ealpine\u003c/td\u003e\n          \u003ctd\u003edocker.io/alpine\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://registry-1.docker.io/v2/library/alpine/manifests/latest\"\u003ehttps://registry-1.docker.io/v2/library/alpine/manifests/latest\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003egcr.io/istio-release/pilot\u003c/td\u003e\n          \u003ctd\u003egcr.io/istio-release/pilot\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://gcr.io/v2/istio-release/pilot/manifests/1.9.1\"\u003ehttps://gcr.io/v2/istio-release/pilot/manifests/1.9.1\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003efoo.org/something/someimage\u003c/td\u003e\n          \u003ctd\u003efoo.org/something/someimage\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://foo.org/v2/something/someimage/manifests/latest\"\u003ehttps://foo.org/v2/something/someimage/manifests/latest\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"check-that-the-caching-proxy-registry-works\"\u003eCheck that the caching proxy registry works\u003c/h2\u003e\n\u003cp\u003eLet\u0026rsquo;s see if the proxy registry works by running a pod:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kubectl run foo -it --rm --image\u003cspan class=\"o\"\u003e=\u003c/span\u003enicolaka/netshoot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e -it proxy ls /var/lib/registry/docker/registry/v2/repositories\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enicolaka\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe can also see through the registry logs that everything is going well:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# docker logs proxy | tail\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-26T14:52:44.2624761Z\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003elevel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003einfo\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Challenge established with upstream : {https registry-1.docker.io /v2/}\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ego\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eversion\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ego1\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e11.2\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;proxy:5000\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mf\"\u003e15e9\u003c/span\u003e\u003cspan class=\"n\"\u003eac86\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"n\"\u003ed79\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e4883\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ea8ce\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e861\u003c/span\u003e\u003cspan class=\"n\"\u003ea7484887c\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emethod\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eHEAD\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremoteaddr\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;172.18.0.2:57588\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/v2/nicolaka/netshoot/manifests/latest\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003euseragent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;containerd/v1.4.0-beta.1-34-g49b0743c\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003evars\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;nicolaka/netshoot\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003evars\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereference\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003elatest\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-26T14:52:45.4195817Z\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003elevel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003einfo\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Adding new scheduler entry for nicolaka/netshoot@sha256:04786602e5a9463f40da65aea06fe5a825425c7df53b307daa21f828cfe40bf8 with ttl=167h59m59.9999793s\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ego\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eversion\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ego1\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e11.2\u003c/span\u003e \u003cspan class=\"n\"\u003einstance\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eba959eb9\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"n\"\u003efa3\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e47\u003c/span\u003e\u003cspan class=\"n\"\u003ec0\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ebeb7\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e91480\u003c/span\u003e\u003cspan class=\"n\"\u003ec8a31ee\u003c/span\u003e \u003cspan class=\"n\"\u003eservice\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eregistry\u003c/span\u003e \u003cspan class=\"n\"\u003eversion\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ev2\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e7.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mf\"\u003e172.18\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e0.2\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e26\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eJul\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"mi\"\u003e2020\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e14\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e52\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e43\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"mi\"\u003e0000\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;HEAD /v2/nicolaka/netshoot/manifests/latest HTTP/1.1\u0026#34;\u003c/span\u003e \u003cspan class=\"mi\"\u003e200\u003c/span\u003e \u003cspan class=\"mi\"\u003e1999\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;containerd/v1.4.0-beta.1-34-g49b0743c\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-07-26T14:52:45.4204299Z\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003elevel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003einfo\u003c/span\u003e \u003cspan class=\"n\"\u003emsg\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;response completed\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ego\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eversion\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ego1\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"mf\"\u003e11.2\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;proxy:5000\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mf\"\u003e15e9\u003c/span\u003e\u003cspan class=\"n\"\u003eac86\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"n\"\u003ed79\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e4883\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ea8ce\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e861\u003c/span\u003e\u003cspan class=\"n\"\u003ea7484887c\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003emethod\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eHEAD\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eremoteaddr\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;172.18.0.2:57588\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003euri\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;/v2/nicolaka/netshoot/manifests/latest\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003erequest\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003euseragent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;containerd/v1.4.0-beta.1-34-g49b0743c\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003econtenttype\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;application/vnd.docker.distribution.manifest.v2+json\u0026#34;\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eduration\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.6697112\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003estatus\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e200\u003c/span\u003e \u003cspan class=\"n\"\u003ehttp\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eresponse\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ewritten\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mi\"\u003e1999\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!--\n\n## Why \"proxy\" wasn't resolved inside containers\n\n```sh\n% docker inspect proxy --format '{{range $net, $cfg := .NetworkSettings.Networks}}{{$net}} {{$cfg.IPAddress}}{{end}}'\nbridge 172.17.0.2\n\n% docker inspect kind-control-plane --format '{{range $net, $cfg := .NetworkSettings.Networks}}{{$net}} {{$cfg.IPAddress}}{{end}}'\nkind 172.18.0.2\n\n% docker network ls\nNETWORK ID          NAME                DRIVER              SCOPE\na6ceea984c68        bridge              bridge              local\n6f6a9618d746        host                host                local\n4927dc2eba9b        kind                bridge              local\n```\n\nLet's try to reproduce this issue. I first run a registry with the default\nnetwork, and I then try to connect to it from a second container using the\nhostname `proxy`:\n\n```sh\n% docker run -d --rm --name proxy registry:2\n% docker run -it --rm alpine nslookup proxy\nServer:         127.0.0.11\nAddress:        127.0.0.11:53\nNon-authoritative answer:\nName:   proxy\nAddress: 172.18.0.7\n\n# Let's cleanup:\n% docker kill proxy\n```\n\nNow, let's do the same but a custom network named \"other\" instead of the\ndefault network:\n\n```sh\n% docker network create other\n% docker run -d --rm --net=other --name proxy registry:2\n% docker run -it --rm --net=other alpine nslookup proxy\nServer:         127.0.0.11\nAddress:        127.0.0.11:53\nNon-authoritative answer:\nName:   proxy\nAddress: 172.18.0.7\n\n# Let's cleanup:\n% docker kill proxy\n```\n\nI thought I could first start the container on the default network and then\nmove the containers to the \"other\" network (so that DNS with container\nnames works) but it does not seem to work either:\n\n```sh\n% docker run -d --rm --name proxy registry:2\n% docker run -d --rm --name alpine alpine sleep 1d\n\n% docker network create other\n% docker network disconnect bridge proxy\n% docker network disconnect bridge alpine\n% docker network connect other proxy\n% docker network connect other alpine\n\n# Now, let's see if 'alpine' can resolve 'proxy':\n% docker exec -it alpine nslookup proxy\n```\n\nI also tried to understand the difference between containers with the\ndefault network and containers with the \"other\" network. As stated [in the\nDocker documentation][dns-services], a container created on the default\nnetwork is setup slightly differently.\n\n```sh\n# 1️⃣ With default network:\n% docker run -it --rm alpine cat /etc/resolv.conf\n# This file is included on the metadata iso\nnameserver 192.168.65.1\n\n% docker run -it --rm alpine cat /etc/hosts\n127.0.0.1       localhost\n::1     localhost ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n172.17.0.4      8f4a5e6bad39\n\n# 2️⃣ With the 'other' network:\n% docker run -it --rm --net=other alpine cat /etc/resolv.conf\nnameserver 127.0.0.11\noptions ndots:0\n\n% docker run -it --rm --net=other alpine cat /etc/hosts\n127.0.0.1       localhost\n::1     localhost ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n172.19.0.4      fed220ca6bd0\n```\n\nSo it definitely comes from `/etc/resolv.conf`! With the default network,\nthe `/etc/resolv.conf` that gets set up does not allow you to resolve\ncontainer names.\n\nSo in order to use container names as hostnames, I have to create your own\nusing `docker network create`.\n\nLet's re-created my registry on the \"kind\" network and also re-create the\ncluster without the `KIND_EXPERIMENTAL_DOCKER_NETWORK=bridge` option:\n\n```sh\ndocker network create kind\ndocker run -d --name proxy --restart=always --net=kind registry:2\nkind create cluster --config /dev/stdin \u003c\u003cEOF\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\ncontainerdConfigPatches:\n  - |-\n    [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors.\"proxy\"]\n      endpoint = [\"http://proxy:5000\"]\nEOF\n```\n\nBoth are now on the same subnet:\n\n```sh\n% docker inspect proxy --format '{{range $net, $cfg := .NetworkSettings.Networks}}{{$net}} {{$cfg.IPAddress}}{{end}}'\nkind 172.18.0.2\n\n% docker inspect kind-control-plane --format '{{range $net, $cfg := .NetworkSettings.Networks}}{{$net}} {{$cfg.IPAddress}}{{end}}'\nkind 172.18.0.3\n```\n\nBut creating a simple deployment doesn't seem to work! By looking at the\nregistry logs, we see no activity at all. Let's see what `containerd` is up\nto:\n\n```log\n% docker exec -i kind-control-plane journalctl -u containerd | grep 'proxy:5000'\ncontainerd[129]: Start cri plugin with config {Registry:{Mirrors:map[\n  docker.io: {Endpoints:[https://registry-1.docker.io]}\n  proxy:  {Endpoints:[http://proxy:5000]}\n]}}\n```\n\n\u003e ✅ I had to remove `-t` (tty) from the above command. That's because\n\u003e `journalctl` was using a pager because this terminal was TTY (which means\n\u003e it had /dev/stdin open? not sure). To disable the pager I removed `-t`.\n\nI guess contained picks the first mirror (`docker.io`); so let's override\nthe `docker.io` key:\n\n```sh\ndocker rm -f registry\ndocker run -d --name proxy --restart=always --net=kind registry:2\nkind create cluster --config /dev/stdin \u003c\u003cEOF\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\ncontainerdConfigPatches:\n  - |-\n    [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors.\"docker.io\"]\n      endpoint = [\"http://proxy:5000\"]\nEOF\n```\n\nAnd here is the actual configuration given to containerd:\n\n```sh\n% docker exec -it kind-control-plane cat /etc/containerd/config.toml\nversion = 2\n[plugins]\n  [plugins.\"io.containerd.grpc.v1.cri\"]\n    sandbox_image = \"k8s.gcr.io/pause:3.2\"\n    [plugins.\"io.containerd.grpc.v1.cri\".containerd]\n      default_runtime_name = \"runc\"\n      [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes]\n        [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.runc]\n          runtime_type = \"io.containerd.runc.v2\"\n        [plugins.\"io.containerd.grpc.v1.cri\".containerd.runtimes.test-handler]\n          runtime_type = \"io.containerd.runc.v2\"\n    [plugins.\"io.containerd.grpc.v1.cri\".registry]\n      [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors]\n        [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors.\"docker.io\"]\n          endpoint = [\"https://registry-1.docker.io\"]\n        [plugins.\"io.containerd.grpc.v1.cri\".registry.mirrors.\"proxy\"]\n          endpoint = [\"http://proxy:5000\"]\n```\n\n--\u003e\n\u003ch2 id=\"docker-proxy-vs-local-registry\"\u003eDocker proxy vs. local registry\u003c/h2\u003e\n\u003cp\u003eA bit later, I discovered that \u003ca href=\"https://docs.docker.com/registry/configuration/#proxy\"\u003eyou can\u0026rsquo;t\u003c/a\u003e push to a proxy registry. \u003ca href=\"https://tilt.dev/\"\u003eTilt\u003c/a\u003e is a tool I use to ease the process of developping in a containerized environment (and it works best with Kubernetes); it \u003ca href=\"https://github.com/tilt-dev/kind-local\"\u003erelies on a local registry\u003c/a\u003e in order to cache build containers even when restarting the Kind cluster.\u003c/p\u003e\n\u003cp\u003eEither the registry is used as a \u0026ldquo;local registry\u0026rdquo; (where you can push images), or it is used as a pull-through proxy. So instead of configuring one single \u0026ldquo;proxy\u0026rdquo; registry, I configure two registries: one for local images, one for caching.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d --name proxy --restart\u003cspan class=\"o\"\u003e=\u003c/span\u003ealways --net\u003cspan class=\"o\"\u003e=\u003c/span\u003ekind -e \u003cspan class=\"nv\"\u003eREGISTRY_PROXY_REMOTEURL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttps://registry-1.docker.io registry:2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d --name registry --restart\u003cspan class=\"o\"\u003e=\u003c/span\u003ealways -p 5000:5000 --net\u003cspan class=\"o\"\u003e=\u003c/span\u003ekind registry:2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekind create cluster --config /dev/stdin \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt;EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ekind: Cluster\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eapiVersion: kind.x-k8s.io/v1alpha4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003econtainerdConfigPatches:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  - |-\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    [plugins.\u0026#34;io.containerd.grpc.v1.cri\u0026#34;.registry.mirrors.\u0026#34;docker.io\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e      endpoint = [\u0026#34;http://proxy:5000\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    [plugins.\u0026#34;io.containerd.grpc.v1.cri\u0026#34;.registry.mirrors.\u0026#34;localhost:5000\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e      endpoint = [\u0026#34;http://registry:5000\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote that we do use a port-forwarding proxy (\u003ccode\u003e-p 5000:5000\u003c/code\u003e) so that we can push images \u0026ldquo;from the host\u0026rdquo;, e.g.:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker tag alpine localhost:5000/alpine\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker push localhost:5000/alpine\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eThe push refers to repository \u003cspan class=\"o\"\u003e[\u003c/span\u003elocalhost:5000/alpine\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e50644c29ef5a: Pushed\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elatest: digest: sha256:a15790640a6690aa1730c38cf0a440e2aa44aaca9b0e8931a9f2b0d7cc90fd65 size: \u003cspan class=\"m\"\u003e528\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Let\u0026#39;s see if this image is also available from the cluster:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker \u003cspan class=\"nb\"\u003eexec\u003c/span\u003e -it kind-control-plane crictl pull localhost:5000/alpine\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eImage is up to date \u003cspan class=\"k\"\u003efor\u003c/span\u003e sha256:a24bb4013296f61e89ba57005a7b3e52274d8edd3ae2077d04395f806b63d83e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIf you use Tilt, you might also want to tell Tilt that it can use the local registry. I find it a bit weird to have to set an annotation (hidden Tilt API?) but whatever. If you set this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekind get nodes \u003cspan class=\"p\"\u003e|\u003c/span\u003e xargs -L1 -I% kubectl annotate node % tilt.dev/registry\u003cspan class=\"o\"\u003e=\u003c/span\u003elocalhost:5000 --overwrite\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ethen Tilt will use \u003ccode\u003edocker push localhost:5000/you-image\u003c/code\u003e (from your host, not from the cluster container) in order to speed up things. Note that there is a proposal (\u003ca href=\"https://github.com/kubernetes/enhancements/tree/master/keps/sig-cluster-lifecycle/generic/1755-communicating-a-local-registry\"\u003eKEP 1755\u003c/a\u003e) that aims at standardizing the discovery of local registries using a configmap. Tilt already supports it, so you may use it!\u003c/p\u003e\n\u003ch2 id=\"improving-the-clusterapi-docker-provider-to-use-a-given-network\"\u003eImproving the ClusterAPI docker provider to use a given network\u003c/h2\u003e\n\u003cp\u003eWhen I play with ClusterAPI, I usually use the CAPD provider (ClusterAPI Provider Docker). This provider \u003ca href=\"https://github.com/kubernetes-sigs/cluster-api/blob/master/test/infrastructure/docker\"\u003eis kept in-tree\u003c/a\u003e inside the cluster-api projet.\u003c/p\u003e\n\u003cp\u003eI want to use the caching mechanism presented above. But to do that, I need to make sure the clusters created by CAPD are not created on the default network (\u003ca href=\"https://sigs.k8s.io/cluster-api/test/infrastructure/docker/docker/kind_manager.go#L178\"\u003ecurrent implementation\u003c/a\u003e creates CAPD clusters on the default \u0026ldquo;bridge\u0026rdquo; network).\u003c/p\u003e\n\u003cp\u003eI want to be able to customize the network on which the CAPD provider creates the container that make up the cluster. Imagine that we could pass the network name as part of a \u003ca href=\"https://github.com/kubernetes-sigs/cluster-api/blob/6821939410c37743b45c36ec91d94c37dba1998e/test/e2e/data/infrastructure-docker/cluster-template.yaml#L26-L35\"\u003eDockerMachineTemplate\u003c/a\u003e (the content of the \u003ccode\u003espec\u003c/code\u003e is defined in code \u003ca href=\"https://github.com/kubernetes-sigs/cluster-api/blob/2ac3728d26593f7c54520999477aad45934e1c59/test/infrastructure/docker/api/v1alpha3/dockermachine_types.go#L30-L55\"\u003ehere\u003c/a\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003einfrastructure.cluster.x-k8s.io/v1alpha3\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eDockerMachineTemplate\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ecapd-control-plane\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003enamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003edefault\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003etemplate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eextraMounts\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e- \u003cspan class=\"nt\"\u003econtainerPath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e/var/run/docker.sock\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003ehostPath\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e/var/run/docker.sock\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003enetwork\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ekind\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# 🔰 This field does not exist yet.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eUpdate 26 July 2020\u003c/strong\u003e: added a section about local registry vs. caching proxy. Reworked the whole post (less noise, more useful information).\u003c/p\u003e\n","date":1593782019,"description":"Kind offers an excellent UX to Kubernetes developers but lacks support for caching images; each time you recreate a new cluster, all the previous downloaded images are gone. In this post, I explain why the default Docker network is a trap and how to set up a registry \u0026 make sure that it actually works.","dir":"2020/docker-proxy-registry-kind/","expirydate":-62135596800,"fuzzywordcount":1700,"images":["docker-proxy-registry-kind/cover-docker-proxy-registry-kind.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1593782019,"objectID":"9fc9b91cf183b07151af2f236ee0e302","permalink":"https://maelvls.dev/do-not-share-yet/docker-proxy-registry-kind/","publishdate":"2020-07-03T15:13:39+02:00","readingtime":8,"relpermalink":"/do-not-share-yet/docker-proxy-registry-kind/","section":"2020","summary":"\u003c!--\nDiagram on macOS + Docker: https://textik.com/#b185c1a72a6e782d\n--\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e \u003cem\u003e(August 2023)\u003c/em\u003e As mentioned by Wolfgang Schnerring \u003ca href=\"https://github.com/maelvls/maelvls.github.io/issues/7#issuecomment-688277166\"\u003ein this comment\u003c/a\u003e, the method presented in this document is very limited: many images are still being pulled directly and it only proxies a single \u0026ldquo;upstream\u0026rdquo; registry. Nowadays, \u003ccode\u003edocker-registry-proxy\u003c/code\u003e is a better alternative: \u003ca href=\"https://github.com/rpardini/docker-registry-proxy#kind-cluster\"\u003ehttps://github.com/rpardini/docker-registry-proxy#kind-cluster\u003c/a\u003e.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003eTL;DR:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eto create a local pull-through registry to speed up image pulling in a \u003ca href=\"https://kind.sigs.k8s.io/\"\u003eKind\u003c/a\u003e cluster, run:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run -d --name proxy --restart\u003cspan class=\"o\"\u003e=\u003c/span\u003ealways --net\u003cspan class=\"o\"\u003e=\u003c/span\u003ekind \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  -e \u003cspan class=\"nv\"\u003eREGISTRY_PROXY_REMOTEURL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttps://registry-1.docker.io registry:2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekind create cluster --config /dev/stdin \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt;EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ekind: Cluster\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eapiVersion: kind.x-k8s.io/v1alpha4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003econtainerdConfigPatches:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  - |-\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    [plugins.\u0026#34;io.containerd.grpc.v1.cri\u0026#34;.registry.mirrors.\u0026#34;docker.io\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e      endpoint = [\u0026#34;http://proxy:5000\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://docs.docker.com/registry/configuration/#proxy\"\u003eyou can\u0026rsquo;t\u003c/a\u003e use this pull-through proxy registry to push your own images (e.g. to \u003ca href=\"https://github.com/tilt-dev/kind-local\"\u003espeed up Tilt builds\u003c/a\u003e), but you can create two registries (one for caching, the other for local images). See \u003ca href=\"#docker-proxy-vs-local-registry\"\u003ethis section\u003c/a\u003e for more context; the lines are:\u003c/p\u003e","tags":["kubernetes","kind","docker","networking","dns"],"title":"Pull-through Docker registry on Kind clusters","type":"2020","url":"https://maelvls.dev/do-not-share-yet/docker-proxy-registry-kind/","weight":0,"wordcount":1601},{"authors":null,"categories":null,"content":"\u003cdiv style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"\u003e\n      \u003ciframe allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen\" loading=\"eager\" referrerpolicy=\"strict-origin-when-cross-origin\" src=\"https://www.youtube.com/embed/30a0WrfaS2A?autoplay=0\u0026amp;controls=1\u0026amp;end=0\u0026amp;loop=0\u0026amp;mute=0\u0026amp;start=0\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" title=\"YouTube video\"\u003e\u003c/iframe\u003e\n    \u003c/div\u003e\n\n\u003cp\u003eIn Oct 2019, Ahmet Alp Balkan wrote \u003ca href=\"https://ahmet.im/blog/kubectl-man-in-the-middle\"\u003ethis blog post\u003c/a\u003e that explains how to use \u003ccode\u003emitmproxy\u003c/code\u003e to observe the requests made by \u003ccode\u003ekubectl\u003c/code\u003e. But I couldn\u0026rsquo;t use the tutorial for two reasons:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eI use \u003ccode\u003ekind\u003c/code\u003e to create local clusters which means I hit the Go \u003ccode\u003enet/http\u003c/code\u003e limitation (skips proxying for hosts \u003ccode\u003elocalhost\u003c/code\u003e and \u003ccode\u003e127.0.0.1\u003c/code\u003e, see \u003ca href=\"https://maelvls.dev/go-ignores-proxy-localhost/\"\u003ethis blog post\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eI use client certs authentication, which can\u0026rsquo;t work with the method presented by Ahmet; it can only work for header-based authentication (e.g. token) but not for client certs.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn the following, I detail how I managed to make all that work.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Let\u0026#39;s use a separate kubeconfig file to avoid messing with ~/.kube/config.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eKUBECONFIG\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e~/.kube/kind-kind\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Now, let\u0026#39;s create a cluster.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekind create cluster\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Let\u0026#39;s see what the content of $KUECONFIG is:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecat \u003cspan class=\"nv\"\u003e$KUBECONFIG\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe can see that the kubeconfig uses a client cert as a way to authenticate to the apiserver.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eclusters\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e- \u003cspan class=\"nt\"\u003ecluster\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003ecertificate-authority-data\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUN5RENDQWJDZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJd01EWXlPVEE1TURJeU4xb1hEVE13TURZeU56QTVNREl5TjFvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBS25qCmhmRzBvenZVb05jMXY1STkvYm13dFBqb2QvK0RyczF4TFZOcWgxQjhFcTY1S3lnQjBSbDdQcTJueUhyRVRnTmsKZ2VPQ2RzRURObGpKOE12SC9GbE9nRkUvS0dqK2hwN2hwc0dHRExReWFUOExUY25JN0FNL2t3KzY5R0hidlN3Nwo2V0Y1VERTMDU1RkRqdnRveGdHcERycmZQZTk5bXN5Zmk3aWtteDk5MmRyMHFQd0xxanJpZHNkWU52MUZqU1Y1CndkRlFISGxBS2hBcmlUWmpQMnhNL3poOENBOFhndjF0UUxVVk5IS1hrSG5UYWlkeFY1MkduaUVaQmd0d2tSK3oKQ3hQempVZFAxQ1JRYzU0YmxDYW9FQVdTc0NYTUVPREhTSnowSi9CWHJCU2JaeGZIakd0Y0k0bEhBUmx2aURNawp3U3lOLy9qdE9tbWhDT29BTzBzQ0F3RUFBYU1qTUNFd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFIMDBrYnZpaWNNT3IxdFJoTkQweVpGa3ZkT1AKUzFGOEZKK1BFd1o1WExUTVVyVG1yekVlZmgza21xWkxYUnlyK3c0Snk1a0grK1o3enBpdlp6Q3BGOEtwclJaWAp5N2Z6TkJOeWMrOHFKN3dCek0xZ21BdTRha3BlNVBYbkw3akZIcU9aUmNXTmZKcUpTci9BS05sK2c2SjAzV2pnCmJDc0NQNTNrZ1czSDZYMkRoS1JzZFRWQlc1UGVlek1YRVlON2VYbGpnWE4xcElMdEU1VE5oWVZIcTZaUDVCaDkKMmU2Y1U4bEFuNlhYQ0Ira2RsTkhudGp1cTlSL2lPQVJRaWpVSVlWSFdCT1NyWGp6TnhkTklEakRRd3lKUnViMApDVEhrcDg4eUlNaEV1Nk1OV1VCUU82ZnVqbURHbUJJbTlzdzJpSnI1UlArSUVUVnQyWFc0Q2dHT1cwVT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eserver\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttps://127.0.0.1:53744\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ekind-helix\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003econtexts\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e- \u003cspan class=\"nt\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003ecluster\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ekind-helix\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ekind-helix\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ekind-helix\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ecurrent-context\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ekind-helix\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eConfig\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003epreferences\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e{}\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003eusers\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e- \u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ekind-helix\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eclient-certificate-data\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM4akNDQWRxZ0F3SUJBZ0lJYTZXc25HT0RGZW93RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TURBMk1qa3dPVEF5TWpkYUZ3MHlNVEEyTWprd09UQXlNekJhTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXRkbkxsb0V1cnFoSmRrMGgKME5VcXpFSHhUbmVHS040QTNtWDBobmFLcE1TT3hISlBQcTB6V0t4WEVxNTZPTkdhSkhvS0VTRUM2Yjh2MGcwTQo5dXVGOXJyQ1VORkpXMmdHcFArRG96TEpVS3RtN2F0WFZRYXNVQ2tjbFRtQ003aHlqOGZTTlRDd2lxT3RNOUFvCnFVVTJYd1k0a2xhL0RuMkRBc1V1VmNiUTdITDA1N0tFbjZvVzlFVy9mQ2hMVE5OTWhmelpkNzFISGs3MFNOZDMKTG5jTXNjNmp2eS9kN2MwbjM4ek45SjVzWVZOTjNsS1YvOU5MT2FaTEQ0bSsyVU5XV1FVazRuci8rZjlaZk1IMwphVlFibDZSWEZwaW1jYWg4UjRJTmhRNkhYbmVEbUI2dUl3RGdjQnhhQUtoNFVPVlZwODB1Uy9pYUVLV1VSWE1PCkg4YXBZUUlEQVFBQm95Y3dKVEFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFJaWtmbis5TkJQc2FNSzNVMU5pWmtBaWxsM1pWVXJDdzNsWgpIeGRGbm9MZGxZYmtPeFVEN25EK3lrNXhZWW4yaDc3WUU4NlU5czJ3aitkdFJTR2Ezc3p4WVJQbkt5MDN3L1M4CkhqZzhwSkZOZFhHWlNPUWJDQTBmT1BONXl5MlpYRlVWd0JwZ3VTMC9nTkNUUkRPUDl3QmNjQXhiSGRmSjMxQzQKa2hCemF4QXI5UEliMVBzUlhqS2ZSRnkvcllwYWRBYVhhYmZMOFRvbTJ4cGpLVDYreGxoL3lJb2tZbVhxSnlXRgp1SGFmWG1qUEdyRDFoZUo2UnR5U0xRM0dKUXQxWmVPK3BaYlJlRjcxU0ZRSjRQdFhtTHhGMjZQL3dlV3F0NWFJClhTK0ZnanRYbzZqUG1mWWRweDZ3bWp3UHRaZ1pRdXhSL2tsejVvQnErNnFaYUZDWXg4RT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eclient-key-data\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eLS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBdGRuTGxvRXVycWhKZGswaDBOVXF6RUh4VG5lR0tONEEzbVgwaG5hS3BNU094SEpQClBxMHpXS3hYRXE1Nk9OR2FKSG9LRVNFQzZiOHYwZzBNOXV1RjlyckNVTkZKVzJnR3BQK0RvekxKVUt0bTdhdFgKVlFhc1VDa2NsVG1DTTdoeWo4ZlNOVEN3aXFPdE05QW9xVVUyWHdZNGtsYS9EbjJEQXNVdVZjYlE3SEwwNTdLRQpuNm9XOUVXL2ZDaExUTk5NaGZ6WmQ3MUhIazcwU05kM0xuY01zYzZqdnkvZDdjMG4zOHpOOUo1c1lWTk4zbEtWCi85TkxPYVpMRDRtKzJVTldXUVVrNG5yLytmOVpmTUgzYVZRYmw2UlhGcGltY2FoOFI0SU5oUTZIWG5lRG1CNnUKSXdEZ2NCeGFBS2g0VU9WVnA4MHVTL2lhRUtXVVJYTU9IOGFwWVFJREFRQUJBb0lCQVFDVkNJOXZJeVB0QkFKZwpyOG44NmhhUEc2UDFtTU1jandUTFAyZHRJNDF3aDU0eHBUVUl1czJQNkgzYjA1NWJIbnhqVkprWGZLUjBpTGxhClBsUFhzU0l6R00vVGlCSEVsYmFNVnRPOVZndml6dllsNWZ4R3RKZFhncm5vR2g5NDM3c1Qxc0dSMGZ0OVE3TFkKK2NtNUgvMzFWcFhhYUxsZjJNRWI3aG1STnNWV1lXWm9MUHJ2QUJPemVmUnpKU0RONHU0M3M0eVpnNHJoL3IzWQo3YUhYOS9CSHpJRk93WTRNL1BRQzdYaFhDMXBIeWNPY2lSWVhFTkpuMTdQN2NOSkdoMnJ4dnc2OVQ1QW9rdXY5Ckcxd2lUNmVrVmZuaVYrSlVnL1lwcTNSRGxNdVFETDRZdCtGNG1zVGJtN3NFZk5yVVMzWGZFMFdmcjB2Wk1YN2sKMnE3dXkxNEJBb0dCQU5jb1BxVHNBa3N5YzR6UWtmQmNzb0Y1ekdJM3NQTUFGTHRSMGF6S2x1Q1V3VGMzYVk5dgpiTE05OTBVK3VpVzdtRHF0VHpZMVNVSzZGNW0yMzJoSW5hTnBCTUVJcDZHQ0I3dis5WWZIQURVSkljaVdodmJhCmpIY0M5Qjl4SG5uUTBydU5aNUErdWVtRE9EZkRKUllIVUhrMEh3MlJpTE1qRFhVRmhBanJBUGJ4QW9HQkFOaGUKL3BHb2FWOWtUREtNOWZwTTZUQkZwMFVtb2lSb3crVG9TWjhWeVBmMkl1VlNpa0dtaXUydHU3MzZCZkJtVzNtQgpGWmFRc01rNkMydExkK1NBQ0lSbktQTUN4czYzR05WNkJ0aXRIRFlBaGNtRCtvU3VpaFRrd3l1WXlpQml4aFovCms1UDY3UHFKVkQ2YnhkNDV6YlFsS2VNaUVtMUhnQUVGSEF0UFBqbHhBb0dBYzNnaHhwankwakNOV3ZGRW9WN2UKWGlaanpnSmRjTXlHVTlHaFdiNlFJbzh5OHROR1Q3aFkrZ2t6ZjNJZXJNbDA5V2kxcmo0Q3gxRGdBWnJuWXl3MQpqZEY2djY1SmFLQkVUbHlTb1AvbjJJN0NGc2pTUGdFa2lXcUlZYWR2MTZoK3NERS9kMlp5bUNQWU0vVURIa05tCnFPV1VGTkFhTVNtS3UxYnVlV3JGNWNFQ2dZQnJvNTVySWVnQjM2aVVnVkdoU24rN1Z2dG15RmhqV29jUnFvbHQKamUzamhWeEl6eTRlaU5hV2RSWnY1U0R0UGs2RmZMVWJxVEY1ZWRuU2I4SGVOOStFMXJrbFk1MDVteGJNcEo4aApUY1U2RERxQ1RKamxSdHRFbDZXTVc3ODZLMGsyU2hORnk4LzJ0empreUtPLzhPdW5rZEZyd0RpQWl0QmdNWVdKCkRzdjYwUUtCZ1FDR2htYnZrODRaYm1sdERxYW9hOVR6YU5UT3FrN3dtb0tDby9FVEg5NEtNVVZMVmk3bHhpN1kKcXFQYUdiSm9aYkZGd0NvWW12Rk5jU21nYk9SNjdCVVBkdUEzMHo0VythV1pmQVkwZGpUR08yTC8zVVhoWHdHegpVUGpZTXZZQU5sdzFmZTVmZmk3UExJSGJvZXFhTmhhaDliRVJXdFNRbm95NnYzV2hlNTh6VkE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLet\u0026rsquo;s run mitmproxy using the above client cert and keys:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emitmproxy -p \u003cspan class=\"m\"\u003e9000\u003c/span\u003e --ssl-insecure --set \u003cspan class=\"nv\"\u003eclient_certs\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;\u003cspan class=\"o\"\u003e(\u003c/span\u003ekubectl config view --minify --flatten -o\u003cspan class=\"o\"\u003e=\u003c/span\u003ego-template\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{{(index (index .users 0).user \u0026#34;client-key-data\u0026#34;)}}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e base64 -d \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e kubectl config view --minify --flatten -o\u003cspan class=\"o\"\u003e=\u003c/span\u003ego-template\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{{(index (index .users 0).user \u0026#34;client-certificate-data\u0026#34;)}}\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e base64 -d\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, let\u0026rsquo;s make sure that we have some DNS alias to 127.0.0.1 to work around \u003ca href=\"https://maelvls.dev/go-ignores-proxy-localhost/\"\u003ethe Go proxy limitation\u003c/a\u003e which skips proxying for \u003ccode\u003e127.0.0.1\u003c/code\u003e and \u003ccode\u003elocalhost\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrep \u003cspan class=\"s2\"\u003e\u0026#34;^127.0.0.1.*local\u003c/span\u003e$\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e /etc/hosts \u003cspan class=\"o\"\u003e||\u003c/span\u003e sudo bash -c \u003cspan class=\"s1\"\u003e\u0026#39;echo \u0026#34;127.0.0.1 local\u0026#34; \u0026gt;\u0026gt; /etc/hosts\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFinally you can run \u003ccode\u003ekubectl\u003c/code\u003e to see the logs of \u003ccode\u003ekube-scheduler\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% \u003cspan class=\"nv\"\u003eHTTPS_PROXY\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e:9000 kubectl --kubeconfig\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;\u003cspan class=\"o\"\u003e(\u003c/span\u003esed \u003cspan class=\"s2\"\u003e\u0026#34;s|127.0.0.1|local|\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003e$KUBECONFIG\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e --insecure-skip-tls-verify logs -n kube-system -l \u003cspan class=\"nv\"\u003ecomponent\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ekube-scheduler,tier\u003cspan class=\"o\"\u003e=\u003c/span\u003econtrol-plane\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:11.585249       \u003cspan class=\"m\"\u003e1\u003c/span\u003e registry.go:150\u003cspan class=\"o\"\u003e]\u003c/span\u003e Registering EvenPodsSpread predicate and priority \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:11.585329       \u003cspan class=\"m\"\u003e1\u003c/span\u003e registry.go:150\u003cspan class=\"o\"\u003e]\u003c/span\u003e Registering EvenPodsSpread predicate and priority \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:12.976581       \u003cspan class=\"m\"\u003e1\u003c/span\u003e serving.go:313\u003cspan class=\"o\"\u003e]\u003c/span\u003e Generated self-signed cert in-memory\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eW0701 11:11:17.407371       \u003cspan class=\"m\"\u003e1\u003c/span\u003e authentication.go:349\u003cspan class=\"o\"\u003e]\u003c/span\u003e Unable to get configmap/extension-apiserver-authentication in kube-system.  Usually fixed by \u003cspan class=\"s1\"\u003e\u0026#39;kubectl create rolebinding -n kube-system ROLEBINDING_NAME --role=extension-apiserver-authentication-reader --serviceaccount=YOUR_NS:YOUR_SA\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eW0701 11:11:17.407465       \u003cspan class=\"m\"\u003e1\u003c/span\u003e authentication.go:297\u003cspan class=\"o\"\u003e]\u003c/span\u003e Error looking up in-cluster authentication configuration: configmaps \u003cspan class=\"s2\"\u003e\u0026#34;extension-apiserver-authentication\u0026#34;\u003c/span\u003e is forbidden: User \u003cspan class=\"s2\"\u003e\u0026#34;system:kube-scheduler\u0026#34;\u003c/span\u003e cannot get resource \u003cspan class=\"s2\"\u003e\u0026#34;configmaps\u0026#34;\u003c/span\u003e in API group \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e in the namespace \u003cspan class=\"s2\"\u003e\u0026#34;kube-system\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eW0701 11:11:17.407483       \u003cspan class=\"m\"\u003e1\u003c/span\u003e authentication.go:298\u003cspan class=\"o\"\u003e]\u003c/span\u003e Continuing without authentication configuration. This may treat all requests as anonymous.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eW0701 11:11:17.407513       \u003cspan class=\"m\"\u003e1\u003c/span\u003e authentication.go:299\u003cspan class=\"o\"\u003e]\u003c/span\u003e To require authentication configuration lookup to succeed, \u003cspan class=\"nb\"\u003eset\u003c/span\u003e --authentication-tolerate-lookup-failure\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003efalse\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:17.478349       \u003cspan class=\"m\"\u003e1\u003c/span\u003e registry.go:150\u003cspan class=\"o\"\u003e]\u003c/span\u003e Registering EvenPodsSpread predicate and priority \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:17.478483       \u003cspan class=\"m\"\u003e1\u003c/span\u003e registry.go:150\u003cspan class=\"o\"\u003e]\u003c/span\u003e Registering EvenPodsSpread predicate and priority \u003cspan class=\"k\"\u003efunction\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eW0701 11:11:17.491616       \u003cspan class=\"m\"\u003e1\u003c/span\u003e authorization.go:47\u003cspan class=\"o\"\u003e]\u003c/span\u003e Authorization is disabled\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eW0701 11:11:17.491729       \u003cspan class=\"m\"\u003e1\u003c/span\u003e authentication.go:40\u003cspan class=\"o\"\u003e]\u003c/span\u003e Authentication is disabled\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:17.491883       \u003cspan class=\"m\"\u003e1\u003c/span\u003e deprecated_insecure_serving.go:51\u003cspan class=\"o\"\u003e]\u003c/span\u003e Serving healthz insecurely on \u003cspan class=\"o\"\u003e[\u003c/span\u003e::\u003cspan class=\"o\"\u003e]\u003c/span\u003e:10251\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:17.500576       \u003cspan class=\"m\"\u003e1\u003c/span\u003e secure_serving.go:178\u003cspan class=\"o\"\u003e]\u003c/span\u003e Serving securely on 127.0.0.1:10259\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:17.500678       \u003cspan class=\"m\"\u003e1\u003c/span\u003e tlsconfig.go:240\u003cspan class=\"o\"\u003e]\u003c/span\u003e Starting DynamicServingCertificateController\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:17.500919       \u003cspan class=\"m\"\u003e1\u003c/span\u003e configmap_cafile_content.go:202\u003cspan class=\"o\"\u003e]\u003c/span\u003e Starting client-ca::kube-system::extension-apiserver-authentication::client-ca-file\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:17.500931       \u003cspan class=\"m\"\u003e1\u003c/span\u003e shared_informer.go:223\u003cspan class=\"o\"\u003e]\u003c/span\u003e Waiting \u003cspan class=\"k\"\u003efor\u003c/span\u003e caches to sync \u003cspan class=\"k\"\u003efor\u003c/span\u003e client-ca::kube-system::extension-apiserver-authentication::client-ca-file\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:17.718085       \u003cspan class=\"m\"\u003e1\u003c/span\u003e shared_informer.go:230\u003cspan class=\"o\"\u003e]\u003c/span\u003e Caches are synced \u003cspan class=\"k\"\u003efor\u003c/span\u003e client-ca::kube-system::extension-apiserver-authentication::client-ca-file\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:17.801300       \u003cspan class=\"m\"\u003e1\u003c/span\u003e leaderelection.go:242\u003cspan class=\"o\"\u003e]\u003c/span\u003e attempting to acquire leader lease  kube-system/kube-scheduler...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0701 11:11:34.659176       \u003cspan class=\"m\"\u003e1\u003c/span\u003e leaderelection.go:252\u003cspan class=\"o\"\u003e]\u003c/span\u003e successfully acquired lease kube-system/kube-scheduler\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIt works!! Here is what mitmproxy is showing:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e18:17:42 GET  HTTPS   \u003cspan class=\"nb\"\u003elocal\u003c/span\u003e /api/v1/namespaces/kube-system/pods/kube-scheduler-helix-control-plane      \u003cspan class=\"m\"\u003e200\u003c/span\u003e …plication/json  5.2k 119ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e18:17:42 GET  HTTPS   \u003cspan class=\"nb\"\u003elocal\u003c/span\u003e /api/v1/namespaces/kube-system/pods/kube-scheduler-helix-control-plane/log  \u003cspan class=\"m\"\u003e200\u003c/span\u003e      text/plain 2.46k 227ms\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1593623844,"description":"Mitmproxy is an excellent tool that helps us understand what network calls are made by programs. And kubectl is one of these interesting programs, but it uses a mutual TLS authentication which is tricky to get right.","dir":"2020/mitmproxy-kubectl/","expirydate":-62135596800,"fuzzywordcount":600,"images":["mitmproxy-kubectl/cover-mitmproxy-kubectl.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1593623844,"objectID":"5e528729d492260b094df30e03c40d47","permalink":"https://maelvls.dev/do-not-share-yet/mitmproxy-kubectl/","publishdate":"2020-07-01T19:17:24+02:00","readingtime":3,"relpermalink":"/do-not-share-yet/mitmproxy-kubectl/","section":"2020","summary":"\u003cdiv style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"\u003e\n      \u003ciframe allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen\" loading=\"eager\" referrerpolicy=\"strict-origin-when-cross-origin\" src=\"https://www.youtube.com/embed/30a0WrfaS2A?autoplay=0\u0026amp;controls=1\u0026amp;end=0\u0026amp;loop=0\u0026amp;mute=0\u0026amp;start=0\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" title=\"YouTube video\"\u003e\u003c/iframe\u003e\n    \u003c/div\u003e\n\n\u003cp\u003eIn Oct 2019, Ahmet Alp Balkan wrote \u003ca href=\"https://ahmet.im/blog/kubectl-man-in-the-middle\"\u003ethis blog post\u003c/a\u003e that explains how to use \u003ccode\u003emitmproxy\u003c/code\u003e to observe the requests made by \u003ccode\u003ekubectl\u003c/code\u003e. But I couldn\u0026rsquo;t use the tutorial for two reasons:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eI use \u003ccode\u003ekind\u003c/code\u003e to create local clusters which means I hit the Go \u003ccode\u003enet/http\u003c/code\u003e limitation (skips proxying for hosts \u003ccode\u003elocalhost\u003c/code\u003e and \u003ccode\u003e127.0.0.1\u003c/code\u003e, see \u003ca href=\"https://maelvls.dev/go-ignores-proxy-localhost/\"\u003ethis blog post\u003c/a\u003e)\u003c/li\u003e\n\u003cli\u003eI use client certs authentication, which can\u0026rsquo;t work with the method presented by Ahmet; it can only work for header-based authentication (e.g. token) but not for client certs.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn the following, I detail how I managed to make all that work.\u003c/p\u003e","tags":["kubernetes","mitmproxy","networking","kind"],"title":"Using mitmproxy to understand what kubectl does under the hood","type":"2020","url":"https://maelvls.dev/do-not-share-yet/mitmproxy-kubectl/","weight":0,"wordcount":521},{"authors":null,"categories":null,"content":"","date":1590864306,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1590864306,"objectID":"https://maelvls.dev/do-not-share-yet/tags/autotools/","permalink":"https://maelvls.dev/do-not-share-yet/tags/autotools/","publishdate":"2020-05-30T20:45:06+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/autotools/","section":"tags","summary":"","tags":null,"title":"Autotools","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/autotools/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1590864306,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1590864306,"objectID":"https://maelvls.dev/do-not-share-yet/tags/c/","permalink":"https://maelvls.dev/do-not-share-yet/tags/c/","publishdate":"2020-05-30T20:45:06+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/c/","section":"tags","summary":"","tags":null,"title":"C","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/c/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1590864306,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1590864306,"objectID":"https://maelvls.dev/do-not-share-yet/tags/c++/","permalink":"https://maelvls.dev/do-not-share-yet/tags/c++/","publishdate":"2020-05-30T20:45:06+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/c++/","section":"tags","summary":"","tags":null,"title":"C++","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/c++/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eBetween May and June 2016, I worked with \u003ca href=\"https://github.com/polazarus/ocamlyices\"\u003eocamlyices2\u003c/a\u003e, an OCaml package that binds to the \u003ca href=\"https://github.com/SRI-CSL/yices2\"\u003eYices\u003c/a\u003e C++ library. Both projects (as well as many Linux projects) are built using the \u0026ldquo;Autotools\u0026rdquo; suite.\u003c/p\u003e\n\u003cp\u003eThe Autotools suite includes tools like \u003ca href=\"https://www.gnu.org/software/autoconf/\"\u003eautoconf\u003c/a\u003e, \u003ca href=\"https://www.gnu.org/software/automake\"\u003eautomake\u003c/a\u003e and \u003ca href=\"https://www.gnu.org/software/libtool/\"\u003elibtool\u003c/a\u003e. These tools generate a bunch of shell scripts and Makefiles using shell scripts and the \u003ca href=\"https://en.wikipedia.org/wiki/M4_(computer_language)\"\u003eM4\u003c/a\u003e macro language. The user of your projects ends up two simple commands to build your project:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eWhy did I bother with this? As part of my PhD, I worked on a tool, \u003ca href=\"https://github.com/touist/touist\"\u003etouist\u003c/a\u003e, which uses SMT solvers like Yices. The \u003ccode\u003etouist\u003c/code\u003e CLI was written in OCaml (a popular language among academics, including my supervisor), which meant I had to go through hoops to interoperate with C/C++ solvers like Yices.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eMy first challenge with ocamlyices2 was the fact that I needed a statically-linked \u003ccode\u003elibyices.a\u003c/code\u003e. And since Yices depends on \u003ca href=\"https://gmplib.org/\"\u003eGMP\u003c/a\u003e, I had to dive deep into Yices2\u0026rsquo;s \u003ccode\u003econfigure.ac\u003c/code\u003e and find a way to select the static version of GMP.\u003c/p\u003e\n\u003cp\u003eBut building a static library \u003ccode\u003elibyices.a\u003c/code\u003e was not enough. I was to build in PIC mode (position-independant code, enabled with \u003ccode\u003e-fPIC\u003c/code\u003e in gcc). The position-independant code is required when you want to embed a static library into a dynamically-linked library. That\u0026rsquo;s due to the fact that OCaml requires both the \u003ccode\u003e.so\u003c/code\u003e and \u003ccode\u003e.a\u003c/code\u003e versions of the \u0026ldquo;stub\u0026rdquo; library (a stub library is a C library that wraps another C library using OCaml C primitives). And naturally, Yices\u0026rsquo; build system had not been written to support building a static PIC \u003ccode\u003elibyices.a\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eI remember these days as an epic struggle against old build systems. This experience taught me everything about \u003ccode\u003eautoconf\u003c/code\u003e, Makefiles, position-independant code, \u003ccode\u003egcc\u003c/code\u003e, \u003ccode\u003eldd\u003c/code\u003e and \u003ccode\u003elibtool\u003c/code\u003e. And in this post, I want to share these discoveries and how I progressed into contributing to the \u003ca href=\"https://github.com/polazarus/ocamlyices\"\u003eocamlyices2\u003c/a\u003e project.\u003c/p\u003e\n\u003cp\u003eHere is a diagram showing the dependencies between libraries. Ocamlyices2 depends on Yices and Yices depends on GMP.\u003c/p\u003e\n\u003cdiv class=\"nohighlight\"\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            build:   dune\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e             touist         lang:    ocaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |           output:  touist binary (statically linked)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |depends on\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                v\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e           ocamlyices2      build:   autoconf + make\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |           lang:    ocaml + C\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |           output:  libyices2_stubs.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |depends on\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                v           build:   autoconf + hacky make\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e              yices         lang:    C++\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |           output:  libyices.a (with PIC enabled)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |depends on\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                v           build:   autoconf + automake + libtool\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e               gmp          lang:    C, assembly\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            output:  libgmp.a (with PIC enabled)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c!-- https://textik.com/#23689eecb0630a77 --\u003e\n\u003cp\u003eThe most important thing about this diagram is that since we need a PIC-enabled static library \u003ccode\u003elibyices.a\u003c/code\u003e in order to build the \u0026ldquo;binding libraries\u0026rdquo;: the shared library \u003ccode\u003eyices2.cmxs\u003c/code\u003e and the static library \u003ccode\u003elibyices2_stubs.a\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eAnd in order to get this PIC-enabled \u003ccode\u003elibyices.a\u003c/code\u003e, I needed to make sure that the GMP library picked by the Yices \u003ccode\u003e./configure\u003c/code\u003e would be static and PIC-enabled.\u003c/p\u003e\n\u003cp\u003eIn early 2016, the Yices build system was limited to building a shared library with no support for cross-compilation (a requirement to build on Windows) and no support for enforcing PIC in \u003ccode\u003elibgmp.a\u003c/code\u003e and \u003ccode\u003elibyices.a\u003c/code\u003e.\u003c/p\u003e\n\u003ch2 id=\"yices2--autoconf-an-attempt-at-fixing-a-limited-build-system\"\u003eYices2 \u0026amp; autoconf: an attempt at fixing a limited build system\u003c/h2\u003e\n\u003cp\u003eI remember the warmth that we had in May 2016. My daughter had turned three and we were still living in a tiny appartment since I was technically still a student.\u003c/p\u003e\n\u003cp\u003eMy first patch to the ocamlyices2 project took over a month of intense work. The stake was immense: I aimed at revamping the whole Yices2 build system. The original build system didn\u0026rsquo;t allow developers to statically build \u003ccode\u003elibyices.a\u003c/code\u003e. More generally, it was a pain to work with: most configuration was happening at \u003ccode\u003e./configure\u003c/code\u003e time, but a ton of things had still to be passed at make time (e.g., \u003ccode\u003emake VAR=value\u003c/code\u003e).\u003c/p\u003e\n\u003cp\u003eThis change (\u003ca href=\"https://github.com/polazarus/ocamlyices2/commit/25f5eb15\"\u003e25f5eb15\u003c/a\u003e) brought a ton of features. But the most important ones were:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eBetter \u003ccode\u003e./configure \u0026amp;\u0026amp; make\u003c/code\u003e experience\u003c/strong\u003e. Instead of having some parts of the build configuration being passed as Makefile variables, I moved everything to nice flags that you would pass to \u003ccode\u003e./configure\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eProper PIC support\u003c/strong\u003e. Sometimes, Yices\u0026rsquo; \u003ccode\u003e./configure\u003c/code\u003e would pick up a \u003ccode\u003elibgmp.a\u003c/code\u003e that would not be \u0026ldquo;PIC\u0026rdquo;. So I wrote a new \u003ca href=\"https://en.wikipedia.org/wiki/M4_(computer_language)\"\u003eM4\u003c/a\u003e macro, \u003ccode\u003eCSL_CHECK_STATIC_GMP_HAS_PIC\u003c/code\u003e, that would do the PIC check using libtool. For example, the developer would be able to ask for a static library with PIC support:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure --with-pic --enable-static --disable-shared --with-pic-gmp\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$PWD\u003c/span\u003e/with-pic/libgmp.a\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eStatic \u003ccode\u003elibyices.a\u003c/code\u003e\u003c/strong\u003e. The original build system did not\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eUsing \u003ccode\u003elibtool\u003c/code\u003e\u003c/strong\u003e. Instead of hand-crafted targets for building the static \u0026amp; dynamic libraries, \u003ccode\u003elibtool\u003c/code\u003e allowed me to build both with very little effort (at the cost of slightly longer build times). I remember trying to fiddle with the Makefile to be able to get PIC/non-PIC as well as dynamic/static \u003ccode\u003e.o\u003c/code\u003e units. Using \u003ccode\u003elibtool\u003c/code\u003e made it so easier to build simultanously the static and dynamic versions of \u003ccode\u003elibyices\u003c/code\u003e (\u003ccode\u003elibyices.a\u003c/code\u003e and \u003ccode\u003elibyices.so\u003c/code\u003e).\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eCross-compilation\u003c/strong\u003e. I wanted to be able to release binaries for Windows users, which meant that I needed to cross-compile from a Cygwin environment to a Win32 executable.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eI also fixed weird bugs like a failure on Alpine 3.5 due to a race condition in \u003ccode\u003eltmain.sh\u003c/code\u003e. Yes, you heard well! A race condition in a build system!\u003c/p\u003e\n\u003cp\u003eNot sure, but \u003ca href=\"https://github.com/polazarus/ocamlyices2/commit/25f5eb15\"\u003e25f5eb15\u003c/a\u003e might be my biggest commit ever:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-mysql\" data-lang=\"mysql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eAuthor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMaël\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eValais\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003emael\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evalais\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003egmail\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ecom\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e   \u003c/span\u003e\u003cspan class=\"n\"\u003eFri\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMay\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e31\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e37\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2017\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"mi\"\u003e0200\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eCommit\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e25\u003c/span\u003e\u003cspan class=\"n\"\u003ef5eb15\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esystem\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emoved\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eall\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econfig\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efrom\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMakefile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econfigure\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eWhat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eI\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etried\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efix\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eImpossible\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eproduces\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003earchive\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emingw32\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSo\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emuch\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edone\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMakefile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einstead\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econfigure\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eThe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make build OPTION= MODE=\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ekind\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eunexpected\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ereally\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003estandard\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eAs\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ean\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"k\"\u003euser\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuilder\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehard\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eguess\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emy\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esystem\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003einstalled\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePIC\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eThe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esystem\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eshould\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehelp\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eme\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethat\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eCFLAGS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eCPPFLAGS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecannot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eoverritten\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eby\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"k\"\u003euser\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuilder\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"kt\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSee\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Preset Output Variables\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eautoconf\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emanual\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003esmt2_commands\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003esmt2_parser\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003esmt2_term_stack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eare\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eall\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eincluding\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003esmt2_commands\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003esmt2_commands\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethere\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edefinition\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003eso\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethere\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eclash\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esymbols\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elink\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSolution\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;extern\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edefinition\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eSolution\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etypedef\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eenum\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eThe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esystem\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eshould\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efully\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eparallel\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eproof\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eNote\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make -j\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003ethread\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebomb\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eprefer\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make -j4\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eyou\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehave\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eprocessors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eWhy\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eremoving\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;dist\u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e?\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003erm\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ef\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edistdir\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003elib\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eshould\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edistributed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eusers\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ealong\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eshared\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elib\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eWhy\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edoes\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econtain\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emore\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethan\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eso\u003c/span\u003e\u003cspan class=\"o\"\u003e?\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eI\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eguess\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebecause\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esome\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003efunction\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eare\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eneeded\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eby\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etests\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etests\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eare\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enever\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edynamically\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elinked\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eshared\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eso\u003c/span\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eFor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eexample\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etest\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003etest_type_matching\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecalls\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efunction\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;delete_pstore\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eexported\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eThis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emeans\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecannot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003ecreated\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eso\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eWe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emust\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einstead\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eobject\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efiles\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edirectly\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eFeatures\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enew\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esystem\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eIt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epossible\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eselect\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewhat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eyou\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewant\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003eenable\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003eenable\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eshared\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eBy\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eboth\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eare\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuilt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eYou\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecan\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003espeed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eup\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003eby\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edisabling\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eone\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emodes\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eexample\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003edisable\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eshared\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eRunning\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econfigure\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewill\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etell\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eyou\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efound\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003egiven\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003egmp\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003epic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003egmp\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePIC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eLibtool\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehandles\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eall\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eshared\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibrary\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enaming\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eversion\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enumber\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esymbolic\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003elinks\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eon\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elinux\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eso\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eon\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emac\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eos\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edylib\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eon\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewindows\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edll\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edll\u003c/span\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eIt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epossible\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003echoose\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eyou\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewant\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePIC\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eonly\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecode\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003elibrary\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003epic\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eThe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econfigure\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econfigures\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMakefile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emakes\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emoved\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eall\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esteps\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewere\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edone\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMakefile\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eIt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erequired\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eanymore\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epass\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eOPTION\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eOPTION\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003ehandled\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eby\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epassing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eexample\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ei686\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ew64\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003emingw32\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erunning\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econfigure\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einstead\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make OPTION=mingw32\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eIt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erequired\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eanymore\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003epass\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMODE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMODE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehandled\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eby\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eargument\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003emode\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003erelease\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eexample\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erunning\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econfigure\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eRemoved\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econfusing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emess\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;/\u003c/span\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econfigs\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003eBuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eobjects\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eare\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esimply\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eput\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMerged\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emany\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMakefiles\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewere\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esharing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecode\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecommon\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eStandardized\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etarget\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eexperience\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuilding\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebinaries\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003elibrary\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eno\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eneed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eOPTION\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMODE\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003edist\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003enon\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003estandard\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eshowing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eresults\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eas\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewould\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"n\"\u003ebe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edistributed\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edistclean\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eremoving\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eany\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efiles\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecreated\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eby\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econfigure\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elib\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eyou\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eonly\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewant\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibrary\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einstall\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003euninstall\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einstalling\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nf\"\u003euninstalling\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDESTDIR\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esupported\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eOn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecan\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibrary\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eOn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eWindows\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eshared\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibraries\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecan\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuilt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eonce\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eThe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003eversion\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecan\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erenamed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eDESTDIR\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eworks\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eas\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eexpected\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewill\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ereproduce\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehierarchy\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eprefix\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003ewhen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erunning\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make install DESTDIR=/path\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enice\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esummary\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econfiguration\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eprinted\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erunning\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econfigure\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003eIt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eallows\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003echeck\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePIC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehelps\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehave\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eclear\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003eview\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewhat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egoing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehappen\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMoved\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eversion\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enumber\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eYices\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econfigure\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eac\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eIf\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003euser\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewants\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003epic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003egmp\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebut\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePIC\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egive\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehim\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003ean\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eindication\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewhat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecommand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erun\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ePIC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMoved\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egmaketest\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003einto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003econfigure\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewarn\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003euser\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egnu\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eParallel\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efully\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003esupported\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nf\"\u003egmp\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esimilar\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eflags\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etry\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efind\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e..\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003einclude\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eautomatically\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efall\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eback\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esystem\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ewide\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003echeck\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eeven\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eno\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003egmp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003einclude\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003edir\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egiven\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emoved\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eall\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecsl_\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efunctions\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003einto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eautoconf\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003em4\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ecsl_check_libs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003em4\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eso\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethey\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003ecan\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ereused\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esomewhere\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecompute\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edependencies\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eonly\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003erelease\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emode\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecompile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003etime\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003einstead\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eahead\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eThis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esaves\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003etime\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eduring\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecompilation\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebecause\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edeps\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003eare\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enecessary\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eh\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efiles\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eare\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003echanged\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuilder\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"k\"\u003euser\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eIf\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuilder\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edeveloper\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ethen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewill\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003eset\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003emode\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"err\"\u003e{\u003c/span\u003e\u003cspan class=\"n\"\u003edebug\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"n\"\u003eprofile\u003c/span\u003e\u003cspan class=\"p\"\u003e...\u003c/span\u003e\u003cspan class=\"err\"\u003e}\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewill\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003etrigger\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edeps\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecomputed\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make test\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecompiles\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eruns\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eall\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etests\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etests\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eunit\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make test_api12\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewill\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecompile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erun\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etest\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etests\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eunit\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003etest_api12\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eremoved\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eversion_\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eas\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003erebuilt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eat\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kt\"\u003etime\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egperf\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eonly\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enecessary\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewhen\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003echanging\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003etokens\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etxt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eor\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ekeywords\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etxt\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efiles\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eend\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"k\"\u003euser\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuilder\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edoes\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehave\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ehave\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003egperf\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einstalled\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eSide\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enotes\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eCPPFLAGS\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eCFLAGS\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eLDFLAGS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eand\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eany\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003emakefile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003evariable\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecan\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eoverwritten\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;make LDFLAGS=...\u0026#39;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewas\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ealready\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ecase\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ewith\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eprevious\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eversion\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eof\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esystem\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"n\"\u003eKnown\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eissues\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eon\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMac\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eOS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elinking\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eexecutables\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eagains\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003enon\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ePIC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewill\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethrow\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethe\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003efollowing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewarning\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"n\"\u003eld\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewarning\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePIE\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edisabled\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eAbsolute\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nf\"\u003eaddressing\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eperhaps\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003emdynamic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eno\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003epic\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003enot\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eallowed\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecode\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esigned\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePIE\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebut\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eused\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003e___gmpn_mul_1\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003efrom\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emul_1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eo\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"k\"\u003eTo\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003efix\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ethis\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewarning\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edon\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;t compile with -mdynamic-no-pic or link with -Wl,-no_pie\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    Todo:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    * produce libyices.def on Windows\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    * make sure the test on libgmp-10.dll is future-proof (remove the \u0026#39;\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    * fix the \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003eecho\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003esummary\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    * I did not test the checks made configure.ac on mcsat and libpoly; we should\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e      do the same tests as done on libgmp.a (for checking that it is PIC) and\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e      add a helping message at the end of configure.ac.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    * For the tests, I read that two kind of tests were compiled:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e      - \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003etests\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; where the tests are linked to the non-PIC libgmp.a and static libgmp.a\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e      - \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003etests\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003estatic\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; where the tests are linked to the PIC libgmp.a and shared\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e        GMP library.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e      I changed the second one: it links to the shared version of libyices and shared\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e      version of GMP. But building the with-PIC libyices.a would be really easy\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e      (and it is still possible using the flag --with-pic).\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    * \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003edist\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; is not a staging area (for now) for \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003einstall\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;. They both\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e      install from built objects.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    * it is not possible to compile the tests against the shared library\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e      because many symbols which are used in the tests are not exported (\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003eexport\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e      in the C code). They exist if we do \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003enm\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; but they are just not usable.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    * pstore issue:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    The visibility is T (visible) in static mode and t (hidden) in shared mode. This\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    is because \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003eabstract_values\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ec\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; has not been \u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003eexported\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39; (=added in `yices_api.c`).\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    Here is an example of the difference (functions from )\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    ```\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    # nm build/lib/libyices.a | grep pstore\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    0000000000000090 T _delete_pstore\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    0000000000000000 T _init_pstore\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    # nm build/lib/.libs/libyices.2.dylib | grep pstore\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    0000000000037e10 t _delete_pstore\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    0000000000037d80 t _init_pstore\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    ```\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    I tweaked the ltmain.sh to be able to pass different CPPFLAGS for the compilation\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    of static and shared objects by the `%.o: %.c` rule. CPPFLAGS must be different\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    because of Windows dlls: `-DNOYICES_DLL -D__GMP_LIBGMP_DLL=0` for example.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    I added two variables LT_STATIC_CFLAGS and LT_SHARED_CFLAGS. They allow me\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    to pass CFLAGS to libtool for .c -\u0026gt; .o targets. It allows me to pass things\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    like -DYICES_STATIC, -DNOYICES_DLL and -D_LIBGMP_DLL.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    ``` diff\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    diff --git a/ext/yices/autoconf/ltmain.sh b/ext/yices/autoconf/ltmain.sh\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    index bf5d83b..7b7dd3a 100644\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    --- a/ext/yices/autoconf/ltmain.sh\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    +++ b/ext/yices/autoconf/ltmain.sh\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    @@ -3500,10 +3500,10 @@ compiler.\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e           fbsd_hideous_sh_bug=$base_compile\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e           if test no != \u0026#34;$pic_mode\u0026#34;; then\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    -       command=\u0026#34;$base_compile $qsrcfile $pic_flag\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e    +       command=\u0026#34;$base_compile $LT_SHARED_CFLAGS $qsrcfile $pic_flag\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e           else\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e            # Don\u0026#39;\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ebuild\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ePIC\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecode\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"w\"\u003e       \u003c/span\u003e\u003cspan class=\"n\"\u003ecommand\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;$base_compile $qsrcfile\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"w\"\u003e       \u003c/span\u003e\u003cspan class=\"n\"\u003ecommand\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;$base_compile $LT_SHARED_CFLAGS $qsrcfile\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e           \u003c/span\u003e\u003cspan class=\"n\"\u003efi\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e           \u003c/span\u003e\u003cspan class=\"n\"\u003efunc_mkdir_p\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;$xdir$objdir\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"o\"\u003e@@\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e3552\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"mi\"\u003e3552\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mi\"\u003e9\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e@@\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ecompiler\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e         if test yes = \u0026#34;\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003ebuild_old_libs\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;; then\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e           if test yes != \u0026#34;\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003epic_mode\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;; then\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            # Don\u0026#39;t build PIC code\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    -       command=\u0026#34;\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003ebase_compile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003eqsrcfile\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003epie_flag\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    +       command=\u0026#34;\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003ebase_compile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003eLT_STATIC_CFLAGS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003eqsrcfile\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003epie_flag\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e           else\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    -       command=\u0026#34;\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003ebase_compile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003eqsrcfile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003epic_flag\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    +       command=\u0026#34;\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003ebase_compile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003eLT_STATIC_CFLAGS\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003eqsrcfile\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003epic_flag\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e           fi\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e           if test yes = \u0026#34;\u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003ecompiler_c_o\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;; then\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e            func_append command \u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eo\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"err\"\u003e$\u003c/span\u003e\u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    ```\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWhat a massive commit message, right?!\u003c/p\u003e\n\u003cp\u003eOviously, I still needed to use all the new features that I had just addeed to the Yices \u003ccode\u003e./configure\u003c/code\u003e. So I proposed a second patch (\u003ca href=\"https://github.com/polazarus/ocamlyices2/commit/ccb5a563\"\u003eccb5a563\u003c/a\u003e) with changes to the ocamlyices2\u0026rsquo;s own \u003ccode\u003e./configure\u003c/code\u003e; that took the form of new flags so that I would be able to build a static \u003ccode\u003elibyices.a\u003c/code\u003e by specifying the static version of the GMP library \u003ccode\u003elibgmp.a\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eI also used the new cross-compilation capability of the Yices \u003ccode\u003e./configure\u003c/code\u003e so that it would be possible to build ocamlyices2 on Windows. The compilation would rely on the POSIX-compliant \u003ca href=\"https://www.cygwin.com/\"\u003eCygwin\u003c/a\u003e suite and cross-compile to a native Win32 executable using \u003ca href=\"http://www.mingw.org/\"\u003eMinGW32\u003c/a\u003e (which a port of GCC).\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eAuthor\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eMaël\u003c/span\u003e \u003cspan class=\"nx\"\u003eValais\u003c/span\u003e \u003cspan class=\"p\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"nx\"\u003emael\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003evalais\u003c/span\u003e\u003cspan class=\"err\"\u003e@\u003c/span\u003e\u003cspan class=\"nx\"\u003egmail\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ecom\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eDate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e   \u003cspan class=\"nx\"\u003eFri\u003c/span\u003e \u003cspan class=\"nx\"\u003eMay\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e \u003cspan class=\"mi\"\u003e16\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e18\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"mi\"\u003e46\u003c/span\u003e \u003cspan class=\"mi\"\u003e2017\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"mo\"\u003e0200\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eCommit\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eccb5a563\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eocamlyices2\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eonly\u003c/span\u003e \u003cspan class=\"nx\"\u003ebuild\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003estatic\u003c/span\u003e \u003cspan class=\"nx\"\u003estub\u003c/span\u003e \u003cspan class=\"nx\"\u003eusing\u003c/span\u003e \u003cspan class=\"nx\"\u003estatic\u003c/span\u003e \u003cspan class=\"nx\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eThe\u003c/span\u003e \u003cspan class=\"nx\"\u003elibrary\u003c/span\u003e \u003cspan class=\"nx\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003ewill\u003c/span\u003e \u003cspan class=\"nx\"\u003ebe\u003c/span\u003e \u003cspan class=\"nx\"\u003esearched\u003c/span\u003e \u003cspan class=\"nx\"\u003ein\u003c/span\u003e \u003cspan class=\"nx\"\u003esystem\u003c/span\u003e \u003cspan class=\"nx\"\u003edirs\u003c/span\u003e \u003cspan class=\"nx\"\u003eor\u003c/span\u003e \u003cspan class=\"nx\"\u003eyou\u003c/span\u003e \u003cspan class=\"nx\"\u003ecan\u003c/span\u003e \u003cspan class=\"nx\"\u003euse\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003eflag\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"nx\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003estatic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003egmp\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003ewhen\u003c/span\u003e \u003cspan class=\"nx\"\u003erunning\u003c/span\u003e \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003econfigure\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003esetting\u003c/span\u003e \u003cspan class=\"nx\"\u003eyour\u003c/span\u003e \u003cspan class=\"nx\"\u003eown\u003c/span\u003e \u003cspan class=\"nx\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e \u003cspan class=\"nx\"\u003eIf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eno\u003c/span\u003e \u003cspan class=\"nx\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003eis\u003c/span\u003e \u003cspan class=\"nx\"\u003efound\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003eshared\u003c/span\u003e \u003cspan class=\"nx\"\u003elibrary\u003c/span\u003e \u003cspan class=\"nx\"\u003eis\u003c/span\u003e \u003cspan class=\"nx\"\u003eused\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e \u003cspan class=\"nx\"\u003eYou\u003c/span\u003e \u003cspan class=\"nx\"\u003ecan\u003c/span\u003e \u003cspan class=\"nx\"\u003eforce\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003euse\u003c/span\u003e \u003cspan class=\"nx\"\u003eof\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eshared\u003c/span\u003e \u003cspan class=\"nx\"\u003egmp\u003c/span\u003e \u003cspan class=\"nx\"\u003elibrary\u003c/span\u003e \u003cspan class=\"nx\"\u003ewith\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"nx\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003eshared\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003egmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eIf\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"nx\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003eshared\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003egmp\u003c/span\u003e \u003cspan class=\"nx\"\u003eis\u003c/span\u003e \u003cspan class=\"nx\"\u003enot\u003c/span\u003e \u003cspan class=\"nx\"\u003egiven\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003ethat\u003c/span\u003e \u003cspan class=\"nx\"\u003ehas\u003c/span\u003e \u003cspan class=\"nx\"\u003ebeen\u003c/span\u003e \u003cspan class=\"nx\"\u003efound\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ewill\u003c/span\u003e \u003cspan class=\"nx\"\u003ebe\u003c/span\u003e \u003cspan class=\"nx\"\u003eincluded\u003c/span\u003e \u003cspan class=\"nx\"\u003ein\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003elist\u003c/span\u003e \u003cspan class=\"nx\"\u003eof\u003c/span\u003e \u003cspan class=\"nx\"\u003einstalled\u003c/span\u003e \u003cspan class=\"nx\"\u003efiles\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e \u003cspan class=\"nx\"\u003eThe\u003c/span\u003e \u003cspan class=\"nx\"\u003ereason\u003c/span\u003e \u003cspan class=\"nx\"\u003eis\u003c/span\u003e \u003cspan class=\"nx\"\u003ebecause\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003ewe\u003c/span\u003e \u003cspan class=\"nx\"\u003ewant\u003c/span\u003e \u003cspan class=\"nx\"\u003eto\u003c/span\u003e \u003cspan class=\"nx\"\u003ebuild\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003eshared\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003egmp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003efree\u003c/span\u003e \u003cspan class=\"nx\"\u003ebinary\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ezarith\u003c/span\u003e \u003cspan class=\"nx\"\u003ewill\u003c/span\u003e \u003cspan class=\"nx\"\u003esometimes\u003c/span\u003e \u003cspan class=\"nx\"\u003epick\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eshared\u003c/span\u003e \u003cspan class=\"nf\"\u003elibrary\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ewith\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003elgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eover\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003estatic\u003c/span\u003e \u003cspan class=\"nx\"\u003elbirary\u003c/span\u003e \u003cspan class=\"nx\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eIncluding\u003c/span\u003e \u003cspan class=\"nx\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003ein\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003edistribution\u003c/span\u003e \u003cspan class=\"nx\"\u003eof\u003c/span\u003e \u003cspan class=\"nx\"\u003eocamlyices2\u003c/span\u003e \u003cspan class=\"nx\"\u003eis\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003econvenience\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ecreating\u003c/span\u003e \u003cspan class=\"nx\"\u003egmp\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003eshared\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003efree\u003c/span\u003e \u003cspan class=\"nx\"\u003ebinaries\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eWhy\u003c/span\u003e \u003cspan class=\"nx\"\u003edo\u003c/span\u003e \u003cspan class=\"nx\"\u003ewe\u003c/span\u003e \u003cspan class=\"nx\"\u003eprefer\u003c/span\u003e \u003cspan class=\"nx\"\u003eusing\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003estatic\u003c/span\u003e \u003cspan class=\"nx\"\u003eversion\u003c/span\u003e \u003cspan class=\"nx\"\u003eof\u003c/span\u003e \u003cspan class=\"nx\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"err\"\u003e?\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e==================================================\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eThis\u003c/span\u003e \u003cspan class=\"nx\"\u003eis\u003c/span\u003e \u003cspan class=\"nx\"\u003ebecause\u003c/span\u003e \u003cspan class=\"nx\"\u003ewe\u003c/span\u003e \u003cspan class=\"nx\"\u003ebuild\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003enon\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003ePIC\u003c/span\u003e \u003cspan class=\"nx\"\u003estatic\u003c/span\u003e \u003cspan class=\"nx\"\u003eversion\u003c/span\u003e \u003cspan class=\"nx\"\u003eof\u003c/span\u003e \u003cspan class=\"nx\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e \u003cspan class=\"nx\"\u003eIf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ewe\u003c/span\u003e \u003cspan class=\"nx\"\u003ewanted\u003c/span\u003e \u003cspan class=\"nx\"\u003eto\u003c/span\u003e \u003cspan class=\"nx\"\u003ebuild\u003c/span\u003e \u003cspan class=\"nx\"\u003eboth\u003c/span\u003e \u003cspan class=\"nx\"\u003estatic\u003c/span\u003e \u003cspan class=\"nx\"\u003eand\u003c/span\u003e \u003cspan class=\"nx\"\u003eshared\u003c/span\u003e \u003cspan class=\"nx\"\u003estubs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ewe\u003c/span\u003e \u003cspan class=\"nx\"\u003eshould\u003c/span\u003e \u003cspan class=\"nx\"\u003eeither\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nx\"\u003ebuild\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003ePIC\u003c/span\u003e \u003cspan class=\"nx\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003ebut\u003c/span\u003e \u003cspan class=\"nx\"\u003eit\u003c/span\u003e \u003cspan class=\"nx\"\u003ewould\u003c/span\u003e \u003cspan class=\"nx\"\u003econflict\u003c/span\u003e \u003cspan class=\"nx\"\u003ewith\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003enon\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003ePIC\u003c/span\u003e \u003cspan class=\"nx\"\u003eone\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e-\u003c/span\u003e \u003cspan class=\"nx\"\u003ebuild\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003eshared\u003c/span\u003e \u003cspan class=\"nx\"\u003elibrary\u003c/span\u003e \u003cspan class=\"nx\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eso\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eFor\u003c/span\u003e \u003cspan class=\"nx\"\u003enow\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eI\u003c/span\u003e \u003cspan class=\"nx\"\u003echose\u003c/span\u003e \u003cspan class=\"nx\"\u003eto\u003c/span\u003e \u003cspan class=\"nx\"\u003ejust\u003c/span\u003e \u003cspan class=\"nx\"\u003eskip\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003eshared\u003c/span\u003e \u003cspan class=\"nf\"\u003estubs\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003edllyices2_stubs\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eso\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eAlso\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003eturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eon\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nf\"\u003efPIC\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ein\u003c/span\u003e \u003cspan class=\"nx\"\u003econfigure\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eac\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eonly\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003enon\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003estatic\u003c/span\u003e \u003cspan class=\"nx\"\u003egmp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003eadded\u003c/span\u003e \u003cspan class=\"nx\"\u003ea\u003c/span\u003e \u003cspan class=\"nx\"\u003eway\u003c/span\u003e \u003cspan class=\"nx\"\u003eto\u003c/span\u003e \u003cspan class=\"nx\"\u003elink\u003c/span\u003e \u003cspan class=\"nx\"\u003estatically\u003c/span\u003e \u003cspan class=\"nx\"\u003eto\u003c/span\u003e \u003cspan class=\"nx\"\u003elibgmp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ea\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"nx\"\u003ewith\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003estatic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003egmp\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003euse\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e \u003cspan class=\"nx\"\u003einstead\u003c/span\u003e \u003cspan class=\"nx\"\u003eof\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003eI\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003elib\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ecompiling\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e \u003cspan class=\"nx\"\u003ein\u003c/span\u003e \u003cspan class=\"nx\"\u003eocamlc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eThis\u003c/span\u003e \u003cspan class=\"nx\"\u003eoption\u003c/span\u003e \u003cspan class=\"nx\"\u003euses\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003echange\u003c/span\u003e \u003cspan class=\"nx\"\u003eI\u003c/span\u003e \u003cspan class=\"nx\"\u003emade\u003c/span\u003e \u003cspan class=\"nx\"\u003eto\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003ebuild\u003c/span\u003e \u003cspan class=\"nx\"\u003esystem\u003c/span\u003e \u003cspan class=\"nx\"\u003eof\u003c/span\u003e \u003cspan class=\"nx\"\u003elibyices\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eWhy\u003c/span\u003e\u003cspan class=\"err\"\u003e?\u003c/span\u003e \u003cspan class=\"nx\"\u003eBecause\u003c/span\u003e \u003cspan class=\"nx\"\u003eI\u003c/span\u003e \u003cspan class=\"nx\"\u003ewant\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003epossibility\u003c/span\u003e \u003cspan class=\"nx\"\u003eof\u003c/span\u003e \u003cspan class=\"nx\"\u003eproducing\u003c/span\u003e \u003cspan class=\"nx\"\u003ebinaries\u003c/span\u003e \u003cspan class=\"nx\"\u003ethat\u003c/span\u003e \u003cspan class=\"nx\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003enot\u003c/span\u003e \u003cspan class=\"nx\"\u003eneed\u003c/span\u003e \u003cspan class=\"kt\"\u003eany\u003c/span\u003e \u003cspan class=\"nx\"\u003edll\u003c/span\u003e \u003cspan class=\"nx\"\u003ealongside\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eGuess\u003c/span\u003e \u003cspan class=\"nx\"\u003ethe\u003c/span\u003e \u003cspan class=\"nx\"\u003ehost\u003c/span\u003e \u003cspan class=\"nx\"\u003esystem\u003c/span\u003e \u003cspan class=\"nx\"\u003eand\u003c/span\u003e \u003cspan class=\"nx\"\u003epass\u003c/span\u003e \u003cspan class=\"nx\"\u003eit\u003c/span\u003e \u003cspan class=\"nx\"\u003eto\u003c/span\u003e \u003cspan class=\"nx\"\u003elibyices\u003c/span\u003e \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003econfigure\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e========================================================\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eIt\u003c/span\u003e \u003cspan class=\"nx\"\u003eis\u003c/span\u003e \u003cspan class=\"nx\"\u003enow\u003c/span\u003e \u003cspan class=\"nx\"\u003epossible\u003c/span\u003e \u003cspan class=\"nx\"\u003eto\u003c/span\u003e \u003cspan class=\"nx\"\u003euse\u003c/span\u003e \u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003econfigure\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003emingw32\u003c/span\u003e \u003cspan class=\"nx\"\u003ecross\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"nx\"\u003ecompilation\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA month past and I soon realized that GMP was not embedded at all in \u003ccode\u003elibyices.a\u003c/code\u003e. I could see the symbols as undefined (\u003ccode\u003eU\u003c/code\u003e) when running \u003ccode\u003enm libyices.a\u003c/code\u003e. It took me a while to figure this out\u0026hellip; back to tweaking the fragile Yices \u003ccode\u003e./configure\u003c/code\u003e!\u003c/p\u003e\n\u003cp\u003eAlong the way, I also realized how different Linux distributions are. Arch Linux is notably lacking support for partial linking (\u003ccode\u003eld -r\u003c/code\u003e). Which meant I had to add a flag for this specific purpose in commit \u003ca href=\"https://github.com/polazarus/ocamlyices2/commit/38200b0a\"\u003e38200b0a\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAuthor: Maël Valais \u0026lt;mael.valais@gmail.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eDate:   Fri Jun 16 21:18:37 2017 +0200\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCommit: 38200b0a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    libyices: added option --without-gmp-embedded\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    This option will disable the partial linking that allows to embed\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    GMP into libyices.a (only with --enable-static).\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    For example, on Arch linux, the partial linking command\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ld -r -lgmp *.o -o libyices.o\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    would fail even if libgmp.so is correclty installed. It seems that \u0026#39;ld -r\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    would only work with a static libgmp.a (but the arch linux repo only installs\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    the shared gmp library).\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Why this `ld -r`? This command is the only way I found to compile a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    static libyices.a from either a shared or a static libgmp and produce\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    a gmp-depend-free libyices.a.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Two solutions:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    1. Drop the necessity for building a libyices.a free of gmp dependency.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       In this case, I could remove the `ld -r`.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       It would then create a libyices.a that depends on libgmp.a/so.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    2. Separate the gmp-dependency-free libyices.a from the normal\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       gmp-dependent libyices.a. For example, I could use the option\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       `--without-gmp-embedded`\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    So I went with solution (2).\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    This option disables the embedding of GMP inside libyices.a. This\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u0026#39;embedding\u0026#39; is made using partial linking (ld -r) which seems to\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    be failing on Arch Linux when using the shared GMP library.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAlthough I had already added a check (\u003ccode\u003eCSL_CHECK_STATIC_GMP_HAS_PIC\u003c/code\u003e in \u003ca href=\"https://github.com/polazarus/ocamlyices2/commit/25f5eb15\"\u003e25f5eb15\u003c/a\u003e) to make sure that the user-provided libgmp was PIC when using \u003ccode\u003e--with-pic\u003c/code\u003e, I realized that it was trickier that what I thought in \u003ca href=\"https://github.com/polazarus/ocamlyices2/commit/55c8e92a\"\u003e55c8e92a\u003c/a\u003e\u0026hellip;\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAuthor: Maël Valais \u0026lt;mael.valais@gmail.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eDate:   Sat Jun 17 14:09:12 2017 +0200\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCommit: 55c8e92a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    libyices: with --enable-static and --with-pic, enforce PIC libgmp.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    One problem I came across was that most of the time, when I was doing\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ./configure --enable-static --with-pic\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    the produced libyices.a would still contain non-PIC libgmp.a, although\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    being itself PIC. In this commit, I enforce that if --with-pic is given,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    then:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    1) either --with-pic-gmp has been given, in this case we use that for\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       creating the PIC libyices.a;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    2) or --with-pic-gmp has not been given and thus we try to simply use the\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e       shared gmp through -lgmp.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Reminder: we also check that the system libgmp.a or the libgmp.a given with\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    --with-static-gmp is PIC. If it is the case, the PIC libgmp.a will be used\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    for --with-pic.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, I also had to fix ocamlyices2\u0026rsquo;s \u003ccode\u003e./configure\u003c/code\u003e since \u003ccode\u003eld -r\u003c/code\u003e (partial linking) was not supported on Arch Linux (see [PR\u0026rsquo;s CI failure](pull request](\u003ca href=\"https://github.com/ocaml/opam-repository/pull/9086)\"\u003ehttps://github.com/ocaml/opam-repository/pull/9086)\u003c/a\u003e. I remember waiting for hours for the CI to run on all imaginable systems: Debian, Ubuntu, Suse, Arch Linux, Alpine, CentOS, Fedora, macOS and Windows\u0026hellip;\u003c/p\u003e\n\u003cp\u003eCommits \u003ca href=\"https://github.com/polazarus/ocamlyices2/commit/df7c89a1\"\u003edf7c89a1\u003c/a\u003e and \u003ca href=\"https://github.com/polazarus/ocamlyices2/commit/70dc5de5\"\u003e70dc5de5\u003c/a\u003e) fix the partial linking issue on Arch Linux:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAuthor: Maël Valais \u0026lt;mael.valais@gmail.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eDate:   Sat Jun 17 16:52:59 2017 +0200\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCommit: df7c89a1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    ocamlyices2: added --with-libyices and --with-libyices-include-dir\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    These options allow to give your own libyices.a and the include directory\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    where the libyices headers are.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAuthor: Maël Valais \u0026lt;mael.valais@gmail.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eDate:   Sat Jun 17 17:01:58 2017 +0200\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCommit: 70dc5de5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    ocamlyices2: use --without-gmp-embedded by default\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    After giving it some thoughts, the need for having a self-contained libyices.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    (which would only need -lyices, no -lgmp needed) in ocamlyices2 is pointless\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    as \u0026#39;zarith\u0026#39; will still need \u0026#39;-lgmp\u0026#39; anyway.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    The Makefile will still put libgmp.a and libyices.a inside src/ so that\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    the static version of gmp is used (with -L.) instead of the shared version.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Rationale: disabling the partial linking fixes the build on Arch Linux, which\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    (I re-tested on a docker image) cannot accept partial linking with -lgmp when\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    only libgmp.so is available. Here is the failing command:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        ld -r *.o -lgmp -o libyices.o\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"final-result-of-the-yices2-build-system\"\u003eFinal result of the Yices2 build system\u003c/h2\u003e\n\u003cp\u003eThe experience with the re-written \u003ccode\u003e./configure\u003c/code\u003e (\u003ca href=\"https://github.com/polazarus/ocamlyices2/tree/master/ext/yices\"\u003ehere\u003c/a\u003e) is very different from the original one. When the user wants to compile the library with PIC, they get a warning if one of the dependencies is not PIC. There is a much finer control over what the user wants: dynamic vs. static, PIC vs. non-PIC. But also more control over dependencies like GMP, since the user must be able to pass a static or dynamic version of libgmp.\u003c/p\u003e\n\u003cp\u003eThe \u003ccode\u003e./configure\u003c/code\u003e that you can see \u003ca href=\"https://github.com/polazarus/ocamlyices2/tree/master/ext/yices\"\u003ehere\u003c/a\u003e gained many features like \u003ccode\u003e--with-shared-gmp\u003c/code\u003e or \u003ccode\u003e--with-pic\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% ./configure --help\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sb\"\u003e`\u003c/span\u003econfigure\u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003e configures Yices 2.5.2 to adapt to many kinds of systems.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eUsage: ./configure \u003cspan class=\"o\"\u003e[\u003c/span\u003eOPTION\u003cspan class=\"o\"\u003e]\u003c/span\u003e... \u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003eVAR\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eVALUE\u003cspan class=\"o\"\u003e]\u003c/span\u003e...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSystem types:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --build\u003cspan class=\"o\"\u003e=\u003c/span\u003eBUILD     configure \u003cspan class=\"k\"\u003efor\u003c/span\u003e building on BUILD \u003cspan class=\"o\"\u003e[\u003c/span\u003eguessed\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --host\u003cspan class=\"o\"\u003e=\u003c/span\u003eHOST       cross-compile to build programs to run on HOST \u003cspan class=\"o\"\u003e[\u003c/span\u003eBUILD\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOptional Features:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --enable-shared\u003cspan class=\"o\"\u003e[=\u003c/span\u003ePKGS\u003cspan class=\"o\"\u003e]\u003c/span\u003e  build shared libraries \u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003edefault\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eyes\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --enable-static\u003cspan class=\"o\"\u003e[=\u003c/span\u003ePKGS\u003cspan class=\"o\"\u003e]\u003c/span\u003e  build static libraries \u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003edefault\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eyes\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --disable-libtool-lock  avoid locking \u003cspan class=\"o\"\u003e(\u003c/span\u003emight \u003cspan class=\"nb\"\u003ebreak\u003c/span\u003e parallel builds\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --enable-mcsat          Enable support \u003cspan class=\"k\"\u003efor\u003c/span\u003e MCSAT. This requires the libpoly\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          library.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOptional Packages:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-pic\u003cspan class=\"o\"\u003e[=\u003c/span\u003ePKGS\u003cspan class=\"o\"\u003e]\u003c/span\u003e       try to use only PIC/non-PIC objects \u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"nv\"\u003edefault\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003euse\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          both\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-static-gmp\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;path\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          Full path to a static GMP library \u003cspan class=\"o\"\u003e(\u003c/span\u003ee.g., libgmp.a\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-static-gmp-include-dir\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;directory\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          Directory of include file \u003cspan class=\"s2\"\u003e\u0026#34;gmp.h\u0026#34;\u003c/span\u003e compatible with\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          static GMP library\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-pic-gmp\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;path\u0026gt;   Full path to a relocatable GMP library \u003cspan class=\"o\"\u003e(\u003c/span\u003ee.g.,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          libgmp.a\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-pic-gmp-include-dir\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;directory\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          Directory of include file \u003cspan class=\"s2\"\u003e\u0026#34;gmp.h\u0026#34;\u003c/span\u003e compatible with\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          relocatable GMP library\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-static-libpoly\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;path\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          Full path to libpoly.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-static-libpoly-include-dir\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;directory\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          Path to include files compatible with libpoly.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          \u003cspan class=\"o\"\u003e(\u003c/span\u003ee.g., /usr/local/include\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-pic-libpoly\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;path\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          Full path to a relocatable libpoly.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-pic-libpoly-include-dir\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026lt;directory\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          Path to include files compatible with the\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          relocatable libpoly.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-shared-gmp       By default, a static version of the GMP library will\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          be searched. This option forces the use of the\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          shared version. This applies \u003cspan class=\"k\"\u003efor\u003c/span\u003e both shared and\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          static libraries.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --without-gmp-embedded  \u003cspan class=\"o\"\u003e(\u003c/span\u003eOnly when --enable-static\u003cspan class=\"o\"\u003e)\u003c/span\u003e By default, the static\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          library libyices.a created will be partially linked\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          \u003cspan class=\"o\"\u003e(\u003c/span\u003eld -r\u003cspan class=\"o\"\u003e)\u003c/span\u003e so that the GMP library is not needed\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          afterwards \u003cspan class=\"o\"\u003e(\u003c/span\u003ei.e., only -lyices is needed\u003cspan class=\"o\"\u003e)\u003c/span\u003e. If you\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          want to disable the partial linking \u003cspan class=\"o\"\u003e(\u003c/span\u003eand thus -lgmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          and -lyices will be needed\u003cspan class=\"o\"\u003e)\u003c/span\u003e, you can use this flag.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-mode\u003cspan class=\"o\"\u003e=\u003c/span\u003eMODE        The mode used during compilation/distribution. It\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          can be one of release, debug, devel, profile, gcov,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          valgrind, purify, quantify or gperftools. \u003cspan class=\"o\"\u003e(\u003c/span\u003edefault:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          release\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  --with-static-name\u003cspan class=\"o\"\u003e=\u003c/span\u003ename \u003cspan class=\"o\"\u003e(\u003c/span\u003eWindows only\u003cspan class=\"o\"\u003e)\u003c/span\u003e when building simultanously shared\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          and static libraries, allows you to give a different\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                          name \u003cspan class=\"k\"\u003efor\u003c/span\u003e the static version of libyices.a.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eI also added a ton of diagnostic information that appears at the end of \u003ccode\u003e./configure\u003c/code\u003e. That\u0026rsquo;s very useful when you want to make sure that \u003ccode\u003e./configure\u003c/code\u003e has picked up the right version of \u003ccode\u003elibgmp\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econfigure: Summary of the configuration:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEXEEXT:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSED:                        /usr/bin/sed\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eLN_S:                       ln -s\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eMKDIR_P:                    /usr/local/opt/coreutils/libexec/gnubin/mkdir -p\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCC:                         gcc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eLD:                         /Library/Developer/CommandLineTools/usr/bin/ld\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAR:                         ar\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eRANLIB:                     ranlib\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSTRIP:                      strip\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eGPERF:                      gperf\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNO_STACK_PROTECTOR:         -fno-stack-protector\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSTATIC_GMP:                 /usr/local/lib/libgmp.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSTATIC_GMP_INCLUDE_DIR:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePIC_GMP:                    /usr/local/lib/libgmp.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePIC_GMP_INCLUDE_DIR:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eENABLE_MCSAT:               no\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSTATIC_LIBPOLY:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSTATIC_LIBPOLY_INCLUDE_DIR:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePIC_LIBPOLY:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePIC_LIBPOLY_INCLUDE_DIR:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eVersion:                    Yices 2.5.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost type:                  x86_64-apple-darwin19.4.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eInstall prefix:             /Users/mvalais/code/ocamlyices2/ext/yices\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBuild mode:                 release\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eFor both static and shared library:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  CPPFLAGS:                  -DMACOSX -DNDEBUG\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  CFLAGS:                    -fvisibility=hidden -Wall -Wredundant-decls -O3 -fomit-frame-pointer -fno-stack-protector\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  LDFLAGS:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eFor static library          libyices.a:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Enable:                   yes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  STATIC_CPPFLAGS:           -DYICES_STATIC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  STATIC_LIBS:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Libgmp.a found:           yes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Libgmp.a path:            /usr/local/lib/libgmp.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Libgmp.a is pic:          yes     (non-PIC is faster for the static library)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  PIC mode for libyices.a:  default\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Use shared gmp instead of libgmp.a:  no\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Embed gmp in libyices.a:  yes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eFor shared library:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Enable:                   yes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  SHARED_CPPFLAGS:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  SHARED_LIBS:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Libgmp.a with PIC found:  yes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Libgmp.a path:            /usr/local/lib/libgmp.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Use shared gmp instead of libgmp.a: no\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA final word about the \u003ccode\u003eMakefile\u003c/code\u003e: since all the build configuration is handled by \u003ccode\u003e./configure\u003c/code\u003e, you don\u0026rsquo;t have to pass any variables at \u003ccode\u003emake\u003c/code\u003e time anymore, which really helps when you need to \u003ccode\u003emake\u003c/code\u003e multiple times in a row and don\u0026rsquo;t want to type the variables every single time.\u003c/p\u003e\n\u003ch2 id=\"inpecting-static-and-dynamic-libraries\"\u003eInpecting static and dynamic libraries\u003c/h2\u003e\n\u003cp\u003eHere are two tips that I learned along the way. First, I very often need to know what libraries an executable is depending on:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# macOS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% otool -L /bin/ls\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/bin/ls:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    /usr/lib/libutil.dylib \u003cspan class=\"o\"\u003e(\u003c/span\u003ecompatibility version 1.0.0, current version 1.0.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    /usr/lib/libncurses.5.4.dylib \u003cspan class=\"o\"\u003e(\u003c/span\u003ecompatibility version 5.4.0, current version 5.4.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    /usr/lib/libSystem.B.dylib \u003cspan class=\"o\"\u003e(\u003c/span\u003ecompatibility version 1.0.0, current version 1281.100.1\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Linux (Alpine Linux 3.9)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eldd /bin/ls\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    /lib/ld-musl-x86_64.so.1 \u003cspan class=\"o\"\u003e(\u003c/span\u003e0x7fc9b2c84000\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    libc.musl-x86_64.so.1 \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; /lib/ld-musl-x86_64.so.1 \u003cspan class=\"o\"\u003e(\u003c/span\u003e0x7fc9b2c84000\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eI also had to dig into the symbols of libraries in order to make sure that static libraries contained all the needed symbols:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nm ext/libyices_pic_no_gmp/lib/libyices.a\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eext/libyices_pic_no_gmp/lib/libyices.a\u003cspan class=\"o\"\u003e(\u003c/span\u003elibyices.o\u003cspan class=\"o\"\u003e)\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e00000000000ef6c0 t _convert_rba_tree\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0000000000049a20 t _convert_simple_value\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e00000000000c2f70 t _convert_term_to_bit\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e00000000000d97e0 t _convert_term_to_conditional\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e0000000000049700\u003c/span\u003e t _convert_term_to_val\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0000000000049b30 t _convert_val\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e00000000000028b0 T _yices_or\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0000000000002fa0 T _yices_or2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0000000000002ca0 T _yices_or3\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e0000000000003480\u003c/span\u003e T _yices_pair\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e000000000002ad30 t _yices_parse\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e0000000000006420\u003c/span\u003e T _yices_parse_bvbin\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e00000000000064b0 T _yices_parse_bvhex\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e0000000000004200\u003c/span\u003e T _yices_parse_float\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e0000000000004180\u003c/span\u003e T _yices_parse_rational\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e000000000000b150 T _yices_parse_term\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e000000000000b090 T _yices_parse_type\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                 U _memcpy\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                 U _memset\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                 U _memset_pattern16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                 U ___error\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e0000000000145280\u003c/span\u003e S ___gmp_0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e000000000017dcf0 D ___gmp_allocate_func\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e00000000001099e0 T ___gmp_assert_fail\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e0000000000109980\u003c/span\u003e T ___gmp_assert_header\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e0000000000145460\u003c/span\u003e S ___gmp_binvert_limb_table\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e000000000014527c S ___gmp_bits_per_limb\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0000000000109a60 T ___gmp_default_allocate\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0000000000109ae0 T ___gmp_default_free\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0000000000109a90 T ___gmp_default_reallocate\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e0000000000145290\u003c/span\u003e S ___gmp_digit_value_tab\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe letter before the symbol is the \u0026ldquo;symbol type\u0026rdquo; (from \u003ccode\u003eman nm\u003c/code\u003e):\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eEach symbol name is preceded by its value (blanks if undefined). This value is followed by one of the following characters, representing the symbol type:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eU = undefined,\u003c/li\u003e\n\u003cli\u003eT (text section symbol),\u003c/li\u003e\n\u003cli\u003eD (data section symbol),\u003c/li\u003e\n\u003cli\u003eS (symbol in a section other than those above).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf the symbol is local (non-external), the symbol\u0026rsquo;s type is instead represented by the corresponding lowercase letter. A lower case u in a dynamic shared library indicates a undefined reference to a private external in another module in the same library.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eFor example, the symbol \u003ccode\u003e_yices_parse_float\u003c/code\u003e is an external symbol, meaning that this symbol isn\u0026rsquo;t static to \u003ccode\u003elibyices.a\u003c/code\u003e. On the other side, \u003ccode\u003e_convert_simple_value\u003c/code\u003e is statically defined (\u003ccode\u003et\u003c/code\u003e).\u003c/p\u003e\n\u003ch2 id=\"contributing-the-new-yices-build-system-to-upstream\"\u003eContributing the new Yices build system to upstream\u003c/h2\u003e\n\u003cp\u003eOn 16 June 2016, I sent an email to Bruno Dutertre, one of the developers at SRI (the company behind the Yices SMT solver). I proposed all these changes with links to the various patches on GitHub. Unfortunately, it didn\u0026rsquo;t work out, and the reason might be that the whole patch was enormous and very hard to review.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHi Maël,\u003c/p\u003e\n\u003cp\u003eThanks for the message and for your efforts. We\u0026rsquo;ll look into your updates.\u003c/p\u003e\n\u003cp\u003eWe know that the Yices build system is unconventional because most of the work is done in the Makefiles rather that in the configure script. There are historical reason for this (and it should be able to build PIC libraries without problems).\u003c/p\u003e\n\u003cp\u003eBy the way, Yices is now open-source (GPL) on github: \u003ca href=\"https://github.com/SRI-CSL/yices2\"\u003ehttps://github.com/SRI-CSL/yices2\u003c/a\u003e. Take a look when you have time,\u003c/p\u003e\n\u003cp\u003eThanks again,\u003c/p\u003e\n\u003cp\u003eBruno\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eI wish we had a unit-test framework for \u003ccode\u003eautoconf\u003c/code\u003e. The \u003ccode\u003eautoconf\u003c/code\u003e ecosystem generates very fragile scripts and the only way to test them is to run them with all possible flag combinations, which is pretty much impossible.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eUpdate 31 May 2020\u003c/strong\u003e: added the ascii \u0026ldquo;dependency\u0026rdquo; diagram to give a better sense of what the challenge was.\u003c/li\u003e\n\u003c/ul\u003e\n","date":1590864306,"description":"Dynamic libraries and PIC (position-independant code) are great features of modern systems. But trying to get the right library built can become a nightmare as soon as you rely on other libraries that may or may not have these features in the first place... In this post, I detail the hacks I made to the ./configure-based build system of Yices, a C++ library.","dir":"2020/static-libraries-and-autoconf-hell/","expirydate":-62135596800,"fuzzywordcount":4400,"images":["static-libraries-and-autoconf-hell/cover-static-libraries-and-autoconf-hell.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1590864306,"objectID":"0afb4ba2379c97d4fb25446e2d083476","permalink":"https://maelvls.dev/do-not-share-yet/static-libraries-and-autoconf-hell/","publishdate":"2020-05-30T20:45:06+02:00","readingtime":21,"relpermalink":"/do-not-share-yet/static-libraries-and-autoconf-hell/","section":"2020","summary":"\u003cp\u003eBetween May and June 2016, I worked with \u003ca href=\"https://github.com/polazarus/ocamlyices\"\u003eocamlyices2\u003c/a\u003e, an OCaml package that binds to the \u003ca href=\"https://github.com/SRI-CSL/yices2\"\u003eYices\u003c/a\u003e C++ library. Both projects (as well as many Linux projects) are built using the \u0026ldquo;Autotools\u0026rdquo; suite.\u003c/p\u003e\n\u003cp\u003eThe Autotools suite includes tools like \u003ca href=\"https://www.gnu.org/software/autoconf/\"\u003eautoconf\u003c/a\u003e, \u003ca href=\"https://www.gnu.org/software/automake\"\u003eautomake\u003c/a\u003e and \u003ca href=\"https://www.gnu.org/software/libtool/\"\u003elibtool\u003c/a\u003e. These tools generate a bunch of shell scripts and Makefiles using shell scripts and the \u003ca href=\"https://en.wikipedia.org/wiki/M4_(computer_language)\"\u003eM4\u003c/a\u003e macro language. The user of your projects ends up two simple commands to build your project:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e./configure\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eWhy did I bother with this? As part of my PhD, I worked on a tool, \u003ca href=\"https://github.com/touist/touist\"\u003etouist\u003c/a\u003e, which uses SMT solvers like Yices. The \u003ccode\u003etouist\u003c/code\u003e CLI was written in OCaml (a popular language among academics, including my supervisor), which meant I had to go through hoops to interoperate with C/C++ solvers like Yices.\u003c/p\u003e","tags":["autotools","c++","c","ocaml"],"title":"Epic journey with statically and dynamically-linked libraries (.a, .so)","type":"2020","url":"https://maelvls.dev/do-not-share-yet/static-libraries-and-autoconf-hell/","weight":0,"wordcount":4349},{"authors":null,"categories":null,"content":"","date":1590864306,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1590864306,"objectID":"https://maelvls.dev/do-not-share-yet/tags/ocaml/","permalink":"https://maelvls.dev/do-not-share-yet/tags/ocaml/","publishdate":"2020-05-30T20:45:06+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/ocaml/","section":"tags","summary":"","tags":null,"title":"Ocaml","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/ocaml/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003ch1 id=\"map-vs-discriminative-arrays-map-key---discriminative-name\"\u003eMap vs. discriminative arrays (map key -\u0026gt; discriminative name)\u003c/h1\u003e\n\u003cp\u003eFrom \u003ccode\u003edocker inspect\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;Networks\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026#34;bridge\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nt\"\u003e\u0026#34;IPAddress\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;172.17.0.2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026#34;kind\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nt\"\u003e\u0026#34;IPAddress\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;172.18.0.2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eversus:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"err\"\u003eNetworks:\u003c/span\u003e \u003cspan class=\"err\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"err\"\u003eName:\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026#34;bridge\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"err\"\u003eIPAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;172.17.0.2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"err\"\u003eName:\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026#34;kind\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"err\"\u003eIPAddress:\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026#34;172.18.0.2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"err\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch1 id=\"polymorphic-vs-discriminative-array-polymorphic-object---discriminative-type\"\u003ePolymorphic vs. discriminative array (polymorphic object -\u0026gt; discriminative type)\u003c/h1\u003e\n\u003cp\u003eFrom the \u003ca href=\"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#loadbalanceringress-v1-core\"\u003eService\u003c/a\u003e type in Kubernetes:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eloadBalancer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eingress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003eip\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e35.67.89.10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003eip\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e35.67.89.11\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003enginx-test.gcp-1.helix.engineering\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIt is confusing: can we have an object with both \u0026ldquo;ip\u0026rdquo; and \u0026ldquo;hostname\u0026rdquo; set? The answer is no: the \u003ccode\u003ekubectl describe\u003c/code\u003e code \u003ca href=\"https://github.com/kubernetes/kubectl/blob/9effcd79b3974fde2098571dfd3d0446f0c86d78/pkg/describe/describe.go#L4907-L4911\"\u003ehere\u003c/a\u003e makes it clear that \u0026ldquo;ip\u0026rdquo; and \u0026ldquo;hostname\u0026rdquo; are mutually exclusive.\u003c/p\u003e\n\u003cp\u003eUsing a discriminative \u0026ldquo;type\u0026rdquo; field helps:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eloadBalancer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eingress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eip\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"nt\"\u003eaddress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e35.67.89.10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eip\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"nt\"\u003eaddress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e35.67.89.11\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehostname\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"nt\"\u003eaddress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003enginx-test.gcp-1.helix.engineering\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1590734136,"description":"","dir":"2020/weird-api-choices/","expirydate":-62135596800,"fuzzywordcount":200,"images":["weird-api-choices/cover-weird-api-choices.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1590734136,"objectID":"a352e98b54986e272f9ffb88c023dc6e","permalink":"https://maelvls.dev/do-not-share-yet/weird-api-choices/","publishdate":"2020-05-29T08:35:36+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/weird-api-choices/","section":"2020","summary":"\u003ch1 id=\"map-vs-discriminative-arrays-map-key---discriminative-name\"\u003eMap vs. discriminative arrays (map key -\u0026gt; discriminative name)\u003c/h1\u003e\n\u003cp\u003eFrom \u003ccode\u003edocker inspect\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;Networks\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026#34;bridge\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nt\"\u003e\u0026#34;IPAddress\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;172.17.0.2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026#34;kind\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      \u003cspan class=\"nt\"\u003e\u0026#34;IPAddress\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;172.18.0.2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eversus:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"err\"\u003eNetworks:\u003c/span\u003e \u003cspan class=\"err\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"err\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"err\"\u003eName:\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026#34;bridge\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"err\"\u003eIPAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;172.17.0.2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"err\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"err\"\u003eName:\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026#34;kind\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"err\"\u003eIPAddress:\u003c/span\u003e \u003cspan class=\"nt\"\u003e\u0026#34;172.18.0.2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"err\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch1 id=\"polymorphic-vs-discriminative-array-polymorphic-object---discriminative-type\"\u003ePolymorphic vs. discriminative array (polymorphic object -\u0026gt; discriminative type)\u003c/h1\u003e\n\u003cp\u003eFrom the \u003ca href=\"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.18/#loadbalanceringress-v1-core\"\u003eService\u003c/a\u003e type in Kubernetes:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eloadBalancer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eingress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003eip\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e35.67.89.10\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003eip\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e35.67.89.11\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003ehostname\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003enginx-test.gcp-1.helix.engineering\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIt is confusing: can we have an object with both \u0026ldquo;ip\u0026rdquo; and \u0026ldquo;hostname\u0026rdquo; set? The answer is no: the \u003ccode\u003ekubectl describe\u003c/code\u003e code \u003ca href=\"https://github.com/kubernetes/kubectl/blob/9effcd79b3974fde2098571dfd3d0446f0c86d78/pkg/describe/describe.go#L4907-L4911\"\u003ehere\u003c/a\u003e makes it clear that \u0026ldquo;ip\u0026rdquo; and \u0026ldquo;hostname\u0026rdquo; are mutually exclusive.\u003c/p\u003e","tags":[],"title":"Weird Api Choices","type":"2020","url":"https://maelvls.dev/do-not-share-yet/weird-api-choices/","weight":0,"wordcount":129},{"authors":null,"categories":null,"content":"\u003cp\u003eA common way of sharing terraform modules is to move them in a separate repo. And for companies, that means a private repo. When \u003ccode\u003eterraform init\u003c/code\u003e is run, the terraform module is fetched and if this module is stored on a Github private repo, you will need to work around the authentication.\u003c/p\u003e\n\u003cp\u003eImagine that these shared modules are stored on the private Github repo \u0026ldquo;github.com/your-org/terraform-modules\u0026rdquo;. Importing this module from a different repo would look something like:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-hcl\" data-lang=\"hcl\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003emodule\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;some_instance_of_this_module\u0026#34;\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e  source\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003e \u0026#34;git@github.com:your-org/terraform-modules.git//path/to/module?ref\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003emaster\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUsing \u003ccode\u003egit+ssh\u003c/code\u003e as a way of fetching this private module will work great locally since you might probably have a private key that Github knows about. Locally, \u003ccode\u003eterraform init\u003c/code\u003e will work.\u003c/p\u003e\n\u003cp\u003eBut what about CI, should I create a key pair and store the private key as a secret and have the public key known by Github (or Gitlab)?\u003c/p\u003e\n\u003cp\u003eUsing SSH key pairs is not ideal. The key pair is tied to an individual and can\u0026rsquo;t be linked to a Github App like \u003ccode\u003egithub-bot\u003c/code\u003e. Plus, the key pair mechanism doesn\u0026rsquo;t offer access to a specific repo, which means all your company\u0026rsquo;s repositories are exposed. And finally, some companies do not have port 22 open for security reasons, which means \u003ccode\u003egit+https\u003c/code\u003e is their only option.\u003c/p\u003e\n\u003cp\u003eTo use https instead of ssh, we start by changing the way we import these modules:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-diff\" data-lang=\"diff\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e module \u0026#34;some_instance_of_this_module\u0026#34; {\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-   source = \u0026#34;git@github.com:your-org/terraform-modules.git//path/to/module?ref=master\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e\u003c/span\u003e\u003cspan class=\"gi\"\u003e+   source = \u0026#34;git::https://github.com/your-org/terraform-modules.git//path/to/module?ref=master\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e\u003c/span\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"local-development--git-over-https\"\u003eLocal development \u0026amp; git over https\u003c/h2\u003e\n\u003cp\u003eLocally, you will have to make sure you can \u003ccode\u003egit clone\u003c/code\u003e this private repo, for example, the following should work:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clone https://github.com/your-org/terraform-modules.git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIf it doesn\u0026rsquo;t work, Github has a helpful page \u0026ldquo;\u003ca href=\"https://help.github.com/en/github/using-git/caching-your-github-password-in-git\"\u003eCaching your GitHub password in Git\u003c/a\u003e\u0026rdquo;.\u003c/p\u003e\n\u003ch2 id=\"continous-integration--git-over-https\"\u003eContinous integration \u0026amp; git over HTTPS\u003c/h2\u003e\n\u003cp\u003eIt is a bit trickier to get HTTPS working on the CI. In the following, I\u0026rsquo;ll take the example of Github Actions but that will work for any CI provider. There are two main solutions:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eusing \u003ccode\u003eurl.insteadof\u003c/code\u003e,\u003c/li\u003e\n\u003cli\u003eor using \u003ccode\u003ecredential.helper\u003c/code\u003e.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eFor both options, you will need a PAT (personal access token) linked your own account. I refer to this token as \u003ccode\u003eGH_TOKEN\u003c/code\u003e. To create a PAT, you can go \u003ca href=\"https://github.com/settings/tokens\"\u003eto your Github settings\u003c/a\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e⚠️ NOTE: around April 2020, Github decided to prevent users from using Github Secrets names that begin with \u003ccode\u003eGITHUB_\u003c/code\u003e. We used to use the name \u003ccode\u003eGITHUB_PAT\u003c/code\u003e frequently in Github Actions readmes, I guess we will all have to update everything!\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"solution-1-urlinsteadof\"\u003eSolution 1: \u003ccode\u003eurl.insteadof\u003c/code\u003e\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eactions/checkout@v2 sets the \u0026lsquo;Authorization\u0026rsquo; for any git command issued from the checked out repo. But since this uses the Github Actions \u003ccode\u003eGITHUB_TOKEN\u003c/code\u003e which is limited to the current repository. And since we want to access another private repo, we have to disable that.\u003c/li\u003e\n\u003cli\u003einstead, you can use \u003ccode\u003egit config --global url.insteadof\u003c/code\u003e. The \u003ccode\u003eGH_TOKEN\u003c/code\u003e Github Secret is a \u003ca href=\"https://github.com/settings/tokens\"\u003eGithub personal token\u003c/a\u003e that has the \u0026lsquo;repo\u0026rsquo; scope (full control of private repositories).\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNote: when using git over https with a token on \u003ccode\u003ehttps://github.com\u003c/code\u003e, the username doesn\u0026rsquo;t matter, that\u0026rsquo;s why we put \u003ccode\u003efoo\u003c/code\u003e here.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- \u003cspan class=\"nt\"\u003erun\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e\u003cspan class=\"sd\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e    git config --local --remove-section http.\u0026#34;https://github.com/\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e    git config --global url.\u0026#34;https://foo:${GH_TOKEN}@github.com/your-org\u0026#34;.insteadOf \u0026#34;https://github.com/your-org\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eGH_TOKEN\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e${{ secrets.GH_TOKEN }}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"solution-2-credentialhelper\"\u003eSolution 2: \u003ccode\u003ecredential.helper\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003eWhen \u003ccode\u003egit config url.insteadof\u003c/code\u003e does not work, you can try using \u003ccode\u003egit credential.helper\u003c/code\u003e instead. For example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- \u003cspan class=\"nt\"\u003erun\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e\u003cspan class=\"sd\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e    cat \u0026lt;\u0026lt;EOF \u0026gt; creds\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e      #!/bin/sh\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e      echo protocol=https\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e      echo host=github.com\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e      echo username=foo\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e      echo password=${GH_TOKEN}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e    EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e    sudo install creds /usr/local/bin/creds\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"sd\"\u003e    git config --global credential.helper \u0026#34;creds\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eenv\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eGH_TOKEN\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003e${{ secrets.GH_TOKEN }}\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"solution-2-bis-credentialhelper-with-a-github-action\"\u003eSolution 2 bis: \u003ccode\u003ecredential.helper\u003c/code\u003e with a Github Action\u003c/h3\u003e\n\u003cp\u003eSame as solution 2 but wrapped in a neat Github Action \u003ca href=\"https://github.com/marketplace/actions/setup-git-credentials\"\u003esetup-git-credentials\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThis action stores the credentials in the file \u003ccode\u003e$XDG_CONFIG_HOME/git/credentials\u003c/code\u003e and configures git to use it by calling:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global credential.helper store/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe actions also makes sure all \u003ccode\u003essh\u003c/code\u003e calls are rewritten to \u003ccode\u003ehttps\u003c/code\u003e. The \u0026lsquo;credentials\u0026rsquo; field must be of the form \u003ca href=\"https://foo:$GH_TOKEN@github.com/\"\u003ehttps://foo:$GH_TOKEN@github.com/\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- \u003cspan class=\"nt\"\u003euses\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003efusion-engineering/setup-git-credentials@v2\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ewith\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003ecredentials\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttps://foo:{{secrets.GH_TOKEN}}@github.com\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1589032946,"description":"Terraform makes it easy to manage infrastructure at scale; you might want to share code between modules, and that's where it becomes tricky. In this post, I try to give some clues on how to use terraform across private Github repos.","dir":"2020/gh-actions-with-tf-private-repo/","expirydate":-62135596800,"fuzzywordcount":700,"images":["gh-actions-with-tf-private-repo/cover-gh-actions-with-tf-private-repo.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1589032946,"objectID":"3257b3d6010edfc7fc136160c6704c4e","permalink":"https://maelvls.dev/do-not-share-yet/gh-actions-with-tf-private-repo/","publishdate":"2020-05-09T16:02:26+02:00","readingtime":3,"relpermalink":"/do-not-share-yet/gh-actions-with-tf-private-repo/","section":"2020","summary":"\u003cp\u003eA common way of sharing terraform modules is to move them in a separate repo. And for companies, that means a private repo. When \u003ccode\u003eterraform init\u003c/code\u003e is run, the terraform module is fetched and if this module is stored on a Github private repo, you will need to work around the authentication.\u003c/p\u003e\n\u003cp\u003eImagine that these shared modules are stored on the private Github repo \u0026ldquo;github.com/your-org/terraform-modules\u0026rdquo;. Importing this module from a different repo would look something like:\u003c/p\u003e","tags":["terraform","github-actions"],"title":"Github Actions with a private Terraform module","type":"2020","url":"https://maelvls.dev/do-not-share-yet/gh-actions-with-tf-private-repo/","weight":0,"wordcount":629},{"authors":null,"categories":null,"content":"","date":1589032946,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1589032946,"objectID":"https://maelvls.dev/do-not-share-yet/tags/github-actions/","permalink":"https://maelvls.dev/do-not-share-yet/tags/github-actions/","publishdate":"2020-05-09T16:02:26+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/github-actions/","section":"tags","summary":"","tags":null,"title":"Github-Actions","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/github-actions/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1589032946,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1589032946,"objectID":"https://maelvls.dev/do-not-share-yet/tags/terraform/","permalink":"https://maelvls.dev/do-not-share-yet/tags/terraform/","publishdate":"2020-05-09T16:02:26+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/terraform/","section":"tags","summary":"","tags":null,"title":"Terraform","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/terraform/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eThe typical way of building a client in Go is to pass a \u003ccode\u003e*http.Client\u003c/code\u003e in order to let the caller set timeouts and so on. See \u003ca href=\"https://github.com/digitalocean/godo/blob/97ac73b1d53e23afa2700e9f97d5eeb1f3641e3f/godo.go#L153-L188\"\u003egodo\u003c/a\u003e (Digital Ocean API client) for a good way of doing it.\u003c/p\u003e\n\u003cp\u003eAnother good practice is to avoid hidden network calls. For example, most Go users do not expect a \u003ccode\u003eNewClient\u003c/code\u003e function to do a network call. Prefer using a dedicated function such as \u003ccode\u003eclient.Auth\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eIn the [docker][] client\u003c/p\u003e\n\u003cp\u003e[docker]: \u003ca href=\"https://github.com/moby/moby/blob/f5bb374a0c6260721ac551b232e8eac02b7d2674/client/client.go#L146-L150\"\u003ehttps://github.com/moby/moby/blob/f5bb374a0c6260721ac551b232e8eac02b7d2674/client/client.go#L146-L150\u003c/a\u003e)\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003eNewClient\u003c/code\u003e should probably only take an \u003ccode\u003e*http.Client\u003c/code\u003e and work from there.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eI think \u003ccode\u003eNewClient\u003c/code\u003e should only take a token and we also offer the user a way to give the token:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eNewClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eClient\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003etoken\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eClient\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eGetToken\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cstrong\u003eContent:\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"#unleash\"\u003eUnleash\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#stripe\"\u003eStripe\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#redis\"\u003eRedis\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#saltstack-client-r3labsgo-salt\"\u003eSaltstack client (r3labs/go-salt)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#docker-engine-api-client\"\u003eDocker Engine API client\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#heroku\"\u003eHeroku\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#slack\"\u003eSlack\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#scaleway\"\u003eScaleway\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"unleash\"\u003eUnleash\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;github.com/Unleash/unleash-client-go\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003einit\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eunleash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInitialize\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eunleash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWithListener\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003eunleash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eDebugListener\u003c/span\u003e\u003cspan class=\"p\"\u003e{}),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eunleash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWithAppName\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;my-application\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eunleash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWithUrl\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://unleash.herokuapp.com/api/\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// Example of API call.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eunleash\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsEnabled\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;app.ToggleX\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"stripe\"\u003eStripe\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;net/http\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003estripe\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;github.com/stripe/stripe-go\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;github.com/stripe/stripe-go/client\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ehttpClient\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eClient\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ebackends\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003estripe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewBackends\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttpClient\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;token\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ebackends\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"redis\"\u003eRedis\u003c/h2\u003e\n\u003cp\u003eDoesn\u0026rsquo;t use HTTP anyway. But you can pass a Dialer function that creates a \u003ccode\u003enet.Conn\u003c/code\u003e. Since Redis is using TCP directly, the Redis client has to offer everything itself (e.g. DialTimeout).\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;github.com/go-redis/redis\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eopts\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003eredis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eAddr\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;localhost:6379\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nx\"\u003ePassword\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eredis\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eopts\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"saltstack-client-r3labsgo-salt\"\u003eSaltstack client (r3labs/go-salt)\u003c/h2\u003e\n\u003cp\u003eThe \u003ca href=\"https://github.com/r3labs/go-salt/blob/e6bcc1482122fbfbb41c8c5d7204e067e97a4266/client.go#L18\"\u003eNewClient\u003c/a\u003e does a network call. That\u0026rsquo;s pretty uncommon to do that in Go.\u003c/p\u003e\n\u003cp\u003eThere is no way to pass a \u003ccode\u003e*http.Client\u003c/code\u003e in \u003ccode\u003eNewClient\u003c/code\u003e. But you can by going through some hoops.\u003c/p\u003e\n\u003cp\u003eAlso, the authentication should create a new \u003ccode\u003e*http.Client\u003c/code\u003e instead of mutating the \u003ccode\u003econn.AuthToken\u003c/code\u003e value.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;net/http\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;github.com/r3labs/go-salt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// Using NewClient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eopts\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003esalt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eConfig\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eHost\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eUsername\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ePassword\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003esalt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eopts\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// With a timeout using *http.Client\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ehttpClient\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eClient\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003econn\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003esalt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eConnector\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eClient\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003ehttpClient\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eAuthToken\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;token\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003econn\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAuthenticate\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003esalt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eClient\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eConnector\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003econn\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ejob\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eJob\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;foo\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"docker-engine-api-client\"\u003eDocker Engine API client\u003c/h2\u003e\n\u003cp\u003eThe \u003ca href=\"https://github.com/moby/moby/blob/f5bb374a0c6260721ac551b232e8eac02b7d2674/client/client.go#L119\"\u003edockerengine.NewClient\u003c/a\u003e does return an error, which is kind of unusual for NewClient in Go. The only thing they do is to check that the transport field (\u003ccode\u003ehttp.Transport\u003c/code\u003e) is in fact a \u003ccode\u003ehttp.RoundTripper\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;net/http\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;github.com/moby/moby/client\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ehttpClient\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eClient\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewClientWithOpts\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWithHTTPClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttpClient\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003epanic\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"heroku\"\u003eHeroku\u003c/h2\u003e\n\u003cp\u003eVery clean! Many globals, but it\u0026rsquo;s just for ease of use: everything can be used without using the global state (\u003ccode\u003eheroku.DefaultTransport\u003c/code\u003e). \u003ca href=\"https://github.com/heroku/heroku-go/blob/master/v5/transport.go\"\u003ehttps://github.com/heroku/heroku-go/blob/master/v5/transport.go\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eheroku\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;github.com/heroku/heroku-go/v5\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eClient\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eTransport\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eheroku\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eTransport\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eBearerToken\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;token\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eh\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eheroku\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewService\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eaddons\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eh\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAddOnList\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTODO\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003eheroku\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eListRange\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eField\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"slack\"\u003eSlack\u003c/h2\u003e\n\u003cp\u003eVery good!!! \u003ca href=\"https://github.com/nlopes/slack/blob/e5749f13b5af3c139165ab4180a95bb06a60128b/slack.go#L68\"\u003ehttps://github.com/nlopes/slack/blob/e5749f13b5af3c139165ab4180a95bb06a60128b/slack.go#L68\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"s\"\u003e\u0026#34;github.com/nlopes/slack\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ehttpClient\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eClient\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e10\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eapi\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eslack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNew\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;token\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eslack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eOptionHTTPClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttpClient\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003egroups\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eapi\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetGroups\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"scaleway\"\u003eScaleway\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/scaleway/scaleway-sdk-go\"\u003ehttps://github.com/scaleway/scaleway-sdk-go\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eAnd they use an HTTP recorder \u0026ldquo;à la Jest Snapshot\u0026rdquo;!\u003c/p\u003e\n","date":1588942827,"description":"","dir":"2020/writing-a-good-go-sdk/","expirydate":-62135596800,"fuzzywordcount":500,"images":["writing-a-good-go-sdk/cover-writing-a-good-go-sdk.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1588942827,"objectID":"eb420f4555e085f2d328ecf3fa545e3b","permalink":"https://maelvls.dev/do-not-share-yet/writing-a-good-go-sdk/","publishdate":"2020-05-08T15:00:27+02:00","readingtime":3,"relpermalink":"/do-not-share-yet/writing-a-good-go-sdk/","section":"2020","summary":"\u003cp\u003eThe typical way of building a client in Go is to pass a \u003ccode\u003e*http.Client\u003c/code\u003e in order to let the caller set timeouts and so on. See \u003ca href=\"https://github.com/digitalocean/godo/blob/97ac73b1d53e23afa2700e9f97d5eeb1f3641e3f/godo.go#L153-L188\"\u003egodo\u003c/a\u003e (Digital Ocean API client) for a good way of doing it.\u003c/p\u003e\n\u003cp\u003eAnother good practice is to avoid hidden network calls. For example, most Go users do not expect a \u003ccode\u003eNewClient\u003c/code\u003e function to do a network call. Prefer using a dedicated function such as \u003ccode\u003eclient.Auth\u003c/code\u003e.\u003c/p\u003e","tags":[],"title":"Writing a good Go SDK","type":"2020","url":"https://maelvls.dev/do-not-share-yet/writing-a-good-go-sdk/","weight":0,"wordcount":477},{"authors":null,"categories":null,"content":"\u003cul\u003e\n\u003cli\u003eChatOps takes the GitOps to the next level and uses a chat interface (such as Slack or Github PR comments) to bring more transparency and retain knowledge about past actions.\u003c/li\u003e\n\u003cli\u003eThe Kubernetes project uses Prow, a chat bot.\u003c/li\u003e\n\u003cli\u003eChat UI = transparent, visible, avoids shadow operations (when a colleague has to do some \u003ccode\u003eterraform apply\u003c/code\u003e locally), workflow is public instead of in people\u0026rsquo;s minds.\u003c/li\u003e\n\u003cli\u003eTekton = tasks \u0026amp; pipelines only but deals with inputs and outputs. API-only which means there is it kind of lacks user-friendliness. You only get the \u003ccode\u003etekton\u003c/code\u003e CLI and a read-only web-based dashboard, but the nice thing is that it is Kubernetes-based so it integrates with many things like \u003ccode\u003ekubectl\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eConcourse CI = also input-output oriented. Has a very nice web UI that is mostly read-only (except for re-running jobs). It is API-only and the main way of configuring and running CI is to use the \u003ccode\u003efly\u003c/code\u003e CLI.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eExample: \u003ca href=\"https://github.com/maelvls/gh-actions-chatops\"\u003ehttps://github.com/maelvls/gh-actions-chatops\u003c/a\u003e\u003c/p\u003e\n","date":1588941631,"description":"","dir":"2020/chatops-github-actions/","expirydate":-62135596800,"fuzzywordcount":200,"images":["chatops-github-actions/cover-chatops-github-actions.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1588941631,"objectID":"2252f5c1a3569cfe1438174d3729cdb7","permalink":"https://maelvls.dev/do-not-share-yet/chatops-github-actions/","publishdate":"2020-05-08T14:40:31+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/chatops-github-actions/","section":"2020","summary":"\u003cul\u003e\n\u003cli\u003eChatOps takes the GitOps to the next level and uses a chat interface (such as Slack or Github PR comments) to bring more transparency and retain knowledge about past actions.\u003c/li\u003e\n\u003cli\u003eThe Kubernetes project uses Prow, a chat bot.\u003c/li\u003e\n\u003cli\u003eChat UI = transparent, visible, avoids shadow operations (when a colleague has to do some \u003ccode\u003eterraform apply\u003c/code\u003e locally), workflow is public instead of in people\u0026rsquo;s minds.\u003c/li\u003e\n\u003cli\u003eTekton = tasks \u0026amp; pipelines only but deals with inputs and outputs. API-only which means there is it kind of lacks user-friendliness. You only get the \u003ccode\u003etekton\u003c/code\u003e CLI and a read-only web-based dashboard, but the nice thing is that it is Kubernetes-based so it integrates with many things like \u003ccode\u003ekubectl\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eConcourse CI = also input-output oriented. Has a very nice web UI that is mostly read-only (except for re-running jobs). It is API-only and the main way of configuring and running CI is to use the \u003ccode\u003efly\u003c/code\u003e CLI.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eExample: \u003ca href=\"https://github.com/maelvls/gh-actions-chatops\"\u003ehttps://github.com/maelvls/gh-actions-chatops\u003c/a\u003e\u003c/p\u003e","tags":[],"title":"A ChatOps bot using Github Actions","type":"2020","url":"https://maelvls.dev/do-not-share-yet/chatops-github-actions/","weight":0,"wordcount":154},{"authors":null,"categories":null,"content":"\u003cp\u003eGiven $U$ the set of users and a pair of users $(u, v) \\in U^2$, we denote by $f$ the function that tells us when two users belong to the same channel $c \\in C$ where $C$ is the set of channels. It is defined as\u003c/p\u003e\n\u003cp\u003e$$\nf(u,v,c) = \\begin{cases}1 \u0026amp; \\text{ if } u \\text{ and } v \\text{ both in channel } c \\ 0 \u0026amp;\\text{ otherwise. }\\end{cases}\n$$\u003c/p\u003e\n\u003cp\u003eLet us define the distance between two users, denoted $dist$, as\u003c/p\u003e\n\u003cp\u003e$$\ndist(u, v) = \\sum_{c \\in C} f(u,v,c)\\text{.}\n$$\u003c/p\u003e\n\u003cp\u003eThe optimization problem can be formulated as:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eGiven a user $u$, we want to find the channel $c$ in which he does not already belong and which maximizes the chances of subscribing to an interesting channel. This assumes that the user has already subscribed to some channels and that some of these channels are\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eFor a given user $v$:\u003c/p\u003e\n\u003cp\u003e$$\\max_{c \\in C} \\sum_{u \\in U, u \\ne v} dist(v, u)$$\u003c/p\u003e\n","date":1588927040,"description":"","dir":"2020/slack-dont-miss-channels/","expirydate":-62135596800,"fuzzywordcount":200,"images":["slack-dont-miss-channels/cover-slack-dont-miss-channels.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1588927040,"objectID":"858f5c58bab2c7e034ce3ef3392bcbd6","permalink":"https://maelvls.dev/do-not-share-yet/slack-dont-miss-channels/","publishdate":"2020-05-08T10:37:20+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/slack-dont-miss-channels/","section":"2020","summary":"\u003cp\u003eGiven $U$ the set of users and a pair of users $(u, v) \\in U^2$, we denote by $f$ the function that tells us when two users belong to the same channel $c \\in C$ where $C$ is the set of channels. It is defined as\u003c/p\u003e\n\u003cp\u003e$$\nf(u,v,c) = \\begin{cases}1 \u0026amp; \\text{ if } u \\text{ and } v \\text{ both in channel } c \\ 0 \u0026amp;\\text{ otherwise. }\\end{cases}\n$$\u003c/p\u003e","tags":[],"title":"Slack: don't miss any channels!","type":"2020","url":"https://maelvls.dev/do-not-share-yet/slack-dont-miss-channels/","weight":0,"wordcount":161},{"authors":null,"categories":null,"content":"\u003cul\u003e\n\u003cli\u003eLinux kernel 3.10 or higher required\u003c/li\u003e\n\u003cli\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% cat /etc/containerd/config.toml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# explicitly use v2 config format\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eversion\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# set default runtime handler to v2, which has a per-pod shim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e.containerd\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003edefault_runtime_name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;runc\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e.containerd.runtimes.runc\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eruntime_type\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.runc.v2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Setup a runtime with the magic name (\u0026#34;test-handler\u0026#34;) used for Kubernetes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# runtime class tests ...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e.containerd.runtimes.test-handler\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eruntime_type\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.runc.v2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ensure the sandbox image matches kubeadm\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# TODO: probably we should instead just use the containerd default\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Implementing the pod sandbox is a CRI implementation detail ..\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003esandbox_image\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;k8s.gcr.io/pause:3.2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% cat /etc/crictl.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eruntime-endpoint: unix:///var/run/containerd/containerd.sock\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"containerd-vs-runc\"\u003eContainerd vs. RunC\u003c/h2\u003e\n\u003cp\u003eAs detailed \u003ca href=\"https://stackoverflow.com/questions/41645665/how-containerd-compares-to-runc#:~:text=runc%20is%20used%20by%20containerd,specification%20for%20runtime%20and%20images.\"\u003ehere\u003c/a\u003e:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/containerd/containerd\"\u003e\u003ccode\u003econtainerd\u003c/code\u003e\u003c/a\u003e is a container runtime which can manage a complete container lifecycle \u0026ndash; from image transfer/storage (locally and from/to registries) to container execution, supervision and networking. Containerd abides by the client-side of the \u003ca href=\"https://github.com/opencontainers/distribution-spec/blob/master/spec.md\"\u003eOCI Distribution spec\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://alexander.holbreich.org/docker-components-explained#containerdshim\"\u003e\u003ccode\u003econtainerd-shim\u003c/code\u003e\u003c/a\u003e handles headless containers, meaning once \u003ccode\u003erunc\u003c/code\u003e initializes the containers, it exits handing the containers over to the container-shim which acts as some middleman.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/opencontainers/runc\"\u003e\u003ccode\u003erunc\u003c/code\u003e\u003c/a\u003e is a lightweight universal container runtime, which abides by the OCI specification. runc is used by containerd for spawning and running containers according to OCI spec. It is also the repackaging of Docker\u0026rsquo;s libcontainer.\u003c/li\u003e\n\u003c/ul\u003e\u003c/blockquote\u003e\n","date":1588229946,"description":"","dir":"2020/everything-about-docker/","expirydate":-62135596800,"fuzzywordcount":200,"images":["everything-about-docker/cover-everything-about-docker.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1588229946,"objectID":"7df998eab1c527e556020c076adbf9d4","permalink":"https://maelvls.dev/do-not-share-yet/everything-about-docker/","publishdate":"2020-04-30T08:59:06+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/everything-about-docker/","section":"2020","summary":"\u003cul\u003e\n\u003cli\u003eLinux kernel 3.10 or higher required\u003c/li\u003e\n\u003cli\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% cat /etc/containerd/config.toml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# explicitly use v2 config format\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eversion\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# set default runtime handler to v2, which has a per-pod shim\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e.containerd\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003edefault_runtime_name\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;runc\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e.containerd.runtimes.runc\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eruntime_type\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.runc.v2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Setup a runtime with the magic name (\u0026#34;test-handler\u0026#34;) used for Kubernetes\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# runtime class tests ...\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e.containerd.runtimes.test-handler\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eruntime_type\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.runc.v2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ensure the sandbox image matches kubeadm\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# TODO: probably we should instead just use the containerd default\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Implementing the pod sandbox is a CRI implementation detail ..\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eplugins.\u003cspan class=\"s2\"\u003e\u0026#34;io.containerd.grpc.v1.cri\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003esandbox_image\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;k8s.gcr.io/pause:3.2\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% cat /etc/crictl.yaml\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eruntime-endpoint: unix:///var/run/containerd/containerd.sock\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"containerd-vs-runc\"\u003eContainerd vs. RunC\u003c/h2\u003e\n\u003cp\u003eAs detailed \u003ca href=\"https://stackoverflow.com/questions/41645665/how-containerd-compares-to-runc#:~:text=runc%20is%20used%20by%20containerd,specification%20for%20runtime%20and%20images.\"\u003ehere\u003c/a\u003e:\u003c/p\u003e","tags":[],"title":"Everything About Docker","type":"2020","url":"https://maelvls.dev/do-not-share-yet/everything-about-docker/","weight":0,"wordcount":198},{"authors":null,"categories":null,"content":"\u003cp\u003eI take a look at \u0026ldquo;\u003ca href=\"https://www.babelstone.co.uk/Unicode/whatisit.html\"\u003ewhatisit\u003c/a\u003e\u0026rdquo;:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e⚠️\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eU+26A0 : WARNING SIGN\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eU+FE0F : VARIATION SELECTOR-16 [VS16] {emoji variation selector}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBut even better: \u003ca href=\"https://github.com/mna/runes\"\u003erunes\u003c/a\u003e is CLI for exploring these emojis! Let\u0026rsquo;s install it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego get github.com/mna/runes\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, let\u0026rsquo;s see with an emoji that I know displays correctly in my terminal (iTerm2):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% runes - ✅\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eS So\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+2705 \u003cspan class=\"s1\"\u003e\u0026#39;✅\u0026#39;\u003c/span\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003eE2 9C 85\u003cspan class=\"o\"\u003e]\u003c/span\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003e2705\u003cspan class=\"o\"\u003e]\u003c/span\u003e      WHITE HEAVY CHECK MARK\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eC Cc\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+0000         \u003cspan class=\"o\"\u003e[\u003c/span\u003e00\u003cspan class=\"o\"\u003e]\u003c/span\u003e          \u003cspan class=\"o\"\u003e[\u003c/span\u003e0\u003cspan class=\"o\"\u003e]\u003c/span\u003e         \u0026lt;control\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eC Cc\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+0000         \u003cspan class=\"o\"\u003e[\u003c/span\u003e00\u003cspan class=\"o\"\u003e]\u003c/span\u003e          \u003cspan class=\"o\"\u003e[\u003c/span\u003e0\u003cspan class=\"o\"\u003e]\u003c/span\u003e         \u0026lt;control\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, let\u0026rsquo;s try with my multi-UTF-8 example \u0026ldquo;⚠️\u0026rdquo;:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% runes - ⚠\u0026lt;fe0f\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eS So\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+26A0 \u003cspan class=\"s1\"\u003e\u0026#39;⚠\u0026#39;\u003c/span\u003e     \u003cspan class=\"o\"\u003e[\u003c/span\u003eE2 9A A0\u003cspan class=\"o\"\u003e]\u003c/span\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003e26A0\u003cspan class=\"o\"\u003e]\u003c/span\u003e      WARNING SIGN\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eC Cc\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+0000         \u003cspan class=\"o\"\u003e[\u003c/span\u003e00\u003cspan class=\"o\"\u003e]\u003c/span\u003e          \u003cspan class=\"o\"\u003e[\u003c/span\u003e0\u003cspan class=\"o\"\u003e]\u003c/span\u003e         \u0026lt;control\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eC Cc\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+0000         \u003cspan class=\"o\"\u003e[\u003c/span\u003e00\u003cspan class=\"o\"\u003e]\u003c/span\u003e          \u003cspan class=\"o\"\u003e[\u003c/span\u003e0\u003cspan class=\"o\"\u003e]\u003c/span\u003e         \u0026lt;control\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eM Mn\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+FE0F \u003cspan class=\"s1\"\u003e\u0026#39;️\u0026#39;\u003c/span\u003e     \u003cspan class=\"o\"\u003e[\u003c/span\u003eEF B8 8F\u003cspan class=\"o\"\u003e]\u003c/span\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003eFE0F\u003cspan class=\"o\"\u003e]\u003c/span\u003e      VARIATION SELECTOR-16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eC Cc\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+0000         \u003cspan class=\"o\"\u003e[\u003c/span\u003e00\u003cspan class=\"o\"\u003e]\u003c/span\u003e          \u003cspan class=\"o\"\u003e[\u003c/span\u003e0\u003cspan class=\"o\"\u003e]\u003c/span\u003e         \u0026lt;control\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eC Cc\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+0000         \u003cspan class=\"o\"\u003e[\u003c/span\u003e00\u003cspan class=\"o\"\u003e]\u003c/span\u003e          \u003cspan class=\"o\"\u003e[\u003c/span\u003e0\u003cspan class=\"o\"\u003e]\u003c/span\u003e         \u0026lt;control\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eMy terminal (iTerm2) doesn\u0026rsquo;t even allow me to paste \u0026ldquo;⚠️\u0026rdquo;?! It shows \u003ccode\u003e⚠\u0026lt;fe0f\u0026gt;\u003c/code\u003e instead.\u003c/p\u003e\n","date":1588003141,"description":"","dir":"2020/unicode/","expirydate":-62135596800,"fuzzywordcount":200,"images":["unicode/cover-unicode.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1588003141,"objectID":"f0f45b97682d3b8802661a16d25f3863","permalink":"https://maelvls.dev/do-not-share-yet/unicode/","publishdate":"2020-04-27T17:59:01+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/unicode/","section":"2020","summary":"\u003cp\u003eI take a look at \u0026ldquo;\u003ca href=\"https://www.babelstone.co.uk/Unicode/whatisit.html\"\u003ewhatisit\u003c/a\u003e\u0026rdquo;:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e⚠️\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eU+26A0 : WARNING SIGN\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eU+FE0F : VARIATION SELECTOR-16 [VS16] {emoji variation selector}\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eBut even better: \u003ca href=\"https://github.com/mna/runes\"\u003erunes\u003c/a\u003e is CLI for exploring these emojis! Let\u0026rsquo;s install it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego get github.com/mna/runes\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, let\u0026rsquo;s see with an emoji that I know displays correctly in my terminal (iTerm2):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% runes - ✅\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eS So\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+2705 \u003cspan class=\"s1\"\u003e\u0026#39;✅\u0026#39;\u003c/span\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003eE2 9C 85\u003cspan class=\"o\"\u003e]\u003c/span\u003e    \u003cspan class=\"o\"\u003e[\u003c/span\u003e2705\u003cspan class=\"o\"\u003e]\u003c/span\u003e      WHITE HEAVY CHECK MARK\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eC Cc\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+0000         \u003cspan class=\"o\"\u003e[\u003c/span\u003e00\u003cspan class=\"o\"\u003e]\u003c/span\u003e          \u003cspan class=\"o\"\u003e[\u003c/span\u003e0\u003cspan class=\"o\"\u003e]\u003c/span\u003e         \u0026lt;control\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eC Cc\u003cspan class=\"o\"\u003e]\u003c/span\u003e U+0000         \u003cspan class=\"o\"\u003e[\u003c/span\u003e00\u003cspan class=\"o\"\u003e]\u003c/span\u003e          \u003cspan class=\"o\"\u003e[\u003c/span\u003e0\u003cspan class=\"o\"\u003e]\u003c/span\u003e         \u0026lt;control\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, let\u0026rsquo;s try with my multi-UTF-8 example \u0026ldquo;⚠️\u0026rdquo;:\u003c/p\u003e","tags":[],"title":"Unicode","type":"2020","url":"https://maelvls.dev/do-not-share-yet/unicode/","weight":0,"wordcount":148},{"authors":null,"categories":null,"content":"\u003cp\u003eGreat post by Duffie Cooley in Apr 2019 \u0026ldquo;\u003ca href=\"https://mauilion.dev/posts/kind-metallb\"\u003eUsing MetalLb with Kind\u003c/a\u003e\u0026rdquo;:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kind create cluster --name metallb --config - \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt;EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eheredoc\u0026gt; kind: Cluster\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eapiVersion: kind.sigs.k8s.io/v1alpha3\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003enodes:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e- role: control-plane\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e- role: worker\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eheredoc\u0026gt; EOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% k get nodes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME                    STATUS     ROLES    AGE   VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emetallb-control-plane   Ready      master   42s   v1.17.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emetallb-worker          NotReady   \u0026lt;none\u0026gt;   9s    v1.17.2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker network inspect bridge \u003cspan class=\"p\"\u003e|\u003c/span\u003e jq -r \u003cspan class=\"s1\"\u003e\u0026#39;.[].IPAM.Config[].Subnet\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e172.17.0.0/16\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% arp -a -n\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e192.168.1.1\u003cspan class=\"o\"\u003e)\u003c/span\u003e at a4:3e:51:cf:e7:96 on en9 ifscope \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e192.168.1.1\u003cspan class=\"o\"\u003e)\u003c/span\u003e at a4:3e:51:cf:e7:96 on en0 ifscope \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e192.168.1.12\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 60:f4:45:70:a9:82 on en9 ifscope \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e192.168.1.21\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 80:49:71:10:b4:ba on en0 ifscope \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e192.168.1.255\u003cspan class=\"o\"\u003e)\u003c/span\u003e at ff:ff:ff:ff:ff:ff on en9 ifscope \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e224.0.0.251\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 1:0:5e:0:0:fb on en9 ifscope permanent \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e224.0.0.251\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 1:0:5e:0:0:fb on en0 ifscope permanent \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e239.255.255.250\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 1:0:5e:7f:ff:fa on en9 ifscope permanent \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e239.255.255.250\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 1:0:5e:7f:ff:fa on en0 ifscope permanent \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1587810302,"description":"","dir":"2020/metallb-vs-k3s-servicelb/","expirydate":-62135596800,"fuzzywordcount":200,"images":["metallb-vs-k3s-servicelb/cover-metallb-vs-k3s-servicelb.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1587810302,"objectID":"2360236743a87265447873db3d3e841a","permalink":"https://maelvls.dev/do-not-share-yet/metallb-vs-k3s-servicelb/","publishdate":"2020-04-25T12:25:02+02:00","readingtime":1,"relpermalink":"/do-not-share-yet/metallb-vs-k3s-servicelb/","section":"2020","summary":"\u003cp\u003eGreat post by Duffie Cooley in Apr 2019 \u0026ldquo;\u003ca href=\"https://mauilion.dev/posts/kind-metallb\"\u003eUsing MetalLb with Kind\u003c/a\u003e\u0026rdquo;:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kind create cluster --name metallb --config - \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt;EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eheredoc\u0026gt; kind: Cluster\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eapiVersion: kind.sigs.k8s.io/v1alpha3\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003enodes:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e- role: control-plane\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e- role: worker\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eheredoc\u0026gt; EOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% k get nodes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME                    STATUS     ROLES    AGE   VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emetallb-control-plane   Ready      master   42s   v1.17.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emetallb-worker          NotReady   \u0026lt;none\u0026gt;   9s    v1.17.2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker network inspect bridge \u003cspan class=\"p\"\u003e|\u003c/span\u003e jq -r \u003cspan class=\"s1\"\u003e\u0026#39;.[].IPAM.Config[].Subnet\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e172.17.0.0/16\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% arp -a -n\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e192.168.1.1\u003cspan class=\"o\"\u003e)\u003c/span\u003e at a4:3e:51:cf:e7:96 on en9 ifscope \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e192.168.1.1\u003cspan class=\"o\"\u003e)\u003c/span\u003e at a4:3e:51:cf:e7:96 on en0 ifscope \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e192.168.1.12\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 60:f4:45:70:a9:82 on en9 ifscope \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e192.168.1.21\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 80:49:71:10:b4:ba on en0 ifscope \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e192.168.1.255\u003cspan class=\"o\"\u003e)\u003c/span\u003e at ff:ff:ff:ff:ff:ff on en9 ifscope \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e224.0.0.251\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 1:0:5e:0:0:fb on en9 ifscope permanent \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e224.0.0.251\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 1:0:5e:0:0:fb on en0 ifscope permanent \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e239.255.255.250\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 1:0:5e:7f:ff:fa on en9 ifscope permanent \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e? \u003cspan class=\"o\"\u003e(\u003c/span\u003e239.255.255.250\u003cspan class=\"o\"\u003e)\u003c/span\u003e at 1:0:5e:7f:ff:fa on en0 ifscope permanent \u003cspan class=\"o\"\u003e[\u003c/span\u003eethernet\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[],"title":"MetalLB vs. K3s servicelb","type":"2020","url":"https://maelvls.dev/do-not-share-yet/metallb-vs-k3s-servicelb/","weight":0,"wordcount":144},{"authors":null,"categories":null,"content":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Make sure I use the same version as the server.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% fly -t main sync\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Login.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% fly login -t main -c https://concourse.k.maelvls.dev/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elogging in to team \u003cspan class=\"s1\"\u003e\u0026#39;main\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enavigate to the following URL in your browser:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  https://concourse.k.maelvls.dev/login?fly_port\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53932\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eor enter token manually:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etarget saved\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eCan \u003ccode\u003e-t main\u003c/code\u003e be remembered by default like contexts and namespaces with \u003ccode\u003ekubectl config set-context\u003c/code\u003e? See:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/concourse/fly/issues/213\"\u003eissue 213\u003c/a\u003e:\u003c/li\u003e\n\u003cli\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/concourse/concourse/issues/1933\"\u003eissue 1933\u003c/a\u003e:\n\u003cblockquote\u003e\n\u003cp\u003eCould \u003ccode\u003efly\u003c/code\u003e remember the target? Either with \u003ccode\u003eFLY_TARGET\u003c/code\u003e env var or setting a default in ~/.flyrc?\u003c/p\u003e\n\u003cp\u003eResponse: The \u003ccode\u003e-t\u003c/code\u003e flag is intentionally stateless and must be explicitly added to each command. This reduces the risk of accidentally running a command against the wrong environment when you have multiple targets defined.\u003c/p\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOK. I hate that kind of stubborness.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% cat \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt;EOF \u0026gt; pipeline.yml\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eresources:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  - name: concourse-docs-git\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    type: git\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    icon: github-circle\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    source:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e      uri: https://github.com/concourse/docs\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003ejobs:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  - name: job\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    public: true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    plan:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e      - get: concourse-docs-git\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e        trigger: true\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e      - task: list-files\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e        config:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e          inputs:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e            - name: concourse-docs-git\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e          platform: linux\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e          image_resource:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e            type: registry-image\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e            source: { repository: busybox }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e          run:\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e            path: ls\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e            args: [\u0026#34;-la\u0026#34;, \u0026#34;./concourse-docs-git\u0026#34;]\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003efly -t main set-pipeline -pmaster -c pipeline.yml\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003e\u0026ldquo;\u003ca href=\"https://concourse-ci.org/concourse-worker.html#configuring-gdn-server\"\u003eConfiguring gdn server\u003c/a\u003e\u0026rdquo;: On Linux, the concourse binary is packaged alongside a \u003ccode\u003egdn\u003c/code\u003e binary. This binary is used for running Guardian, which is a Garden backend implementation which runs containers via \u003ccode\u003erunc\u003c/code\u003e (the same technology underlying tools like Docker).\u003c/p\u003e\u003c/blockquote\u003e\n","date":1587569832,"description":"","dir":"2020/setting-up-concourse/","expirydate":-62135596800,"fuzzywordcount":300,"images":["setting-up-concourse/cover-setting-up-concourse.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1587569832,"objectID":"b73aaa53fbaa7c923d726f279e315f45","permalink":"https://maelvls.dev/do-not-share-yet/setting-up-concourse/","publishdate":"2020-04-22T17:37:12+02:00","readingtime":2,"relpermalink":"/do-not-share-yet/setting-up-concourse/","section":"2020","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Make sure I use the same version as the server.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% fly -t main sync\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Login.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% fly login -t main -c https://concourse.k.maelvls.dev/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elogging in to team \u003cspan class=\"s1\"\u003e\u0026#39;main\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enavigate to the following URL in your browser:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  https://concourse.k.maelvls.dev/login?fly_port\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53932\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eor enter token manually:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etarget saved\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eCan \u003ccode\u003e-t main\u003c/code\u003e be remembered by default like contexts and namespaces with \u003ccode\u003ekubectl config set-context\u003c/code\u003e? See:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/concourse/fly/issues/213\"\u003eissue 213\u003c/a\u003e:\u003c/li\u003e\n\u003cli\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/concourse/concourse/issues/1933\"\u003eissue 1933\u003c/a\u003e:\n\u003cblockquote\u003e\n\u003cp\u003eCould \u003ccode\u003efly\u003c/code\u003e remember the target? Either with \u003ccode\u003eFLY_TARGET\u003c/code\u003e env var or setting a default in ~/.flyrc?\u003c/p\u003e","tags":[],"title":"Setting Up Concourse","type":"2020","url":"https://maelvls.dev/do-not-share-yet/setting-up-concourse/","weight":0,"wordcount":222},{"authors":null,"categories":null,"content":"","date":1587549506,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1587549506,"objectID":"https://maelvls.dev/do-not-share-yet/tags/controllers/","permalink":"https://maelvls.dev/do-not-share-yet/tags/controllers/","publishdate":"2020-04-22T11:58:26+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/controllers/","section":"tags","summary":"","tags":null,"title":"Controllers","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/controllers/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eKubernetes\u0026rsquo; extensibility is probably its biggest strength. Controllers and CRDs are all over the place. But finding the right information to begin writing a controller isn\u0026rsquo;t easy due to the sheer amount of tribal knowledge scattered everywhere. This post intends to help you start with controllers.\u003c/p\u003e\n\u003c!--\n\n\u003e A \"Kubernetes controller\" is a binary that runs reconciliation loops. A\n\u003e reconciliation loop watches the objects stored in Kubernetes. When it\n\u003e notices a discrepency between what the object specifies (e.g. 4 replicas)\n\u003e and the observed reality (e.g., the reconcialiation loop asks kubelet,\n\u003e and it answers there are only 2 replicas), the reconcialiation loop will\n\u003e take actions in order to satisfy what is specified in the object. The\n\u003e \"controller\" binary is run as a simple Kubernetes Deployment. Sometimes,\n\u003e when the Kubernetes API is not enough, it may also come with some\n\u003e CustomResourceDefinitions YAML files.\n\nI use interchangeably the term \"sync loop\" and \"controller\". The word\n\"controller\" is quite overloaded: we use to qualify the binary that runs in\na pod and watches for objects (\"Kubernetes controller\"), but we also use it\nto mean \"one sync loop\" that is running inside this binary.\n\nAnyone writing Kubernetes controllers might want to take a look at the\nfollowing resources.\nOne controller\n\n**[Kubernetes API conventions](https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md)**\n\n\u003e When a new version of an object is POSTed or PUT, the \"spec\" is updated\n\u003e and available immediately. Over time the system will work to bring the\n\u003e \"status\" into line with the \"spec\". The system will drive toward the most\n\u003e recent \"spec\" regardless of previous versions of that stanza. In other\n\u003e words, if a value is changed from 2 to 5 in one PUT and then back down to\n\u003e 3 in another PUT the system is not required to 'touch base' at 5 before\n\u003e changing the \"status\" to 3. In other words, the system's behavior is\n\u003e level-based rather than edge-based. This enables robust behavior in the\n\u003e presence of missed intermediate state changes.\n\n--\u003e\n\u003chr\u003e\n\u003cp\u003eLet us begin with some terminology:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003econtroller\u003c/strong\u003e: a single loop that watches some objects. We often refer to this loop as \u0026ldquo;controller loop\u0026rdquo; or \u0026ldquo;sync loop\u0026rdquo; or \u0026ldquo;reconcile loop\u0026rdquo;.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003econtroller binary\u003c/strong\u003e is a binary that runs one or multiple sync loops. We often refer to it as \u0026ldquo;controllers\u0026rdquo;.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eCRD\u003c/strong\u003e (Custom Resource Definition) is a simple YAML manifest that describes a custom object, for example \u003ca href=\"https://github.com/jetstack/cert-manager/blob/a04d2f0935/deploy/crds/crd-orders.yaml#L2\"\u003ethis CRD\u003c/a\u003e defines the acme.cert-manager.io/v1alpha3 Order resource. After applying this CRD to a Kubernetes cluster, you can apply manifests that have the kind \u0026ldquo;Order\u0026rdquo;\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNote: CRDs and controllers are decoupled. You can apply a CRD manifest without having any controller binary running. It works in both ways: you can have a controller binary running that doesn\u0026rsquo;t require any custom objects. Traefik is a controller binary which relies on built-in Service objects.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNote: the \u0026ldquo;CRD\u0026rdquo; manifest is just a schema. It doesn\u0026rsquo;t carry any logic (except for the basic validation the apiserver does). The actual logic happens in the controller binary.\u003c/p\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eoperator\u003c/strong\u003e: the term \u0026ldquo;operator\u0026rdquo; is often used to mean a controller binary with its CRDs, for example the \u003ca href=\"https://github.com/elastic/cloud-on-k8s\"\u003eelastic operator\u003c/a\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cp\u003eHere are the links that I would give to anyone interested in writing their own controller:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/kubernetes/community/blob/712590c108bd4533b80e8f2753cadaa617d9bdf2/contributors/devel/sig-api-machinery/controllers.md\"\u003esig-api-machinery/controllers.md\u003c/a\u003e gives a good intuition as to what a \u0026ldquo;controller\u0026rdquo; is:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eA Kubernetes controller is an active reconciliation process. That is, it watches some object for the world\u0026rsquo;s desired state, and it watches the world\u0026rsquo;s actual state, too. Then, it sends instructions to try and make the world\u0026rsquo;s current state be more like the desired state.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eNote: the client-go\u0026rsquo;s informers and listers and workqueue are not mandatory for writing a controller: you can just rely on client-go\u0026rsquo;s \u003ccode\u003eWatch\u003c/code\u003e primitive to reconcile state. The informers and workqueue add important scalability and reliability features but these also come with the cost of heavy abstractions. Use client-go\u0026rsquo;s \u003ccode\u003eWatch\u003c/code\u003e first to have a sense of what it can offer, and then try out informers and workqueue.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://book.kubebuilder.io/quick-start.html\"\u003eKubebuilder book\u003c/a\u003e is a nice starting point. Kubebuilder uses code generation a lot and that\u0026rsquo;s what most controllers use nowadays (Rancher uses a somehow forked version of controller-runtime and controller-tools, \u003ca href=\"https://github.com/rancher/wrangler\"\u003eWrangler\u003c/a\u003e, that also generates code but with their own \u0026ldquo;style\u0026rdquo; – for example, simple flat interfaces instead of \u003ca href=\"https://github.com/kubernetes/client-go\"\u003eclient-go\u003c/a\u003e\u0026rsquo;s deeply nested interfaces that don\u0026rsquo;t feel like Go).\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe \u003ca href=\"https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md\"\u003eKubernetes API conventions\u003c/a\u003e is an amazing document. It summarizes a lot of the \u0026ldquo;tribal knowledge\u0026rdquo; around naming and how sync loops are conceived and what they mean by \u0026ldquo;level-based behaviour\u0026rdquo;.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eGithub search \u0026ldquo;\u003ca href=\"https://github.com/search?q=language%3Ayaml+language%3Ago+kubernetes+controllers\"\u003elanguage:yaml language:go kubernetes controllers\u003c/a\u003e\u0026rdquo;, tons of nice examples of controllers\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/jetstack/cert-manager\"\u003ecert-manager\u003c/a\u003e\u0026rsquo;s codebase is a nice controller to take a look at\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eClusterAPI \u003ca href=\"https://github.com/kubernetes-sigs/cluster-api/blob/master/docs/proposals/20190610-machine-states-preboot-bootstrapping.md\"\u003eproposals\u003c/a\u003e and codebase (\u003ca href=\"https://github.com/kubernetes-sigs/cluster-api\"\u003ecapi\u003c/a\u003e, \u003ca href=\"https://github.com/kubernetes-sigs/cluster-api-provider-aws\"\u003ecapa\u003c/a\u003e) and  (we took a lot of inspiration from what they do)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe ClusterAPI \u003ca href=\"https://docs.google.com/document/d/1fQNlqsDkvEggWFi51GVxOglL2P1Bvo2JhZlMhm2d-Co/edit#\"\u003eMeeting notes\u003c/a\u003e contains a ton of useful information on Machine, MachinePool\u0026hellip; (crazy how much I learned from that).\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe Kubernetes \u003ccode\u003estatus\u003c/code\u003e field is tricky. You can take a look at \u0026ldquo;\u003ca href=\"https://maelvls.dev/kubernetes-conditions/\"\u003econditions vs. phases vs. reasons\u003c/a\u003e\u0026rdquo;.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe \u003ca href=\"https://github.com/kubernetes/kubernetes\"\u003eKubernetes codebase\u003c/a\u003e itself is also a very nice read. It might feel overwhelming at first; I invite you to take a look at a few of the following sync loops contained in the \u003ccode\u003ekube-controller-manager\u003c/code\u003e, \u003ccode\u003ekube-scheduler\u003c/code\u003e and \u003ccode\u003ekubelet\u003c/code\u003e. Since each sync loop reads or updates different objects, I also detail which objects are updated or created by each sync loop:\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003ebinary\u003c/th\u003e\n          \u003cth\u003esync loop = component\u003c/th\u003e\n          \u003cth\u003ereads\u003c/th\u003e\n          \u003cth\u003ecreates\u003c/th\u003e\n          \u003cth\u003eupdates\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekube-controller-manager\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/controller/deployment/deployment_controller.go#L560-L649\"\u003e\u003ccode\u003esyncDeployment\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003ePod\u003c/td\u003e\n          \u003ctd\u003eReplicaSet\u003c/td\u003e\n          \u003ctd\u003eDeployment\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekube-controller-manager\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/controller/replicaset/replica_set.go#L653-L721\"\u003e\u003ccode\u003esyncReplicaSet\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003ePod\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekubelet\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/kubelet/status/status_manager.go#L514-L567\"\u003e\u003ccode\u003esyncPod\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003ePod\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekube-scheduler\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/scheduler/scheduler.go#L589-L762\"\u003e\u003ccode\u003escheduleOne\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003ePod\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekubelet\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bff9bfb9dfe0f2ea40f1c80cac47fc12b2/pkg/kubelet/kubelet_node_status.go#L374-L391\"\u003e\u003ccode\u003esyncNodeStatus\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eNode\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cul\u003e\n\u003cli\u003eThe podcast episode \u0026ldquo;\u003ca href=\"https://changelog.com/gotime/105\"\u003eGotime #105 – Kubernetes and Cloud Native\u003c/a\u003e\u0026rdquo; (Oct. 2019) with Joe Beda (initiator of Kubernetes) and Kris Nova is very interesting and tells us more about the genesis of the project, which things like why is Kubernetes written in Go and why client-go feels like Java. For example:\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eKris Nova:\u003c/strong\u003e I think there’s a fourth role. I think there’s what we called in the book an infrastructure engineer. These are effectively the folks like Joe and myself. These are the folks who are writing software to manage and mutate infrastructure behind the scenes. Folks who are contributing to Kubernetes, folks who are writing the software for the operators, folks who are writing admission controller implementations and so forth… I think it’s this very new engineer role, that we haven’t seen until we’ve started having – effectively, as Joe likes to put it, a platform-platform.\u003c/p\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003eThe \u003ca href=\"https://github.com/operator-framework/operator-sdk\"\u003eoperator-sdk\u003c/a\u003e (RedHat) is a package that aims at helping dealing with the whole scafollding when writing a sync loop. It relies on \u003ca href=\"https://github.com/kubernetes-sigs/controller-runtime\"\u003econtroller-runtime\u003c/a\u003e. I don\u0026rsquo;t use either of them but taking a look at these projects helps getting more understanding about the challenges (read: boilerplate) that comes when writing controllers. I personally write all the controller-related boilerplate myself (creating the queue, setting event handlers, running the loop itself\u0026hellip;).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAnd a final note: CRDs are not necessary for writing a controller! You can write a tiny controller that watches the \u0026ldquo;standard\u0026rdquo; Kubernetes objects. That\u0026rsquo;s exactly what ingress controllers do: they watch for Service objects.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eUpdate 23 April 2020\u003c/strong\u003e: I added a quote from Kris Nova! 😁\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eUpdate 2 May 2020\u003c/strong\u003e: Rephrased the \u0026ldquo;terminology\u0026rdquo; bullet points to make them clearer and added a note on CRD vs. controller binary.\u003c/li\u003e\n\u003c/ul\u003e\n","date":1587549506,"description":"Kubernetes' extensibility is probably its biggest strength. Controllers and CRDs are all over the place. But finding the right information to begin writing a controller isn't easy due to the sheer amount of tribal knowledge scattered everywhere. Here are some links to help you start.","dir":"2020/learning-kubernetes-controllers/","expirydate":-62135596800,"fuzzywordcount":1000,"images":["learning-kubernetes-controllers/cover-learning-kubernetes-controllers.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1587549506,"objectID":"bbd09cca5d6050a160c38a6f108f6ec0","permalink":"https://maelvls.dev/do-not-share-yet/learning-kubernetes-controllers/","publishdate":"2020-04-22T11:58:26+02:00","readingtime":5,"relpermalink":"/do-not-share-yet/learning-kubernetes-controllers/","section":"2020","summary":"\u003cp\u003eKubernetes\u0026rsquo; extensibility is probably its biggest strength. Controllers and CRDs are all over the place. But finding the right information to begin writing a controller isn\u0026rsquo;t easy due to the sheer amount of tribal knowledge scattered everywhere. This post intends to help you start with controllers.\u003c/p\u003e\n\u003c!--\n\n\u003e A \"Kubernetes controller\" is a binary that runs reconciliation loops. A\n\u003e reconciliation loop watches the objects stored in Kubernetes. When it\n\u003e notices a discrepency between what the object specifies (e.g. 4 replicas)\n\u003e and the observed reality (e.g., the reconcialiation loop asks kubelet,\n\u003e and it answers there are only 2 replicas), the reconcialiation loop will\n\u003e take actions in order to satisfy what is specified in the object. The\n\u003e \"controller\" binary is run as a simple Kubernetes Deployment. Sometimes,\n\u003e when the Kubernetes API is not enough, it may also come with some\n\u003e CustomResourceDefinitions YAML files.\n\nI use interchangeably the term \"sync loop\" and \"controller\". The word\n\"controller\" is quite overloaded: we use to qualify the binary that runs in\na pod and watches for objects (\"Kubernetes controller\"), but we also use it\nto mean \"one sync loop\" that is running inside this binary.\n\nAnyone writing Kubernetes controllers might want to take a look at the\nfollowing resources.\nOne controller\n\n**[Kubernetes API conventions](https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md)**\n\n\u003e When a new version of an object is POSTed or PUT, the \"spec\" is updated\n\u003e and available immediately. Over time the system will work to bring the\n\u003e \"status\" into line with the \"spec\". The system will drive toward the most\n\u003e recent \"spec\" regardless of previous versions of that stanza. In other\n\u003e words, if a value is changed from 2 to 5 in one PUT and then back down to\n\u003e 3 in another PUT the system is not required to 'touch base' at 5 before\n\u003e changing the \"status\" to 3. In other words, the system's behavior is\n\u003e level-based rather than edge-based. This enables robust behavior in the\n\u003e presence of missed intermediate state changes.\n\n--\u003e\n\u003chr\u003e\n\u003cp\u003eLet us begin with some terminology:\u003c/p\u003e","tags":["kubernetes","controllers"],"title":"Learning Kubernetes Controllers","type":"2020","url":"https://maelvls.dev/do-not-share-yet/learning-kubernetes-controllers/","weight":0,"wordcount":903},{"authors":null,"categories":null,"content":"\u003cp\u003eAfter reading the venerable \u0026ldquo;\u003ca href=\"https://www.ardanlabs.com/blog/2014/12/using-pointers-in-go.html\"\u003eUsing Pointers In Go (2014)\u003c/a\u003e\u0026rdquo;. In this post, William Kennedy mentions the \u0026ldquo;tribal knowledge\u0026rdquo; around the use of pointers:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eMy use of pointers is based on discoveries I have made looking at code from the standard library. There are always exceptions to these rules, but what I will show you is common practice. It starts with classifying the type of value that needs to be shared. These type classifications are built-in, struct and reference types. Let’s look at each one individually. — William Kennedy\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eAs far as I remember, Go was created with a minimal set of features. Why did pointers make it into Go when we all know how confusing they are? I really wich the Go team had gone with a pointer-less language but with \u0026ldquo;move\u0026rdquo; semantics\u0026hellip; That would have avoided the need for \u003ccode\u003enil\u003c/code\u003e entirely!\u003c/p\u003e\n\u003cp\u003eAt least, Go doesn\u0026rsquo;t have arithmetic on pointers! With this, we avoid a whole class of bugs that can be typically found in C and C++ and is the source of endless security patches.\u003c/p\u003e\n\u003cp\u003eAnyway; now that we are stuck with pointers, I want to talk about how I deal with them and how to \u0026ldquo;model\u0026rdquo; some of the decisions (using pointer vs passing by value) based on the \u0026ldquo;ownership\u0026rdquo; of the data they point to.\u003c/p\u003e\n\u003cp\u003eWhen developing Kubernetes controllers, you end up with a lot of pointer manipulation. A good practice in Go is to announce that an argument will be mutated by passing it by pointer (I mean, that\u0026rsquo;s what \u0026hellip;\u0026hellip;\u0026hellip;\u0026hellip;)\u003c/p\u003e\n\u003c!-- ![Example of a PR comment mentioning that a pointer automatically means \"watch out, this data is modified by the function\"](pointer-and-ownership.png) --\u003e\n\u003c!--\nhttps://github.com/ori-edge/edge-platform-controllers/pull/24\n--\u003e\n\u003cp\u003eImagine you have:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e \u003cspan class=\"nx\"\u003eCondition\u003c/span\u003e \u003cspan class=\"kd\"\u003estruct\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eType\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Update mutates the given slice.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eUpdate\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"nx\"\u003eCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"nx\"\u003eCondition\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eType\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"nx\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eType\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003enew\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// Condition type doesn\u0026#39;t currently exist, add it.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nb\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe are mutating \u003ccode\u003ecurrent\u003c/code\u003e but we still return it, which is confusing: is the function mutating \u003ccode\u003ecurrent\u003c/code\u003e?\u003c/p\u003e\n\u003cp\u003eOne better way would be to write:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eUpdate\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"nx\"\u003eCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003enew\u003c/span\u003e \u003cspan class=\"nx\"\u003eCondition\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"nx\"\u003eCondition\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ec\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"k\"\u003erange\u003c/span\u003e \u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003ec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eType\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"nx\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eType\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nb\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"o\"\u003e...\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e+\u003c/span\u003e\u003cspan class=\"mf\"\u003e1.\u003c/span\u003e\u003cspan class=\"p\"\u003e..])\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// Condition type doesn\u0026#39;t currently exist, add it.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nb\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003enew\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThat\u0026rsquo;s much better.\u003c/p\u003e\n\u003ch2 id=\"pointer-or-not-pointer\"\u003ePointer or not pointer?\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e \u003cspan class=\"nx\"\u003eDictionary\u003c/span\u003e \u003cspan class=\"kd\"\u003estruct\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ewords\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"kt\"\u003estring\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eAddWord\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ed\u003c/span\u003e \u003cspan class=\"nx\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eentry\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nx\"\u003eDictionary\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWith that signature, I immediately see the data flow: a new Dictionary is returned. But what about \u003ccode\u003ewords\u003c/code\u003e? If we don\u0026rsquo;t copy the whole slice, both \u003ccode\u003ewords\u003c/code\u003e will point to the same slice.\u003c/p\u003e\n\u003cp\u003eThe \u003ccode\u003ewords\u003c/code\u003e slice is a shared resource.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003eAddWord\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ed\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eDictionary\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eentry\u003c/span\u003e \u003cspan class=\"kt\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe kind of avoid that kind of signature in go \u0026ndash; at least when it\u0026rsquo;s possible to avoid it. We can\u0026rsquo;t see the flow of data. Even worse: imagine that this function works with an interface, which means the \u003ccode\u003e*\u003c/code\u003e won\u0026rsquo;t even help us guess that this data is shared.\u003c/p\u003e\n\u003ch2 id=\"the-for-loop-gotcha\"\u003eThe for loop gotcha\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://stackoverflow.com/questions/52980172/cannot-understand-5-6-1-caveat-capturing-iteration-variables\"\u003ehttps://stackoverflow.com/questions/52980172/cannot-understand-5-6-1-caveat-capturing-iteration-variables\u003c/a\u003e\u003c/p\u003e\n","date":1587449857,"description":"","dir":"2020/go-pointers-and-ownership/","expirydate":-62135596800,"fuzzywordcount":500,"images":["go-pointers-and-ownership/cover-go-pointers-and-ownership.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1587449857,"objectID":"a4b6cc4c040c1f2a4d1c123139916fbe","permalink":"https://maelvls.dev/do-not-share-yet/go-pointers-and-ownership/","publishdate":"2020-04-21T08:17:37+02:00","readingtime":3,"relpermalink":"/do-not-share-yet/go-pointers-and-ownership/","section":"2020","summary":"\u003cp\u003eAfter reading the venerable \u0026ldquo;\u003ca href=\"https://www.ardanlabs.com/blog/2014/12/using-pointers-in-go.html\"\u003eUsing Pointers In Go (2014)\u003c/a\u003e\u0026rdquo;. In this post, William Kennedy mentions the \u0026ldquo;tribal knowledge\u0026rdquo; around the use of pointers:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eMy use of pointers is based on discoveries I have made looking at code from the standard library. There are always exceptions to these rules, but what I will show you is common practice. It starts with classifying the type of value that needs to be shared. These type classifications are built-in, struct and reference types. Let’s look at each one individually. — William Kennedy\u003c/p\u003e","tags":null,"title":"Go, pointers and data ownership","type":"2020","url":"https://maelvls.dev/do-not-share-yet/go-pointers-and-ownership/","weight":0,"wordcount":492},{"authors":null,"categories":null,"content":"\u003cul\u003e\n\u003cli\u003eGo (powerline/bullettrain-like) \u003ca href=\"https://github.com/jtyr/gbt\"\u003ehttps://github.com/jtyr/gbt\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eGo (powerline-like): \u003ca href=\"https://github.com/bullettrain-sh/bullettrain-go-core\"\u003ehttps://github.com/bullettrain-sh/bullettrain-go-core\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eRust: \u003ca href=\"https://github.com/starship/starship\"\u003ehttps://github.com/starship/starship\u003c/a\u003e (git not async: \u003ca href=\"https://github.com/starship/starship/issues/301\"\u003ehttps://github.com/starship/starship/issues/301\u003c/a\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSpecification:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emust be fast (pure zsh themes are just too slow)\u003c/li\u003e\n\u003cli\u003egit should be \u003ca href=\"https://github.com/mafredri/zsh-async\"\u003easync\u003c/a\u003e like with \u003ca href=\"https://github.com/agkozak/agkozak-zsh-prompt\"\u003eagkozak/agkozak-zsh-prompt\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003edisplay the current kubernetes user \u0026amp; context \u0026amp; cluster\u003c/li\u003e\n\u003cli\u003edisplay if I\u0026rsquo;m in a Go module or GOPATH\u003c/li\u003e\n\u003c/ul\u003e\n","date":1587340800,"description":"","dir":"2020/proper-prompt/","expirydate":-62135596800,"fuzzywordcount":100,"images":[],"keywords":null,"kind":"page","lang":"en","lastmod":1587340800,"objectID":"cec1959796bda39532af5967e8258600","permalink":"https://maelvls.dev/do-not-share-yet/proper-prompt/","publishdate":"2020-04-20T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/proper-prompt/","section":"2020","summary":"\u003cul\u003e\n\u003cli\u003eGo (powerline/bullettrain-like) \u003ca href=\"https://github.com/jtyr/gbt\"\u003ehttps://github.com/jtyr/gbt\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eGo (powerline-like): \u003ca href=\"https://github.com/bullettrain-sh/bullettrain-go-core\"\u003ehttps://github.com/bullettrain-sh/bullettrain-go-core\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eRust: \u003ca href=\"https://github.com/starship/starship\"\u003ehttps://github.com/starship/starship\u003c/a\u003e (git not async: \u003ca href=\"https://github.com/starship/starship/issues/301\"\u003ehttps://github.com/starship/starship/issues/301\u003c/a\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSpecification:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emust be fast (pure zsh themes are just too slow)\u003c/li\u003e\n\u003cli\u003egit should be \u003ca href=\"https://github.com/mafredri/zsh-async\"\u003easync\u003c/a\u003e like with \u003ca href=\"https://github.com/agkozak/agkozak-zsh-prompt\"\u003eagkozak/agkozak-zsh-prompt\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003edisplay the current kubernetes user \u0026amp; context \u0026amp; cluster\u003c/li\u003e\n\u003cli\u003edisplay if I\u0026rsquo;m in a Go module or GOPATH\u003c/li\u003e\n\u003c/ul\u003e","tags":null,"title":"A proper prompt","type":"2020","url":"https://maelvls.dev/do-not-share-yet/proper-prompt/","weight":0,"wordcount":48},{"authors":null,"categories":null,"content":"\u003cul\u003e\n\u003cli\u003elevel-based events -\u0026gt; state is\u0026hellip;\u003c/li\u003e\n\u003cli\u003eedge-triggered state -\u0026gt; state is\u0026hellip;\u003c/li\u003e\n\u003cli\u003eASK KRIS NOVA\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"is-kubernetes-event-driven\"\u003eIs Kubernetes event driven?\u003c/h2\u003e\n\u003cp\u003eBy event driven, I mean a system that works by reacting to events. For example, a simple event driven system would be\u003c/p\u003e\n","date":1587340800,"description":"","dir":"2020/kubernetes-level-based-behaviour/","expirydate":-62135596800,"fuzzywordcount":100,"images":[],"keywords":null,"kind":"page","lang":"en","lastmod":1587340800,"objectID":"bbb11158c8086305679720b7b61ae862","permalink":"https://maelvls.dev/do-not-share-yet/kubernetes-level-based-state/","publishdate":"2020-04-20T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/kubernetes-level-based-state/","section":"2020","summary":"\u003cul\u003e\n\u003cli\u003elevel-based events -\u0026gt; state is\u0026hellip;\u003c/li\u003e\n\u003cli\u003eedge-triggered state -\u0026gt; state is\u0026hellip;\u003c/li\u003e\n\u003cli\u003eASK KRIS NOVA\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"is-kubernetes-event-driven\"\u003eIs Kubernetes event driven?\u003c/h2\u003e\n\u003cp\u003eBy event driven, I mean a system that works by reacting to events. For example, a simple event driven system would be\u003c/p\u003e","tags":["kubernetes"],"title":"Kubernetes level-based behaviour","type":"2020","url":"https://maelvls.dev/do-not-share-yet/kubernetes-level-based-state/","weight":0,"wordcount":39},{"authors":null,"categories":null,"content":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewhois \u003cspan class=\"k\"\u003e$(\u003c/span\u003ecurl ifconfig.me/ip\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% Information related to \u003cspan class=\"s1\"\u003e\u0026#39;90.76.0.0/16AS3215\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroute:          90.76.0.0/16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edescr:          France Telecom IP2000-ADSL-BAS\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eorigin:         AS3215                           \u003cspan class=\"c1\"\u003e# ✳\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emnt-by:         FT-BRX\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecreated:        2018-08-16T14:22:19Z\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elast-modified:  2018-08-16T14:22:19Z\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esource:         RIPE\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://bgp.he.net/AS5511\"\u003eAS3215\u003c/a\u003e is my ISP\u0026rsquo;s autonomous system.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% sudo mtr google.fr\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                        My traceroute  \u003cspan class=\"o\"\u003e[\u003c/span\u003ev0.93\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emacbook-pro-de-mael-2.home \u003cspan class=\"o\"\u003e(\u003c/span\u003e2a01:cb19:86a2:8c00:20db:756d:83b3:8891\u003cspan class=\"o\"\u003e)\u003c/span\u003e         2020-04-19T17:55:26+0200\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eKeys:  Help   Display mode   Restart statistics   Order of fields   quit\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                             Packets               Pings\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e Host                                                      Loss%   Snt   Last   Avg  Best  Wrst StDev\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 1. livebox.home                                            0.0%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e    5.6  41.7   3.2 700.4 128.3\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 2. 2a01cb08a00402190193025300740181.ipv6.abo.wanadoo.fr    0.0%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   18.5  61.2   9.8 1012. 158.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 3. 2a01:cfc4:0:d00::a                                      0.0%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   42.9  55.9  16.5 957.9 137.9\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 4. bundle-ether103.pastr4.-.opentransit.net               76.5%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   31.8  33.3  23.3  60.9  11.5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 5. et-15-0-2-0.pastr3.-.opentransit.net                    0.0%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   59.6  70.8  23.4 1050. 153.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 6. 2001:4860:1:1::336                                      0.0%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   41.0  67.6  23.6 943.7 133.7\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 7. 2001:4860:0:1017::1                                    49.3%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   29.9  77.2  25.3 1046. 185.7\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 8. 2001:4860:0:1::1e3b                                     0.0%    \u003cspan class=\"m\"\u003e68\u003c/span\u003e   34.5  80.7  23.0 952.3 179.7\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 9. par10s29-in-x03.1e100.net                               0.0%    \u003cspan class=\"m\"\u003e68\u003c/span\u003e   29.1  72.1  23.7 836.8 154.7\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% subnetcalc 80.10.236.253/26\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eAddress\u003c/span\u003e       \u003cspan class=\"o\"\u003e=\u003c/span\u003e 80.10.236.253\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                   \u003cspan class=\"m\"\u003e01010000\u003c/span\u003e . \u003cspan class=\"m\"\u003e00001010\u003c/span\u003e . \u003cspan class=\"m\"\u003e11101100\u003c/span\u003e . \u003cspan class=\"m\"\u003e11111101\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eNetwork\u003c/span\u003e       \u003cspan class=\"o\"\u003e=\u003c/span\u003e 80.10.236.192 / \u003cspan class=\"m\"\u003e26\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eNetmask\u003c/span\u003e       \u003cspan class=\"o\"\u003e=\u003c/span\u003e 255.255.255.192\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eBroadcast\u003c/span\u003e     \u003cspan class=\"o\"\u003e=\u003c/span\u003e 80.10.236.255\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eWildcard \u003cspan class=\"nv\"\u003eMask\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e 0.0.0.63\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHosts \u003cspan class=\"nv\"\u003eBits\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e6\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eMax. \u003cspan class=\"nv\"\u003eHosts\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e62\u003c/span\u003e   \u003cspan class=\"o\"\u003e(\u003c/span\u003e2^6 - 2\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost \u003cspan class=\"nv\"\u003eRange\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e 80.10.236.193 - 80.10.236.254 \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eProperties\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   - 80.10.236.253 is a HOST address in 80.10.236.192/26\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   - Class A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eDNS \u003cspan class=\"nv\"\u003eHostname\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003enodename nor servname provided, or not known\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc route-server.opentransit.net \u003cspan class=\"m\"\u003e23\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         route-server.opentransit.net -- \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e Opentransit\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        IPv4/IPv6 views\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eThis router keeps peering sessions with all the Opentransit Backbone Routers,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ethroughout the Opentransit IP Backbone as follows:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eIPv4/IPv6 view\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.1             IPv6: 2001:688:0:1::158 Dallas\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.3             IPv6: 2001:688:0:1::1c  Los Angeles\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.7             IPv6: 2001:688:0:1::55  London\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPV4: 193.251.245.9             IPv6: 2001:688:0:1::41  Palo Alto\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.10            IPv6: 2001:688:0:1::4e  Paris\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.16            IPv6: 2001:688:0:1::168 New York\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.19            IPv6: 2001:688:0:1::4b  Barcelona\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.28            IPv6: 2001:688:0:1::8   Frankfurt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.37            IPv6: 2001:688:0:1::    Frankfurt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.49            IPv6: 2001:688:0:1::19  London\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.53            IPv6: 2001:688:0:1::1e  Chicago\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.57            IPv6: 2001:688:0:1::45  Miami\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.66            IPv6: 2001:688:0:1::44  Geneva\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPV4: 193.251.245.69            IPV6: 2001:688:0:1::56  Singapore\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.76            IPv6: 2001:688:0:1::d   New York\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.78            IPv6: 2001:688:0:1::22  Madrid\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.81            IPv6: 2001:688:0:1::4   Barcelona\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.88            IPv6: 2001:688:0:1::f   London\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.254.92            IPv6: 2001:688:0:1::24  Paris\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.96            IPv6: 2001:688:0:1::3E  Brussels\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.134           IPv6: 2001:688:0:1::4a  Zurich\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.147           IPv6: 2001:688:0:1::2A  HongKong\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.163           IPv6: 2001:688:0:1::18  New York\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.170           IPv6: 2001:688:0:1::2f  Madrid\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.181           IPv6: 2001:688:0:1::3C  Singapore\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.196           IPv6: 2001:688:0:1::57  Frankfurt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.216           IPv6: 2001:688:0:1::16  Miami\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.251           IPv6: 2001:688:0:1::30  Amsterdam\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.252           IPv6: 2001:688:0:1::12  Ashburn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eFor questions about this route-server, send email to: opentransit.iptac@orange.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e*** Log in with username \u003cspan class=\"s1\"\u003e\u0026#39;rviews\u0026#39;\u003c/span\u003e, password \u003cspan class=\"s1\"\u003e\u0026#39;Rviews\u0026#39;\u003c/span\u003e ***\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eUser Access Verification\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eUsername: rviews\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erviews\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePassword: Rviews\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOAKRS1#show ?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eshow ?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  banner      Display banner information\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  bgp         BGP information\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  bootflash:  display information about bootflash: file system\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  flash:      display information about flash: file system\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  ip          IP information\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  ipv6        IPv6 information\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  webui:      display information about webui: file system\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u0026lt;cr\u0026gt;        \u0026lt;cr\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOAKRS1#show\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% Type \u003cspan class=\"s2\"\u003e\u0026#34;show ?\u0026#34;\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e a list of subcommands\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOAKRS1#show bgp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eshow bgp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% Command accepted but obsolete, unreleased or unsupported\u003cspan class=\"p\"\u003e;\u003c/span\u003e see documentation.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBGP table version is 183946817, \u003cspan class=\"nb\"\u003elocal\u003c/span\u003e router ID is 204.59.3.38\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStatus codes: s suppressed, d damped, h history, * valid, \u0026gt; best, i - internal,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e              r RIB-failure, S Stale, m multipath, b backup-path, f RT-Filter,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e              x best-external, a additional-path, c RIB-compressed,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e              t secondary path, L long-lived-stale,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOrigin codes: i - IGP, e - EGP, ? - incomplete\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eRPKI validation codes: V valid, I invalid, N Not found\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     Network          Next Hop            Metric LocPrf Weight Path\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e r\u0026gt;i  0.0.0.0          193.251.245.7                 \u003cspan class=\"m\"\u003e100\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e r i                   193.251.245.252               \u003cspan class=\"m\"\u003e100\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i  1.0.0.0/24       4.68.70.169            \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   195.219.87.114         \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e6453\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   4.68.63.97             \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   4.68.73.97             \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   193.251.249.46         \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e2914\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   4.68.127.233           \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   129.250.66.141         \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e2914\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   193.251.247.156        \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e2914\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   4.68.70.173            \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   66.198.127.81          \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e6453\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   4.68.73.153            \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1587311515,"description":"","dir":"2020/bgp-101/","expirydate":-62135596800,"fuzzywordcount":700,"images":["bgp-101/cover-bgp-101.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1587311515,"objectID":"2f6560ae04990c5439efaaafed633b28","permalink":"https://maelvls.dev/do-not-share-yet/bgp-101/","publishdate":"2020-04-19T17:51:55+02:00","readingtime":4,"relpermalink":"/do-not-share-yet/bgp-101/","section":"2020","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewhois \u003cspan class=\"k\"\u003e$(\u003c/span\u003ecurl ifconfig.me/ip\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% Information related to \u003cspan class=\"s1\"\u003e\u0026#39;90.76.0.0/16AS3215\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eroute:          90.76.0.0/16\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edescr:          France Telecom IP2000-ADSL-BAS\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eorigin:         AS3215                           \u003cspan class=\"c1\"\u003e# ✳\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emnt-by:         FT-BRX\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecreated:        2018-08-16T14:22:19Z\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elast-modified:  2018-08-16T14:22:19Z\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esource:         RIPE\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://bgp.he.net/AS5511\"\u003eAS3215\u003c/a\u003e is my ISP\u0026rsquo;s autonomous system.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% sudo mtr google.fr\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                        My traceroute  \u003cspan class=\"o\"\u003e[\u003c/span\u003ev0.93\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emacbook-pro-de-mael-2.home \u003cspan class=\"o\"\u003e(\u003c/span\u003e2a01:cb19:86a2:8c00:20db:756d:83b3:8891\u003cspan class=\"o\"\u003e)\u003c/span\u003e         2020-04-19T17:55:26+0200\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eKeys:  Help   Display mode   Restart statistics   Order of fields   quit\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                             Packets               Pings\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e Host                                                      Loss%   Snt   Last   Avg  Best  Wrst StDev\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 1. livebox.home                                            0.0%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e    5.6  41.7   3.2 700.4 128.3\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 2. 2a01cb08a00402190193025300740181.ipv6.abo.wanadoo.fr    0.0%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   18.5  61.2   9.8 1012. 158.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 3. 2a01:cfc4:0:d00::a                                      0.0%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   42.9  55.9  16.5 957.9 137.9\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 4. bundle-ether103.pastr4.-.opentransit.net               76.5%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   31.8  33.3  23.3  60.9  11.5\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 5. et-15-0-2-0.pastr3.-.opentransit.net                    0.0%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   59.6  70.8  23.4 1050. 153.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 6. 2001:4860:1:1::336                                      0.0%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   41.0  67.6  23.6 943.7 133.7\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 7. 2001:4860:0:1017::1                                    49.3%    \u003cspan class=\"m\"\u003e69\u003c/span\u003e   29.9  77.2  25.3 1046. 185.7\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 8. 2001:4860:0:1::1e3b                                     0.0%    \u003cspan class=\"m\"\u003e68\u003c/span\u003e   34.5  80.7  23.0 952.3 179.7\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 9. par10s29-in-x03.1e100.net                               0.0%    \u003cspan class=\"m\"\u003e68\u003c/span\u003e   29.1  72.1  23.7 836.8 154.7\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% subnetcalc 80.10.236.253/26\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eAddress\u003c/span\u003e       \u003cspan class=\"o\"\u003e=\u003c/span\u003e 80.10.236.253\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                   \u003cspan class=\"m\"\u003e01010000\u003c/span\u003e . \u003cspan class=\"m\"\u003e00001010\u003c/span\u003e . \u003cspan class=\"m\"\u003e11101100\u003c/span\u003e . \u003cspan class=\"m\"\u003e11111101\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eNetwork\u003c/span\u003e       \u003cspan class=\"o\"\u003e=\u003c/span\u003e 80.10.236.192 / \u003cspan class=\"m\"\u003e26\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eNetmask\u003c/span\u003e       \u003cspan class=\"o\"\u003e=\u003c/span\u003e 255.255.255.192\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eBroadcast\u003c/span\u003e     \u003cspan class=\"o\"\u003e=\u003c/span\u003e 80.10.236.255\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eWildcard \u003cspan class=\"nv\"\u003eMask\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e 0.0.0.63\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHosts \u003cspan class=\"nv\"\u003eBits\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e6\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eMax. \u003cspan class=\"nv\"\u003eHosts\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"m\"\u003e62\u003c/span\u003e   \u003cspan class=\"o\"\u003e(\u003c/span\u003e2^6 - 2\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost \u003cspan class=\"nv\"\u003eRange\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e{\u003c/span\u003e 80.10.236.193 - 80.10.236.254 \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eProperties\u003c/span\u003e    \u003cspan class=\"o\"\u003e=\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   - 80.10.236.253 is a HOST address in 80.10.236.192/26\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   - Class A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eDNS \u003cspan class=\"nv\"\u003eHostname\u003c/span\u003e  \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003enodename nor servname provided, or not known\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc route-server.opentransit.net \u003cspan class=\"m\"\u003e23\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u0026amp;\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         route-server.opentransit.net -- \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e Opentransit\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        IPv4/IPv6 views\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eThis router keeps peering sessions with all the Opentransit Backbone Routers,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ethroughout the Opentransit IP Backbone as follows:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003eIPv4/IPv6 view\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.1             IPv6: 2001:688:0:1::158 Dallas\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.3             IPv6: 2001:688:0:1::1c  Los Angeles\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.7             IPv6: 2001:688:0:1::55  London\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPV4: 193.251.245.9             IPv6: 2001:688:0:1::41  Palo Alto\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.10            IPv6: 2001:688:0:1::4e  Paris\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.16            IPv6: 2001:688:0:1::168 New York\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.19            IPv6: 2001:688:0:1::4b  Barcelona\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.28            IPv6: 2001:688:0:1::8   Frankfurt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.37            IPv6: 2001:688:0:1::    Frankfurt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.49            IPv6: 2001:688:0:1::19  London\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.53            IPv6: 2001:688:0:1::1e  Chicago\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.57            IPv6: 2001:688:0:1::45  Miami\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.66            IPv6: 2001:688:0:1::44  Geneva\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPV4: 193.251.245.69            IPV6: 2001:688:0:1::56  Singapore\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.76            IPv6: 2001:688:0:1::d   New York\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.78            IPv6: 2001:688:0:1::22  Madrid\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.81            IPv6: 2001:688:0:1::4   Barcelona\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.88            IPv6: 2001:688:0:1::f   London\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.254.92            IPv6: 2001:688:0:1::24  Paris\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.96            IPv6: 2001:688:0:1::3E  Brussels\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.134           IPv6: 2001:688:0:1::4a  Zurich\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.147           IPv6: 2001:688:0:1::2A  HongKong\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.163           IPv6: 2001:688:0:1::18  New York\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.170           IPv6: 2001:688:0:1::2f  Madrid\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.181           IPv6: 2001:688:0:1::3C  Singapore\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.196           IPv6: 2001:688:0:1::57  Frankfurt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.216           IPv6: 2001:688:0:1::16  Miami\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.251           IPv6: 2001:688:0:1::30  Amsterdam\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIPv4: 193.251.245.252           IPv6: 2001:688:0:1::12  Ashburn\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eFor questions about this route-server, send email to: opentransit.iptac@orange.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e*** Log in with username \u003cspan class=\"s1\"\u003e\u0026#39;rviews\u0026#39;\u003c/span\u003e, password \u003cspan class=\"s1\"\u003e\u0026#39;Rviews\u0026#39;\u003c/span\u003e ***\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eUser Access Verification\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eUsername: rviews\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003erviews\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePassword: Rviews\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOAKRS1#show ?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eshow ?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  banner      Display banner information\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  bgp         BGP information\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  bootflash:  display information about bootflash: file system\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  flash:      display information about flash: file system\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  ip          IP information\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  ipv6        IPv6 information\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  webui:      display information about webui: file system\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u0026lt;cr\u0026gt;        \u0026lt;cr\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOAKRS1#show\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% Type \u003cspan class=\"s2\"\u003e\u0026#34;show ?\u0026#34;\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e a list of subcommands\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOAKRS1#show bgp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eshow bgp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% Command accepted but obsolete, unreleased or unsupported\u003cspan class=\"p\"\u003e;\u003c/span\u003e see documentation.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBGP table version is 183946817, \u003cspan class=\"nb\"\u003elocal\u003c/span\u003e router ID is 204.59.3.38\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStatus codes: s suppressed, d damped, h history, * valid, \u0026gt; best, i - internal,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e              r RIB-failure, S Stale, m multipath, b backup-path, f RT-Filter,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e              x best-external, a additional-path, c RIB-compressed,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e              t secondary path, L long-lived-stale,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eOrigin codes: i - IGP, e - EGP, ? - incomplete\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eRPKI validation codes: V valid, I invalid, N Not found\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     Network          Next Hop            Metric LocPrf Weight Path\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e r\u0026gt;i  0.0.0.0          193.251.245.7                 \u003cspan class=\"m\"\u003e100\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e r i                   193.251.245.252               \u003cspan class=\"m\"\u003e100\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i  1.0.0.0/24       4.68.70.169            \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   195.219.87.114         \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e6453\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   4.68.63.97             \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   4.68.73.97             \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   193.251.249.46         \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e2914\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   4.68.127.233           \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   129.250.66.141         \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e2914\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   193.251.247.156        \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e2914\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   4.68.70.173            \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   66.198.127.81          \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e6453\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e * i                   4.68.73.153            \u003cspan class=\"m\"\u003e100\u003c/span\u003e     \u003cspan class=\"m\"\u003e85\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"m\"\u003e3356\u003c/span\u003e \u003cspan class=\"m\"\u003e13335\u003c/span\u003e i\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":null,"title":"BGP 101","type":"2020","url":"https://maelvls.dev/do-not-share-yet/bgp-101/","weight":0,"wordcount":670},{"authors":null,"categories":null,"content":"\u003cp\u003eLet\u0026rsquo;s go through the client-certificate in my kube config. This kube config contains one user, \u0026ldquo;kind-kind\u0026rdquo;. Instead of inspecting the certificate PEM with openssl, I use \u003ca href=\"https://github.com/square/certigo\"\u003ecertigo\u003c/a\u003e (much nicer experience!)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl config view -ojson --flatten \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e jq \u003cspan class=\"s1\"\u003e\u0026#39;.users[] | .user.\u0026#34;client-certificate-data\u0026#34; | select(.!=null)\u0026#39;\u003c/span\u003e -r \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e base64 -d \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e certigo dump\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThat gives us:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e** CERTIFICATE 1 **\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eValid: 2020-03-03 12:31 UTC to 2021-03-03 12:31 UTC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSubject:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    O=system:masters, CN=kubernetes-admin\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIssuer:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    CN=kubernetes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eWarnings:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Certificate doesn\u0026#39;t have any valid DNS/URI names or IP addresses set\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe common name (\u003ccode\u003eCN=\u003c/code\u003e) is \u0026ldquo;kubernetes-admin\u0026rdquo;, that\u0026rsquo;s the name of the user. The organization (\u003ccode\u003eO=\u003c/code\u003e) is \u0026ldquo;system:master\u0026rdquo;.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eQuick recap of what a certificate is. For us, \u0026ldquo;certificate\u0026rdquo; means a \u003ca href=\"https://tools.ietf.org/html/rfc5280#section-4.1\"\u003eX.509-v3\u003c/a\u003e-formated binary chunk. This binary chunk is, most of the time, presented in the PEM format (the binary chunk is encoded in base 64 and wrapped with some decorations:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-----BEGIN RSA PRIVATE KEY-----\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026lt;the base64-encoded X.509 binary chunk\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-----END RSA PRIVATE KEY-----\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis chunk of binary data contains three important parts:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003ethe public key of the certificate,\u003c/li\u003e\n\u003cli\u003ea list of attributes, e.g. \u003ccode\u003eO=Google LLC,CN=*.google.com\u003c/code\u003e,\u003c/li\u003e\n\u003cli\u003ea signature of (1)+(2) created using the certificate authority\u0026rsquo;s private key.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThe CA certificate uses its private key to sign the concatenation of the attributes with the public key:\u003c/p\u003e\n\u003cdiv class=\"nohighlight\"\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e +------------------------------+  +-------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |        CA CERTIFICATE        |  |         CA KEY          |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |+----------------------------+|  |+-----------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e || O=GlobalSign,CN=GlobalSign ||  ||      private key      ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |+----------------------------+|  |+-----------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |+----------------------------+|  +-------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e ||         public key         ||               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |+----------------------------+|               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e +------------------------------+               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e +------------------------------+               |signs using\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |         CERTIFICATE          |               |private key\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |1----------------------------+|               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e ||O=Google LLC,CN=*.google.com||               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |+----------------------------+|               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |2----------------------------+|               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e ||         public key         ||               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |+----------------------------+|               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |+----------------------------+|               |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e ||      signature of 1+2      ||\u0026lt;--------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\u003cp\u003eWhen someone connects to foo.google.com and wants to make sure this server can be trusted, they would use the CA certificates that are securely stored on their disk in order to verify the signature of the untrusted certificate that foo.google.com just sent them.\u003c/p\u003e\n\u003cdiv class=\"nohighlight\"\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                  +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                  |   CA CERTIFICATE (trusted)   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCan I trust foo.google.com?       |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |                     || O=GlobalSign,CN=GlobalSign ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |                     |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |                     |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  +-----------------\u0026gt;||         public key         ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  |                  |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  |                  +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  |check signature   (this cert is secure on my disk)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  |using public key\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        (1) |  |(2)               +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  |                  |    CERTIFICATE (untrusted)   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     verify |  |                  |1----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  signature |  |                  ||O=Google LLC,CN=*.google.com||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  |                  |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  |                  |2----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  |                  ||         public key         ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |  +------------------|+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            |                     |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            +--------------------\u0026gt;||      signature of 1+2      ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                  |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                  +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                  (this cert is sent to me by the\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                            foo.google.com server)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/blockquote\u003e\n\u003c!--\nhttps://textik.com/#d85b4624473ca862\n--\u003e\n\u003cdiv style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"\u003e\n      \u003ciframe allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen\" loading=\"eager\" referrerpolicy=\"strict-origin-when-cross-origin\" src=\"https://www.youtube.com/embed/gXz4cq3PKdg?autoplay=0\u0026amp;controls=1\u0026amp;end=0\u0026amp;loop=0\u0026amp;mute=0\u0026amp;start=0\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" title=\"YouTube video\"\u003e\u003c/iframe\u003e\n    \u003c/div\u003e\n\n\u003chr\u003e\n\u003ch2 id=\"see-the-acme-http-01-protocol-using-pebble-lego-cli-and-mitmproxy\"\u003eSee the ACME HTTP-01 protocol using Pebble, Lego CLI and mitmproxy\u003c/h2\u003e\n\u003cp\u003eFirst, let us create a CA key pair using \u003ca href=\"https://github.com/jsha/minica\"\u003eminica\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego get -u github.com/jsha/minica\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eminica --domains me -ip-addresses 127.0.0.1,0.0.0.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain minica.pem\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe are going to use the domain \u003ccode\u003eme\u003c/code\u003e instead of \u003ccode\u003elocahost\u003c/code\u003e since Go programs \u003ca href=\"https://maelvls.dev/go-ignores-proxy-localhost/\"\u003eare ignoring the proxy settings\u003c/a\u003e when the host of the request is \u003ccode\u003elocalhost\u003c/code\u003e. Thus, we need to make sure we can resolve the \u003ccode\u003eme\u003c/code\u003e name by adding a line in \u003ccode\u003e/etc/hosts\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# /etc/hosts\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e127.0.0.1   me\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, let us run \u003ca href=\"https://mitmproxy.org/\"\u003emitmproxy\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emitmproxy -p \u003cspan class=\"m\"\u003e9090\u003c/span\u003e --set \u003cspan class=\"nv\"\u003essl_verify_upstream_trusted_ca\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eminica.pem\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003eThe \u003ccode\u003eminica.pem\u003c/code\u003e has to be given to mitmproxy since it does not know about the system keychain (on macOS). Even if we added this root CA to the keychain and set it as trusted, mitmproxy uses its own certificate bundle (handled by \u003ca href=\"https://github.com/certifi/python-certifi\"\u003ecertifi\u003c/a\u003e). So we have to give mitmproxy the root CA of the upstream server that mitmproxy will talk to (i.e., pebble).\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eAt this point, let\u0026rsquo;s make sure \u003ccode\u003elego\u003c/code\u003e will trust mitmproxy\u0026rsquo;s man-in-the-middle CA:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo security add-trusted-cert -d -r trustAsRoot -k /Library/Keychains/System.keychain ~/.mitmproxy/mitmproxy-ca-cert.pem\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThen, let us run \u003ca href=\"https://github.com/letsencrypt/pebble\"\u003epebble\u003c/a\u003e, the simple ACME server meant for testing:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego get -u github.com/letsencrypt/pebble/cmd/pebble\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eHTTP_PROXY\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003elocalhost:9090 pebble -config /dev/stdin \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt;EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e{\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  \u0026#34;pebble\u0026#34;: {\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    \u0026#34;listenAddress\u0026#34;: \u0026#34;0.0.0.0:14000\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    \u0026#34;managementListenAddress\u0026#34;: \u0026#34;0.0.0.0:15000\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    \u0026#34;certificate\u0026#34;: \u0026#34;me/cert.pem\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    \u0026#34;privateKey\u0026#34;: \u0026#34;me/key.pem\u0026#34;,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    \u0026#34;httpPort\u0026#34;: 5002,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    \u0026#34;tlsPort\u0026#34;: 5001,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e    \u0026#34;externalAccountBindingRequired\u0026#34;: false\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e  }\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFinally, let us run the ACME client \u003ca href=\"https://github.com/go-acme/lego\"\u003elego\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego get -u github.com/go-acme/lego/v4/cmd/lego\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elego -server\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttps://me:14000/dir -domains me -email foo@bar.org -http.port :5002 -http run\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd there we go!\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"mitmproxy-with-lego-and-pebble.png\" alt=\"Screeshot of mitmproxy running interactively in the terminal and capturing the input and output from Pebble and Lego\"\u003e\u003c/p\u003e\n\u003cp\u003eIf you would like to dig into these traces, you can do so by downloading the mitmproxy flow here:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecurl -O https://maelvls.dev/do-not-share-yet/kubeconfigs-and-certs/pebble-and-lego.mitmproxy\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emitmproxy -r pebble-and-lego.mitmproxy\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1587240847,"description":"","dir":"2020/kubeconfigs-and-certs/","expirydate":-62135596800,"fuzzywordcount":700,"images":["kubeconfigs-and-certs/cover-kubeconfigs-and-certs.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1587240847,"objectID":"c2b88422d3770fe53eb1bbb226fb8202","permalink":"https://maelvls.dev/do-not-share-yet/kubeconfigs-and-certs/","publishdate":"2020-04-18T22:14:07+02:00","readingtime":4,"relpermalink":"/do-not-share-yet/kubeconfigs-and-certs/","section":"2020","summary":"\u003cp\u003eLet\u0026rsquo;s go through the client-certificate in my kube config. This kube config contains one user, \u0026ldquo;kind-kind\u0026rdquo;. Instead of inspecting the certificate PEM with openssl, I use \u003ca href=\"https://github.com/square/certigo\"\u003ecertigo\u003c/a\u003e (much nicer experience!)\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl config view -ojson --flatten \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e jq \u003cspan class=\"s1\"\u003e\u0026#39;.users[] | .user.\u0026#34;client-certificate-data\u0026#34; | select(.!=null)\u0026#39;\u003c/span\u003e -r \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e base64 -d \u003cspan class=\"se\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"se\"\u003e\u003c/span\u003e  \u003cspan class=\"p\"\u003e|\u003c/span\u003e certigo dump\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThat gives us:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e** CERTIFICATE 1 **\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eValid: 2020-03-03 12:31 UTC to 2021-03-03 12:31 UTC\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSubject:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    O=system:masters, CN=kubernetes-admin\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eIssuer:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    CN=kubernetes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eWarnings:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Certificate doesn\u0026#39;t have any valid DNS/URI names or IP addresses set\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe common name (\u003ccode\u003eCN=\u003c/code\u003e) is \u0026ldquo;kubernetes-admin\u0026rdquo;, that\u0026rsquo;s the name of the user. The organization (\u003ccode\u003eO=\u003c/code\u003e) is \u0026ldquo;system:master\u0026rdquo;.\u003c/p\u003e","tags":null,"title":"Kubeconfigs and Certs","type":"2020","url":"https://maelvls.dev/do-not-share-yet/kubeconfigs-and-certs/","weight":0,"wordcount":689},{"authors":null,"categories":null,"content":"\u003cp\u003eLast month, Sylvain Wallez, author of the excellent \u0026ldquo;\u003ca href=\"https://bluxte.net/musings/2018/04/10/go-good-bad-ugly/\"\u003eGo: the Good, the Bad and the Ugly\u003c/a\u003e\u0026rdquo;, wrote:\u003c/p\u003e\n\u003cblockquote class=\"twitter-tweet\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eWoah! Because interface values in Go are represented by two pointers causing assignment to not be atomic, you can easily write concurrent code that swaps one of the pointers, leading to completely unpredictable behaviour. Demonstrated with an RCE... \u003ca href=\"https://t.co/DsMWzpYuQ4\"\u003ehttps://t.co/DsMWzpYuQ4\u003c/a\u003e\u003c/p\u003e\u0026mdash; Sylvain Wallez (@bluxte) \u003ca href=\"https://twitter.com/bluxte/status/1192945301604184065?ref_src=twsrc%5Etfw\"\u003eNovember 8, 2019\u003c/a\u003e\u003c/blockquote\u003e\n\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\n\n\u003cp\u003eOnce again, my beloved language takes a hit. As time passes, I come to realize Go has its strenghts (ease of adoption, no overly abstract REST framework, readability, fast compilation) but also its weaknesses. I can think of the weirdness of variable scoping (\u003ca href=\"https://github.com/kyoh86/scopelint\"\u003escopelint\u003c/a\u003e really helps) and also variable shadowing, weird syntax around variable assignment, \u003ccode\u003ego help\u003c/code\u003e is unreadable and just not up to the standard (compared to \u003ccode\u003egit help\u003c/code\u003e for example), the ever-changing behaviour of GO111MODULE (that\u0026rsquo;s a temporary issue), \u003ccode\u003ego get\u003c/code\u003e that do too many things and changes \u003ccode\u003ego.mod\u003c/code\u003e when you just want to install some tool, but also \u003ccode\u003ego install\u003c/code\u003e \u0026amp; \u003ccode\u003ego run\u003c/code\u003e that don\u0026rsquo;t support versions (e.g. ). Wait, also the \u0026ldquo;semantic import versioning\u0026rdquo; that everybody seems to avoid (including Google itself in \u003ca href=\"https://github.com/golang/protobuf/issues/1049\"\u003eprotobuf\u003c/a\u003e).\u003c/p\u003e\n\u003cp\u003eBut the issue Sylvain raised really bothered me: it felt like a bug.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eGiven \u003ccode\u003ev\u003c/code\u003e a pointer to an interface, \u003ccode\u003ev != nil\u003c/code\u003e when \u003ccode\u003ev\u003c/code\u003e is \u003ccode\u003enil\u003c/code\u003e.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eOooh, let\u0026rsquo;s see.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eBoxed type, fat pointer:\u003c/p\u003e\n\u003cp\u003eDo Go use boxed types for map[string]string? No! It doesn\u0026rsquo;t use interface{} boxing (boxed = fat pointer = one more level of indirection, less locality – same problem as linked lists).\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eHere is a short program:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e \u003cspan class=\"nx\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;strconv\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e \u003cspan class=\"nx\"\u003eabstract\u003c/span\u003e \u003cspan class=\"kd\"\u003einterface\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e \u003cspan class=\"nx\"\u003econcrete\u003c/span\u003e \u003cspan class=\"kd\"\u003estruct\u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estrconv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eItoa\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ev1\u003c/span\u003e \u003cspan class=\"nx\"\u003eabstract\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ev1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ev2\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ev2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLet\u0026rsquo;s go over what \u003ccode\u003ef1\u003c/code\u003e and \u003ccode\u003ef2\u003c/code\u003e do.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# go build . -o ./main\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# go tool objdump -S ./main \u0026gt; main.s\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eTEXT\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.concrete.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eUsers\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003emvalais\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ecode\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ego\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eatomic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eissue\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ewallez\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003etweet\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003emain.go\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003efunc \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994c0\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e65488\u003c/span\u003e\u003cspan class=\"n\"\u003eb0c2530000000\u003c/span\u003e\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eGS\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x30\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eCX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994c9\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e483\u003c/span\u003e\u003cspan class=\"n\"\u003eb6110\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCMPQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCX\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994cd\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"n\"\u003ef869c000000\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eJBE\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x109956f\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994d3\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4883\u003c/span\u003e\u003cspan class=\"n\"\u003eec58\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eSUBQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x58\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994d7\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48896\u003c/span\u003e\u003cspan class=\"n\"\u003ec2450\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x50\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994dc\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed6c2450\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x50\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nf\"\u003efmt.Print\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003estrconv.Itoa\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994e1\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48\u003c/span\u003e\u003cspan class=\"n\"\u003ec7042401000000\u003c/span\u003e\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eFormatInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003eint64\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994e9\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48\u003c/span\u003e\u003cspan class=\"n\"\u003ec74424080a000000\u003c/span\u003e\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0xa\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x8\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994f2\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee8097ffcff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003estrconv.FormatInt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994f7\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003eb442410\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10994fc\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003eb4c2418\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x18\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eCX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nf\"\u003efmt.Print\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nf\"\u003estrconv.Itoa\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099501\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48890424\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099505\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48894\u003c/span\u003e\u003cspan class=\"n\"\u003ec2408\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eCX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x8\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109950a\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee8a1f7f6ff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003eruntime.convTstring\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109950f\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003eb442410\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099514\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"n\"\u003ef57c0\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eXORPS\u003c/span\u003e \u003cspan class=\"n\"\u003eX0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eX0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099517\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"n\"\u003ef11442440\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVUPS\u003c/span\u003e \u003cspan class=\"n\"\u003eX0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x40\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109951c\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed0dfd1a0100\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"n\"\u003eruntime.types\u003c/span\u003e\u003cspan class=\"m\"\u003e+72160\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eCX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099523\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48894\u003c/span\u003e\u003cspan class=\"n\"\u003ec2440\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eCX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x40\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099528\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4889442448\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x48\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nf\"\u003eFprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eos.Stdout\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ea...\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109952d\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003eb05c4ea0d00\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"nf\"\u003eos.Stdout\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099534\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed0d251b0500\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"n\"\u003ego.itab.\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eos.File\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nf\"\u003eio.Writer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eCX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109953b\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48890\u003c/span\u003e\u003cspan class=\"n\"\u003ec24\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eCX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109953f\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4889442408\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x8\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099544\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed442440\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x40\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099549\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4889442410\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109954e\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48\u003c/span\u003e\u003cspan class=\"n\"\u003ec744241801000000\u003c/span\u003e\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x18\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099557\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48\u003c/span\u003e\u003cspan class=\"n\"\u003ec744242001000000\u003c/span\u003e\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x20\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099560\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee8cb97ffff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003efmt.Fprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099565\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003eb6c2450\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x50\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109956a\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4883\u003c/span\u003e\u003cspan class=\"n\"\u003ec458\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eADDQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x58\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109956e\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ec3\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eRET\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003efunc \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109956f\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee8ac7ffbff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003eruntime.morestack_noctxt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099574\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee947ffffff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eJMP\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.concrete.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099579\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109957a\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109957b\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109957c\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109957d\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109957e\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109957f\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eTEXT\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.main\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003eUsers\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003emvalais\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ecode\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ego\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eatomic\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eissue\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ewallez\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003etweet\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003emain.go\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099580\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e65488\u003c/span\u003e\u003cspan class=\"n\"\u003eb0c2530000000\u003c/span\u003e\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eGS\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x30\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eCX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099589\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e483\u003c/span\u003e\u003cspan class=\"n\"\u003eb6110\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCMPQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCX\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109958d\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e7631\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJBE\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10995c0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109958f\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4883\u003c/span\u003e\u003cspan class=\"n\"\u003eec10\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eSUBQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099593\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48896\u003c/span\u003e\u003cspan class=\"n\"\u003ec2408\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x8\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099598\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed6c2408\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x8\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nf\"\u003ev.f\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109959d\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed059c1a0500\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"n\"\u003ego.itab.\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003emain.concrete\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nf\"\u003emain.abstract\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995a4\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e8400\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eTESTB\u003c/span\u003e \u003cspan class=\"n\"\u003eAL\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eAX\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995a6\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed05eba40f00\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"nf\"\u003eruntime.zerobase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995ad\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48890424\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995b1\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee81a000000\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nf\"\u003e.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995b6\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003eb6c2408\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x8\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995bb\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4883\u003c/span\u003e\u003cspan class=\"n\"\u003ec410\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eADDQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995bf\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ec3\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eRET\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995c0\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee85b7ffbff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003eruntime.morestack_noctxt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995c5\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eebb9\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJMP\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.main\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995c7\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995c8\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995c9\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995ca\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995cb\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995cc\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995cd\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995ce\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995cf\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ecc\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eINT\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eTEXT\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nf\"\u003e.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eautogenerated\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995d0\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e65488\u003c/span\u003e\u003cspan class=\"n\"\u003eb0c2530000000\u003c/span\u003e\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eGS\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x30\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eCX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995d9\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e483\u003c/span\u003e\u003cspan class=\"n\"\u003eb6110\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCMPQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCX\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995dd\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e7631\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJBE\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x1099610\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995df\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4883\u003c/span\u003e\u003cspan class=\"n\"\u003eec08\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eSUBQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995e3\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48892\u003c/span\u003e\u003cspan class=\"n\"\u003ec24\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995e7\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed2c24\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995eb\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003eb5920\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x20\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCX\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eBX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995ef\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4885\u003c/span\u003e\u003cspan class=\"n\"\u003edb\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eTESTQ\u003c/span\u003e \u003cspan class=\"n\"\u003eBX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995f2\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e7523\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJNE\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x1099617\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995f4\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48837\u003c/span\u003e\u003cspan class=\"n\"\u003ec241000\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCMPQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995fa\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e740\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJE\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x109960a\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995fc\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee8bffeffff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.concrete.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099601\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003eb2c24\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099605\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4883\u003c/span\u003e\u003cspan class=\"n\"\u003ec408\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eADDQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099609\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ec3\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eRET\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109960a\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee8c1ddf6ff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003eruntime.panicwrap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109960f\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e90\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eNOPL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099610\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee80b7ffbff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003eruntime.morestack_noctxt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099615\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eebb9\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJMP\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nf\"\u003e.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099617\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed7c2410\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eDI\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109961c\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48393\u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eCMPQ\u003c/span\u003e \u003cspan class=\"n\"\u003eDI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBX\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109961f\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e75\u003c/span\u003e\u003cspan class=\"n\"\u003ed3\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJNE\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10995f4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099621\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488923\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBX\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x1099624\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eebce\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJMP\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10995f4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e \u003cspan class=\"nx\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;strconv\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e \u003cspan class=\"nx\"\u003eabstract\u003c/span\u003e \u003cspan class=\"kd\"\u003einterface\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e \u003cspan class=\"nx\"\u003econcrete\u003c/span\u003e \u003cspan class=\"kd\"\u003estruct\u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e++\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003estrconv\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eItoa\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003ev1\u003c/span\u003e \u003cspan class=\"nx\"\u003eabstract\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ev1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ev2\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ev2\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ef\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"review-of-what-happens-in-v1f\"\u003eReview of what happens in \u003ccode\u003ev1.f()\u003c/code\u003e\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nf\"\u003ev1.f\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109959d\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed059c1a0500\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"n\"\u003ego.itab.\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003emain.concrete\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nf\"\u003emain.abstract\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995a4\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e8400\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eTESTB\u003c/span\u003e \u003cspan class=\"n\"\u003eAL\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eAX\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995a6\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed05eba40f00\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"nf\"\u003eruntime.zerobase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995ad\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48890424\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995b1\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee81a000000\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nf\"\u003e.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLet\u0026rsquo;s read that line by line.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x109959d\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed059c1a0500\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"n\"\u003ego.itab.\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003emain.concrete\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"nf\"\u003emain.abstract\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe first load the \u003ccode\u003etab\u003c/code\u003e field of the \u003ccode\u003eitab\u003c/code\u003e struct into the address pointed by the stack pointer (SP). This \u003ccode\u003eitab\u003c/code\u003e refers to the field \u0026lsquo;itab\u0026rsquo; of the iface struct (see \u003ca href=\"https://github.com/golang/go/blob/bf86aec25972f3a100c3aa58a6abcbcc35bdea49/src/runtime/runtime2.go#L143-L146\"\u003eiface\u003c/a\u003e in runtime2.go):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003etype\u003c/span\u003e \u003cspan class=\"nx\"\u003eiface\u003c/span\u003e \u003cspan class=\"kd\"\u003estruct\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003etab\u003c/span\u003e  \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eitab\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nx\"\u003edata\u003c/span\u003e \u003cspan class=\"nx\"\u003eunsafe\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003ePointer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995a4\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e8400\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eTESTB\u003c/span\u003e \u003cspan class=\"n\"\u003eAL\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eAX\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHere, we test that AL, which contains\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995a6\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed05eba40f00\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"nf\"\u003eruntime.zerobase\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995ad\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48890424\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eAX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow that the \u003ccode\u003etab\u003c/code\u003e address is contained in the address pointed by the SP, it\u0026rsquo;s time to find out which concrete implementation of \u003ccode\u003ef()\u003c/code\u003e should be called:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995b1\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee81a000000\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nf\"\u003e.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd here is the dispath function \u003ccode\u003emain.(*concrete).f\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eTEXT\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nf\"\u003e.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eautogenerated\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995d0\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e65488\u003c/span\u003e\u003cspan class=\"n\"\u003eb0c2530000000\u003c/span\u003e\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eGS\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x30\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eCX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995d9\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e483\u003c/span\u003e\u003cspan class=\"n\"\u003eb6110\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCMPQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCX\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995dd\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e7631\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJBE\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x1099610\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThat\u0026rsquo;s the \u003ca href=\"https://cmc.gitbook.io/go-internals/chapter-i-go-assembly#splits\"\u003estack-split prologue\u003c/a\u003e that deals with growing the stack when the goroutine doesn\u0026rsquo;t have enough stack space. Basicall, \u003ccode\u003eJBE\u003c/code\u003e means \u0026lsquo;jump to the stack-split epilogue if the value contained in \u003ccode\u003eGS:0x30\u003c/code\u003e is lower or equal to the SP (stack pointer). Since the stack grows backwards, meaning that SP will decrease as the stack grows).\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995df\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4883\u003c/span\u003e\u003cspan class=\"n\"\u003eec08\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eSUBQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995e3\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48892\u003c/span\u003e\u003cspan class=\"n\"\u003ec24\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995e7\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed2c24\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995eb\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003eb5920\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x20\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eCX\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eBX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995ef\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4885\u003c/span\u003e\u003cspan class=\"n\"\u003edb\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eTESTQ\u003c/span\u003e \u003cspan class=\"n\"\u003eBX\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eBX\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995f2\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e7523\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJNE\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x1099617\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995f4\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48837\u003c/span\u003e\u003cspan class=\"n\"\u003ec241000\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCMPQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x0\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995fa\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e740\u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJE\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x109960a\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x10995fc\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee8bffeffff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.concrete.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x1099601\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003eb2c24\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eBP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x1099605\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e4883\u003c/span\u003e\u003cspan class=\"n\"\u003ec408\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eADDQ\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x8\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x1099609\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ec3\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eRET\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x109960a\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee8c1ddf6ff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003eruntime.panicwrap\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x109960f\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e90\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eNOPL\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x1099610\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee80b7ffbff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003eruntime.morestack_noctxt\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x1099615\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eebb9\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJMP\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003econcrete\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"nf\"\u003e.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x1099617\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488\u003c/span\u003e\u003cspan class=\"n\"\u003ed7c2410\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eLEAQ\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"n\"\u003eDI\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x109961c\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e48393\u003c/span\u003e\u003cspan class=\"n\"\u003eb\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eCMPQ\u003c/span\u003e \u003cspan class=\"n\"\u003eDI\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBX\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x109961f\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e75\u003c/span\u003e\u003cspan class=\"n\"\u003ed3\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJNE\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10995f4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x1099621\u003c/span\u003e\t\t\u003cspan class=\"m\"\u003e488923\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eMOVQ\u003c/span\u003e \u003cspan class=\"n\"\u003eSP\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eBX\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"mh\"\u003e0x1099624\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eebce\u003c/span\u003e\t\t\t\u003cspan class=\"n\"\u003eJMP\u003c/span\u003e \u003cspan class=\"mh\"\u003e0x10995f4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"review-of-what-happens-in-v2f\"\u003eReview of what happens in \u003ccode\u003ev2.f()\u003c/code\u003e\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nf\"\u003ev2.f\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995b6\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee805ffffff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.concrete.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"notes\"\u003eNotes\u003c/h2\u003e\n\u003ch3 id=\"the-ax-and-al-registers\"\u003eThe AX and AL registers\u003c/h3\u003e\n\u003cp\u003eFrom \u003ca href=\"https://software.intel.com/sites/default/files/managed/39/c5/325462-sdm-vol-1-2abcd-3abcd.pdf\" title=\"Intel 64's x86_64 specification\"\u003eintel64\u003c/a\u003e (Figure 3-5. Alternate General-Purpose Register Names, p. 3-12 Vol. 1):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| 0000 0001 0010 0011 0100 0101 0110 0111 | ------\u0026gt; EAX\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|                     0100 0101 0110 0111 | ------\u0026gt; AX\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|                               0110 0111 | ------\u0026gt; AL\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|                     0100 0101           | ------\u0026gt; AH\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e(from a Stackoverflow \u003ca href=\"https://stackoverflow.com/a/52892696/3808537%3E\"\u003epost\u003c/a\u003e)\u003c/p\u003e\n\u003cp\u003eFrom \u003ca href=\"https://software.intel.com/sites/default/files/managed/39/c5/325462-sdm-vol-1-2abcd-3abcd.pdf\" title=\"Intel 64's x86_64 specification\"\u003eintel64\u003c/a\u003e (p. 3-16, Vol. 1):\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAF (bit 4) Auxiliary Carry flag — Set if an arithmetic operation generates a carry or a borrow out of bit 3 of the result; cleared otherwise. This flag is used in binary-coded decimal (BCD) arithmetic.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"the-gs-register\"\u003eThe GS register\u003c/h3\u003e\n\u003cp\u003eIn the x86-64 \u003ca href=\"https://software.intel.com/sites/default/files/managed/39/c5/325462-sdm-vol-1-2abcd-3abcd.pdf\" title=\"Intel 64's x86_64 specification\"\u003eintel64\u003c/a\u003e (p. 3-14, Vol. 1):\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe DS, ES, FS, and GS registers point to four data segments. The availability of four data segments permits efficient and secure access to different types of data structures. For example, four separate data segments might be created: one for the data structures of the current module, another for the data exported from a higher-level module, a third for a dynamically created data structure, and a fourth for data shared with another program. To access additional data segments, the application program must load segment selectors for these segments into the DS, ES, FS, and GS registers, as needed.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch3 id=\"the-q-suffix-in-movq-and-leaq\"\u003eThe \u0026lsquo;Q\u0026rsquo; suffix in MOVQ and LEAQ\u003c/h3\u003e\n\u003cp\u003eI could not find that in the \u003ca href=\"https://software.intel.com/sites/default/files/managed/39/c5/325462-sdm-vol-1-2abcd-3abcd.pdf\" title=\"Intel 64's x86_64 specification\"\u003eIntel 64 PDF\u003c/a\u003e. Apparently, these prefixes were introduced with the assembler (\u003ccode\u003eas\u003c/code\u003e). See binutils\u0026rsquo;s as \u003ca href=\"https://sourceware.org/binutils/docs/as/i386_002dMnemonics.html#Instruction-Naming\"\u003ei386mnemonics\u003c/a\u003e:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eInstruction mnemonics are suffixed with one character modifiers which specify the size of operands. The letters ‘b’, ‘w’, ‘l’ and ‘q’ specify byte, word, long and quadruple word operands.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"what-are-sp-and-sb\"\u003eWhat are SP and SB\u003c/h2\u003e\n\u003cp\u003eFrom \u003ca href=\"https://golang.org/doc/asm#symbols\"\u003ehttps://golang.org/doc/asm#symbols\u003c/a\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFP: Frame pointer: arguments and locals.\u003c/li\u003e\n\u003cli\u003ePC: Program counter: jumps and branches.\u003c/li\u003e\n\u003cli\u003eSB: Static base pointer: global symbols.\u003c/li\u003e\n\u003cli\u003eSP: Stack pointer: top of stack.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003ego-internals book: \u003ca href=\"https://github.com/teh-cmc/go-internals\"\u003ehttps://github.com/teh-cmc/go-internals\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003ex86 Programming course: \u003ca href=\"https://courses.cs.washington.edu/courses/cse351/17wi/lectures/CSE351-L09-x86-II_17wi.pdf\"\u003ehttps://courses.cs.washington.edu/courses/cse351/17wi/lectures/CSE351-L09-x86-II_17wi.pdf\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nf\"\u003ev2.f\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"mh\"\u003e0x10995b6\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003ee805ffffff\u003c/span\u003e\t\t\u003cspan class=\"n\"\u003eCALL\u003c/span\u003e \u003cspan class=\"nf\"\u003emain.concrete.f\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eSB\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1587044555,"description":"","dir":"2020/deep-dive-go-assembly/","expirydate":-62135596800,"fuzzywordcount":1500,"images":[],"keywords":null,"kind":"page","lang":"en","lastmod":1587044555,"objectID":"ee66e6c05f44974b211ee84d6cbffb5b","permalink":"https://maelvls.dev/do-not-share-yet/deep-dive-go-assembly/","publishdate":"2020-04-16T15:42:35+02:00","readingtime":7,"relpermalink":"/do-not-share-yet/deep-dive-go-assembly/","section":"2020","summary":"\u003cp\u003eLast month, Sylvain Wallez, author of the excellent \u0026ldquo;\u003ca href=\"https://bluxte.net/musings/2018/04/10/go-good-bad-ugly/\"\u003eGo: the Good, the Bad and the Ugly\u003c/a\u003e\u0026rdquo;, wrote:\u003c/p\u003e\n\u003cblockquote class=\"twitter-tweet\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eWoah! Because interface values in Go are represented by two pointers causing assignment to not be atomic, you can easily write concurrent code that swaps one of the pointers, leading to completely unpredictable behaviour. Demonstrated with an RCE... \u003ca href=\"https://t.co/DsMWzpYuQ4\"\u003ehttps://t.co/DsMWzpYuQ4\u003c/a\u003e\u003c/p\u003e\u0026mdash; Sylvain Wallez (@bluxte) \u003ca href=\"https://twitter.com/bluxte/status/1192945301604184065?ref_src=twsrc%5Etfw\"\u003eNovember 8, 2019\u003c/a\u003e\u003c/blockquote\u003e\n\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\n\n\u003cp\u003eOnce again, my beloved language takes a hit. As time passes, I come to realize Go has its strenghts (ease of adoption, no overly abstract REST framework, readability, fast compilation) but also its weaknesses. I can think of the weirdness of variable scoping (\u003ca href=\"https://github.com/kyoh86/scopelint\"\u003escopelint\u003c/a\u003e really helps) and also variable shadowing, weird syntax around variable assignment, \u003ccode\u003ego help\u003c/code\u003e is unreadable and just not up to the standard (compared to \u003ccode\u003egit help\u003c/code\u003e for example), the ever-changing behaviour of GO111MODULE (that\u0026rsquo;s a temporary issue), \u003ccode\u003ego get\u003c/code\u003e that do too many things and changes \u003ccode\u003ego.mod\u003c/code\u003e when you just want to install some tool, but also \u003ccode\u003ego install\u003c/code\u003e \u0026amp; \u003ccode\u003ego run\u003c/code\u003e that don\u0026rsquo;t support versions (e.g. ). Wait, also the \u0026ldquo;semantic import versioning\u0026rdquo; that everybody seems to avoid (including Google itself in \u003ca href=\"https://github.com/golang/protobuf/issues/1049\"\u003eprotobuf\u003c/a\u003e).\u003c/p\u003e","tags":null,"title":"Deep Dive into Go Assembly","type":"2020","url":"https://maelvls.dev/do-not-share-yet/deep-dive-go-assembly/","weight":0,"wordcount":1432},{"authors":null,"categories":null,"content":"","date":1586908800,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1586908800,"objectID":"https://maelvls.dev/do-not-share-yet/tags/client-go/","permalink":"https://maelvls.dev/do-not-share-yet/tags/client-go/","publishdate":"2020-04-15T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/tags/client-go/","section":"tags","summary":"","tags":null,"title":"Client-Go","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/client-go/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1586908800,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1586908800,"objectID":"https://maelvls.dev/do-not-share-yet/tags/go-modules/","permalink":"https://maelvls.dev/do-not-share-yet/tags/go-modules/","publishdate":"2020-04-15T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/tags/go-modules/","section":"tags","summary":"","tags":null,"title":"Go-Modules","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/go-modules/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cblockquote\u003e\n\u003cp\u003e⚠️ I\u0026rsquo;m not sure this is a transitive issue. It might just not be due to transitivity at all!\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eLooks like the Kubernetes people chose to break the client-go API without bumping the major version (with a new import path e.g \u003ccode\u003ek8s.io/client-go/v13\u003c/code\u003e) when adding support for \u003ccode\u003econtext.Context\u003c/code\u003e that comes with Kubernetes v1.18. Darren Shepherd reported the \u003ca href=\"https://issues.k8s.io/88472\"\u003eissue\u003c/a\u003e in February 2020. We \u003ca href=\"https://github.com/kubernetes/client-go#compatibility-your-code---client-go\"\u003ewere warned\u003c/a\u003e:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe v0.x.y tags indicate that go APIs may change in incompatible ways in different versions.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eAt first, I thought that it would not affect us at Ori since we don’t use any extra dependency that rely on client-go — so no transitive dependencies on client-go, we are the sole user of it. We then began working on some tooling depending on the API of our main project. And the transitive hell began.\u003c/p\u003e\n\u003cp\u003eHere is what the error looks like:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# k8s.io/client-go/rest\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e../../../go/pkg/mod/k8s.io/client-go@v11.0.0+incompatible/rest/request.go:598:31: not enough arguments in call to watch.NewStreamWatcher\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        have (*versioned.Decoder)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        want (watch.Decoder, watch.Reporter)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eOn top of that, you might also have a version mismatch between \u003ccode\u003ek8s.io/api\u003c/code\u003e and \u003ccode\u003ek8s.io/apimachinery\u003c/code\u003e with the following error:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e../../../go/pkg/mod/k8s.io/client-go@v11.0.0+incompatible/tools/clientcmd/api/v1/conversion.go:52:12: s.DefaultConvert undefined (type conversion.Scope has no field or method DefaultConvert)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIf you cannot upgrade to v0.18.* (e.g. you have a transitive dependency that still relies on v0.17.4), a workaround is to set client-go to use the latest pre-v1.18 version:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-diff\" data-lang=\"diff\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e require (\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-    k8s.io/client-go v0.18.1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-    k8s.io/apimachinery v0.18.1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-    k8s.io/api v0.18.1 //indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e\u003c/span\u003e\u003cspan class=\"gi\"\u003e+    k8s.io/client-go v0.17.4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+    k8s.io/apimachinery v0.17.4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+    k8s.io/api v0.17.4 //indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e\u003c/span\u003e )\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe \u003ccode\u003ev0.17.4\u003c/code\u003e version is the last version of apimachinery and api that stays compatible with client-go pre-v1.18.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eLong-term\u003c/strong\u003e: you want to upgrade to client-go v0.18.* as soon as possible. If the breaking dependencies that still require client-go with no \u003ccode\u003econtext.Context\u003c/code\u003e argument, ask their maintainer (if it is an open-source project) and hopefully that will work\u0026hellip; but then, anyone relying on this project will also have then stuff broken.\u003c/p\u003e\n\u003cp\u003eThe project still has v11, v12\u0026hellip; version but they stopped tagging new major versions like they did with \u003ccode\u003ev11.0.0\u003c/code\u003e (there is no \u003ccode\u003ev18.0.0\u003c/code\u003e) because they don\u0026rsquo;t use the major used with Go Modules. That\u0026rsquo;s due to the fact that the client-go project doesn\u0026rsquo;t follow the \u0026ldquo;\u003ca href=\"https://research.swtch.com/vgo-import\"\u003esemantic import versioning\u003c/a\u003e\u0026rdquo; rule. You can\u0026rsquo;t do:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% go get k8s.io/client-go@v12.0.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego get k8s.io/client-go@v12.0.0: k8s.io/client-go@v12.0.0: invalid version: module contains a go.mod file, so major version must be compatible: should be v0 or v1, not v12\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThat\u0026rsquo;s why the Kubernetes team maintains another set of tags that begin with \u003ccode\u003ev0.*\u003c/code\u003e (e.g., \u003ccode\u003ev0.18.0\u003c/code\u003e) for that specific reason. Just a clever way of escaping the semantic import versioning, but all these different versions make it very confusing\u0026hellip;\u003c/p\u003e\n\u003cp\u003eOh, and when you use the \u003ccode\u003ekubernetes-1.17.4\u003c/code\u003e tag, it redirects to the \u003ccode\u003ev0.17.4\u003c/code\u003e tag (my guess is that it is infered by \u003ccode\u003ego get\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% go get k8s.io/client-go@kubernetes-1.17.4\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego: k8s.io/client-go kubernetes-1.17.4 \u003cspan class=\"o\"\u003e=\u003c/span\u003e\u0026gt; v0.17.4\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego: downloading k8s.io/client-go v0.17.4\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAnd to make even more confusing, these tags (kubernetes-v1.17.4, v0.17.4 and v12.0.0) are not set on the master branch; instead, they all live on headless branches.\u003c/p\u003e\n\u003cp\u003eThis issue is a reminder that we (Kubernetes hackers who write controllers for a living) heavily rely on the “good will” of the Kubernetes team. These decisions as they might affect anyone relying on Kubernetes \u0026ldquo;as a platform\u0026rdquo;\u0026hellip; 🤔\u003c/p\u003e\n\u003c!--\nhttps://ori-edge.slack.com/archives/C96DU1WDC/p1583851517147600?thread_ts=1582966579.027200\u0026cid=C96DU1WDC\nhttps://ori-edge.slack.com/archives/C96DU1WDC/p1586525068128100\n--\u003e\n","date":1586908800,"description":"Client-go is the client library that allows anyone (including Kubernetes itself) to talk to the Kubernetes apiserver. Recently, the Kubernetes team chose to release a breaking version of client-go that adds support for context.Context, without really giving anyone notice. In this post, I detail the workaround and what that happened.","dir":"2020/client-go-transitive-hell/","expirydate":-62135596800,"fuzzywordcount":600,"images":[],"keywords":null,"kind":"page","lang":"en","lastmod":1586908800,"objectID":"55b47cacb0aff126ea5b2fe200af69d1","permalink":"https://maelvls.dev/do-not-share-yet/client-go-transitive-hell/","publishdate":"2020-04-15T00:00:00Z","readingtime":3,"relpermalink":"/do-not-share-yet/client-go-transitive-hell/","section":"2020","summary":"\u003cblockquote\u003e\n\u003cp\u003e⚠️ I\u0026rsquo;m not sure this is a transitive issue. It might just not be due to transitivity at all!\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eLooks like the Kubernetes people chose to break the client-go API without bumping the major version (with a new import path e.g \u003ccode\u003ek8s.io/client-go/v13\u003c/code\u003e) when adding support for \u003ccode\u003econtext.Context\u003c/code\u003e that comes with Kubernetes v1.18. Darren Shepherd reported the \u003ca href=\"https://issues.k8s.io/88472\"\u003eissue\u003c/a\u003e in February 2020. We \u003ca href=\"https://github.com/kubernetes/client-go#compatibility-your-code---client-go\"\u003ewere warned\u003c/a\u003e:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe v0.x.y tags indicate that go APIs may change in incompatible ways in different versions.\u003c/p\u003e","tags":["go-modules","kubernetes","client-go"],"title":"The Client-go Transitive Hell","type":"2020","url":"https://maelvls.dev/do-not-share-yet/client-go-transitive-hell/","weight":0,"wordcount":528},{"authors":null,"categories":null,"content":"","date":1586736000,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1586736000,"objectID":"https://maelvls.dev/do-not-share-yet/tags/gcp/","permalink":"https://maelvls.dev/do-not-share-yet/tags/gcp/","publishdate":"2020-04-13T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/tags/gcp/","section":"tags","summary":"","tags":null,"title":"Gcp","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/gcp/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eIn a previous post \u0026ldquo;\u003ca href=\"/packets-eye-kubernetes-service/\"\u003eThe Packet\u0026rsquo;s-Eye View of a Kubernetes Service\u003c/a\u003e\u0026rdquo;, I studied how traffic flows in when using Kubernetes Services. In the last diagram of that post, I could not clearly see how traffic could make its way back to the user. In this article, I will try to understand how packets are able to flow back to the user and where stateless rewriting happens.\u003c/p\u003e\n\u003cp\u003eIn the following diagram, we can see a packet coming from a user, then being re-written by Google\u0026rsquo;s VPC firewalls and finally coming into a VM \u0026ldquo;node 1\u0026rdquo;.\u003c/p\u003e\n\u003cimg alt=\"Packet coming from a user hitting one going through Google's VPC\" src=\"dnat-google-vpc-how-comes-back.svg\" width=\"80%\"/\u003e\n\u003cp\u003eSo, how come the packet can come back \u003cdel\u003eand does it use conntrack\u003c/del\u003e and does Google\u0026rsquo;s firewall have to remember some state?\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eUpdate 14th April:\u003c/strong\u003e I initially thought that the conntrack kernel module would not register anything when using DNAT. \u003ca href=\"https://twitter.com/networkop1\"\u003e@networkop1\u003c/a\u003e showed me that conntrack registers the connection even for stateless DNATing.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://netfilter.org/documentation/HOWTO/netfilter-hacking-HOWTO-3.html#ss3.3\"\u003econntrack\u003c/a\u003e is a part of the netfilter suite in the Linux kernel. It is in charge of remembering connections that are forwarded. The initial packet hits the iptables machinery and conntrack remembers it so that further packets don\u0026rsquo;t need to go through iptables again. You can list the tracked connections using the \u003ca href=\"https://manpages.debian.org/testing/conntrack/conntrack.8.en.html\"\u003econntrack(8)\u003c/a\u003e tool. I mention it in \u0026ldquo;\u003ca href=\"/debugging-kubernetes-networking/\"\u003eDebugging Kubernetes Networking\u003c/a\u003e\u0026rdquo;.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eLet us dive a bit more and add the \u0026ldquo;response\u0026rdquo; packets. For the following diagram, I used the excellent \u003ca href=\"https://textik.com/\"\u003etextik\u003c/a\u003e ascii drawing tool.\u003c/p\u003e\n\u003cdiv class=\"nohighlight\"\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e           D-NAT (dest-based NAT, also called port-forwarding)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+--------------------------------------------------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|   src: 90.76.45.149:32345                       src: 35.211.248.124:80   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|   dst: 35.211.248.124:80                        dst: 90.76.45.149:32345  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+------------------------------90.76.45.149--------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e               |                 (user)                     |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e               |                                            |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+--------------------------------------------------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|              |                one-to-one                  |              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|              v              port forwarding               |              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|   src: 90.76.45.149:32345          =          - src: 10.142.0.62:80      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| - dst: 35.211.248.124:80      no need for     + src: 35.211.248.124:80   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e| + dst: 10.142.0.62:80         conntrack to      dst: 90.76.45.149:32345  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|              |                 remember!                  ^              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|              |                (stateless)                 |              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|              |                                            |              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+--------------|--------------35.211.248.124----------------|--------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e               |              (Google\u0026#39;s VPC)                |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e               |                                            |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e               |                                            |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+--------------|--------------------------------------------|--------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|              v             userland process               |              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|   src: 90.76.45.149:32345      response         src: 10.142.0.62:80      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|   dst: 10.142.0.62:80      ----------------\u0026gt;    dst: 90.76.45.149:32345  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|                                                                          |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-------------------------------10.142.0.62--------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                (VM in VPC)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c!-- https://textik.com/#0db10960397c06f5 --\u003e\n\u003cp\u003eBy reading through the diagram, we can see that the packet is re-written by Google\u0026rsquo;s firewall using DNAT: the destination is replaced by a fixed IP, the one of the VM.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWhy do I say \u0026ldquo;packets\u0026rdquo; but what I should really say is \u0026ldquo;segments\u0026rdquo;? That\u0026rsquo;s because I don\u0026rsquo;t really know anyone using this strict terminology. Outside of the kernel and TCP/IP stack implementors, who actually cares about the L3 layer \u0026ldquo;units\u0026rdquo;? And I enjoy the \u0026ldquo;packet\u0026rdquo; word too more than \u0026ldquo;segment\u0026rdquo;!\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eNow, why do I care about Google\u0026rsquo;s firewalls storing state? That\u0026rsquo;s because if some state about a connection has to be remembered, it means it is harder to distribute the firewall horizontally, which makes it harder to scale.\u003c/p\u003e\n\u003cp\u003eAs we can see on the diagram, the firewall does not need to remember anything: it is just a static one-to-one relation between \u003ccode\u003e10.142.0.62\u003c/code\u003e and \u003ccode\u003e35.211.248.124\u003c/code\u003e.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eHere is what I want to remember from this post:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eOutgoing traffic from your broadband modem router has to be SNATed (source-based NAT). The router needs to keep track of outgoing connections using conntrack.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIncoming traffic from the Internet to a Google Cloud VM has to go through the VPC firewall. The packet rewriting is very fast and very scalable since it only uses DNAT, which means no need to remember anything.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMost packet forwarding in Kubernetes relies on stateless DNATing (e.g. \u003ccode\u003ehostPort\u003c/code\u003e or \u003ccode\u003enodePort\u003c/code\u003e). Some parts of Kubernetes rely on stateful SNAT rewriting, for example when you use \u003ccode\u003eexternalTrafficPolicy: Cluster\u003c/code\u003e in a which is the default policy for a Service. The following diagram shows where this rewriting happens (extracted from the last diagram in \u0026ldquo;\u003ca href=\"/packets-eye-kubernetes-service/\"\u003eThe Packet\u0026rsquo;s-Eye View of a Kubernetes Service\u003c/a\u003e\u0026rdquo;):\u003c/p\u003e\n\u003cimg alt=\"Packet's source is rewritten (SNAT) because of the 'policy: Cluster' that is set in the Service.\" src=\"kubernetes-snat-cluster-ip.svg\" width=\"50%\"/\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n","date":1586736000,"description":"In one of my previous posts, I studied how traffic flows when using Kubernetes Services. While drawing the last diagram, I did not clearly see how traffic could make its way back to the user. In this post, I focus on how packets find their way back and what makes stateless rewriting interesting.","dir":"2020/how-do-packets-come-back/","expirydate":-62135596800,"fuzzywordcount":700,"images":["how-do-packets-come-back/cover-how-can-packets-come-back.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1586736000,"objectID":"2ec8ba01594d6b8f7f27da15a5586661","permalink":"https://maelvls.dev/do-not-share-yet/how-do-packets-come-back/","publishdate":"2020-04-13T00:00:00Z","readingtime":3,"relpermalink":"/do-not-share-yet/how-do-packets-come-back/","section":"2020","summary":"\u003cp\u003eIn a previous post \u0026ldquo;\u003ca href=\"/packets-eye-kubernetes-service/\"\u003eThe Packet\u0026rsquo;s-Eye View of a Kubernetes Service\u003c/a\u003e\u0026rdquo;, I studied how traffic flows in when using Kubernetes Services. In the last diagram of that post, I could not clearly see how traffic could make its way back to the user. In this article, I will try to understand how packets are able to flow back to the user and where stateless rewriting happens.\u003c/p\u003e\n\u003cp\u003eIn the following diagram, we can see a packet coming from a user, then being re-written by Google\u0026rsquo;s VPC firewalls and finally coming into a VM \u0026ldquo;node 1\u0026rdquo;.\u003c/p\u003e","tags":["networking","gcp"],"title":"How do packets find their way back?","type":"2020","url":"https://maelvls.dev/do-not-share-yet/how-do-packets-come-back/","weight":0,"wordcount":622},{"authors":null,"categories":null,"content":"","date":1585526400,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1585526400,"objectID":"https://maelvls.dev/do-not-share-yet/tags/home-office/","permalink":"https://maelvls.dev/do-not-share-yet/tags/home-office/","publishdate":"2020-03-30T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/tags/home-office/","section":"tags","summary":"","tags":null,"title":"Home-Office","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/home-office/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"","date":1585526400,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1585526400,"objectID":"https://maelvls.dev/do-not-share-yet/tags/setup/","permalink":"https://maelvls.dev/do-not-share-yet/tags/setup/","publishdate":"2020-03-30T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/tags/setup/","section":"tags","summary":"","tags":null,"title":"Setup","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/setup/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eIn this post, I document the changes to my office setup through time.\u003c/p\u003e\n\u003ch2 id=\"2022-update-2\"\u003e2022 Update 2\u003c/h2\u003e\n\u003cp\u003eI decided to move my office out of my home! I am now located in a co-working space in the city of Toulouse. It is called \u0026ldquo;HarryCow\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"harrycow-2022-03-03.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"2022-update\"\u003e2022 Update\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"mael-home-office-desk-2022.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eI added a second monitor. It is the same as the one I bought in 2019.\u003c/p\u003e\n\u003ch2 id=\"2021-second-update\"\u003e2021 Second Update\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"mael-home-office-desk-2021-06-18.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eAs you can see in the above picture, I went from a Macbook Pro to a custom PC I built!! I wanted a machine purposed for Linux and with as much CPU as I could afford. I made a \u003ca href=\"https://gist.github.com/maelvls/3028862dd516005403cf728f4705f4bb\"\u003egist\u003c/a\u003e with all the tips I have learned from my experience of switching from macOS to Linux.\u003c/p\u003e\n\u003cp\u003eHere is the part list (also available on \u003ca href=\"https://pcpartpicker.com/list/FcxPkX\"\u003epcpartpicker\u003c/a\u003e):\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003ePart\u003c/th\u003e\n          \u003cth\u003eName\u003c/th\u003e\n          \u003cth\u003ePrice (01 May 2021)\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCPU\u003c/td\u003e\n          \u003ctd\u003e\u003cdel\u003eAMD Ryzen 9 5900X 3.4 GHz 12-Core Processor\u003c/del\u003e (I sent it back)\u003c/td\u003e\n          \u003ctd\u003e€ 708 (street price)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCPU\u003c/td\u003e\n          \u003ctd\u003eAMD Ryzen 9 5950X 3.4 GHz 16-Core Processor (bought on AMD.com at MSRP)\u003c/td\u003e\n          \u003ctd\u003e€ 795 (MSRP)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCPU Cooler\u003c/td\u003e\n          \u003ctd\u003eNoctua NH-D15 CHROMAX.BLACK 82.52 CFM CPU Cooler\u003c/td\u003e\n          \u003ctd\u003e€ 99\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eMotherboard\u003c/td\u003e\n          \u003ctd\u003eGigabyte X570 AORUS MASTER ATX AM4 Motherboard\u003c/td\u003e\n          \u003ctd\u003e€ 359\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eMemory\u003c/td\u003e\n          \u003ctd\u003eG.Skill Trident Z RGB 32 GB (2 x 16 GB) DDR4-3600 CL16 Memory\u003c/td\u003e\n          \u003ctd\u003e€ 304\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eStorage\u003c/td\u003e\n          \u003ctd\u003eSamsung 980 Pro 1 TB M.2-2280 NVME Solid State Drive\u003c/td\u003e\n          \u003ctd\u003e€ 219\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eVideo Card\u003c/td\u003e\n          \u003ctd\u003e\u003cdel\u003eGigabyte Radeon RX 6700 XT 12 GB EAGLE\u003c/del\u003e (I sent it back)\u003c/td\u003e\n          \u003ctd\u003e€ 858 (street price)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eVideo Card\u003c/td\u003e\n          \u003ctd\u003eAMD Radeon RX 6800 16 GB (bought on AMD.com at MSRP)\u003c/td\u003e\n          \u003ctd\u003e€ 579 (MSRP)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCase\u003c/td\u003e\n          \u003ctd\u003eFractal Design Define 7 Compact ATX Mid Tower Case\u003c/td\u003e\n          \u003ctd\u003e€ 133\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePower Supply\u003c/td\u003e\n          \u003ctd\u003ebe quiet! Dark Power Pro 11 750 W 80+ Platinum Semi-modular ATX Power Supply\u003c/td\u003e\n          \u003ctd\u003e€ 243\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCase Fan × 4\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://www.bequiet.com/en/casefans/717\"\u003ebe quiet! Silent Wings 3 59.5 CFM 140 mm Fan PWM\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e€ 29 × 4\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eTotal\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e€ 2847\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e\u003cimg src=\"mael-home-office-desk-2021-06-18-close-up-pc.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"2021-update\"\u003e2021 Update\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"mael-home-office-desk-2021.jpg\" alt=\"My home office in 2020\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eI switched from the Apple Magic AZERTY keyboard to a QWERTY mechanical keyboard: the \u003ca href=\"https://www.amazon.com/DURGOD-Mechanical-Interface-Tenkeyless-Anti-Ghosting/dp/B07B8J6C3C\"\u003eDurgod Taurus K320 TKL\u003c/a\u003e. I chose the Cherry MX Brown switches, and I love them. It feels so much better to be typing on this keyboard. Moving from AZERTY to QWERTY was the hardest part. It took about 3 months to get as confortable as I was using the AZERTY layout. I really wanted to stop working on a \u0026ldquo;second class\u0026rdquo; keyboard layout that has poor shortcut support on most apps. The other adjustment I had to do was to go to the macOS settings and swap the \u003ckbd\u003eWindows\u003c/kbd\u003e key with the \u003ckbd\u003eAlt\u003c/kbd\u003e key so that the \u003ckbd\u003e⌘\u003c/kbd\u003e and \u003ckbd/\u003e⌥\u003c/kbd\u003e keys are at in the right order.\u003c/li\u003e\n\u003cli\u003eTwo \u003ca href=\"https://www.amazon.com/UTEBIT-Upgraded-Articulating-Friction-Adjustable/dp/B07H77KB7R/ref=sr_1_6?dchild=1\u0026amp;keywords=UTEBIT+Desk+Mount+Metal+Tabletop+Light+Stand+Adjustable\u0026amp;qid=1615567111\u0026amp;sr=8-6\"\u003eUTEBIT articulating arms\u003c/a\u003e that hold (1) an old iPhone 7 that I use as a secondary screen using Duet and (2) a Razer Kiyo camera.\u003c/li\u003e\n\u003cli\u003eA \u003ca href=\"https://www.razer.com/streaming-cameras/razer-kiyo\"\u003eRazer Kiyo\u003c/a\u003e camera (USB 3). I wish I had a proper DSLR camera though: the Kiyo needs a ton of light to have a good image quality.\u003c/li\u003e\n\u003cli\u003eTwo \u003ca href=\"https://www.amazon.com/UTEBIT-Shooting-Adjustable-Aluminum-Tabletop/dp/B08PYY95LJ/ref=sr_1_3?dchild=1\u0026amp;keywords=UTEBIT+Desk+Mount+Metal+Tabletop+Light+Stand+Adjustable\u0026amp;qid=1615567111\u0026amp;sr=8-3\"\u003eUTEBIT tabletop arms\u003c/a\u003e that I use to hold the flood lights.\u003c/li\u003e\n\u003cli\u003eTwo \u003ca href=\"https://www.amazon.com/Neewer-Pieces-Bi-color-Video-Light/dp/B06XW3B81V\"\u003eNEEWER bi-color 660 flood lights\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eA set of UTEBIT 1/4 to 3/8 screw adapters.\u003c/li\u003e\n\u003cli\u003e24 panels of the \u003ca href=\"https://www.thomann.de/gb/the_takustik_was7_absorber_8erset.htm\"\u003et.akustik WAS-7 Absorber\u003c/a\u003e. It greatly reduced the amount of echo/reberb in the room, and allows me to put the microphone a bit further away without losing on sound quality.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2020-update\"\u003e2020 Update\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"mael-home-office-desk-2020.jpg\" alt=\"My home office in 2020\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.bluedesigns.com/products/compass\"\u003eYeti Compass\u003c/a\u003e boom arm\n\u003cblockquote\u003e\n\u003cp\u003eNote that the boom arm is meant to carry the shock mount + the mic and since I only mounted the Yeti mic, the spring mechanism is a bit too tight which means the arm tends to go up. I unscrewed the screw in the base of the boom arm at its minimum but the tension is still too high and the boom arm tends to go up.\u003c/p\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003eApple Magic Keyboard. I also use a \u003ca href=\"https://fr.sharkoon.com/product/PureWriter%20TKL\"\u003eSharkoon PureWriter TKL\u003c/a\u003e from time to time when I want to bother my collegues with the clank-clank sound of the red switches\u003c/li\u003e\n\u003cli\u003eUSB-C hub Ugreen and AUKEY USB3 hub.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2019-office\"\u003e2019 Office\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"mael-home-office-desk-2019.jpg\" alt=\"My home office in 2020\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.amazon.com/LG-27UL850-W-Display-DisplayHDR-Connectivity/dp/B07MKT1W65/ref=cm_cr_arp_d_product_top?ie=UTF8\"\u003eLG 27UL850-W 27 inches 4K monitor\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://griffintechnology.com/products/elevator\"\u003eGriffin Elevator stand\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eThe \u003ca href=\"https://www.amazon.co.uk/FlexiSpot-Adjustable-Electric-Standing-Automatic/dp/B071G2NSRP/ref=sr_1_fkmr0_1?keywords=flexispot%2BE5B\u0026amp;qid=1563776981\u0026amp;s=electronics\u0026amp;sr=8-1-fkmr0\u0026amp;th=1\"\u003eFlexispot standing desk E5B\u003c/a\u003e (B = black) with a €25 wood board I mounted on top.\u003c/li\u003e\n\u003cli\u003eI use the \u003ca href=\"https://www.beatsbydre.com/headphones/solo3-wireless\"\u003eBeats Solo 3\u003c/a\u003e headphones. I only use it for audio output. I never use the mic in Bluetooth mode since it greatly degrades my colleague\u0026rsquo;s listening experience.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.bluedesigns.com/products/yeti\"\u003eBlue Yeti\u003c/a\u003e USB microphone\n\u003cblockquote\u003e\n\u003cp\u003eWhy a standalone mic just for Zoom? One very important aspect of the remote-only work setup is the importance of being properly understood. I take this very seriously and think that the sound quality of the mic I use every day influences how effective my meetings are. I also make a number of calls to potential candidates, which means I should sound perfect.\u003c/p\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.amazon.com/Logitech-Wireless-Solar-Kebyoard-iPhone/dp/B007VL8Y2C\"\u003eLogitech K760\u003c/a\u003e (wireless solar keyboard).\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.amazon.co.uk/Logitech-Master-Wireless-Bluetooth-Windows/dp/B00ULNAOMA\"\u003eLogitech MX Master\u003c/a\u003e Just an excellent mouse\u003c/li\u003e\n\u003cli\u003eAUKEY mousepad XXL.\u003c/li\u003e\n\u003cli\u003eSome random chair (I wish I could afford the Herman Miller Aeron)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!--\n## Cool software stuff\n\n- USB overdrive (the default macOS mouse acceleration drives me crazy; also\n  allows me to invert up/down scolling for the mouse only; I keep \"natural\n  scrolling\" turned on in the system settings)\n- HyperSwitch for switching between windows with \u003ckbd\u003ealt+tab\u003c/kbd\u003e (\u003ckbd\u003ecmd+tab\u003c/kbd\u003e only allows to switch between apps)\n- iTerm 2 + zsh + antigen + async prompt theme (agkozak-zsh-prompt) + tons\n  of stuff around command line\n--\u003e\n\u003cp\u003eAnd finally, here is a picture from the backyard. 🙂\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"at-maels.jpg\" alt=\"Backyard\"\u003e\u003c/p\u003e\n","date":1585526400,"description":"I present what hardware I have been using and what changed between 2019 and 2022!","dir":"2020/home-office-remote-setup/","expirydate":-62135596800,"fuzzywordcount":900,"images":["/evolution-of-my-home-office/mael-home-office-desk-2021.jpg"],"keywords":null,"kind":"page","lang":"en","lastmod":1585526400,"objectID":"2c5e15dbae92dd7d9996736c62059924","permalink":"https://maelvls.dev/do-not-share-yet/evolution-of-my-home-office/","publishdate":"2020-03-30T00:00:00Z","readingtime":4,"relpermalink":"/do-not-share-yet/evolution-of-my-home-office/","section":"2020","summary":"\u003cp\u003eIn this post, I document the changes to my office setup through time.\u003c/p\u003e\n\u003ch2 id=\"2022-update-2\"\u003e2022 Update 2\u003c/h2\u003e\n\u003cp\u003eI decided to move my office out of my home! I am now located in a co-working space in the city of Toulouse. It is called \u0026ldquo;HarryCow\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"harrycow-2022-03-03.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"2022-update\"\u003e2022 Update\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"mael-home-office-desk-2022.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eI added a second monitor. It is the same as the one I bought in 2019.\u003c/p\u003e\n\u003ch2 id=\"2021-second-update\"\u003e2021 Second Update\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"mael-home-office-desk-2021-06-18.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eAs you can see in the above picture, I went from a Macbook Pro to a custom PC I built!! I wanted a machine purposed for Linux and with as much CPU as I could afford. I made a \u003ca href=\"https://gist.github.com/maelvls/3028862dd516005403cf728f4705f4bb\"\u003egist\u003c/a\u003e with all the tips I have learned from my experience of switching from macOS to Linux.\u003c/p\u003e","tags":["setup","home-office"],"title":"The evolution of my home office from 2019 to 2022","type":"2020","url":"https://maelvls.dev/do-not-share-yet/evolution-of-my-home-office/","weight":0,"wordcount":814},{"authors":null,"categories":null,"content":"\u003cp\u003eTo learn and play with Kubernetes, I keep a \u0026ldquo;playground\u0026rdquo; cluster to try things on it (helm files I use are \u003ca href=\"https://github.com/maelvls/k.maelvls.dev\"\u003ehere\u003c/a\u003e). Since 2019, I have been using GKE (Google\u0026rsquo;s managed Kubernetes service), which works great with the one-year $300 credit that you get initially. A few days ago, reality hit me hard with this message:\u003c/p\u003e\n\u003cimg alt=\"Only 2 days left on my GCP 1-year trial\" src=\"2-days-free-trial.png\" width=\"50%\"\u003e\n\u003cp\u003eI had only 2 days to find a plan and migrate everything away from GKE! My current setup was only using a single \u003ccode\u003en1-standard-1\u003c/code\u003e on \u003ccode\u003eus-west-1\u003c/code\u003e and with no network load balancer. But that was still around €15 a month, and I just didn\u0026rsquo;t want to pay. I chose to migrate to Civo\u0026rsquo;s managed K3s since they are in beta and I really wanted to try K3s.\u003c/p\u003e\n\u003ch2 id=\"civos-managed-k3s\"\u003eCivo\u0026rsquo;s Managed K3s\u003c/h2\u003e\n\u003cp\u003eCivo is a company that offers a public cloud as well as managed Kubernetes clusters. Their managed Kubernetes offer, named \u0026ldquo;\u003ca href=\"https://www.civo.com/kube100\"\u003eKUBE100\u003c/a\u003e\u0026rdquo;, is quite new (launched in mid-2019). Unlike most managed Kubernetes offerings like EKS or GKE, Civo went with Rancher\u0026rsquo;s \u003ca href=\"https://k3s.io/\"\u003eK3s\u003c/a\u003e Kubernetes distribution.\u003c/p\u003e\n\u003cp\u003eCompared to the standard Kubernetes distribution, K3s is a way lighter: simple embedded database with sqlite, one single binary instead of four; a single VM can both host the control plane and run pods. With the traditional Kubernetes distribution, you have to run the control plane on a separate VM. Note that Civo has a whole blog post on \u0026ldquo;\u003ca href=\"https://www.civo.com/blog/k8s-vs-k3s\"\u003eKubernetes vs. K3s\u003c/a\u003e\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003eThis lightweight feature is what brings me here, and also the fact that K3s comes by default with Traefik \u0026amp; their own tiny Service type=LoadBalancer controller, which means you don\u0026rsquo;t even need an expensive network load balancer like on GKE when you want to expose a service to the internet.\u003c/p\u003e\n\u003cp\u003eOf course, K3s has drawbacks and is probably meant for IoT-based clusters, but it\u0026rsquo;s also perfect for playing around with Kubernetes! So I went ahead and create a two-nodes cluster:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"civo-k3s.png\" alt=\"My K3s cluster on Civo\"\u003e\u003c/p\u003e\n\u003cp\u003eNote that since this is K3s, the master can also be scheduled with pods. So I could have gone with a single node.\u003c/p\u003e\n\u003ch2 id=\"migrating-externaldns-cert-manager-and-traefik\"\u003eMigrating ExternalDNS, cert-manager and Traefik\u003c/h2\u003e\n\u003cp\u003eThat\u0026rsquo;s the easy part. I just had to run \u003ca href=\"https://github.com/maelvls/k.maelvls.dev\"\u003e./helm_apply\u003c/a\u003e which runs \u003ccode\u003ehelm upgrade --install\u003c/code\u003e for each helm chart I use.\u003c/p\u003e\n\u003cp\u003eIn the process, I decided to go with \u003ccode\u003e*.k.maelvls.dev\u003c/code\u003e instead of \u003ccode\u003e*.kube.maelvls.dev\u003c/code\u003e. The shorter, the better! I forgot to add that I still use Google\u0026rsquo;s CloudDNS. I did not find an easy alternative yet. Maybe just Cloudflare for now?\u003c/p\u003e\n\u003cp\u003eAfter creating Traefik, I knew that its service would automatically be populated with the \u003ccode\u003estatus.loadBalancer\u003c/code\u003e field thanks to K3s\u0026rsquo; \u003ca href=\"https://github.com/rancher/k3s/blob/master/pkg/servicelb/controller.go\"\u003eservicelb\u003c/a\u003e. Let\u0026rsquo;s see:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kubectl -n traefik get services\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME     TYPE          CLUSTER-IP        EXTERNAL-IP      PORT\u003cspan class=\"o\"\u003e(\u003c/span\u003eS\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etraefik  LoadBalancer  192.168.255.134   91.211.152.190   443:32164/TCP,80:32684/TCP\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eGreat! Now, Traefik will propagate this external IP to the ingresses, and ExternalDNS will use the \u003ccode\u003estatus.loadBalancer\u003c/code\u003e from these ingresses in order to set \u003ccode\u003eA\u003c/code\u003e records.\u003c/p\u003e\n\u003cp\u003eIf you want to know more about how \u0026ldquo;servicelb\u0026rdquo; works, you can take a look at \u003ca href=\"https://maelvls.dev/packets-eye-kubernetes-service/\"\u003eThe Packet\u0026rsquo;s-Eye View of a Kubernetes Service\u003c/a\u003e where I describe how Akrobateo works (K3s\u0026rsquo; servicelb has the exact same behavior).\u003c/p\u003e\n\u003ch2 id=\"migrating-minio-from-the-old-to-the-new-cluster\"\u003eMigrating MinIO from the old to the new cluster\u003c/h2\u003e\n\u003cp\u003eI use \u003ca href=\"https://min.io/\"\u003eminio\u003c/a\u003e for various uses. It is great if you want a S3-compatible storage solution. In order to migrate, I followed \u003ca href=\"https://www.scaleway.com/en/docs/how-to-migrate-object-storage-buckets-with-minio\"\u003ethis\u003c/a\u003e. It\u0026rsquo;s quite painless:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ kubectl -n minio run a --generator\u003cspan class=\"o\"\u003e=\u003c/span\u003erun-pod/v1 -it --rm --restart\u003cspan class=\"o\"\u003e=\u003c/span\u003eNever --image\u003cspan class=\"o\"\u003e=\u003c/span\u003ealpine\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% wget https://dl.minio.io/client/mc/release/linux-amd64/mc \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e install mc /usr/bin\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% mc config host add old https://minio.kube.maelvls.dev AKIAIOSFODNN7EXAMPLE \u003cspan class=\"s2\"\u003e\u0026#34;wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\u0026#34;\u003c/span\u003e --api S3v4\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% mc config host add new http://minio:9000 AKIAIOSFODNN7EXAMPLE \u003cspan class=\"s2\"\u003e\u0026#34;wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\u0026#34;\u003c/span\u003e --api S3v4\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% mc ls old/         \u003cspan class=\"c1\"\u003e# List buckets since I had to create manually each bucket.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% mc mb new/bucket1  \u003cspan class=\"c1\"\u003e# Then create each bucket one by one.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% mc cp --recursive old/bucket1/ new/bucket1/\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eI also decided to change the access key \u0026amp; secret key. Again, quite painless. As mentioned in the \u003ca href=\"https://github.com/minio/minio/tree/master/docs/config\"\u003edocumentation\u003c/a\u003e, I changed the secret stored in Kubernetes:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl -n minio edit secret minio\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eand then I temporarily added the \u003ccode\u003eMINIO_ACCESS_KEY_OLD\u003c/code\u003e and \u003ccode\u003eMINIO_SECRET_KEY_OLD\u003c/code\u003e to the deployment by editing it.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl -n minio edit deployment minio\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAfter that, the pods get recreated, and MinIO picks up the new secret. Note: I also had to edit the deployment again in order to remove the temporary \u003ccode\u003e_OLD\u003c/code\u003e environment variables.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eTo recap, the whole migration was painless. The only data I migrated was MinIO. Note that I didn\u0026rsquo;t have any SLA to comply with, but if I had planned a bit better, I could have moved over with almost zero downtime.\u003c/p\u003e\n\u003cp\u003eIn order to get almost-zero-downtime, I would have made sure to keep the old and new MinIO instances replicated until the move was over. The only problem with the whole migration is the DNS change. I cannot precisely know when the propagation will take. After completing the migration and assuming that all the DNS entries are propagated, if for some reason people keep hitting the old IP due to outdated DNS entries, the old and new clusters would have become out-of-sync. To mitigate that issue, I could have chosen to \u0026ldquo;cordon\u0026rdquo; the old cluster just to make sure that this case never happens.\u003c/p\u003e\n\u003cp\u003eThe repo for my Kubernetes playground cluster (\u003ccode\u003e*.k.maelvls.dev\u003c/code\u003e) is available \u003ca href=\"https://github.com/maelvls/k.maelvls.dev\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eUpdate 7 May 2020\u003c/strong\u003e: better introduction explaining why I use GKE, tell what Civo and K3s are all about.\u003c/li\u003e\n\u003c/ul\u003e\n","date":1584835200,"description":"My free trial on GKE was ending in 2 days and I had to find a way to migrate away. I decided to switch to Civo's managed K3s.","dir":"2020/migrating-from-gke-to-civo/","expirydate":-62135596800,"fuzzywordcount":900,"images":["from-gke-to-civo-k3s/civo-k3s.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1584835200,"objectID":"427b7e08b111144c1fb2461d0da60a82","permalink":"https://maelvls.dev/do-not-share-yet/from-gke-to-civo-k3s/","publishdate":"2020-03-22T00:00:00Z","readingtime":5,"relpermalink":"/do-not-share-yet/from-gke-to-civo-k3s/","section":"2020","summary":"\u003cp\u003eTo learn and play with Kubernetes, I keep a \u0026ldquo;playground\u0026rdquo; cluster to try things on it (helm files I use are \u003ca href=\"https://github.com/maelvls/k.maelvls.dev\"\u003ehere\u003c/a\u003e). Since 2019, I have been using GKE (Google\u0026rsquo;s managed Kubernetes service), which works great with the one-year $300 credit that you get initially. A few days ago, reality hit me hard with this message:\u003c/p\u003e\n\u003cimg alt=\"Only 2 days left on my GCP 1-year trial\" src=\"2-days-free-trial.png\" width=\"50%\"\u003e\n\u003cp\u003eI had only 2 days to find a plan and migrate everything away from GKE! My current setup was only using a single \u003ccode\u003en1-standard-1\u003c/code\u003e on \u003ccode\u003eus-west-1\u003c/code\u003e and with no network load balancer. But that was still around €15 a month, and I just didn\u0026rsquo;t want to pay. I chose to migrate to Civo\u0026rsquo;s managed K3s since they are in beta and I really wanted to try K3s.\u003c/p\u003e","tags":["kubernetes"],"title":"Migrating from GKE to Civo's K3s","type":"2020","url":"https://maelvls.dev/do-not-share-yet/from-gke-to-civo-k3s/","weight":0,"wordcount":865},{"authors":null,"categories":null,"content":"\u003c!--\n\n1. service vs. ingress (L4 vs L7)\n\n\u003chttps://github.com/kubernetes/ingress-gce/search?p=3\u0026q=LoadBalancer\u0026unscoped_q=LoadBalancer\u003e\n\n2. how service and ingress interact with their controllers\n3. traffic flow with GKE's service LB and Traefik\n4. using my own service controller\n5. traffic flow with my own service controller\n6. comparison, benchmark, recap\n\n--\u003e\n\u003cp\u003eThe Service and Ingress respectively brings L4 and L7 traffics to your pods. I previously talked about \u003ca href=\"/avoid-gke-lb-with-hostport/\"\u003eusing \u003ccode\u003ehostPort\u003c/code\u003e to avoid GKE\u0026rsquo;s load balancer\u003c/a\u003e without really getting into the details of how everything works. In this article, I focus on how traffic flows in and what are the interactions between the ingress controller and the \u0026ldquo;service-lb controller\u0026rdquo; (the thing that creates the external load balancer). I also detail how the \u003ccode\u003ehostPort\u003c/code\u003e approach shapes traffic.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eIn Kubernetes, the service object represents how a set of pods can be hit with TCP or UDP connections. Since it is L4-only, the service only deals with IPs and ports. An Ingress is the L7 counterpart of a service: it deals with TLS, hostnames, HTTP paths and virtual servers (called \u0026ldquo;backends\u0026rdquo;).\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eNote: you might see some mentions of ingresses since Traefik is an ingress controller but I will not describe the traffic handling at the L7 level.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eAn ingress controller is a binary running as a simple deployment that watches all Ingress objects and live-updates the L7 proxy. Traefik qualifies as an ingress controllers: it has the nice property of embeding both the \u0026ldquo;ingress watcher\u0026rdquo; and the L7 proxy in a single binary. HAProxy and Nginx both use separate ingress controllers. And in order to get L4 traffic coming to the L7 proxy, we usually use a service that has the type \u003ccode\u003eLoadBalancer\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eI call \u0026ldquo;service-lb controller\u0026rdquo; a binary that watches service objects that have the \u003ccode\u003eLoadBalancer\u003c/code\u003e type. Any time the Google\u0026rsquo;s service-lb controller sees a new \u003ccode\u003eLoadBalancer\u003c/code\u003e service, it spins up a Network Load Balancer and sets up some firewall rules. In fact, Google\u0026rsquo;s service-lb controller runs as a small closed-source binary that runs on your master node (but not visible as a pod) and acts as a service-lb controller.\u003c/p\u003e\n\u003cp\u003eHere is a diagram that represents how GKE\u0026rsquo;s service-lb controller interacts with the ingress controller:\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"GKE service LoadBalancer controller and ingress controller\ninteraction\" src=\"/packets-eye-kubernetes-service/kubernetes-service-controllers-with-gke-service.svg\" width=\"80%\"/\u003e\u003c/p\u003e\n\u003cp\u003eSo, how does external traffic make it to the pod? The following diagram shows how a packet is forwarded to the right pod. Notice how many iptable rewriting happen (which corresponds to one connection managed by conntrack):\u003c/p\u003e\n\u003cimg alt=\"Packet coming from a user hitting the GKE network balancer and forwarded to the right pod\" src=\"kubernetes-traffic-with-gke-lb.svg\" width=\"80%\"/\u003e\n\u003cp\u003eNow, let\u0026rsquo;s see how it goes when using \u003ca href=\"https://github.com/kontena/akrobateo\"\u003eAkrobateo\u003c/a\u003e (I detailed that \u003ca href=\"/avoid-gke-lb-with-hostport/\"\u003ehere\u003c/a\u003e). Instead of using an external compute resource, we use the node\u0026rsquo;s IP in order to let traffic in.\u003c/p\u003e\n\u003cp\u003eNote: Akrobateo is EOL, but K3s\u0026rsquo;s \u003ca href=\"https://github.com/rancher/k3s/blob/master/pkg/servicelb/controller.go\"\u003eservicelb\u003c/a\u003e and \u003ca href=\"https://github.com/metallb/metallb\"\u003eMetallb\u003c/a\u003e work in a very similar way, setting the service\u0026rsquo;s \u003ccode\u003estatus.loadBalancer\u003c/code\u003e field with the correct external IP.\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Akrobateo service LoadBalancer controller and ingress controller\ninteraction\" src=\"kubernetes-service-controllers-with-akrobateo.svg\" width=\"70%\"/\u003e\u003c/p\u003e\n\u003cp\u003eYou might wonder why the \u0026lsquo;internal IP\u0026rsquo; is used in \u003ccode\u003estatus.loadBalancer\u003c/code\u003e. We might expect the external IP to be set there. But since Google\u0026rsquo;s VPC NAT swaps the node\u0026rsquo;s external IP to the node\u0026rsquo;s internal IP, the incoming packets have the internal IP as source IP. So that\u0026rsquo;s why 😁.\u003c/p\u003e\n\u003cp\u003eThe following diagram shows a packet coming from a user being routed to the Service that has the ClusterIP \u003ccode\u003e10.24.3.12\u003c/code\u003e. Notice the number of packet rewritings:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eDNAT by the VPC firewall,\u003c/li\u003e\n\u003cli\u003eDNAT in the \u003ccode\u003ehostPort\u003c/code\u003e rule on node 1,\u003c/li\u003e\n\u003cli\u003eDNAT in the Akrobateo pod,\u003c/li\u003e\n\u003cli\u003eDNAT for the Service ClusterIP rule on node 1,\u003c/li\u003e\n\u003cli\u003eSNAT due to the \u003ccode\u003eexternalTrafficPolicy: Cluster\u003c/code\u003e rule on node 1 (service-level random load-balancing across nodes),\u003c/li\u003e\n\u003cli\u003eUser-space TCP termination by Traefik (i.e., new dial to the pod-ip).\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThat\u0026rsquo;s a lot of hops and rewritings!\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"Packet coming from a user hitting one of the nodes directly\nthrough DNS resolution and forwarded to the right pod\"\nsrc=\"kubernetes-traffic-with-akrobateo.svg\" width=\"70%\"/\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eUpdate 28 April 2020\u003c/strong\u003e: Fixed a mistake I made in this diagram. I had set the source port to 80 in the \u0026ldquo;User\u0026rsquo;s request\u0026rdquo;. This example does not reflect what happens in reality. When connecting to a remote host, the TCP stack picks a random ephemeral IP above or equal 32768. The kernel calls it \u0026ldquo;local ports\u0026rdquo;, see \u003ca href=\"https://github.com/torvalds/linux/blob/c60174717544aa8959683d7e19d568309c3a0c65/net/ipv4/inet_hashtables.c#L739-L740\"\u003e\u003ccode\u003einet_hash_connect\u003c/code\u003e (\u003ccode\u003einet_hashtables.c\u003c/code\u003e)\u003c/a\u003e, \u003ca href=\"https://github.com/torvalds/linux/blob/9c7db5004280767566e91a33445bf93aa479ef02/net/core/secure_seq.c\"\u003e\u003ccode\u003esecure_ipv4_port_ephemeral\u003c/code\u003e (\u003ccode\u003esecure_seq.c\u003c/code\u003e)\u003c/a\u003e and \u003ca href=\"https://github.com/torvalds/linux/blob/29d9f30d4ce6c7a38745a54a8cddface10013490/Documentation/networking/ip-sysctl.txt#L907-L914\"\u003e\u003ccode\u003eip_local_port_range\u003c/code\u003e (\u003ccode\u003eip-sysctl.txt\u003c/code\u003e)\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eSo I changed the \u0026ldquo;User\u0026rsquo;s request\u0026rdquo; source port from 80 to 32345:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-diff\" data-lang=\"diff\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-src: 1.2.3.4:80\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e\u003c/span\u003e\u003cspan class=\"gi\"\u003e+src: 1.2.3.4:32345\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e\u003c/span\u003e dst: 35.211.248.124:80\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/blockquote\u003e\n\u003cp\u003eWith the \u0026ldquo;Akrobateo\u0026rdquo; method, we only rely on the VPC\u0026rsquo;s firewall rules. But using the node\u0026rsquo;s IP is not perfect: it might be a seen as a security risk, and the many IPs that end up in the service\u0026rsquo;s \u003ccode\u003estatus.loadBalancer\u003c/code\u003e isn\u0026rsquo;t ideal when it comes to setting your DNS \u003ccode\u003eA\u003c/code\u003e records:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ewhen a node disappears, the DNS might forward traffic to a unexisting node,\u003c/li\u003e\n\u003cli\u003eoffloading ingress traffic load balancing from a load balancer with a single IP to relying on DNS records isn\u0026rsquo;t ideal since DNS records leave you very few options as to how to balance traffic.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eK3s uses this approach of using the node IPs as service backends and does not need any external load balancer.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eUpdate 28 April 2020\u003c/strong\u003e: fixed an error with the source port in the last diagram. Added the list of DNAT and SNAT rewritings that happen in the last diagram. I also rewrote the introduction.\u003c/p\u003e\n","date":1584191410,"description":"The Service and Ingress respectively brings L4 and L7 traffics to your pods. In this article, I focus on how traffic flows in and what are the interactions between the ingress controller and the service-lb controller (the thing that creates the external load balancer). I also detail how the `hostPort` approach shapes traffic.","dir":"2020/packets-eye-of-a-service/","expirydate":-62135596800,"fuzzywordcount":800,"images":["packets-eye-kubernetes-service/cover-packets-eye-kubernetes-service.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1584191410,"objectID":"a200a0c3236a727545b7eb8be5d9e6b3","permalink":"https://maelvls.dev/do-not-share-yet/packets-eye-kubernetes-service/","publishdate":"2020-03-14T15:10:10+02:00","readingtime":4,"relpermalink":"/do-not-share-yet/packets-eye-kubernetes-service/","section":"2020","summary":"\u003c!--\n\n1. service vs. ingress (L4 vs L7)\n\n\u003chttps://github.com/kubernetes/ingress-gce/search?p=3\u0026q=LoadBalancer\u0026unscoped_q=LoadBalancer\u003e\n\n2. how service and ingress interact with their controllers\n3. traffic flow with GKE's service LB and Traefik\n4. using my own service controller\n5. traffic flow with my own service controller\n6. comparison, benchmark, recap\n\n--\u003e\n\u003cp\u003eThe Service and Ingress respectively brings L4 and L7 traffics to your pods. I previously talked about \u003ca href=\"/avoid-gke-lb-with-hostport/\"\u003eusing \u003ccode\u003ehostPort\u003c/code\u003e to avoid GKE\u0026rsquo;s load balancer\u003c/a\u003e without really getting into the details of how everything works. In this article, I focus on how traffic flows in and what are the interactions between the ingress controller and the \u0026ldquo;service-lb controller\u0026rdquo; (the thing that creates the external load balancer). I also detail how the \u003ccode\u003ehostPort\u003c/code\u003e approach shapes traffic.\u003c/p\u003e","tags":["kubernetes","networking","traefik"],"title":"The Packet's-Eye View of a Kubernetes Service","type":"2020","url":"https://maelvls.dev/do-not-share-yet/packets-eye-kubernetes-service/","weight":0,"wordcount":775},{"authors":null,"categories":null,"content":"","date":1584191410,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1584191410,"objectID":"https://maelvls.dev/do-not-share-yet/tags/traefik/","permalink":"https://maelvls.dev/do-not-share-yet/tags/traefik/","publishdate":"2020-03-14T15:10:10+02:00","readingtime":0,"relpermalink":"/do-not-share-yet/tags/traefik/","section":"tags","summary":"","tags":null,"title":"Traefik","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/traefik/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eWhen I scaled my GKE cluster from one node to two nodes, I realised there was some DNS issues with one of the pods on the new Node 2 (that\u0026rsquo;s what I initially thought).\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"diagram-node-2-dns-not-working.png\" alt=\"network diagram of the cluster where DNS not working in a pod of Node 2\"\u003e\u003c/p\u003e\n\u003cp\u003eSo I went into pod-on-2 (10.24.12.40) and checked that DNS wasn\u0026rsquo;t working. What I did is run\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud compute ssh node-2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker run --rm -it --net\u003cspan class=\"o\"\u003e=\u003c/span\u003econtainer:\u003cspan class=\"k\"\u003e$(\u003c/span\u003edocker ps \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep POD_pod-on-2 \u003cspan class=\"p\"\u003e|\u003c/span\u003e head -1 \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -f1 -d\u003cspan class=\"s2\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e\u003cspan class=\"k\"\u003e)\u003c/span\u003e nicolaka/netshoot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nslookup github.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e;;\u003c/span\u003e connection timed out\u003cspan class=\"p\"\u003e;\u003c/span\u003e no servers could be reached\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLet\u0026rsquo;s see if this DNS request actually goes out of the container. So I ran tcpdump on the \u003ccode\u003ecbr0\u003c/code\u003e interface on node 2. \u003ccode\u003ecbr0\u003c/code\u003e is the linux bridge used by Kubernetes (the bridge and the interface have the same name). Using Wireshark on top of tcpdump gives me easier-to-explore results:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"wireshark-node-2-cbr0-and-terminal.png\" alt=\"Wireshark running on interface cbr0 on node 2\"\u003e\u003c/p\u003e\n\u003cp\u003eNote that the actual name of Node 2 is \u003cem\u003egke-august-period-234610-worker-micro-1de60498-9gsb\u003c/em\u003e (now, you know!). Here is the command I used for opening wireshark on Node 2:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud compute ssh node-2 --command \u003cspan class=\"s2\"\u003e\u0026#34;docker run --rm --net=host corfr/tcpdump -i cbr0 -U -w - \u0026#39;not port 22\u0026#39;\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e wireshark -k -i -\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcpdump: listening on cbr0, link-type EN10MB \u003cspan class=\"o\"\u003e(\u003c/span\u003eEthernet\u003cspan class=\"o\"\u003e)\u003c/span\u003e, capture size \u003cspan class=\"m\"\u003e262144\u003c/span\u003e bytes\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWhat we see is that \u003ccode\u003ecbr0\u003c/code\u003e properly receives UDP packets coming from the pod \u003ccode\u003e10.24.12.40\u003c/code\u003e, and that the DNS address is \u003ccode\u003e10.27.240.10\u003c/code\u003e. I double checked, \u003ccode\u003e10.27.240.10\u003c/code\u003e is the DNS address set in \u003ccode\u003e/etc/resolve.conf\u003c/code\u003e inside containers in this pod.\u003c/p\u003e\n\u003cp\u003eHere is the network setup with the IPs to get a better picture:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"diagram-pod-ips.png\" alt=\"Network diagram of the Kubernetes cluster with two nodes and two pods and with IPs displayed\"\u003e\u003c/p\u003e\n\u003cp\u003eLet\u0026rsquo;s check that \u003ccode\u003e10.27.240.10\u003c/code\u003e is actually a service:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kubectl -n kube-system get service kube-dns\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME       TYPE        CLUSTER-IP     EXTERNAL-IP   PORT\u003cspan class=\"o\"\u003e(\u003c/span\u003eS\u003cspan class=\"o\"\u003e)\u003c/span\u003e         AGE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekube-dns   ClusterIP   10.27.240.10   \u0026lt;none\u0026gt;        53/UDP,53/TCP   34d\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe now know that the DNS used in all the pods is the ClusterIP of the kube-dns service. That\u0026rsquo;s not a real pod IP, so the iptables should be translating that into an actual pod IP.\u003c/p\u003e\n\u003cp\u003eNow that we know that the packet goes to \u003ccode\u003ecbr0\u003c/code\u003e, is it forwarded to Node 2\u0026rsquo;s \u003ccode\u003eeth0\u003c/code\u003e? I used Wireshark again, but on \u003ccode\u003eeth0\u003c/code\u003e this time:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"wireshark-node-2-eth0.png\" alt=\"Wireshark on eth0 of Node 2\"\u003e\u003c/p\u003e\n\u003cp\u003eApparently, the packet destination has been re-written from \u003ccode\u003e10.27.240.10\u003c/code\u003e to \u003ccode\u003e10.24.9.31\u003c/code\u003e (an actual pod IP) which is good sign. This pod IP corresponds to one of the replicas of kube-dns on node 1, which seems fine.\u003c/p\u003e\n\u003cp\u003eAt this point, I was wondering: are UDP packets from node 2 to node 1 properly routed?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emvalais@node-2 ~ $ docker run -it --rm --net\u003cspan class=\"o\"\u003e=\u003c/span\u003ehost nicolaka/netshoot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nslookup github.com 10.27.240.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eServer:\t\t10.27.240.10\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAddress:\t10.27.240.10#53\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNon-authoritative answer:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eName:\tgithub.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAddress: 192.30.253.113\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWait what? The DNS query to \u003ccode\u003e10.27.240.10\u003c/code\u003e works from the host but not from the pod? At this point, my guesses were:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003esomething wrong with the routes on the host,\u003c/li\u003e\n\u003cli\u003esomething is wrong with networking on node 1\u003c/li\u003e\n\u003cli\u003esomething is wrong with the iptables of node 2\u003c/li\u003e\n\u003cli\u003ean issue with routing of \u003ccode\u003e10.24.0.0/14\u003c/code\u003e on the VPC (it\u0026rsquo;s the CIDR allocated to this GKE cluster; the nodes themselves receive \u003ccode\u003e/24\u003c/code\u003e CIDRs from this range)\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eLet\u0026rsquo;s rule (1) out. Here is the L3 routing table on node 2:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emvalais@node-2 ~ $ docker run -it --rm --net\u003cspan class=\"o\"\u003e=\u003c/span\u003ehost nicolaka/netshoot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% ip route\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault via 10.142.0.1 dev eth0    proto dhcp   src 10.142.15.206 metric \u003cspan class=\"m\"\u003e1024\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault via 10.142.0.1 dev eth0    proto dhcp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.24.12.0/24          dev cbr0    proto kernel src 10.24.12.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.142.0.1             dev eth0    proto dhcp   src 10.142.15.206 metric \u003cspan class=\"m\"\u003e1024\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.142.0.1             dev eth0    proto dhcp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e169.254.123.0/24       dev docker0 proto kernel src 169.254.123.1 linkdown\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eRemembering that Node 2\u0026rsquo;s eth0 has the IP \u003ccode\u003e10.142.15.206\u003c/code\u003e, it looks like all packets that are meant for Node 1\u0026rsquo;s kube-dns will use the first rule. So no problem on this side.\u003c/p\u003e\n\u003cp\u003eThe (2) guess is easy to check: I ran tcpdump with wireshark on the eth0 of node 1. No trace of an UDP packet coming from \u003ccode\u003e10.24.12.40\u003c/code\u003e. So the packets don\u0026rsquo;t even reach the node 1.\u003c/p\u003e\n\u003cp\u003eLet\u0026rsquo;s recap all we know: the packet goes from the pod\u0026rsquo;s eth0 to the linux bridge, and is then rewritten and forwarded to the host\u0026rsquo;s eth0.\u003c/p\u003e\n\u003cp\u003e\u003cimg\nsrc=\"diagram-node-2-iptables-flow.png\"\nwidth=\"400\" alt=\"On Node 2, packet goes from pod's eth0 to host's cbr0 and\nthen host's eth0\" /\u003e\u003c/p\u003e\n\u003cp\u003eSo we are left with\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003esomething is wrong with the iptables of node 2\u003c/li\u003e\n\u003cli\u003ean issue with routing of \u003ccode\u003e10.24.0.0/14\u003c/code\u003e on the VPC\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eI now realise that I could have ruled out the iptable issue since I could see the packet on Node 2\u0026rsquo;s eth0 interface. But I wanted to know how that packet was handled anyway!\u003c/p\u003e\n\u003cp\u003eSo let\u0026rsquo;s dive into what iptables is doing to this packet. First, let\u0026rsquo;s see if a conntrack entry exists due to the DNAT rewriting:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# From the pod on Node 2:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% nslookup github.com\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003emvalais\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"m\"\u003e-2\u003c/span\u003e \u003cspan class=\"o\"\u003e~\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e \u003cspan class=\"n\"\u003edocker\u003c/span\u003e \u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003enet\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003eprivileged\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003erm\u003c/span\u003e \u003cspan class=\"n\"\u003emissioncriticalkubernetes\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econntrack\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eL\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003egrep\u003c/span\u003e \u003cspan class=\"m\"\u003e10.24\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003econntrack\u003c/span\u003e \u003cspan class=\"nf\"\u003ev1.4.4 \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econntrack\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003etools\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e52\u003c/span\u003e \u003cspan class=\"n\"\u003eflow\u003c/span\u003e \u003cspan class=\"n\"\u003eentries\u003c/span\u003e \u003cspan class=\"n\"\u003ehave\u003c/span\u003e \u003cspan class=\"n\"\u003ebeen\u003c/span\u003e \u003cspan class=\"n\"\u003eshown.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eudp\u003c/span\u003e \u003cspan class=\"m\"\u003e17\u003c/span\u003e \u003cspan class=\"m\"\u003e26\u003c/span\u003e  \u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e    \u003cspan class=\"n\"\u003edst\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e \u003cspan class=\"n\"\u003esport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57400\u003c/span\u003e \u003cspan class=\"n\"\u003edport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003e[UNREPLIED]\u003c/span\u003e \u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e \u003cspan class=\"n\"\u003edst\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e     \u003cspan class=\"n\"\u003esport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003edport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57400\u003c/span\u003e           \u003cspan class=\"n\"\u003emark\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# From Node 2\u0026#39;s host networking:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% nslookup github.com 10.27.240.10\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003emvalais\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003enode\u003c/span\u003e\u003cspan class=\"m\"\u003e-2\u003c/span\u003e \u003cspan class=\"o\"\u003e~\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e \u003cspan class=\"n\"\u003edocker\u003c/span\u003e \u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003enet\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003eprivileged\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003erm\u003c/span\u003e \u003cspan class=\"n\"\u003emissioncriticalkubernetes\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econntrack\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eL\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003egrep\u003c/span\u003e \u003cspan class=\"m\"\u003e10.24\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eudp\u003c/span\u003e \u003cspan class=\"m\"\u003e17\u003c/span\u003e \u003cspan class=\"m\"\u003e175\u003c/span\u003e \u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.142.15.206\u003c/span\u003e \u003cspan class=\"n\"\u003edst\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e \u003cspan class=\"n\"\u003esport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e37337\u003c/span\u003e \u003cspan class=\"n\"\u003edport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e             \u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e \u003cspan class=\"n\"\u003edst\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.142.15.206\u003c/span\u003e \u003cspan class=\"n\"\u003esport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003edport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e37337\u003c/span\u003e \u003cspan class=\"n\"\u003e[ASSURED]\u003c/span\u003e \u003cspan class=\"n\"\u003emark\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eComing from the pod, we see that the DNAT rewriting happened but the connection status is UNREPLIED. Coming from the host, the DNAT rewriting also happened but the connection status is ASSURED, which means a reply has been given.\u003c/p\u003e\n\u003cp\u003eNow, the deep dive: let\u0026rsquo;s use iptables\u0026rsquo; \u003ccode\u003eTRACE\u003c/code\u003e target to know how this packet gets rewritten when coming from the pod:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# From Node 2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% sudo modprobe ipt_LOG\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003esudo\u003c/span\u003e \u003cspan class=\"n\"\u003eiptables\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"m\"\u003e10.24.0.0\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e16\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% sudo iptables -A PREROUTING -t raw -d 10.24.0.0/16 -j TRACE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003edocker\u003c/span\u003e \u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003erm\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003enet\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003econtainer\u003c/span\u003e\u003cspan class=\"o\"\u003e:$\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edocker\u003c/span\u003e \u003cspan class=\"n\"\u003eps\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003egrep\u003c/span\u003e \u003cspan class=\"n\"\u003ePOD_pod\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eon\u003c/span\u003e\u003cspan class=\"m\"\u003e-2\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003ehead\u003c/span\u003e \u003cspan class=\"m\"\u003e-1\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003ecut\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ef1\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003eprivileged\u003c/span\u003e \u003cspan class=\"n\"\u003enicolaka\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003enetshoot\u003c/span\u003e \u003cspan class=\"n\"\u003enslookup\u003c/span\u003e \u003cspan class=\"n\"\u003egithub.com\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% \u003cspan class=\"n\"\u003edmesg\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ew\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.179725]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                  \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.200327]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e               \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.221171]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.241576]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSERVICES\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e14\u003c/span\u003e                \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.262385]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSVC\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eTCOU7JCQXEZGVUNU\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e     \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.284116]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSEP\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eMQYG7Z5PYI3N6YFY\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e     \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.305838]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                  \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.326491]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.346973]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e             \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.368068]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.389031]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSERVICES\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e            \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.410253]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.430735]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eDOCKER\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eUSER\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e              \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.451887]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.472366]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eDOCKER\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eISOLATION\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSTAGE\u003c/span\u003e\u003cspan class=\"m\"\u003e-1\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.494488]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e                   \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.515049]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e              \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.531693]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                   \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.547953]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e            \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.564769]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                   \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.580978]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eIP\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eMASQ\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                       \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.596840]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e                 \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.12.40\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.31\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe last list, \u003ccode\u003ePOSTROUTING\u003c/code\u003e, makes it clear that the packet is properly sent to the host\u0026rsquo;s \u003ccode\u003eeth0\u003c/code\u003e with \u003ccode\u003esrc 10.24.12.40\u003c/code\u003e and \u003ccode\u003edst 10.24.9.31\u003c/code\u003e. The packet should get to node 1 now!\u003c/p\u003e\n\u003cp\u003eI noticed that using \u003ccode\u003e-j TRACE\u003c/code\u003e is extremely expensive. For example, using \u003ccode\u003e-p icmp\u003c/code\u003e would result in pings going from 1ms (without tracing) to 500ms. I also overloaded one of the nodes by adding a rule that was \u0026ldquo;too wide\u0026rdquo; and nearly killed the entire node. Use tracing filters (\u003ccode\u003e-s\u003c/code\u003e, \u003ccode\u003e-p\u003c/code\u003e, \u003ccode\u003e-d\u003c/code\u003e) as narrow as possible!\u003c/p\u003e\n\u003cp\u003eSo UDP traffic doesn\u0026rsquo;t get routed. But what about ICMP and TCP packets? I had previously noticed that \u003ccode\u003eping\u003c/code\u003e would work from 10.24.12.40 to 10.24.9.31.\u003c/p\u003e\n\u003cp\u003eLet\u0026rsquo;s see if TCP traffic also works. This time, instead of ssh-ing into the nodes and running docker, I used \u003ccode\u003e--generator=run-pod/v1\u003c/code\u003e and \u003ccode\u003e--override\u003c/code\u003e in order to choose on which node the pod is launched. Here is a sample of what I give to \u003ccode\u003e--override\u003c/code\u003e for running a pod on \u003ccode\u003enode-2\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eaffinity\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003enodeAffinity\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003erequiredDuringSchedulingIgnoredDuringExecution\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e\u003cspan class=\"nt\"\u003enodeSelectorTerms\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e- \u003cspan class=\"nt\"\u003ematchFields\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e              \u003c/span\u003e- \u003cspan class=\"nt\"\u003ekey\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003emetadata.name\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e                \u003c/span\u003e\u003cspan class=\"nt\"\u003eoperator\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eIn\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e                \u003c/span\u003e\u003cspan class=\"nt\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"l\"\u003enode-2]\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFrom a pod on Node 1 (\u003ccode\u003e10.24.9.32\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kubectl run --generator\u003cspan class=\"o\"\u003e=\u003c/span\u003erun-pod/v1 tmp-host-a --overrides\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;spec\u0026#34;:{\u0026#34;affinity\u0026#34;:{\u0026#34;nodeAffinity\u0026#34;:{\u0026#34;requiredDuringSchedulingIgnoredDuringExecution\u0026#34;:{\u0026#34;nodeSelectorTerms\u0026#34;:[{\u0026#34;matchFields\u0026#34;:[{\u0026#34;key\u0026#34;:\u0026#34;metadata.name\u0026#34;,\u0026#34;operator\u0026#34;:\u0026#34;In\u0026#34;,\u0026#34;values\u0026#34;:[\u0026#34;node-1\u0026#34;]}]}]}}}}}\u0026#39;\u003c/span\u003e --rm -i --tty --image nicolaka/netshoot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc -v 10.24.12.41 \u003cspan class=\"m\"\u003e80\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eConnection to 10.24.12.41 \u003cspan class=\"m\"\u003e80\u003c/span\u003e port \u003cspan class=\"o\"\u003e[\u003c/span\u003etcp/http\u003cspan class=\"o\"\u003e]\u003c/span\u003e succeeded!\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFrom a pod on Node 2 (\u003ccode\u003e10.24.12.41\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kubectl run --generator\u003cspan class=\"o\"\u003e=\u003c/span\u003erun-pod/v1 tmp-host-b --overrides\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;spec\u0026#34;:{\u0026#34;affinity\u0026#34;:{\u0026#34;nodeAffinity\u0026#34;:{\u0026#34;requiredDuringSchedulingIgnoredDuringExecution\u0026#34;:{\u0026#34;nodeSelectorTerms\u0026#34;:[{\u0026#34;matchFields\u0026#34;:[{\u0026#34;key\u0026#34;:\u0026#34;metadata.name\u0026#34;,\u0026#34;operator\u0026#34;:\u0026#34;In\u0026#34;,\u0026#34;values\u0026#34;:[\u0026#34;node-2\u0026#34;]}]}]}}}}}\u0026#39;\u003c/span\u003e --rm -i --tty --image nicolaka/netshoot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc -v -l \u003cspan class=\"m\"\u003e80\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eListening on \u003cspan class=\"o\"\u003e[\u003c/span\u003e0.0.0.0\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003efamily 0, port 80\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eConnection from 10.24.9.32 \u003cspan class=\"m\"\u003e38274\u003c/span\u003e received!\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe traffic on 80/tcp definitely seems to work from Node 1 to Node 2! Now, let\u0026rsquo;s try the same but with 53/tcp and from Node 2 to Node 1.\u003c/p\u003e\n\u003cp\u003eFrom pod on Node 1 (\u003ccode\u003e10.24.9.32\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc -v -l \u003cspan class=\"m\"\u003e53\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eListening on \u003cspan class=\"o\"\u003e[\u003c/span\u003e0.0.0.0\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003efamily 0, port 53\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFrom pod on Node 2 (\u003ccode\u003e10.24.12.41\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% curl 10.24.9.32:53\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ecurl: \u003cspan class=\"o\"\u003e(\u003c/span\u003e28\u003cspan class=\"o\"\u003e)\u003c/span\u003e Failed to connect to 10.24.9.32 port 53: Operation timed out\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo recap, only 80/tcp, 443/tcp and icmp packets are routed. It\u0026rsquo;s surprisingly very specific: what if the VPC firewall rules were off? That was my last guess, but I guess it should have been myst first\u0026hellip;\u003c/p\u003e\n\u003cp\u003eTwo weeks ago, I remember having deleted some left-over rules when I was playing with Kops. I might have deleted one of the rules that allowed this traffic to flow!\u003c/p\u003e\n\u003cp\u003eHere is what the UI shows:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"gcp-ui-vpc-firewall-rules.png\" alt=\"Screenshot of the VPC interface on GCP, the 10.24.0.0 subnet doesn\u0026rsquo;t seem to be allowed\"\u003e\u003c/p\u003e\n\u003cp\u003eEven easier-to-read, using \u003ccode\u003egcloud\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud compute firewall-rules list\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME                   NETWORK  DIRECTION  PRIORITY ALLOW\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eakrobateo-fw-traefik   default  INGRESS    \u003cspan class=\"m\"\u003e1000\u003c/span\u003e     tcp:80,tcp:443\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-icmp     default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e    icmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-internal default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e    tcp:0-65535,udp:0-65535,icmp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-rdp      default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e    tcp:3389\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-ssh      default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e    tcp:22\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHow is the traffic using the \u003ccode\u003e10.24.0.0/14\u003c/code\u003e subnet supposed to be routed? This subnet was allocated to this GKE cluster; node 1 was given the CIDR \u003ccode\u003e10.24.9.0/24\u003c/code\u003e and node 2 was given the CIDR \u003ccode\u003e10.24.12.0/24\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eSo I added a new rule \u003ccode\u003egke-august-period-234610-all\u003c/code\u003e (august-period-234610 is the name of my project); it looks like that:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME                         NETWORK  DIRECTION  PRIORITY  ALLOW                         DENY  DISABLED\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egke-august-period-234610-all default  INGRESS    \u003cspan class=\"m\"\u003e1000\u003c/span\u003e      udp,icmp,esp,ah,sctp,tcp            False\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, let\u0026rsquo;s test again using 53/udp:\u003c/p\u003e\n\u003cp\u003ePod on Node 2 (\u003ccode\u003e10.24.12.41\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc -v -u 10.24.9.32 \u003cspan class=\"m\"\u003e8888\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Exits with 0 and no output\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ePod on Node 1 (\u003ccode\u003e10.24.9.32\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% tcpdump\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcpdump: verbose output suppressed, use -v or -vv \u003cspan class=\"k\"\u003efor\u003c/span\u003e full protocol decode\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elistening on eth0, link-type EN10MB \u003cspan class=\"o\"\u003e(\u003c/span\u003eEthernet\u003cspan class=\"o\"\u003e)\u003c/span\u003e, capture size \u003cspan class=\"m\"\u003e262144\u003c/span\u003e bytes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21:54:39.787779 IP 10.24.12.41.40760 \u0026gt; tmp-host-a.8888: UDP, length \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21:54:39.787802 IP tmp-host-a \u0026gt; 10.24.12.41: ICMP tmp-host-a udp port \u003cspan class=\"m\"\u003e8888\u003c/span\u003e unreachable, length \u003cspan class=\"m\"\u003e37\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21:54:39.787805 IP 10.24.12.41.40760 \u0026gt; tmp-host-a.8888: UDP, length \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21:54:39.787808 IP tmp-host-a \u0026gt; 10.24.12.41: ICMP tmp-host-a udp port \u003cspan class=\"m\"\u003e8888\u003c/span\u003e unreachable, length \u003cspan class=\"m\"\u003e37\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eYay! In the end, the issue was not so deep\u0026hellip; A manual edit to the firewall rules that I had not thought through and for which I have no record of. I already terraformed a lot of the cluster and node creation, but I should definitely move everything to terraform and stop doing manual edits that can\u0026rsquo;t be traced back!\u003c/p\u003e\n\u003c!--\nIf you with to leave a comment, here is a Twitter thread:\n\n\u003cblockquote class=\"twitter-tweet\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eI decided to write a blog post that recaps what I went through while trying to fix my cluster 😁 \u003ca href=\"https://t.co/sb0UcctUUU\"\u003ehttps://t.co/sb0UcctUUU\u003c/a\u003e\u003c/p\u003e\u0026mdash; Maël Valais (@maelvls) \u003ca href=\"https://twitter.com/maelvls/status/1221488683485925376?ref_src=twsrc%5Etfw\"\u003eJanuary 26, 2020\u003c/a\u003e\u003c/blockquote\u003e\n\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\n\n--\u003e\n","date":1579996800,"description":"Some pods were unable to connect to the kube-proxy pod on one of my GKE Kubernetes clusters. This post present an in-depth investigation using tcpdump, wireshark and iptables tracing.","dir":"2020/debug-kubernetes-networking/","expirydate":-62135596800,"fuzzywordcount":2000,"images":["debugging-kubernetes-networking/cover-debug-kubernetes-networking.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1579996800,"objectID":"3857ffe139e101d2bed980267b059779","permalink":"https://maelvls.dev/do-not-share-yet/debugging-kubernetes-networking/","publishdate":"2020-01-26T00:00:00Z","readingtime":10,"relpermalink":"/do-not-share-yet/debugging-kubernetes-networking/","section":"2020","summary":"\u003cp\u003eWhen I scaled my GKE cluster from one node to two nodes, I realised there was some DNS issues with one of the pods on the new Node 2 (that\u0026rsquo;s what I initially thought).\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"diagram-node-2-dns-not-working.png\" alt=\"network diagram of the cluster where DNS not working in a pod of Node 2\"\u003e\u003c/p\u003e\n\u003cp\u003eSo I went into pod-on-2 (10.24.12.40) and checked that DNS wasn\u0026rsquo;t working. What I did is run\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud compute ssh node-2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% docker run --rm -it --net\u003cspan class=\"o\"\u003e=\u003c/span\u003econtainer:\u003cspan class=\"k\"\u003e$(\u003c/span\u003edocker ps \u003cspan class=\"p\"\u003e|\u003c/span\u003e grep POD_pod-on-2 \u003cspan class=\"p\"\u003e|\u003c/span\u003e head -1 \u003cspan class=\"p\"\u003e|\u003c/span\u003e cut -f1 -d\u003cspan class=\"s2\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e\u003cspan class=\"k\"\u003e)\u003c/span\u003e nicolaka/netshoot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nslookup github.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e;;\u003c/span\u003e connection timed out\u003cspan class=\"p\"\u003e;\u003c/span\u003e no servers could be reached\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLet\u0026rsquo;s see if this DNS request actually goes out of the container. So I ran tcpdump on the \u003ccode\u003ecbr0\u003c/code\u003e interface on node 2. \u003ccode\u003ecbr0\u003c/code\u003e is the linux bridge used by Kubernetes (the bridge and the interface have the same name). Using Wireshark on top of tcpdump gives me easier-to-explore results:\u003c/p\u003e","tags":["kubernetes","networking"],"title":"Debugging Kubernetes Networking: my kube-dns is not working!","type":"2020","url":"https://maelvls.dev/do-not-share-yet/debugging-kubernetes-networking/","weight":0,"wordcount":1950},{"authors":null,"categories":null,"content":"\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e⚠️ Update 25 April 2020\u003c/strong\u003e: Akrobateo has been EOL in January 2020 due to the company going out of business. Their blog post regarding the EOL isn\u0026rsquo;t available anymore and was probably shut down. Fortunately, the Wayback Machine \u003ca href=\"https://web.archive.org/web/20200107111252/https://blog.kontena.io/farewell/\"\u003ehas a snapshot of the post\u003c/a\u003e (7th January 2020). Here is an excerpt:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThis is a sad day for team Kontena. We tried to build something amazing but our plans of creating business around open source software has failed. We couldn\u0026rsquo;t build a sustainable business. Despite all the effort, highs and lows, as of today, Kontena has ceased operations. The team is no more and the official support for Kontena products is no more available.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eThis is so sad\u0026hellip; 😢 Note that the Github repo \u003ca href=\"https://github.com/kontena/akrobateo\"\u003ekontena/akrobateo\u003c/a\u003e is still there (and has not been archived yet), but their Docker registry has been shut down which means most of this post is broken.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eIn my spare time, I maintain a tiny \u0026ldquo;playground\u0026rdquo; Kubernetes cluster on \u003ca href=\"https://cloud.google.com/kubernetes-engine\"\u003eGKE\u003c/a\u003e (helm charts \u003ca href=\"https://github.com/maelvls/k.maelvls.dev\"\u003ehere\u003c/a\u003e). I quickly realized that realized using \u003ccode\u003eService type=LoadBalancer\u003c/code\u003e in GKE was spawning a \u003cem\u003e\u003ca href=\"https://cloud.google.com/load-balancing/docs/network\"\u003eNetwork Load Balancer\u003c/a\u003e\u003c/em\u003e which costs approximately \u003cstrong\u003e$15 per month\u003c/strong\u003e! In this post, I present a way of avoiding the expensive Google Network Load Balancer by load balancing in-cluster using akrobateo, which acts as a Service type=LoadBalancer controller.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e✅ Since this method uses the worker node\u0026rsquo;s external IPs, we can\u0026rsquo;t really say it is a real \u0026ldquo;load balancing\u0026rdquo; mechanism (i.e., this method doesn\u0026rsquo;t handle IP failover and doesn\u0026rsquo;t even tolerate node failures). But in my tiny setup, it makes a lot of sense to use that.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"cost-load-balancer-gke.png\" alt=\"Network Load Balancing: Forwarding Rule Minimum Service Charge in EMEA\"\u003e\u003c/p\u003e\n\u003cp\u003eWhat happens is that GKE has a LoadBalancer controller running (I can\u0026rsquo;t see it) and whenever I have a service with \u003ccode\u003etype: LoadBalancer\u003c/code\u003e, it will create a L4 load balancer that balances 80 and 443 traffic across the nodes. Here is a diagram of my current setup:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"how-service-controller-works-on-gke.png\" alt=\"ExternalDNS, GKE and Traefik\"\u003e\u003c/p\u003e\n\u003cp\u003eI use Traefik as a reverse-proxy and terminates the end-user TLS connection. And since Traefik sets the \u003ccode\u003estatus.loadBalancer.ingress\u003c/code\u003e on the ingress objects, I can also use \u003ca href=\"https://github.com/kubernetes-sigs/external-dns/\"\u003eExternalDNS\u003c/a\u003e for setting the \u003ccode\u003eA\u003c/code\u003e records automatically (I use Cloud DNS).\u003c/p\u003e\n\u003cp\u003eWhat if I stopped using the LoadBalancer service and use a \u003ccode\u003eNodePort\u003c/code\u003e instead? Two reasons against that:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eGKE \u003ca href=\"https://issues.k8s.io/9995\"\u003erestricts\u003c/a\u003e the ports you can use to 30000 and above. So I would end up with \u003ccode\u003ehttps://kube.maelvls.dev:30145\u003c/code\u003e and I definitely don\u0026rsquo;t want that. I want to use 80 and 443.\u003c/li\u003e\n\u003cli\u003eTraefik uses the LoadBalancer service\u0026rsquo;s status in order to set the ingresses\u0026rsquo; \u003ccode\u003estatus.loadBalancer.ingress\u003c/code\u003e, which in turn is used by ExternalDNS for setting the \u003ccode\u003eA\u003c/code\u003e records automatically. I still want to be able to use ExternalDNS.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThus, my goal is expose Traefik on 80 and 443 and still use the \u003ccode\u003etype: LoadBalancer\u003c/code\u003e which, in turn, allows me to use ExternalDNS.\u003c/p\u003e\n\u003cp\u003eI could use the service\u0026rsquo;s \u003ccode\u003eexternalIPs\u003c/code\u003e but it isn\u0026rsquo;t supported by Traefik and I would have to write some controller that would get the node internal IP and then set the \u003ccode\u003eexternalIPs\u003c/code\u003e with these.\u003c/p\u003e\n\u003cp\u003eInstead, I opted for the \u003ccode\u003ehostPort\u003c/code\u003e solution. No restriction on 80 or 443. But I still have to automate a lot. Fortunately, \u003ca href=\"https://github.com/kontena/akrobateo\"\u003eakrobateo\u003c/a\u003e does exactly what I need.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003ehostPort\u003c/code\u003e is a field you can set in a Pod. The hostPort is used by kube-proxy to forward traffic coming to the node with the destination \u003ccode\u003ehostIP:hostPort\u003c/code\u003e to the pod itself.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ePod\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eakrobateo-lb-xmz8z\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econtainers\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;registry.pharos.sh/kontenapharos/akrobateo-lb:0.1.1\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eports\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e        \u003c/span\u003e- \u003cspan class=\"nt\"\u003econtainerPort\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e443\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003ehostPort\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e443\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# ⚠️\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttps\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e          \u003c/span\u003e\u003cspan class=\"nt\"\u003eprotocol\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eTCP\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ehostIP\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e172.31.4.153\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# ⚠️ hostIP and hostPort go together\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003epodIP\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e192.168.1.38\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn this example pod, the pod runs on the node that has the hostIP \u003ccode\u003e172.31.4.153\u003c/code\u003e. Any time traffic comes to the main network interface of the node with the TCP packet destination \u003ccode\u003edst: 172.31.4.153:443\u003c/code\u003e will be forwarded (i.e., DNATed) to \u003ccode\u003edst: 192.168.1.38:443\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eNote that this pod was actually created using a DeamonSet.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eAkrobateo acts as an internal LoadBalancer service controller and replaces the gce-ingress-controller that GKE applies to every GKE cluster. It is inspired by K3S\u0026rsquo; \u003ca href=\"https://github.com/rancher/k3s/blob/341a5553/pkg/servicelb/controller.go\"\u003eservicelb\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThe akrobateo controller reads the LoadBalancer services and updates the \u003ccode\u003estatus.loadBalancer.ingress\u003c/code\u003e on these services with the node external IPs. Whenever the external IPs change (since they are ephemeral), the controller updates the service; Traefik does it job and finally ExternalDNS updates the DNS records.\u003c/p\u003e\n\u003cp\u003eI might get some downtime with that, but for my use it\u0026rsquo;s just fine.\u003c/p\u003e\n\u003ch2 id=\"setting-up-akrobateo\"\u003eSetting up Akrobateo\u003c/h2\u003e\n\u003cp\u003eThat will install the akrobateo controller in the kube-system namespace:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ek apply -k https://github.com/kontena/akrobateo/deploy\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSince we want TCP 80 and 443 traffic to be able to hit the nodes. Let\u0026rsquo;s set a new firewall rule:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud compute firewall-rules create akrobateo-fw-traefik --allow tcp:80,tcp:443 --source-ranges\u003cspan class=\"o\"\u003e=\u003c/span\u003e0.0.0.0/0\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAlso, make sure we don\u0026rsquo;t have a L4 load balancer still running. The load balancer won\u0026rsquo;t get removed automatically.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud compute forwarding-rules list\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eListed \u003cspan class=\"m\"\u003e0\u003c/span\u003e items.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAt this point, the LoadBalancer service should contain the IPs of the nodes:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl -n traefik get services traefik -oyaml\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ev1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eService\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003emetadata\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003etraefik\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003enamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003etraefik\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eclusterIP\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.244.111\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eexternalTrafficPolicy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eCluster\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eports\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttp\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003enodePort\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e30371\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e80\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eprotocol\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eTCP\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003etargetPort\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttp\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003ename\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttps\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003enodePort\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e32748\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eport\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e443\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eprotocol\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eTCP\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003etargetPort\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ehttps\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eLoadBalancer\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eloadBalancer\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e\u003cspan class=\"nt\"\u003eingress\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003eip\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e35.211.248.124\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e- \u003cspan class=\"nt\"\u003eip\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"m\"\u003e35.231.10.40\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWhen displayed with \u003ccode\u003ekubectl get\u003c/code\u003e, we can see the two IPs from the status.loadBalancer in the \u0026ldquo;EXTERNAL-IP\u0026rdquo; column:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kubectl -n traefik get services -owide\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME                TYPE           CLUSTER-IP      EXTERNAL-IP                   PORT\u003cspan class=\"o\"\u003e(\u003c/span\u003eS\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etraefik             LoadBalancer   10.27.244.111   35.211.248.124,35.231.10.40   80:30371/TCP,443:32748/TCP\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLet\u0026rsquo;s check that these are the external IPs of the cluster nodes:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kubectl get nodes -owide\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME                                                 INTERNAL-IP   EXTERNAL-IP\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egke-august-period-234610-worker-0c5c84f5-rq25        10.142.0.61   35.231.10.40\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egke-august-period-234610-worker-micro-cf12d79d-klh6  10.142.0.62   35.211.248.124\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe \u003ccode\u003ekube-system/akrobateo\u003c/code\u003e controller will create a DeamonSet for every LoadBalancer service it finds. The DeamonSet is created in the same namespace as where the Service is:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kubectl get ds -A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAMESPACE     NAME                       DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etraefik       akrobateo-traefik          \u003cspan class=\"m\"\u003e2\u003c/span\u003e         \u003cspan class=\"m\"\u003e2\u003c/span\u003e         \u003cspan class=\"m\"\u003e2\u003c/span\u003e       \u003cspan class=\"m\"\u003e2\u003c/span\u003e            \u003cspan class=\"m\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis DeamonSet runs one pod per node, each pod being responsible for proxying everything coming to the host\u0026rsquo;s 80 and 443 ports to Traefik (see description of the network flow below).\u003c/p\u003e\n\u003cp\u003eLet\u0026rsquo;s make sure ExternalDNS uses the correct IPs:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ek -n external-dns logs -l app.kubernetes.io/name\u003cspan class=\"o\"\u003e=\u003c/span\u003eexternal-dns -f\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2020-01-18T17:26:31Z\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003elevel\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003edebug \u003cspan class=\"nv\"\u003emsg\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Endpoints generated from ingress: traefik/traefik-dashboard: [traefik.kube.maelvls.dev 0 IN A  35.211.248.124 [] traefik.kube.maelvls.dev 0 IN A  35.211.248.124 []]\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThere still is a slight issue here: we would expect ExternalDNS to set a \u003ccode\u003eA\u003c/code\u003e record with both IPs (35.211.248.124 and 35.231.10.40). But for some reason, it doesn\u0026rsquo;t. As we have seen previously, the Akrobateo controller has successfully updated the traefik/traefik service (type LoadBalancer). And since Traefik is the ingress controller responsible for setting the \u003ccode\u003estatus.loadBalancer.ingress\u003c/code\u003e on ingresses, Traefik is probably the culprit and might simply pick the first element.\u003c/p\u003e\n\u003ch2 id=\"pros-and-cons\"\u003ePros and cons\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eIsn\u0026rsquo;t \u003ccode\u003ehostPort\u003c/code\u003e a bad practice?\u003c/strong\u003e From the \u003ca href=\"https://kubernetes.io/docs/concepts/configuration/overview/#services\"\u003eKubernetes documentation\u003c/a\u003e:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eDon\u0026rsquo;t specify a \u003ccode\u003ehostPort\u003c/code\u003e for a Pod unless it is absolutely necessary. When you bind a Pod to a \u003ccode\u003ehostPort\u003c/code\u003e, it limits the number of places the Pod can be scheduled, because each \u0026lt;\u003ccode\u003ehostIP\u003c/code\u003e, \u003ccode\u003ehostPort\u003c/code\u003e, \u003ccode\u003eprotocol\u003c/code\u003e\u0026gt; combination must be unique.\u003c/p\u003e\n\u003cp\u003e[When using \u003ccode\u003ehostPort\u003c/code\u003e,] if you don\u0026rsquo;t specify the \u003ccode\u003ehostIP\u003c/code\u003e and \u003ccode\u003eprotocol\u003c/code\u003e explicitly, Kubernetes will use \u003ccode\u003e0.0.0.0\u003c/code\u003e as the default \u003ccode\u003ehostIP\u003c/code\u003e and \u003ccode\u003eTCP\u003c/code\u003e as the default \u003ccode\u003eprotocol\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eIf you explicitly need to expose a Pod’s port on the node, consider using a \u003ca href=\"https://kubernetes.io/docs/concepts/services-networking/service/#nodeport\"\u003eNodePort\u003c/a\u003e Service before resorting to \u003ccode\u003ehostPort\u003c/code\u003e.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eI do not fuly grasp what are the implications of using a hostPort. I guess it \u0026ldquo;litters\u0026rdquo; the iptables on the node? I\u0026rsquo;m not sure.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eWhat if I have many more nodes, can it scale?\u003c/strong\u003e I guess it won\u0026rsquo;t. Maybe one idea would be to leader-elect two or three nodes and put only these two or three IPs in \u003ccode\u003estatus.loadbalancer.ingress[]\u003c/code\u003e. If one of the nodes fails, the DNS will be updated; the client will be able to failover using the two or three IPs from the DNS record.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eReliability?\u003c/strong\u003e If the nodes that are advertised in the \u003ccode\u003eA\u003c/code\u003e DNS records go down, no more ingress traffic possible.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eWhat if the node\u0026rsquo;s external-ip changes?\u003c/strong\u003e Since these IPs are ephemeral, the controller will pick up this change and change the \u003ccode\u003estatus.loadBalancer.ingress\u003c/code\u003e field of my \u003ccode\u003etype: LoadBalancer\u003c/code\u003e service.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"how-does-it-work\"\u003eHow does it work?\u003c/h2\u003e\n\u003cp\u003eSince I created a firewall rule for 80 and 443, GCE forwards the traffic from 35.211.248.124 (the node\u0026rsquo;s external-ip) to 10.142.0.62 (the node\u0026rsquo;s internal-ip). And since we use \u003ccode\u003ehostPort\u003c/code\u003e, kubelet creates some iptable rules that redirect traffic to the pod running on that node:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud compute ssh gke-august-period-234610-worker-micro-cf12d79d-klh6 --command\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;sudo iptables-save\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e egrep \u003cspan class=\"s2\"\u003e\u0026#34;(HOSTPORT|HP)\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A PREROUTING -m comment --comment \u003cspan class=\"s2\"\u003e\u0026#34;kube hostport portals\u0026#34;\u003c/span\u003e -m addrtype --dst-type LOCAL -j KUBE-HOSTPORTS\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A OUTPUT -m comment --comment \u003cspan class=\"s2\"\u003e\u0026#34;kube hostport portals\u0026#34;\u003c/span\u003e -m addrtype --dst-type LOCAL -j KUBE-HOSTPORTS\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A PREROUTING -m comment --comment \u003cspan class=\"s2\"\u003e\u0026#34;kube hostport portals\u0026#34;\u003c/span\u003e -m addrtype --dst-type LOCAL -j KUBE-HOSTPORTS\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# If the packet destination is local (localhost or 127.*), continue with KUBE-HOSTPORTS.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A KUBE-HOSTPORTS -p tcp -m comment --comment \u003cspan class=\"s2\"\u003e\u0026#34;akrobateo-traefik-4jh5k_traefik hostport 443\u0026#34;\u003c/span\u003e -m tcp --dport \u003cspan class=\"m\"\u003e443\u003c/span\u003e -j KUBE-HP-A7HWACIJNU4N3R5W\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# If it is a TCP packet and the destication port is 443, continue with KUBE-HP-A7HWACIJNU4N3R5W\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A KUBE-HP-A7HWACIJNU4N3R5W -s 10.24.4.2/32 -m comment --comment \u003cspan class=\"s2\"\u003e\u0026#34;akrobateo-traefik-4jh5k_traefik hostport 443\u0026#34;\u003c/span\u003e -j KUBE-MARK-MASQ\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# If the source IP of the packet is the akrobateo proxy pod, this packet is egressing: continue with KUBE-MARK-MASQ (masquarade)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A KUBE-HP-A7HWACIJNU4N3R5W -p tcp -m comment --comment \u003cspan class=\"s2\"\u003e\u0026#34;akrobateo-traefik-4jh5k_traefik hostport 443\u0026#34;\u003c/span\u003e -m tcp -j DNAT --to-destination 10.24.4.2:443\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# If the source wasnt this pod, then we assume it is some ingress. We replace the destination with the pods ClusterIP.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThen, when it is in the pod, the pod\u0026rsquo;s iptables will kick in and redirect. Nothing is actually running in the pod, except for the namespaced network stack. These pods have:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ean init container that runs \u003ccode\u003esysctl -w net.ipv4.ip_forward=1\u003c/code\u003e (see \u003ca href=\"https://kubernetes.io/docs/concepts/cluster-administration/networking/#google-compute-engine-gce\"\u003ek8s-networking-gce\u003c/a\u003e) in privileged mode, which enables forwarding inside the pod (does not affect the host).\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etwo containers set iptables and then \u003ccode\u003epause\u003c/code\u003e. In order to alter its namespaced TCP stack, we give the containers the NET_ADMIN capability (these rules only affect the pod, not the host).\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -t nat -I PREROUTING ! -s 10.27.244.111/32 -p TCP --dport \u003cspan class=\"m\"\u003e80\u003c/span\u003e -j DNAT --to 10.27.244.111:80\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -t nat -I POSTROUTING -d 10.27.244.111/32 -p TCP -j MASQUERADE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -t nat -I PREROUTING ! -s 10.27.244.111/32 -p TCP --dport \u003cspan class=\"m\"\u003e443\u003c/span\u003e -j DNAT --to 10.27.244.111:443\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables -t nat -I POSTROUTING -d 10.27.244.111/32 -p TCP -j MASQUERADE\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eHere is a diagram that shows the whole picture:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"packet-routing-with-akrobateo.png\" alt=\"Packet routing using Akrobateo, Traefik and iptables\"\u003e\u003c/p\u003e\n\u003ch2 id=\"akrobateo-vs-k3ss-servicelb-controller\"\u003eAkrobateo vs. K3s\u0026rsquo;s servicelb controller\u003c/h2\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/rancher/k3s\"\u003eK3s\u003c/a\u003e has this same idea of \u0026ldquo;service type loadbalancer controller\u0026rdquo; embedded to K3s itself. The controller, called \u0026ldquo;servicelb\u0026rdquo; (\u003ca href=\"https://github.com/rancher/k3s/blob/master/pkg/servicelb/controller.go\"\u003eservicelb/controller.go\u003c/a\u003e) runs as a Deployment and a DeamonSet running \u003ca href=\"https://github.com/rancher/klipper-lb\"\u003eklipper-lb\u003c/a\u003e that uses pod\u0026rsquo;s \u003ccode\u003ehostPort\u003c/code\u003e and the pod\u0026rsquo;s iptables to forward traffic to the cluster-ip of the service. I don\u0026rsquo;t know yet what are the differences between Akrobateo and K3s\u0026rsquo; servicelb. Note that Akrobateo itself is based on servicelb.\u003c/p\u003e\n\u003ch2 id=\"recap\"\u003eRecap\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eAkrobateo is a controller that watches Services of \u003ccode\u003etype: LoadBalancer\u003c/code\u003e;\u003c/li\u003e\n\u003cli\u003eWhen it finds one, creates a deamonset of empty pods.\u003c/li\u003e\n\u003cli\u003eThe task of these empty pods is to set one iptable rule that redirects traffic to the ClusterIP of the \u003ccode\u003etype: LoadBalancer\u003c/code\u003e service.\u003c/li\u003e\n\u003cli\u003eAkrobateo also sets the Service\u0026rsquo;s status with the loadBalancer IP.\u003c/li\u003e\n\u003cli\u003eBenefit: since the loadBalancer IP is properly set, ExternalDNS works!\u003c/li\u003e\n\u003c/ul\u003e\n\u003c!--\nWant to drop a comment? Here is a Twitter thread:\n\n\u003cblockquote class=\"twitter-tweet\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eGKE is great and everything but the default €17 load balancer is just too much for my \u0026quot;playground\u0026quot; cluster.\u003cbr\u003e\u003cbr\u003eHere is how I avoid it by using a custom loadbalancer controller \u003cbr\u003e (kontena/akrobateo) with ExternalDNS and Traefik:\u003ca href=\"https://t.co/8TjrrUi4Sg\"\u003ehttps://t.co/8TjrrUi4Sg\u003c/a\u003e\u003c/p\u003e\u0026mdash; Maël Valais (@maelvls) \u003ca href=\"https://twitter.com/maelvls/status/1219193625478881285?ref_src=twsrc%5Etfw\"\u003eJanuary 20, 2020\u003c/a\u003e\u003c/blockquote\u003e\n\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\n\n--\u003e\n\u003c!--\n## Metallb vs. K3s' servicelb vs. akrobateo\n\n- metallb = vrrp + arp (l2), see \"[MetalLB Layer 2 concepts](https://metallb.universe.tf/concepts/layer2/)\"\n\nARP =\nNDP =\n\nMetalLB implements something close to VRRP.\n\n--\u003e\n\u003cp\u003e\u003cstrong\u003eUpdate 22 April 2020:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAkrobateo \u003ca href=\"https://twitter.com/i/status/1219193625478881285\"\u003eis EOL\u003c/a\u003e since January 2020 😢 I added a note about that.\u003c/li\u003e\n\u003cli\u003eBetter introduction.\u003c/li\u003e\n\u003cli\u003eExplain what I mean by \u003ccode\u003ehostPort\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eIn \u0026ldquo;Isn\u0026rsquo;t \u003ccode\u003ehostPort\u003c/code\u003e a bad practice?\u0026rdquo;, I replaced \u0026ldquo;I don\u0026rsquo;t know\u0026rdquo; with a \u003ca href=\"https://kubernetes.io/docs/concepts/configuration/overview/#services\"\u003elink\u003c/a\u003e to the Kubernetes documentation that mention why I should avoid hostPort.\u003c/li\u003e\n\u003cli\u003eIn \u0026ldquo;What if I have many more nodes, can it scale?\u0026rdquo;, I replaced \u0026ldquo;I don\u0026rsquo;t know\u0026rdquo; with a proposition of solution.\u003c/li\u003e\n\u003cli\u003eDetail how K3s\u0026rsquo; servicelb is similar to Akrobateo.\u003c/li\u003e\n\u003c/ul\u003e\n","date":1579478400,"description":"I want to avoid using the expensive Google Network Load Balancer and instead do the load balancing in-cluster using akrobateo, which acts as a LoadBalancer controller.","dir":"2020/avoid-gke-lb-using-hostport/","expirydate":-62135596800,"fuzzywordcount":2000,"images":["avoid-gke-lb-with-hostport/cover-external-dns.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1579478400,"objectID":"766db7c63735883bace9bdcba2b5030e","permalink":"https://maelvls.dev/do-not-share-yet/avoid-gke-lb-with-hostport/","publishdate":"2020-01-20T00:00:00Z","readingtime":9,"relpermalink":"/do-not-share-yet/avoid-gke-lb-with-hostport/","section":"2020","summary":"\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e⚠️ Update 25 April 2020\u003c/strong\u003e: Akrobateo has been EOL in January 2020 due to the company going out of business. Their blog post regarding the EOL isn\u0026rsquo;t available anymore and was probably shut down. Fortunately, the Wayback Machine \u003ca href=\"https://web.archive.org/web/20200107111252/https://blog.kontena.io/farewell/\"\u003ehas a snapshot of the post\u003c/a\u003e (7th January 2020). Here is an excerpt:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThis is a sad day for team Kontena. We tried to build something amazing but our plans of creating business around open source software has failed. We couldn\u0026rsquo;t build a sustainable business. Despite all the effort, highs and lows, as of today, Kontena has ceased operations. The team is no more and the official support for Kontena products is no more available.\u003c/p\u003e","tags":["kubernetes","networking"],"title":"Avoid GKE's expensive load balancer by using hostPort","type":"2020","url":"https://maelvls.dev/do-not-share-yet/avoid-gke-lb-with-hostport/","weight":0,"wordcount":1917},{"authors":null,"categories":null,"content":"\u003cdiv class=\"nohighlight\"\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  ROLE OF THE CERTIFICATE AUTHORITY\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      +------------------------------+  +-----------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     CERTIFICATE AUTHORITY (NOT A CERT) |     CA KEY      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|  |+---------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      || O=GlobalSign,CN=GlobalSign ||  || private key   ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|  |+-------|-------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|  +--------|--------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      ||   public key (= VERIFY)    ||           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      +------------------------------+           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e CA cert\u0026#39;s pub key = signature                   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e -----------------------------------------------------------\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e Signed cert\u0026#39;s pub key = encryption              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      +------------------------------+           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |         CERTIFICATE          |           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |1----------------------------+|           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      ||O=Google LLC,CN=*.google.com||           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|           |signs using\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |2----------------------------+|           |private key\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      ||   public key (= DECRYPT)   ||           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      ||      signature of 1+2      ||\u0026lt;----------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   ROLE OF THE END-USER               +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      |   CA CERTIFICATE (trusted)   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Can I trust foo.google.com?       |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                     || O=GlobalSign,CN=GlobalSign ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                     |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                     |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  +-----------------\u0026gt;||    public key (= VERIFY)   ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |check signature   (this cert is secure on my disk)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |using public key\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            (1) |  |(2)               +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  |    CERTIFICATE (untrusted)   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         verify |  |                  |1----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      signature |  |                  ||O=Google LLC,CN=*.google.com||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  |2----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  ||   public key (= ENCRYPT)   ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  +------------------|+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                     |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                +--------------------\u0026gt;||      signature of 1+2      ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      (this cert is sent to me by the\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                foo.google.com server)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c!--\nhttps://textik.com/#d85b4624473ca862\n--\u003e\n\u003ch2 id=\"whats-a-certificate-in-the-openssl-jargon\"\u003eWhat\u0026rsquo;s a \u0026ldquo;certificate\u0026rdquo; in the openssl jargon\u003c/h2\u003e\n\u003cp\u003eFor example, mitmproxy relies on a specific dir structure and filenames:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/Users/mvalais/.mitmproxy\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e├── mitmproxy-ca-cert.pem            \u003cspan class=\"c1\"\u003e# ca-cert = cert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e└── mitmproxy-ca.pem                 \u003cspan class=\"c1\"\u003e# ca      = cert + key\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThat\u0026rsquo;s the kind of directory structure that \u003ccode\u003e--set client_dir=...\u003c/code\u003e would expect (in mitmproxy).\u003c/p\u003e\n\u003ch2 id=\"using-openssl-to-dig-certificates\"\u003eUsing \u003ccode\u003eopenssl\u003c/code\u003e to dig certificates\u003c/h2\u003e\n\u003cp\u003eThis \u003ca href=\"https://www.sslshopper.com/article-most-common-openssl-commands.html\"\u003echeat sheet\u003c/a\u003e is nice. Here is a one-liner for fetching the certificate chain sitting on a server; for example for \u003ccode\u003eapi.github.com:443\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% openssl x509 -in \u0026lt;\u003cspan class=\"o\"\u003e(\u003c/span\u003eopenssl s_client -connect api.github.com:443 -prexit \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e)\u003c/span\u003e -noout -text\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eopenssldepth\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"nv\"\u003eC\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e US, \u003cspan class=\"nv\"\u003eO\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e DigiCert Inc, \u003cspan class=\"nv\"\u003eOU\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e www.digicert.com, \u003cspan class=\"nv\"\u003eCN\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e DigiCert High Assurance EV Root CA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003everify \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e:1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003edepth\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"nv\"\u003eC\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e US, \u003cspan class=\"nv\"\u003eO\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e DigiCert Inc, \u003cspan class=\"nv\"\u003eOU\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e www.digicert.com, \u003cspan class=\"nv\"\u003eCN\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e DigiCert SHA2 High Assurance Server CA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003everify \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e:1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003edepth\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"nv\"\u003eC\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e US, \u003cspan class=\"nv\"\u003eST\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e California, \u003cspan class=\"nv\"\u003eL\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e San Francisco, \u003cspan class=\"nv\"\u003eO\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;GitHub, Inc.\u0026#34;\u003c/span\u003e, \u003cspan class=\"nv\"\u003eCN\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e *.github.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003everify \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e:1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eDONE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eCertificate:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Data:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        Version: \u003cspan class=\"m\"\u003e3\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e0x2\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        Serial Number:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            0c:07:3b:67:6f:67:45:78:f9:99:81:48:52:84:46:51\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Signature Algorithm: sha256WithRSAEncryption\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        Issuer: \u003cspan class=\"nv\"\u003eC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eUS, \u003cspan class=\"nv\"\u003eO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDigiCert Inc, \u003cspan class=\"nv\"\u003eOU\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ewww.digicert.com, \u003cspan class=\"nv\"\u003eCN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDigiCert SHA2 High Assurance Server CA\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        Validity\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            Not Before: Jun \u003cspan class=\"m\"\u003e22\u003c/span\u003e 00:00:00 \u003cspan class=\"m\"\u003e2020\u003c/span\u003e GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            Not After : Aug \u003cspan class=\"m\"\u003e17\u003c/span\u003e 12:00:00 \u003cspan class=\"m\"\u003e2022\u003c/span\u003e GMT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        Subject: \u003cspan class=\"nv\"\u003eC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eUS, \u003cspan class=\"nv\"\u003eST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eCalifornia, \u003cspan class=\"nv\"\u003eL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eSan Francisco, \u003cspan class=\"nv\"\u003eO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eGitHub, Inc., \u003cspan class=\"nv\"\u003eCN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e*.github.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        Subject Public Key Info:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            Public Key Algorithm: rsaEncryption\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                Public-Key: \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e2048\u003c/span\u003e bit\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                Modulus:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    00:a0:e6:d3:87:ac:6f:4e:3b:29:75:60:4c:4a:1e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    fa:dd:af:81:0a:37:c4:89:ad:b5:8e:9d:1d:0c:55:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    da:a4:b1:cb:ab:d3:14:bc:d2:6d:b8:d1:7c:36:1f:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    45:a1:06:25:32:63:7f:94:4c:f4:d6:97:06:3f:24:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    f2:85:f5:83:8c:27:8a:7f:6a:c8:46:e8:04:6f:4c:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    5f:4c:48:9a:a6:80:c1:08:db:9c:6e:81:8b:54:59:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    f0:c6:6d:58:2a:3d:42:ea:da:5d:aa:6b:90:7b:af:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    12:34:30:1b:22:5c:af:cd:ee:f2:3c:08:90:99:91:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    be:41:16:c6:e0:95:59:a9:d6:52:39:de:e9:a3:02:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    e2:68:e3:f9:b5:56:ce:ae:62:27:5e:ff:a3:94:1f:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    89:82:0f:5d:ea:82:4d:af:de:0f:3b:aa:04:4a:6f:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    a4:85:43:80:11:35:f1:3b:d6:66:80:68:97:6e:0a:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    e9:79:57:63:44:91:c1:e2:45:db:dd:2c:b9:2d:3d:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    16:76:af:0b:a4:04:80:c0:10:35:26:f2:9f:38:43:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    a8:1d:a5:19:79:f0:b0:60:98:40:f8:4c:54:53:5f:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    32:0e:de:86:65:e7:4f:5c:21:7a:c7:35:7f:de:a3:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    e0:8e:b2:d3:02:42:64:40:14:21:20:96:14:09:54:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    1f:53\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                Exponent: \u003cspan class=\"m\"\u003e65537\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003e0x10001\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        X509v3 extensions:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            X509v3 Authority Key Identifier:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                keyid:51:68:FF:90:AF:02:07:75:3C:CC:D9:65:64:62:A2:12:B8:59:72:3B\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            X509v3 Subject Key Identifier:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                79:53:13:17:53:DA:1E:A9:73:A9:9E:88:8D:C2:53:D9:36:E2:E5:2A\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            X509v3 Subject Alternative Name:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                DNS:*.github.com, DNS:github.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            X509v3 Key Usage: critical\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                Digital Signature, Key Encipherment\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            X509v3 Extended Key Usage:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                TLS Web Server Authentication, TLS Web Client Authentication\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            X509v3 CRL Distribution Points:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                Full Name:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                  URI:http://crl3.digicert.com/sha2-ha-server-g6.crl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                Full Name:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                  URI:http://crl4.digicert.com/sha2-ha-server-g6.crl\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            X509v3 Certificate Policies:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                Policy: 2.16.840.1.114412.1.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                  CPS: https://www.digicert.com/CPS\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                Policy: 2.23.140.1.2.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            Authority Information Access:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                OCSP - URI:http://ocsp.digicert.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                CA Issuers - URI:http://cacerts.digicert.com/DigiCertSHA2HighAssuranceServerCA.crt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            X509v3 Basic Constraints: critical\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                CA:FALSE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            1.3.6.1.4.1.11129.2.4.2:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                ...g.e.u.\u003cspan class=\"o\"\u003e)\u003c/span\u003ey...99!.Vs.c.w..W\u003cspan class=\"o\"\u003e}\u003c/span\u003e.\u003cspan class=\"sb\"\u003e`\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e..M\u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"se\"\u003e\\%\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e.....r..*......F0D. f........\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e,cj...\u003cspan class=\"s2\"\u003e\u0026#34;~........M,..... U+.zza....WN9.V...A;U..?k.e%._.`.u.A....\u0026#34;\u003c/span\u003eFJ...:.B.^N1.....K.h..b......r..*......F0D. w.jXF...7K..v. %.A...\u003cspan class=\"p\"\u003e;\u003c/span\u003e,.E.o\u003cspan class=\"o\"\u003e}\u003c/span\u003eJN... 39..W..Z..Ff\u003cspan class=\"p\"\u003e;\u003c/span\u003e.0.....u SZ\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e..\u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e. ...u.F.U.u.. 0...i..\u003cspan class=\"o\"\u003e}\u003c/span\u003e.,At..I.....p.mG...r..+6.....F0D. \u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003e....................O....Dmcpu@. A?W...o.d..o.!..e*....C\u003cspan class=\"o\"\u003e(\u003c/span\u003e%......c\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Signature Algorithm: sha256WithRSAEncryption\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         4e:0c:e9:56:59:75:8a:8c:af:75:d9:0e:57:58:fc:c0:8d:d9:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         35:67:84:61:a9:2c:0b:aa:ff:a6:62:31:31:53:6c:d6:50:44:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         1d:7e:0a:11:ec:40:00:d9:f4:d2:e0:f7:a3:f7:32:91:1b:ac:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         d0:4c:01:1e:03:f8:19:8b:1e:79:33:dd:38:c6:a7:f4:4b:3b:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         e9:31:11:b9:c6:a7:63:40:d6:02:2b:43:59:bb:98:4f:08:24:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         78:a0:67:1d:0e:35:bb:40:82:85:e0:d5:7e:76:7e:e4:94:d3:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         4e:a6:d1:31:c0:41:d2:b0:9a:b7:77:c9:36:b9:31:69:95:87:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         b0:50:d9:ef:e5:37:80:a9:f2:dc:0d:a0:82:c8:56:2e:af:85:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         1b:ef:0d:c2:eb:1c:33:d5:76:ae:cb:9d:f1:6e:b4:00:85:75:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         e2:b9:4c:3b:7f:16:41:47:a9:53:b0:c4:b1:7a:44:da:f6:5b:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         84:45:29:13:37:c3:aa:30:98:d2:67:8f:fb:1a:be:94:06:0e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         b9:cf:e6:fc:5f:fc:e2:f1:1b:32:6a:8e:c2:16:a7:cd:45:c1:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         fe:75:8b:02:b2:f0:d9:3b:5d:7c:1b:a8:45:b8:b1:4d:d8:3c:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         66:2b:2b:33:1e:9f:dc:b8:5e:3b:fe:0a:e4:b2:5b:eb:41:48:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         59:10:6b:63\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"fun-things-about-x509\"\u003eFun things about X.509\u003c/h2\u003e\n\u003cp\u003eIn \u003ca href=\"https://github.com/golang/go/blob/e6ac2df2/src/crypto/x509/verify.go#L700-L715\"\u003ecrypto/x509/verify.go\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// KeyUsage status flags are ignored. From Engineering Security, Peter\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Gutmann: A European government CA marked its signing certificates as\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// being valid for encryption only, but no-one noticed. Another\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// European CA marked its signature keys as not being valid for\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// signatures. A different CA marked its own trusted root certificate\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// as being invalid for certificate signing. Another national CA\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// distributed a certificate to be used to encrypt data for the\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// country’s tax authority that was marked as only being usable for\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// digital signatures but not for encryption. Yet another CA reversed\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// the order of the bit flags in the keyUsage due to confusion over\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// encoding endianness, essentially setting a random keyUsage in\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// certificates that it issued. Another CA created a self-invalidating\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// certificate by adding a certificate policy statement stipulating\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// that the certificate had to be used strictly as specified in the\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// keyUsage, and a keyUsage containing a flag indicating that the RSA\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// encryption key could only be used for Diffie-Hellman key agreement.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"encoding-vs-format\"\u003eEncoding vs. format\u003c/h2\u003e\n\u003cp\u003eSource: \u003ca href=\"https://github.com/jetstack/cert-manager/issues/843#issuecomment-566054175\"\u003eJames Roper, 2019\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThere are multiple axes of encodings standards, there\u0026rsquo;s PEM and DER, and there\u0026rsquo;s\nPKCS*. So you can have PEM encoded PKCS1, DER encoded PKCS8, PEM encoded PKCS8\netc. PKCS* is more commonly referred to as the format (in some places its called\nthe syntax), while PEM and DER are the ascii and binary encodings of whichever\nformat you\u0026rsquo;ve chosen, and so are more commonly referred to as the encoding. That\nsaid, openssl just calls them all formats. It\u0026rsquo;s really a mess.\u003c/p\u003e\n\u003cp\u003eDER = pure ASN.1, which is a binary format.\nPEM = ASN.1 base64-encoded.\u003c/p\u003e\n","date":1579478400,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":900,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1579478400,"objectID":"13e2daa957e78da454740b10126948f5","permalink":"https://maelvls.dev/do-not-share-yet/notes/tls/","publishdate":"2020-01-20T00:00:00Z","readingtime":4,"relpermalink":"/do-not-share-yet/notes/tls/","section":"notes","summary":"\u003cdiv class=\"nohighlight\"\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  ROLE OF THE CERTIFICATE AUTHORITY\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      +------------------------------+  +-----------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     CERTIFICATE AUTHORITY (NOT A CERT) |     CA KEY      |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|  |+---------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      || O=GlobalSign,CN=GlobalSign ||  || private key   ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|  |+-------|-------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|  +--------|--------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      ||   public key (= VERIFY)    ||           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      +------------------------------+           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e CA cert\u0026#39;s pub key = signature                   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e -----------------------------------------------------------\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e Signed cert\u0026#39;s pub key = encryption              |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                 |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      +------------------------------+           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |         CERTIFICATE          |           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |1----------------------------+|           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      ||O=Google LLC,CN=*.google.com||           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|           |signs using\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |2----------------------------+|           |private key\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      ||   public key (= DECRYPT)   ||           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      ||      signature of 1+2      ||\u0026lt;----------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   ROLE OF THE END-USER               +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      |   CA CERTIFICATE (trusted)   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    Can I trust foo.google.com?       |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                     || O=GlobalSign,CN=GlobalSign ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                     |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                     |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  +-----------------\u0026gt;||    public key (= VERIFY)   ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |check signature   (this cert is secure on my disk)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |using public key\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            (1) |  |(2)               +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  |    CERTIFICATE (untrusted)   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e         verify |  |                  |1----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e      signature |  |                  ||O=Google LLC,CN=*.google.com||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  |2----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  |                  ||   public key (= ENCRYPT)   ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |  +------------------|+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                |                     |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                +--------------------\u0026gt;||      signature of 1+2      ||\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      |+----------------------------+|\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      +------------------------------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                      (this cert is sent to me by the\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                                foo.google.com server)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\u003c!--\nhttps://textik.com/#d85b4624473ca862\n--\u003e\n\u003ch2 id=\"whats-a-certificate-in-the-openssl-jargon\"\u003eWhat\u0026rsquo;s a \u0026ldquo;certificate\u0026rdquo; in the openssl jargon\u003c/h2\u003e\n\u003cp\u003eFor example, mitmproxy relies on a specific dir structure and filenames:\u003c/p\u003e","tags":[],"title":"Nice diagram about TLS, certificates and keys","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/tls/","weight":0,"wordcount":815},{"authors":null,"categories":null,"content":"","date":1578268800,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1578268800,"objectID":"https://maelvls.dev/do-not-share-yet/tags/proxyman/","permalink":"https://maelvls.dev/do-not-share-yet/tags/proxyman/","publishdate":"2020-01-06T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/tags/proxyman/","section":"tags","summary":"","tags":null,"title":"Proxyman","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/proxyman/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eI use \u003ca href=\"https://proxyman.io\"\u003eProxyman\u003c/a\u003e for inspecting the HTTP and HTTPS traffic coming from applications. For example, you may want to know which API calls are made by \u003ccode\u003edocker\u003c/code\u003e when running \u003ccode\u003edocker search\u003c/code\u003e. What I would do is\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eHTTPS_PROXY\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttp://localhost:9090 docker search ubuntu\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSince Proxyman acts like a proxy listening on 0.0.0.0:9090, I can see and replay all the HTTP calls, similarly to what you would do with the Chrome DevTools.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"proxyman.png\" alt=\"Screenshot with macOS\u0026rsquo; Proxyman for a local Openstack instance\"\u003e\u003c/p\u003e\n\u003cp\u003eNote that HTTPS is a bit tricky and requires an additional step on macOS (settings \u0026gt; Proxyman CA \u0026gt; Generate new) but works flawlessly with any Go binary since Go supports \u003ccode\u003eHTTPS_PROXY\u003c/code\u003e by default. For Python, it becomes a bit trickier often requires the app to have a flag like \u003ccode\u003e--cacert\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eBut by default, Go [ignores \u003ccode\u003eHTTPS_PROXY\u003c/code\u003e] for \u003ccode\u003elocalhost\u003c/code\u003e and \u003ccode\u003e127.0.0.1\u003c/code\u003e hosts (see \u003ca href=\"https://godoc.org/golang.org/x/net/http/httpproxy#Config.ProxyFunc\"\u003eProxyFunc\u003c/a\u003e and \u003ca href=\"https://github.com/golang/net/blob/c0dbc17a35534bf2e581d7a942408dc936316da4/http/httpproxy/proxy.go#L172-L191\"\u003euseProxy\u003c/a\u003e):\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAs a special case, if req.URL.Host is \u0026ldquo;localhost\u0026rdquo; (with or without a port number), then a nil URL and nil error will be returned.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eNote that the documentation forgets to mention that \u003ccode\u003e127.0.0.1\u003c/code\u003e (and related) are also ignored. That\u0026rsquo;s a bummer since using a proxy may be the only way to debug a CLI or an application that makes network calls without logging properly.\u003c/p\u003e\n\u003cp\u003eTwo solutions: either you have access (and are willing to) hack the source code in order to force Go to use the proxy with \u003ccode\u003elocalhost\u003c/code\u003e anyway, or you can hack your \u003ccode\u003e/etc/hosts\u003c/code\u003e and use a different host.\u003c/p\u003e\n\u003ch2 id=\"solution-1-hack-the-proxy-setup-by-tweaking-httptransport\"\u003eSolution 1: hack the proxy setup by tweaking \u003ccode\u003ehttp.Transport\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eYou need to have access to the place where the \u003ccode\u003ehttp.Client\u003c/code\u003e is set. Imagine that you are working on something that uses the Openstack API. You would have something like:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e \u003cspan class=\"nx\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;os\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;github.com/gophercloud/gophercloud\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;github.com/gophercloud/gophercloud/openstack\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;github.com/gophercloud/gophercloud/openstack/compute/v2/servers\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003epr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eopenstack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://localhost/identity/v3\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eStderr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;could not create an openstack client\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eopenstack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAuthenticate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003egophercloud\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAuthOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eIdentityEndpoint\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;http://localhost/identity/v3\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eDomainName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"s\"\u003e\u0026#34;Default\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eUsername\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e         \u003cspan class=\"s\"\u003e\u0026#34;admin\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003ePassword\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e         \u003cspan class=\"s\"\u003e\u0026#34;secret\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eTenantName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"s\"\u003e\u0026#34;admin\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eStderr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;auth failed\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ecompute\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eopenstack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewComputeV2\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003egophercloud\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eEndpointOpts\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eRegion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003esrvs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eservers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecompute\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eAllPages\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eStderr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;%v\\n\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;servers:\\n%v\\n\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003esrvs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe must be able to swap the \u003ccode\u003ehttp.Transport\u003c/code\u003e used. The \u003ca href=\"https://golang.org/src/net/http/transport.go#L42\"\u003e\u003ccode\u003ehttp.DefaultTransport\u003c/code\u003e\u003c/a\u003e uses \u003ccode\u003eProxyFromEnvironment\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// DefaultTransport is the default implementation of Transport and is\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// used by DefaultClient. It establishes network connections as needed\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// and caches them for reuse by subsequent calls. It uses HTTP proxies\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// as directed by the $HTTP_PROXY and $NO_PROXY (or $http_proxy and\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// $no_proxy) environment variables.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eDefaultTransport\u003c/span\u003e \u003cspan class=\"nx\"\u003eRoundTripper\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003eTransport\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eProxy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003eProxyFromEnvironment\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eDialContext\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003enet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eDialer\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e   \u003cspan class=\"mi\"\u003e30\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eKeepAlive\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e30\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eDualStack\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}).\u003c/span\u003e\u003cspan class=\"nx\"\u003eDialContext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eForceAttemptHTTP2\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e     \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eMaxIdleConns\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e          \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eIdleConnTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"mi\"\u003e90\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eTLSHandshakeTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e   \u003cspan class=\"mi\"\u003e10\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eExpectContinueTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLet\u0026rsquo;s change \u003ccode\u003eProxyFromEnvironment\u003c/code\u003e with something of our own:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003eProxy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eURL\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://127.0.0.1:9090\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, the code looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003epackage\u003c/span\u003e \u003cspan class=\"nx\"\u003emain\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;fmt\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;net\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;net/http\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;net/url\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;os\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;time\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;github.com/gophercloud/gophercloud\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;github.com/gophercloud/gophercloud/openstack\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"s\"\u003e\u0026#34;github.com/gophercloud/gophercloud/openstack/compute/v2/servers\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"nf\"\u003emain\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003epr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eopenstack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewClient\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://localhost/identity/v3\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eStderr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;could not create an openstack client\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003epr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eHTTPClient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eTransport\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eTransport\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eProxy\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kd\"\u003efunc\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ereq\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003ehttp\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eRequest\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eURL\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003eurl\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eParse\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://127.0.0.1:9090\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"p\"\u003e},\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eDialContext\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003enet\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eDialer\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"nx\"\u003eTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e   \u003cspan class=\"mi\"\u003e30\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"nx\"\u003eKeepAlive\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e30\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\t\u003cspan class=\"nx\"\u003eDualStack\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"p\"\u003e}).\u003c/span\u003e\u003cspan class=\"nx\"\u003eDialContext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eForceAttemptHTTP2\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e     \u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eMaxIdleConns\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e          \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eIdleConnTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"mi\"\u003e90\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eTLSHandshakeTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e   \u003cspan class=\"mi\"\u003e10\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eExpectContinueTimeout\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nx\"\u003etime\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSecond\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003eopenstack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eAuthenticate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003egophercloud\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eAuthOptions\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eIdentityEndpoint\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;http://localhost/identity/v3\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eDomainName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"s\"\u003e\u0026#34;Default\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eUsername\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e         \u003cspan class=\"s\"\u003e\u0026#34;admin\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003ePassword\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e         \u003cspan class=\"s\"\u003e\u0026#34;secret\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eTenantName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e       \u003cspan class=\"s\"\u003e\u0026#34;admin\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eStderr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;auth failed\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003ecompute\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eopenstack\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eNewComputeV2\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003egophercloud\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eEndpointOpts\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eRegion\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003esrvs\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eservers\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eList\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ecompute\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"nf\"\u003eAllPages\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eStderr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;%v\\n\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\t\u003cspan class=\"nx\"\u003eos\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eExit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePrintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;servers:\\n%v\\n\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003esrvs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, all traffic including calls to \u003ccode\u003eHost: localhost\u003c/code\u003e or \u003ccode\u003eHost: 127.0.0.1\u003c/code\u003e will be properly proxied to \u003ccode\u003elocalhost:9090\u003c/code\u003e.\u003c/p\u003e\n\u003ch2 id=\"solution-2-use-a-different-host-name\"\u003eSolution 2: use a different host name\u003c/h2\u003e\n\u003cp\u003eIn your \u003ccode\u003e/etc/hosts\u003c/code\u003e, add the line such as \u003ccode\u003elocal 127.0.0.1\u003c/code\u003e. Now, you can use the host \u003ccode\u003elocal\u003c/code\u003e instead of \u003ccode\u003elocalhost\u003c/code\u003e, which means Go will proxy your requests properly.\u003c/p\u003e\n\u003c!--\nJoin the discussion [on\nTwitter](https://twitter.com/maelvls/status/1214242197119406080) or post a\nmessage here\n--\u003e\n","date":1578268800,"description":"At some point, the Go team chose to disable the proxy for requests coming from localhost or 127.0.0.1. This is annoying when debugging services locally.","dir":"2020/go-proxy-localhost-ignored/","expirydate":-62135596800,"fuzzywordcount":700,"images":["go-ignores-proxy-localhost/cover-go-proxy-ignored.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1578268800,"objectID":"c8d5bca6870aa365b80f0b1a357e5ae9","permalink":"https://maelvls.dev/do-not-share-yet/go-ignores-proxy-localhost/","publishdate":"2020-01-06T00:00:00Z","readingtime":4,"relpermalink":"/do-not-share-yet/go-ignores-proxy-localhost/","section":"2020","summary":"\u003cp\u003eI use \u003ca href=\"https://proxyman.io\"\u003eProxyman\u003c/a\u003e for inspecting the HTTP and HTTPS traffic coming from applications. For example, you may want to know which API calls are made by \u003ccode\u003edocker\u003c/code\u003e when running \u003ccode\u003edocker search\u003c/code\u003e. What I would do is\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eHTTPS_PROXY\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ehttp://localhost:9090 docker search ubuntu\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSince Proxyman acts like a proxy listening on 0.0.0.0:9090, I can see and replay all the HTTP calls, similarly to what you would do with the Chrome DevTools.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"proxyman.png\" alt=\"Screenshot with macOS\u0026rsquo; Proxyman for a local Openstack instance\"\u003e\u003c/p\u003e","tags":["go","proxyman"],"title":"What to do when Go ignores HTTP_PROXY for 127.0.0.1","type":"2020","url":"https://maelvls.dev/do-not-share-yet/go-ignores-proxy-localhost/","weight":0,"wordcount":653},{"authors":null,"categories":null,"content":"","date":1574467200,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"section","lang":"en","lastmod":1574467200,"objectID":"https://maelvls.dev/do-not-share-yet/2019/","permalink":"https://maelvls.dev/do-not-share-yet/2019/","publishdate":"2019-11-23T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/2019/","section":"2019","summary":"","tags":null,"title":"2019s","type":"2019","url":"https://maelvls.dev/do-not-share-yet/2019/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eReadability is a property we all love about Go. In other languages, it might be fine to have a lot of nested if statements; in Go, it is a good practice to keep away from overly-nested logic. One of the \u003ca href=\"https://www.reddit.com/r/ProgrammerTIL/comments/acweob/go_til_a_new_go_proverb_the_happy_path_is/\"\u003eGo proverbs\u003c/a\u003e says:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe happy path is left-aligned.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eIn this post, I attempt to show through two examples what we mean by \u0026ldquo;left-aligned happy path\u0026rdquo; and what are the benefits in terms of readibility and maintainability.\u003c/p\u003e\n\u003ch2 id=\"simple-example\"\u003eSimple example\u003c/h2\u003e\n\u003cp\u003eLet\u0026rsquo;s see a quick example of what we mean by \u0026ldquo;happy path is left-aligned\u0026rdquo;. The following snippet has two nested ifs. That would be the standard idiom for any language like Java:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eauthorizationHeader\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// nested happy path\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ebearerToken\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// even more nested happy path\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// error handling here\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// error handling here\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe see two things happening here:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003enesting \u003ccode\u003eif\u003c/code\u003es increases the cognitive weight; we have to think in order to understand what the logic does.\u003c/li\u003e\n\u003cli\u003enesting ifs often encourages the use of \u0026ldquo;fallthroughs\u0026rdquo; (reusing the same code path for two different cases). It tends to obfuscate how and where the function fails and returns.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf we move the first \u003ccode\u003eif\u003c/code\u003e to its own \u0026ldquo;guard statement\u0026rdquo;, then we end up with less nesting which translates to code easier to parse (parse as a human):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eauthorizationHeader\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// unhappy path, error handling here\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// happy path always stays (or almost always) unnested\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003ebearerToken\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// unhappy path, error handling here\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNotice how each code path is obvious. Parsing the code is fast and you have less chance of misunderstanding the logic.\u003c/p\u003e\n\u003c!--\n\n## Business logic guards vs. data verification guards\n\nIn the chapter \"[Introducing Guard\nClauses](https://www.pluralsight.com/courses/advanced-defensive-programming-techniques)\"\n(pluralsight course), it says you should fail fast with guard clauses.\nThat's pretty much what the left-aligned happy path idiom does. The author\nadds something interesting: we should avoid mixing the \"business logic\nguards\" with the \"data verification (nil, err...) guards\". It makes sense\nbecause it's easy to mix things and loose where the business logic is.\nFurther on that: [Go Verifier\nlibrary](https://itnext.io/clear-defensive-programming-with-go-using-verifier-library-6f648810b453).\n\n--\u003e\n\u003c!--\n## How does it fit with Defensive programming?\n\ndefensive programming = logic must be nested in ifs so that it is protected and is only run when all if checks are OK\n\nYou can write a program with the \"deeply-nested ifs\" and later change it to\nbe \"left-aligned with guard clauses\". Both ways are very similar, it is\njust a different \"style\".\n\nChanging from one to the other will not make your code \"more defensive\" or\n\"less defensive\" in the sense that these two styles are just styles and do\nnot prescribe a specific way of writing things like the input verification.\n--\u003e\n\u003ch2 id=\"real-example\"\u003eReal example\u003c/h2\u003e\n\u003cp\u003eWhile perusing how other Kubernetes developers are implementing their own reconciliation loop, I came across \u003ca href=\"https://github.com/kubeflow/katib/blob/40f55b41c/pkg/controller.v1alpha3/trial/trial_controller.go#L259-L291\"\u003ean interesting piece of code\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThe author decided to use the \u003ccode\u003eif-else\u003c/code\u003e control flow at its maximum potential: the logic goes as deep as three tabs to the right. We cannot immediately guess which parts are important and which aren\u0026rsquo;t.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eReconcileTrial\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nf\"\u003ereconcileJob\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einstance\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003etrialsv1alpha3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eTrial\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eunstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eUnstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eunstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eUnstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"kt\"\u003eerror\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003elogger\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWithValues\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Trial\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003etypes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNamespacedName\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetName\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nx\"\u003eNamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetNamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e()})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eapiVersion\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAPIVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ekind\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetKind\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003egvk\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromAPIVersionAndKind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003edeployedJob\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003eunstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eUnstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003edeployedJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetGroupVersionKind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003egvk\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTODO\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nx\"\u003etypes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNamespacedName\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetName\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nx\"\u003eNamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetNamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e()},\u003c/span\u003e \u003cspan class=\"nx\"\u003edeployedJob\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerrors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNotFound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsCompleted\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Creating Job\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;kind\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"s\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetName\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTODO\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Create job error\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003eeventMsg\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Job %s has been created\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetName\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erecorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEventf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecorev1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eEventTypeNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eJobCreatedReason\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eeventMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003emsg\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Trial is running\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMarkTrialStatusRunning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eTrialRunningReason\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Trial Get error\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsCompleted\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eRetainRun\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTODO\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePropagationPolicy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003emetav1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eDeletePropagationForeground\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Delete job error\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003eeventMsg\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Job %s has been deleted\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetName\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erecorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEventf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecorev1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eEventTypeNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eJobDeletedReason\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eeventMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003edeployedJob\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe outline of this function doesn\u0026rsquo;t tell us anything about what the flow is and where the important logic is. Having deeply nested \u003ccode\u003eif-else\u003c/code\u003e statements hurt Go\u0026rsquo;s glanceability: where is the \u0026ldquo;happy path\u0026rdquo;? Where are the \u0026ldquo;error paths\u0026rdquo;?\u003c/p\u003e\n\u003cimg src=\"before.png\" width=\"500\"/\u003e\n\u003cp\u003eBy refactoring and removing \u003ccode\u003eelse\u003c/code\u003e statements, we obtain a more coherent aligned-to-the-left path:\u003c/p\u003e\n\u003cimg src=\"after.png\" width=\"500\"/\u003e\n\u003cp\u003eThe green line represents the \u0026ldquo;core logic\u0026rdquo; and is at the minimum indentation level. The red line represents anything out of the ordinary: error handling and guards.\u003c/p\u003e\n\u003cp\u003eAnd since our eyes are very good at following lines, the \u003cem\u003eline of sight\u003c/em\u003e (the green line) guides us and greatly improves the experience of glancing at a piece of code.\u003c/p\u003e\n\u003cp\u003eHere is the actual code I rewrote:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kd\"\u003efunc\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003er\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eReconcileTrial\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"nf\"\u003ereconcileJob\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einstance\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003etrialsv1alpha3\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eTrial\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eunstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eUnstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nx\"\u003eunstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eUnstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kt\"\u003eerror\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kd\"\u003evar\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"kt\"\u003eerror\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003elogger\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eWithValues\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Trial\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003etypes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNamespacedName\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetName\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nx\"\u003eNamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetNamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e()})\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eapiVersion\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetAPIVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003ekind\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetKind\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003egvk\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003eschema\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eFromAPIVersionAndKind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eapiVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003edeployedJob\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"nx\"\u003eunstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eUnstructured\u003c/span\u003e\u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003edeployedJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSetGroupVersionKind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003egvk\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGet\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTODO\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nx\"\u003etypes\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eNamespacedName\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nx\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetName\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nx\"\u003eNamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetNamespace\u003c/span\u003e\u003cspan class=\"p\"\u003e()},\u003c/span\u003e \u003cspan class=\"nx\"\u003edeployedJob\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eswitch\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"nx\"\u003eerrors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNotFound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsCompleted\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// Job deleted and trial completed, nothing left to do.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"nx\"\u003eerrors\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsNotFound\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c1\"\u003e// Job deleted, we must create a job.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eInfo\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Creating Job\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;kind\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetName\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eCreate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTODO\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nx\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Create job error\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eeventMsg\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Job %s has been created\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetName\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erecorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEventf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecorev1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eEventTypeNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eJobCreatedReason\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eeventMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003emsg\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Trial is running\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eMarkTrialStatusRunning\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eTrialRunningReason\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003emsg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ecase\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Trial Get error\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e!\u003c/span\u003e\u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eIsCompleted\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e||\u003c/span\u003e \u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eSpec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eRetainRun\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003eeventMsg\u003c/span\u003e \u003cspan class=\"o\"\u003e:=\u003c/span\u003e \u003cspan class=\"nx\"\u003efmt\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eSprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Job %s has been deleted\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eGetName\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003erecorder\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eEventf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003einstance\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003ecorev1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eEventTypeNormal\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eJobDeletedReason\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eeventMsg\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nx\"\u003er\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eDelete\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eTODO\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"nx\"\u003edesiredJob\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eclient\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003ePropagationPolicy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003emetav1\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eDeletePropagationForeground\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nx\"\u003elogger\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nf\"\u003eError\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Delete job error\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nx\"\u003eerr\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nx\"\u003edeployedJob\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"kc\"\u003enil\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eYou can also take a look at Matt Ryer\u0026rsquo;s \u003cem\u003eIdiomatic Go Tricks\u003c/em\u003e (\u003ca href=\"https://medium.com/@matryer/line-of-sight-in-code-186dd7cdea88\"\u003eblog post\u003c/a\u003e) where he presents some ways of keeping your code as readable as possible:\u003c/p\u003e\n\u003cdiv style=\"position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;\"\u003e\n      \u003ciframe allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen\" loading=\"eager\" referrerpolicy=\"strict-origin-when-cross-origin\" src=\"https://www.youtube.com/embed/yeetIgNeIkc?autoplay=0\u0026amp;controls=1\u0026amp;end=0\u0026amp;loop=0\u0026amp;mute=0\u0026amp;start=0\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;\" title=\"YouTube video\"\u003e\u003c/iframe\u003e\n    \u003c/div\u003e\n\n\u003cp\u003e\u003cstrong\u003eUpdate 23 April 2020:\u003c/strong\u003e added a proper introduction with a simple example.\u003c/p\u003e\n\u003chr\u003e\n\u003c!--\nWish to comment? Here is the Twitter thread for that post:\n\n\u003cblockquote class=\"twitter-tweet\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eMy weekend\u0026#39;s write-up: your Go code wants to be happy: let it be as close to the left as possible! 😄\u003ca href=\"https://t.co/bizd1zouzv\"\u003ehttps://t.co/bizd1zouzv\u003c/a\u003e\u003c/p\u003e\u0026mdash; Maël Valais (@maelvls) \u003ca href=\"https://twitter.com/maelvls/status/1198259761722122240?ref_src=twsrc%5Etfw\"\u003eNovember 23, 2019\u003c/a\u003e\u003c/blockquote\u003e\n\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\n\n--\u003e\n","date":1574467200,"description":"Readability is a property we all love about Go. In other languages, it might be fine to have a lot of nested if statements; in Go, it is a good practice to keep away from overly-nested logic.","dir":"2019/go-happy-line-of-sight/","expirydate":-62135596800,"fuzzywordcount":900,"images":["go-happy-line-of-sight/cover-happy-line-of-sight.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1574467200,"objectID":"b938d053a3ffd72b467c5890eba9ff01","permalink":"https://maelvls.dev/do-not-share-yet/go-happy-line-of-sight/","publishdate":"2019-11-23T00:00:00Z","readingtime":4,"relpermalink":"/do-not-share-yet/go-happy-line-of-sight/","section":"2019","summary":"\u003cp\u003eReadability is a property we all love about Go. In other languages, it might be fine to have a lot of nested if statements; in Go, it is a good practice to keep away from overly-nested logic. One of the \u003ca href=\"https://www.reddit.com/r/ProgrammerTIL/comments/acweob/go_til_a_new_go_proverb_the_happy_path_is/\"\u003eGo proverbs\u003c/a\u003e says:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe happy path is left-aligned.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eIn this post, I attempt to show through two examples what we mean by \u0026ldquo;left-aligned happy path\u0026rdquo; and what are the benefits in terms of readibility and maintainability.\u003c/p\u003e","tags":["go"],"title":"Go Happy Path: the Unindented Line of Sight","type":"2019","url":"https://maelvls.dev/do-not-share-yet/go-happy-line-of-sight/","weight":0,"wordcount":821},{"authors":null,"categories":null,"content":"\u003cp\u003eYou might have noticed that \u003ccode\u003eGO111MODULE=on\u003c/code\u003e is flourishing everywhere. Many readmes have that:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon go get golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote that \u003ccode\u003ego get\u003c/code\u003e has been deprecated for installing binaries since Go 1.17 and will be become impossible in Go 1.18. If you are using Go 1.16 or above, you should use instead:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego install golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn this short post, I will explain why \u003ccode\u003eGO111MODULE\u003c/code\u003e was introduced in Go 1.11, its caveats and interesting bits that you need to know when dealing with Go Modules.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cstrong\u003eTable of content:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#from-gopath-to-go111module\"\u003eFrom \u003ccode\u003eGOPATH\u003c/code\u003e to \u003ccode\u003eGO111MODULE\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#the-go111module-environment-variable\"\u003eThe \u003ccode\u003eGO111MODULE\u003c/code\u003e environment variable\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#go111module-with-go-111-and-112\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.11 and 1.12\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#go111module-with-go-113\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.13\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#go111module-with-go-114\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.14\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#go111module-with-go-115\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.15\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#go111module-with-go-116\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.16\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#go111module-with-go-117\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.17\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#faster-downloading-of-dependencies-if-you-are-using-git-to-fetch-modules\"\u003eFaster downloading of dependencies if you are using Git to fetch modules\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#installing-binaries-with-go111moduleon-go-get-is-deprecated\"\u003eInstalling binaries with \u003ccode\u003eGO111MODULE=on go get\u003c/code\u003e is deprecated\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#go-run-knows-about-version-finally\"\u003e\u003ccode\u003ego run\u003c/code\u003e knows about \u003ccode\u003e@version\u003c/code\u003e (finally!)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#go111module-with-go-118\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.18\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#go111module-with-go-119\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.19\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#go111module-with-go-120\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.20\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#why-was-go111module-everywhere-go-115-and-below\"\u003eWhy was \u003ccode\u003eGO111MODULE\u003c/code\u003e everywhere? (Go 1.15 and below)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#the-pitfall-of-gomod-being-silently-updated-go-115-and-below\"\u003eThe pitfall of \u003ccode\u003ego.mod\u003c/code\u003e being silently updated (Go 1.15 and below)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#the--u-and-version-pitfall\"\u003eThe \u003ccode\u003e-u\u003c/code\u003e and \u003ccode\u003e@version\u003c/code\u003e pitfall\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#caveats-when-using-go-modules\"\u003eCaveats when using Go Modules\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#remember-that-go-get-also-updates-your-gomod\"\u003eRemember that \u003ccode\u003ego get\u003c/code\u003e also updates your \u003ccode\u003ego.mod\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#where-are-the-sources-of-the-dependencies-with-go-modules\"\u003eWhere are the sources of the dependencies with Go Modules\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#set-go111module-on-a-per-folder-basis-with-direnv\"\u003eSet \u003ccode\u003eGO111MODULE\u003c/code\u003e on a per-folder basis with \u003ccode\u003edirenv\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#private-go-modules-and-dockerfile\"\u003ePrivate Go Modules and Dockerfile\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#solution-1-vendoring\"\u003eSolution 1: vendoring\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#solution-2-no-vendoring\"\u003eSolution 2: no vendoring\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"from-gopath-to-go111module\"\u003eFrom \u003ccode\u003eGOPATH\u003c/code\u003e to \u003ccode\u003eGO111MODULE\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eFirst off, let\u0026rsquo;s talk about GOPATH. When Go was first introduced in 2009, it was not shipped with a package manager. Instead, \u003ccode\u003ego get\u003c/code\u003e would fetch all the sources by using their import paths and store them in \u003ccode\u003e$GOPATH/src\u003c/code\u003e. There was no versioning and the \u0026lsquo;master\u0026rsquo; branch would represent a stable version of the package.\u003c/p\u003e\n\u003cp\u003eGo Modules (previously called vgo \u0026ndash; versioned Go) were introduced with Go 1.11. Instead of using the GOPATH for storing a single git checkout of every package, Go Modules stores tagged versions with \u003ccode\u003ego.mod\u003c/code\u003e keeping track of each package\u0026rsquo;s version.\u003c/p\u003e\n\u003cp\u003eSince then, the interaction between the \u0026lsquo;GOPATH behavior\u0026rsquo; and the \u0026lsquo;Go Modules behavior\u0026rsquo; has become one of the biggest gotchas of Go. One environment variable is responsible for 95% of this pain: \u003ccode\u003eGO111MODULE\u003c/code\u003e.\u003c/p\u003e\n\u003ch2 id=\"the-go111module-environment-variable\"\u003eThe \u003ccode\u003eGO111MODULE\u003c/code\u003e environment variable\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e is an environment variable that can be set when using \u003ccode\u003ego\u003c/code\u003e for changing how Go imports packages. One of the first pain-points is that depending on the Go version, its semantics change.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e can be set in two different ways:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe environment variable in your shell, e.g.: \u003ccode\u003eexport GO111MODULE=on\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eThe \u0026ldquo;hidden\u0026rdquo; global configuration only known by \u003ccode\u003ego env\u003c/code\u003e using \u003ccode\u003ego env -w GO111MODULE=on\u003c/code\u003e (only available since Go 1.12).\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf Go seems to behave the way you think it should, it is recommended to check whether, in the past, you have set the global configuration using \u003ccode\u003ego env -w GO111MODULE=on\u003c/code\u003e (or \u003ccode\u003eoff\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego env GO111MODULE\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote that the environment variable takes precedence over the value that was stored using \u003ccode\u003ego env -w GO111MODULE\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eTo unset the global configuration, you can do:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego env -u GO111MODULE\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"go111module-with-go-111-and-112\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.11 and 1.12\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eGO111MODULE=on\u003c/code\u003e will force using Go modules even if the project is in your GOPATH. Requires \u003ccode\u003ego.mod\u003c/code\u003e to work.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eGO111MODULE=off\u003c/code\u003e forces Go to behave the GOPATH way, even outside of GOPATH.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eGO111MODULE=auto\u003c/code\u003e is the default mode. In this mode, Go will behave\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esimilarly to \u003ccode\u003eGO111MODULE=on\u003c/code\u003e when you are outside of \u003ccode\u003eGOPATH\u003c/code\u003e,\u003c/li\u003e\n\u003cli\u003esimilarly to \u003ccode\u003eGO111MODULE=off\u003c/code\u003e when you are inside the \u003ccode\u003eGOPATH\u003c/code\u003e even if a \u003ccode\u003ego.mod\u003c/code\u003e is present.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhenever you are in your GOPATH and you want to do an operation that requires Go modules (e.g., \u003ccode\u003ego get\u003c/code\u003e a specific version of a binary), you need to do:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon go get github.com/golang/mock/tree/master/mockgen@v1.3.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"go111module-with-go-113\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.13\u003c/h3\u003e\n\u003cp\u003eUsing Go 1.13, \u003ccode\u003eGO111MODULE\u003c/code\u003e\u0026rsquo;s default (\u003ccode\u003eauto\u003c/code\u003e) changes:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ebehaves like \u003ccode\u003eGO111MODULE=on\u003c/code\u003e anywhere there is a \u003ccode\u003ego.mod\u003c/code\u003e OR anywhere outside the GOPATH even if there is no \u003ccode\u003ego.mod\u003c/code\u003e. So you can keep all your repositories in your GOPATH with Go 1.13.\u003c/li\u003e\n\u003cli\u003ebehaves like \u003ccode\u003eGO111MODULE=off\u003c/code\u003e in the GOPATH with no \u003ccode\u003ego.mod\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"go111module-with-go-114\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.14\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003eGO111MODULE\u003c/code\u003e variable has the same behavior as with Go 1.13.\u003c/p\u003e\n\u003cp\u003eNote that some slight changes in behaviors unrelated to \u003ccode\u003eGO111MODULE\u003c/code\u003e happened:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe \u003ccode\u003evendor/\u003c/code\u003e is picked up automatically. That has the tendency of breaking Gomock (\u003ca href=\"https://github.com/golang/mock/issues/415\"\u003eissue\u003c/a\u003e) which were unknowingly not using \u003ccode\u003evendor/\u003c/code\u003e before 1.14.\u003c/li\u003e\n\u003cli\u003eYou still need to use \u003ccode\u003ecd \u0026amp;\u0026amp; GO111MODULE=on go get\u003c/code\u003e when you don\u0026rsquo;t want to mess up your current project’s \u003ccode\u003ego.mod\u003c/code\u003e (that\u0026rsquo;s so annoying).\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"go111module-with-go-115\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.15\u003c/h3\u003e\n\u003cp\u003eNothing with regards to \u003ccode\u003eGO111MODULE\u003c/code\u003e has changed with Go 1.15.\u003c/p\u003e\n\u003ch3 id=\"go111module-with-go-116\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.16\u003c/h3\u003e\n\u003cp\u003eAs of Go 1.16, the default behavior is \u003ccode\u003eGO111MODULE=on\u003c/code\u003e, meaning that if you want to keep using the old \u003ccode\u003eGOPATH\u003c/code\u003e way, you will have to force Go not to use the Go Modules feature:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eoff\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe best news in Go 1.16 is that we finally get a dedicated command for installing Go tools instead of relying on the does-it-all \u003ccode\u003ego get\u003c/code\u003e that keeps \u003ca href=\"#the-pitfall-of-gomod-being-silently-updated-go-115-and-below\"\u003eupdating\u003c/a\u003e your \u003ccode\u003ego.mod\u003c/code\u003e. Instead of:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Old way\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e go get golang.org/x/tools/gopls@latest\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eyou can now run:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego install golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eOne caveat is that the semantics of \u003ccode\u003ego install\u003c/code\u003e is slightly different from \u003ccode\u003ego get\u003c/code\u003e. As detailed on the \u003ca href=\"https://blog.golang.org/go116-module-changes\"\u003eGo\nblog\u003c/a\u003e:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIn order to eliminate ambiguity about which versions are used, there are several restrictions on what directives may be present in the program\u0026rsquo;s \u003ccode\u003ego.mod\u003c/code\u003e file when using this install syntax. In particular, \u003cstrong\u003ereplace and exclude directives are not allowed\u003c/strong\u003e, at least for now. In the long term, once the new \u003ccode\u003ego install program@version\u003c/code\u003e is working well for enough use cases, we plan to make \u003ccode\u003ego get\u003c/code\u003e stop installing command binaries. See \u003ca href=\"https://github.com/golang/go/issues/43684\"\u003eissue 43684\u003c/a\u003e for details.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eAs an example, you cannot (as of April 2021) install the master version of \u003ca href=\"https://github.com/golang/tools/tree/master/gopls\"\u003egopls\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% go install golang.org/x/tools/gopls@master\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego: downloading golang.org/x/tools v0.1.1-0.20210316190639-9e9211a98eaa\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego: downloading golang.org/x/tools/gopls v0.0.0-20210316190639-9e9211a98eaa\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego install golang.org/x/tools/gopls@master: golang.org/x/tools/gopls@v0.0.0-20210316190639-9e9211a98eaa\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        The go.mod file \u003cspan class=\"k\"\u003efor\u003c/span\u003e the module providing named packages contains one or\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        more replace directives. It must not contain directives that would cause\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        it to be interpreted differently than \u003cspan class=\"k\"\u003eif\u003c/span\u003e it were the main module.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe replace directive in the \u003ca href=\"https://github.com/golang/tools/blob/master/gopls/go.mod\"\u003ego.mod\u003c/a\u003e file looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ereplace\u003c/span\u003e \u003cspan class=\"nx\"\u003egolang\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"nx\"\u003eorg\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003ex\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"nx\"\u003etools\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"p\"\u003e..\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eFortunately, the gopls project makes sure to remove the \u003ccode\u003ereplace\u003c/code\u003e directive before each release, which means you can use the \u003ccode\u003elatest\u003c/code\u003e tag:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego install golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#                                   ^^^^^^\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"go111module-with-go-117\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.17\u003c/h3\u003e\n\u003cp\u003eGo 1.17 was released on August 16, 2021. As for 1.16, \u003ccode\u003eGO111MODULE=on\u003c/code\u003e is the default behavior, and \u003ccode\u003eGO111MODULE=auto\u003c/code\u003e is equivalent to \u003ccode\u003eGO111MODULE=on\u003c/code\u003e. If you still want to use the \u003ccode\u003eGOPATH\u003c/code\u003e way, you will have to force Go not to use the Go Modules feature using \u003ccode\u003eGO111MODULE=off\u003c/code\u003e (see \u003ca href=\"#set-go111module-on-a-per-folder-basis-with-direnv\"\u003ethe section about \u003ccode\u003edirenv\u003c/code\u003e\u003c/a\u003e).\u003c/p\u003e\n\u003cp\u003eThe three important changes that may affect how you use \u003ccode\u003eGO111MODULE\u003c/code\u003e are the following:\u003c/p\u003e\n\u003ch4 id=\"faster-downloading-of-dependencies-if-you-are-using-git-to-fetch-modules\"\u003eFaster downloading of dependencies if you are using Git to fetch modules\u003c/h4\u003e\n\u003cp\u003eIf you decide to update the \u003ccode\u003ego\u003c/code\u003e line in your \u003ccode\u003ego.mod\u003c/code\u003e to take advantage of the new \u003ca href=\"https://golang.org/ref/mod#graph-pruning\"\u003emodule graph pruning\u003c/a\u003e, your \u003ccode\u003ego.mod\u003c/code\u003e will want to get updated. The first time you will want to use \u003ccode\u003ego build\u003c/code\u003e, you will see the following error:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego build ./...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego: updates to go.mod needed; to update it:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        go mod tidy\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eAfter running \u003ccode\u003ego mod tidy\u003c/code\u003e, you will see that your \u003ccode\u003ego.mod\u003c/code\u003e changed quite a lot with a new \u003ccode\u003erequire\u003c/code\u003e block:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-diff\" data-lang=\"diff\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gh\"\u003ediff --git a/go.mod b/go.mod\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gh\"\u003eindex 3af719e..26ed354 100644\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gh\"\u003e\u003c/span\u003e\u003cspan class=\"gd\"\u003e--- a/go.mod\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e\u003c/span\u003e\u003cspan class=\"gi\"\u003e+++ b/go.mod\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e\u003c/span\u003e\u003cspan class=\"gu\"\u003e@@ -1,12 +1,12 @@\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e   module github.com/maelvls/users-grpc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-go 1.12\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e\u003c/span\u003e\u003cspan class=\"gi\"\u003e+go 1.17\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   require (\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   github.com/MakeNowJust/heredoc/v2 v2.0.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   github.com/fsnotify/fsnotify v1.4.9 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   github.com/golang/mock v1.4.4\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-\tgithub.com/golang/protobuf v1.4.3\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e\u003c/span\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/golang/protobuf v1.5.2\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e\u003c/span\u003e   github.com/grpc-ecosystem/go-grpc-middleware v1.0.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   github.com/grpc-ecosystem/go-grpc-prometheus v1.2.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   github.com/hashicorp/go-memdb v1.3.0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e@@ -37,8 +37,25 @@ require (\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gu\"\u003e\u003c/span\u003e   golang.org/x/xerrors v0.0.0-20200804184101-5ec99f83aff1 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   google.golang.org/genproto v0.0.0-20201116205149-79184cff4dfe // indirect\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   google.golang.org/grpc v1.33.2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e-\tgoogle.golang.org/protobuf v1.25.0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gd\"\u003e\u003c/span\u003e\u003cspan class=\"gi\"\u003e+\tgoogle.golang.org/protobuf v1.27.1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e\u003c/span\u003e   gopkg.in/check.v1 v1.0.0-20190902080502-41f04d3bba15 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   gopkg.in/ini.v1 v1.62.0 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   gopkg.in/yaml.v3 v3.0.0-20200615113413-eeeca48fe776 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e   )\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+require (\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/beorn7/perks v1.0.0 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/davecgh/go-spew v1.1.1 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/hashicorp/go-immutable-radix v1.3.0 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/hashicorp/golang-lru v0.5.4 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/hashicorp/hcl v1.0.0 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/inconshreveable/mousetrap v1.0.0 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/matttproud/golang_protobuf_extensions v1.0.1 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/pmezard/go-difflib v1.0.0 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/prometheus/client_model v0.0.0-20190812154241-14fe0d1b01d4 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/prometheus/common v0.4.0 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/prometheus/procfs v0.0.0-20190507164030-5867b95ac084 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/spf13/pflag v1.0.5 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgithub.com/subosito/gotenv v1.2.0 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+\tgopkg.in/yaml.v2 v2.3.0 // indirect\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"gi\"\u003e+)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe new \u003ccode\u003erequire\u003c/code\u003e block adds even more \u003ccode\u003e// indirect\u003c/code\u003e lines. Thanks to these new lines, Go commands such as \u003ccode\u003ego get\u003c/code\u003e have less downloading to do (the mechanism is called \u003ca href=\"https://go.googlesource.com/proposal/+/master/design/36460-lazy-module-loading.md\"\u003elazy modules loading\u003c/a\u003e). Previously, \u003ccode\u003ego get\u003c/code\u003e had to download every single project in order to access their \u003ccode\u003ego.mod\u003c/code\u003e files, even if some of these projects were not actually used by your code. That was a big problem for git-based projects, and less of a problem for people using \u003ccode\u003eGOPROXY\u003c/code\u003e (i.e., everyone else) since the \u003ccode\u003ego.mod\u003c/code\u003e can be fetched without fetching the whole repository when using the \u003ccode\u003eGOPROXY\u003c/code\u003e mechanism.\u003c/p\u003e\n\u003cp\u003eFor example, using the \u003ccode\u003eGOPROXY\u003c/code\u003e mechanism, the number of HTTP GET calls is reduced from 252 to 169 (49% less HTTP requests) with the cert-manager project for the tag v1.4.0. The number of HTTP calls was calculated using mitmproxy using \u003ccode\u003eGOCACHE=off\u003c/code\u003e. Although the number of HTTP calls has been reduced, I did not notice any significant time reduction.\u003c/p\u003e\n\u003cp\u003eThe biggest difference will happen for people who are relying on Git for downloading repositories. Each time Go needs to read a \u003ccode\u003ego.mod\u003c/code\u003e, it needs to download the whole Git repository. We can force Go to clone the Git repositories by using \u003ccode\u003eGOPRIVATE=*\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# With Go 1.16:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003etime\u003c/span\u003e \u003cspan class=\"nv\"\u003eGOPATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003emktemp -d\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u003cspan class=\"nv\"\u003eGOPRIVATE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;*\u0026#39;\u003c/span\u003e go get ./...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e161.65s user 34.07s system 38% cpu 8:23.58 total\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# With Go 1.17:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003etime\u003c/span\u003e \u003cspan class=\"nv\"\u003eGOPATH\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"k\"\u003e$(\u003c/span\u003emktemp -d\u003cspan class=\"k\"\u003e)\u003c/span\u003e \u003cspan class=\"nv\"\u003eGOPRIVATE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;*\u0026#39;\u003c/span\u003e go get ./...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e158.09s user 33.39s system 39% cpu 7:59.63 total\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThat\u0026rsquo;s 5% faster (24 seconds less with a 30 Mbit/s DSL connection). I would have expected a better result, but that number will depend on the \u003ccode\u003ego.mod\u003c/code\u003e you have!\u003c/p\u003e\n\u003ch4 id=\"installing-binaries-with-go111moduleon-go-get-is-deprecated\"\u003eInstalling binaries with \u003ccode\u003eGO111MODULE=on go get\u003c/code\u003e is deprecated\u003c/h4\u003e\n\u003cp\u003eIn Go 1.17, the use of \u003ccode\u003ego get\u003c/code\u003e to install binaries is now showing the following warning:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon go get golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego get: installing executables with \u003cspan class=\"s1\"\u003e\u0026#39;go get\u0026#39;\u003c/span\u003e in module mode is deprecated.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     Use \u003cspan class=\"s1\"\u003e\u0026#39;go install pkg@version\u0026#39;\u003c/span\u003e instead.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     For more information, see https://golang.org/doc/go-get-install-deprecation\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e     or run \u003cspan class=\"s1\"\u003e\u0026#39;go help get\u0026#39;\u003c/span\u003e or \u003cspan class=\"s1\"\u003e\u0026#39;go help install\u0026#39;\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo work around this warning, you can use \u003ccode\u003ego install\u003c/code\u003e that was taught how to deal with \u003ccode\u003e@version\u003c/code\u003e in Go 1.16:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego install golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNotice that \u003ccode\u003e@version\u003c/code\u003e implies the Go module mode, meaning that you don\u0026rsquo;t have to add \u003ccode\u003eGO111MODULE=on\u003c/code\u003e at the beginning of the command when you are not in a Go project that has a \u003ccode\u003ego.mod\u003c/code\u003e.\u003c/p\u003e\n\u003ch4 id=\"go-run-knows-about-version-finally\"\u003e\u003ccode\u003ego run\u003c/code\u003e knows about \u003ccode\u003e@version\u003c/code\u003e (finally!)\u003c/h4\u003e\n\u003cp\u003eThe \u003ccode\u003ego run\u003c/code\u003e command was taught how to deal with \u003ccode\u003e@version\u003c/code\u003e! Like \u003ccode\u003ego install\u003c/code\u003e, it implies \u003ccode\u003eGO111MODULE=on\u003c/code\u003e. Up to now, if you wanted to run a binary once, you had two ways:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIf you were running the binary from a \u003ccode\u003ego.mod\u003c/code\u003e enabled project, you could specify the version of the binary you want to run in your \u003ccode\u003ego.mod\u003c/code\u003e and then run \u003ccode\u003ego run -mod=mod\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# Before Go 1.17:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego get github.com/golang/mock/mockgen@v1.3.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego run -mod=mod github.com/golang/mock/mockgen\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e# With Go 1.17:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego run github.com/golang/mock/mockgen@v1.3.1\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis is great if you use \u003ccode\u003e//go:generate\u003c/code\u003e to generate mocks. For example, in the project [users-grpc](\u003ca href=\"https://github.com/maelvls/users-grpc/blob/\"\u003ehttps://github.com/maelvls/users-grpc/blob/\u003c/a\u003e master/schema/placeholder.go), I was able to replace my \u003ccode\u003e//go:generate\u003c/code\u003e directive:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-go\" data-lang=\"go\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// Old way, before 1.17:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//go:generate go run -mod=mod github.com/golang/mock/mockgen -build_flags=-mod=mod -package mocks -destination ./mock_service.go -source=../  user.go\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// New way, Go 1.17:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e//go:generate go run github.com/golang/mock/mockgen@v1.4.4 -package mocks -destination ./mock_service.go -source=../user.go\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"go111module-with-go-118\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.18\u003c/h3\u003e\n\u003cp\u003eIf you still need to use \u003ccode\u003ego get\u003c/code\u003e to install a binary, you will need to set \u003ccode\u003eGO111MODULE=off\u003c/code\u003e. The recommended way is to switch to using \u003ccode\u003ego install\u003c/code\u003e instead. Without \u003ccode\u003eGO111MODULE=off\u003c/code\u003e, \u003ccode\u003ego get\u003c/code\u003e will only update your \u003ccode\u003ego.mod\u003c/code\u003e. Otherwise, it won\u0026rsquo;t do anything. All the READMEs on the Internet have to be updated; if they don\u0026rsquo;t, people will get confused by not seeing the binary being installed.\u003c/p\u003e\n\u003ch3 id=\"go111module-with-go-119\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.19\u003c/h3\u003e\n\u003cp\u003eNothing with regards to \u003ccode\u003eGO111MODULE\u003c/code\u003e has changed with Go 1.19.\u003c/p\u003e\n\u003ch3 id=\"go111module-with-go-120\"\u003e\u003ccode\u003eGO111MODULE\u003c/code\u003e with Go 1.20\u003c/h3\u003e\n\u003cp\u003eNothing with regards to \u003ccode\u003eGO111MODULE\u003c/code\u003e has changed with Go 1.20.\u003c/p\u003e\n\u003ch3 id=\"why-was-go111module-everywhere-go-115-and-below\"\u003eWhy was \u003ccode\u003eGO111MODULE\u003c/code\u003e everywhere? (Go 1.15 and below)\u003c/h3\u003e\n\u003cp\u003eNow that we know that \u003ccode\u003eGO111MODULE\u003c/code\u003e was very useful with Go 1.15 and below for enabling the Go Modules behavior, here is the answer: that\u0026rsquo;s because \u003ccode\u003eGO111MODULE=on\u003c/code\u003e allows you to select a version. Without Go Modules, \u003ccode\u003ego get\u003c/code\u003e fetches the latest commit from master. With Go Modules, you can select a specific version based on git tags.\u003c/p\u003e\n\u003cp\u003eBefore Go 1.16 got released, I used to use \u003ccode\u003eGO111MODULE=on\u003c/code\u003e very often when I wanted to switch between the latest version and the HEAD version of \u003ccode\u003egopls\u003c/code\u003e (the Go Language Server):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# With Go 1.15.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon go get golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon go get golang.org/x/tools/gopls@master\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon go get golang.org/x/tools/gopls@v0.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon go get golang.org/x/tools/gopls@v0.1.8\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;on\u0026#34;\u003c/span\u003e go get sigs.k8s.io/kind@v0.7.0\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThis became much easier with Go 1.16 though. I could do the same thing with:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# With Go 1.16.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego install golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"the-pitfall-of-gomod-being-silently-updated-go-115-and-below\"\u003eThe pitfall of \u003ccode\u003ego.mod\u003c/code\u003e being silently updated (Go 1.15 and below)\u003c/h3\u003e\n\u003cp\u003eWith Go 1.15 and below, our only option to install binaries was to use \u003ccode\u003ego get\u003c/code\u003e. You may have encountered this weird one-liner in READMEs:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon go get golang.org/x/tools/gopls@latest\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e the \u003ccode\u003e@latest\u003c/code\u003e suffix will use the latest git tag of gopls. Note that \u003ccode\u003e-u\u003c/code\u003e (which means \u0026lsquo;update\u0026rsquo;) is not needed for \u003ccode\u003e@v0.1.8\u003c/code\u003e since this is a \u0026lsquo;fixed\u0026rsquo; version, and updating a fixed version does not really make sense. It is also interesting to note that with \u003ccode\u003e@v0.1\u003c/code\u003e, \u003ccode\u003ego get\u003c/code\u003e will fetch the latest patch version for that tag.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eSo, why did we need to use this contrived command that calls a subshell and moves to your HOME? That\u0026rsquo;s yet another Go ideocracy that was fixed with Go 1.16: in Go 1.15 and below, by default (and you can\u0026rsquo;t turn that off), if you are in a folder that has a \u003ccode\u003ego.mod\u003c/code\u003e, \u003ccode\u003ego get\u003c/code\u003e will update that \u003ccode\u003ego.mod\u003c/code\u003e with what you just installed. And in the case of development binaries like \u003ca href=\"https://github.com/golang/tools/tree/master/gopls\"\u003egopls\u003c/a\u003e or \u003ca href=\"https://github.com/kubernetes-sigs/kind\"\u003ekind\u003c/a\u003e, you definitely don\u0026rsquo;t want to have these appearing in the \u003ccode\u003ego.mod\u003c/code\u003e file!\u003c/p\u003e\n\u003cp\u003eSo the workaround for anyone using Go 1.15 and below was to give a one-liner that makes sure that you won\u0026rsquo;t be in a \u003ccode\u003ego.mod\u003c/code\u003e-enabled folder: \u003ccode\u003e(cd \u0026amp;\u0026amp; go get)\u003c/code\u003e does exactly that.\u003c/p\u003e\n\u003cp\u003eFortunately, with Go 1.16, there is now a clear separation of concerns between \u003ccode\u003ego get\u003c/code\u003e that is adding a dependency to your \u003ccode\u003ego.mod\u003c/code\u003e (like npm install) and \u003ccode\u003ego install\u003c/code\u003e that is meant to install a binary without messing up your \u003ccode\u003ego.mod\u003c/code\u003e. With Go 1.16, the above \u003ccode\u003ego get\u003c/code\u003e becomes:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego install golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"the--u-and-version-pitfall\"\u003eThe \u003ccode\u003e-u\u003c/code\u003e and \u003ccode\u003e@version\u003c/code\u003e pitfall\u003c/h3\u003e\n\u003cp\u003eI have been bitten multiple times by this: when using \u003ccode\u003ego get @latest\u003c/code\u003e (for a binary, at least), you should avoid using \u003ccode\u003e-u\u003c/code\u003e so that it uses the dependencies as defined in \u003ccode\u003ego.sum\u003c/code\u003e. Otherwise, it will update all the dependencies to their latest minor revision\u0026hellip; And since a ton of projects choose to have breaking changes between minor versions (e.g. v0.2.0 to v0.3.0), using \u003ccode\u003e-u\u003c/code\u003e has a large chance of breaking things.\u003c/p\u003e\n\u003cp\u003eSo if you see this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Both -u and @latest!\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon go get -u golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ethen you will immediately realize that (1) it uses the old preGo .1.16 way of installing a Go binary, and (2) you want to be using the recorded versions given in \u003ccode\u003ego.sum\u003c/code\u003e when go-getting a binary!\u003c/p\u003e\n\u003cp\u003eRebecca Stambler \u003ca href=\"https://github.com/golang/go/issues/35868#issuecomment-564151454\"\u003ereminds us\u003c/a\u003e that we should not use \u003ccode\u003e-u\u003c/code\u003e in conjunction with a version:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003e-u\u003c/code\u003e should not be used in conjunction with the \u003ccode\u003e@latest\u003c/code\u003e tag, as it will give you incorrect versions of the dependencies.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eBut it\u0026rsquo;s kind of hidden in this issue\u0026hellip; I guess it is written somewhere in the Go help (btw, what a hideous help compared to \u003ccode\u003egit help\u003c/code\u003e) but that kind of caveat should be more visible: maybe print a warning when installing a binary with both \u003ccode\u003e@version\u003c/code\u003e and \u003ccode\u003e-u\u003c/code\u003e?\u003c/p\u003e\n\u003ch2 id=\"caveats-when-using-go-modules\"\u003eCaveats when using Go Modules\u003c/h2\u003e\n\u003cp\u003eNow, let\u0026rsquo;s go through some caveats I encountered when working with Go Modules.\u003c/p\u003e\n\u003ch3 id=\"remember-that-go-get-also-updates-your-gomod\"\u003eRemember that \u003ccode\u003ego get\u003c/code\u003e also updates your \u003ccode\u003ego.mod\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003eBefore Go 1.16 came out, that was one of the weird things with \u003ccode\u003ego get\u003c/code\u003e: sometimes, it served the purpose of installing binaries or downloading packages. And with Go modules, if you were in a repo with a \u003ccode\u003ego.mod\u003c/code\u003e, it would silently add the binary that you were \u003ccode\u003ego get\u003c/code\u003e-ing to your \u003ccode\u003ego.mod\u003c/code\u003e!\u003c/p\u003e\n\u003cp\u003eFortunately, with Go 1.16, \u003ccode\u003ego install\u003c/code\u003e has \u003ca href=\"https://blog.golang.org/go116-module-changes\"\u003elearnt\u003c/a\u003e about the \u003ccode\u003e@version\u003c/code\u003e suffix. With \u003ccode\u003ego install foo@version\u003c/code\u003e, your local \u003ccode\u003ego.mod\u003c/code\u003e won\u0026rsquo;t be affected! And in Go 1.18, \u003ccode\u003ego get\u003c/code\u003e won\u0026rsquo;t install binaries anymore, and will only ever be used for adding dependencies to your \u003ccode\u003ego.mod\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eAnd if you would like to run \u003ccode\u003ego test\u003c/code\u003e or \u003ccode\u003ego build\u003c/code\u003e without having \u003ccode\u003ego.mod\u003c/code\u003e updated, you can use the flag \u003ccode\u003e-mod=readonly\u003c/code\u003e. For example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego \u003cspan class=\"nb\"\u003etest\u003c/span\u003e -mod\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003ereadonly\u003c/span\u003e ./...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego build -mod\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003ereadonly\u003c/span\u003e ./...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"where-are-the-sources-of-the-dependencies-with-go-modules\"\u003eWhere are the sources of the dependencies with Go Modules\u003c/h3\u003e\n\u003cp\u003eWhen using Go Modules, the packages that are used during \u003ccode\u003ego build\u003c/code\u003e are stored in \u003ccode\u003e$GOPATH/pkg/mod\u003c/code\u003e. When trying to inspect an \u0026lsquo;import\u0026rsquo; in vim or VSCode, you might end up in the GOPATH version of the package instead of the pkg/mod one used during compilation.\u003c/p\u003e\n\u003cp\u003eA second issue that arises is when you want to hack one of your dependencies, for example for testing purposes.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eSolution 1\u003c/strong\u003e: use \u003ccode\u003ego mod vendor\u003c/code\u003e + \u003ccode\u003ego build -mod=vendor\u003c/code\u003e. That will force \u003ccode\u003ego\u003c/code\u003e to use the vendor/ files instead of using the \u003ccode\u003e$GOPATH/pkg/mod\u003c/code\u003e ones. This option also solves the problem of vim and VSCode not opening the right version of a package’s file.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eSolution 2\u003c/strong\u003e: add a \u0026lsquo;replace\u0026rsquo; line at the end of your \u003ccode\u003ego.mod\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ereplace github.com/maelvls/beers =\u0026gt; ../beers\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewhere \u003ccode\u003e../beers\u003c/code\u003e is a local copy I made of the dependency I want to inspect and hack.\u003c/p\u003e\n\u003ch3 id=\"set-go111module-on-a-per-folder-basis-with-direnv\"\u003eSet \u003ccode\u003eGO111MODULE\u003c/code\u003e on a per-folder basis with \u003ccode\u003edirenv\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003eOn older versions of Go (1.15 and below), while migrating from GOPATH-based projects (mainly using Dep) to Go Modules, I found myself struggling with two different places: inside and outside GOPATH. All Go Modules had to be kept outside of GOPATH, which meant my projects were in different folders. To remediate that, I used \u003ccode\u003eGO111MODULE\u003c/code\u003e extensively. I would keep all my projects in the GOPATH, and for the Go Modules-enabled projects, I would set \u003ccode\u003eexport GO111MODULE=on\u003c/code\u003e.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eNote:\u003c/strong\u003e since the default behavior in Go 1.16 is now \u003ccode\u003eGO111MODULE=on\u003c/code\u003e, this trick isn\u0026rsquo;t necessary anymore.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eThis is where \u003ca href=\"https://direnv.net/\"\u003e\u003ccode\u003edirenv\u003c/code\u003e\u003c/a\u003e came in handy. Direnv is a lightweight command written in Go that will load a file, \u003ccode\u003e.envrc\u003c/code\u003e, whenever you enter a directory and \u003ccode\u003e.envrc\u003c/code\u003e is present. For every Go Module-enabled project, I would have this \u003ccode\u003e.envrc\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# .envrc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eGOPRIVATE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003egithub.com/mycompany/\u003cspan class=\"se\"\u003e\\*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eGOFLAGS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e-mod\u003cspan class=\"o\"\u003e=\u003c/span\u003evendor\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe \u003ccode\u003eGOPRIVATE\u003c/code\u003e environment variable disables the Go Proxy (introduced in Go 1.13) for certain import paths. I also found useful to set \u003ccode\u003e-mod=vendor\u003c/code\u003e so that every command uses the \u003ccode\u003evendor\u003c/code\u003e folder (\u003ccode\u003ego mod vendor\u003c/code\u003e).\u003c/p\u003e\n\u003ch3 id=\"private-go-modules-and-dockerfile\"\u003ePrivate Go Modules and Dockerfile\u003c/h3\u003e\n\u003cp\u003eMany companies choose to use private repositories as import paths. As explained above, we can use \u003ccode\u003eGOPRIVATE\u003c/code\u003e in order to tell Go (as of Go 1.13) to skip the package proxy and fetch our private packages directly from Github.\u003c/p\u003e\n\u003cp\u003eBut what about building Docker images? How can \u003ccode\u003ego get\u003c/code\u003e fetch our private repositories from a docker build?\u003c/p\u003e\n\u003ch4 id=\"solution-1-vendoring\"\u003eSolution 1: vendoring\u003c/h4\u003e\n\u003cp\u003eWith \u003ccode\u003ego mod vendor\u003c/code\u003e, no need to pass Github credentials to the docker build context. We can just put everything in \u003ccode\u003evendor/\u003c/code\u003e and the problem is solved. In the Dockerfile, \u003ccode\u003e-mod=vendor\u003c/code\u003e will be required, but developers don\u0026rsquo;t even have to bother with \u003ccode\u003e-mod=vendor\u003c/code\u003e since they have access to the private Github repositories anyway using their local Git config\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePros: faster build on CI (~10 to 30 seconds less)\u003c/li\u003e\n\u003cli\u003eCons: PRs are bloated with \u003ccode\u003evendor/\u003c/code\u003e changes and the repo\u0026rsquo;s size might be big\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"solution-2-no-vendoring\"\u003eSolution 2: no vendoring\u003c/h4\u003e\n\u003cp\u003eIf \u003ccode\u003evendor/\u003c/code\u003e is just too big (e.g., for Kubernetes controllers, \u003ccode\u003evendor/\u003c/code\u003e is about 30MB), we can very well do it without vendoring. That would require to pass some form of GITHUB_TOKEN as argument of \u003ccode\u003edocker build\u003c/code\u003e, and in the Dockerfile, set something like:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit config --global url.\u003cspan class=\"s2\"\u003e\u0026#34;https://foo:\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eGITHUB_TOKEN\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e@github.com/company\u0026#34;\u003c/span\u003e.insteadOf \u003cspan class=\"s2\"\u003e\u0026#34;https://github.com/company\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eexport\u003c/span\u003e \u003cspan class=\"nv\"\u003eGOPRIVATE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003egithub.com/company/\u003cspan class=\"se\"\u003e\\*\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cem\u003eIllustration by Bailey Beougher, from The Illustrated Children\u0026rsquo;s Guide to Kubernetes.\u003c/em\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eUpdate 22 June 2020:\u003c/strong\u003e it said \u003ccode\u003euse replace\u003c/code\u003e instead of just \u003ccode\u003ereplace\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eUpdate 8 April 2021:\u003c/strong\u003e update with Go 1.16.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eUpdate 20 Sept 2021:\u003c/strong\u003e update with Go 1.17.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eUpdate 18 Feb 2023:\u003c/strong\u003e mention the \u003ccode\u003ego env GO111MODULE\u003c/code\u003e gotcha reported by \u003ca href=\"https://github.com/jsoref\"\u003eJosh Soref\u003c/a\u003e. I also mentioned Go 1.18, Go 1.19, and Go 1.20. Finally, I reformulated \u0026ldquo;Why is GO111MODULE everywhere\u0026rdquo; to \u0026ldquo;Why was GO111MODULE everywhere in Go 1.15 and below\u0026rdquo; thanks to \u003ca href=\"https://github.com/edrandall\"\u003eEd Randall\u003c/a\u003e\u0026rsquo;s remark. I also added a note about \u003ccode\u003e-mod=readonly\u003c/code\u003e after a remark from \u003ca href=\"https://dev.to/daodennis\"\u003edaodennis\u003c/a\u003e, and fixed an issue reported by \u003ca href=\"https://github.com/0xF4D3C0D3\"\u003eDongHo Jung\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n","date":1573603200,"description":"GO111MODULE is all over the place. It appears in README install instructions, in Dockerfiles, in makefiles. On top of that, the behavior of GO111MODULE has changed from Go 1.11 to 1.12, changed again with Go 1.13 and Go 1.15 and changed a last time in Go 1.16, and is stable since then.","dir":"2019/go111modules/","expirydate":-62135596800,"fuzzywordcount":3400,"images":["go111module-everywhere/cover-go-modules-sad.jpg"],"keywords":null,"kind":"page","lang":"en","lastmod":1573603200,"objectID":"a29fe97a11056a2aa23043ba9101578a","permalink":"https://maelvls.dev/do-not-share-yet/go111module-everywhere/","publishdate":"2019-11-13T00:00:00Z","readingtime":16,"relpermalink":"/do-not-share-yet/go111module-everywhere/","section":"2019","summary":"\u003cp\u003eYou might have noticed that \u003ccode\u003eGO111MODULE=on\u003c/code\u003e is flourishing everywhere. Many readmes have that:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003eGO111MODULE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eon go get golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote that \u003ccode\u003ego get\u003c/code\u003e has been deprecated for installing binaries since Go 1.17 and will be become impossible in Go 1.18. If you are using Go 1.16 or above, you should use instead:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ego install golang.org/x/tools/gopls@latest\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIn this short post, I will explain why \u003ccode\u003eGO111MODULE\u003c/code\u003e was introduced in Go 1.11, its caveats and interesting bits that you need to know when dealing with Go Modules.\u003c/p\u003e","tags":["go","go-modules"],"title":"Why is GO111MODULE everywhere, and everything about Go Modules (updated with Go 1.20)","type":"2019","url":"https://maelvls.dev/do-not-share-yet/go111module-everywhere/","weight":0,"wordcount":3392},{"authors":null,"categories":null,"content":"","date":1573516800,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"term","lang":"en","lastmod":1573516800,"objectID":"https://maelvls.dev/do-not-share-yet/tags/controller/","permalink":"https://maelvls.dev/do-not-share-yet/tags/controller/","publishdate":"2019-11-12T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/tags/controller/","section":"tags","summary":"","tags":null,"title":"Controller","type":"tags","url":"https://maelvls.dev/do-not-share-yet/tags/controller/","weight":0,"wordcount":0},{"authors":null,"categories":null,"content":"\u003cp\u003eWhile building a Kubernetes controller using CRDs, I stumbled across \u0026lsquo;conditions\u0026rsquo; in the status field. What are conditions and how should I implement them in my controller?\u003c/p\u003e\n\u003cp\u003eIn this post, I will explain what \u0026lsquo;status conditions\u0026rsquo; are in Kubernetes and show how they can be used in your own controllers.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eTable of contents:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"#pod-example\"\u003ePod example\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#what-other-projects-do\"\u003eWhat other projects do\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#conditions-vs-state-machine\"\u003eConditions vs. State machine\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#conditions-vs-events\"\u003eConditions vs. Events\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#orthogonality-vs-extensibility\"\u003eOrthogonality vs. Extensibility\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#are-conditions-still-used\"\u003eAre Conditions still used?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#conditions-vs-reasons\"\u003eConditions vs. Reasons\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#how-many-conditions\"\u003eHow many conditions?\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003cp\u003eIn the following, a \u0026lsquo;component\u0026rsquo; is considered to be one sync loop. A sync loop (also called reconciliation loop) is what must be done in order to synchronize the \u0026lsquo;desired state\u0026rsquo; with the \u0026lsquo;observed state\u0026rsquo;.\u003c/p\u003e\n\u003cp\u003eKubernetes itself is made of multiple binaries (kubelet on each node, one apiserver, one kube-controller-manager and one kube-scheduler). And each of these binaries have multiple components (i.e., sync loops):\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003ebinary\u003c/th\u003e\n          \u003cth\u003esync loop = component\u003c/th\u003e\n          \u003cth\u003ereads\u003c/th\u003e\n          \u003cth\u003ecreates\u003c/th\u003e\n          \u003cth\u003eupdates\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekube-controller-manager\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/controller/deployment/deployment_controller.go#L560-L649\"\u003e\u003ccode\u003esyncDeployment\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003ePod\u003c/td\u003e\n          \u003ctd\u003eReplicaSet\u003c/td\u003e\n          \u003ctd\u003eDeployment\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekube-controller-manager\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/controller/replicaset/replica_set.go#L653-L721\"\u003e\u003ccode\u003esyncReplicaSet\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003ePod\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekubelet\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/kubelet/status/status_manager.go#L514-L567\"\u003e\u003ccode\u003esyncPod\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003ePod\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekube-scheduler\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/scheduler/scheduler.go#L589-L762\"\u003e\u003ccode\u003escheduleOne\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003ePod\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ekubelet\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bff9bfb9dfe0f2ea40f1c80cac47fc12b2/pkg/kubelet/kubelet_node_status.go#L374-L391\"\u003e\u003ccode\u003esyncNodeStatus\u003c/code\u003e\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eNode\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eWe can see that one single object (Pod) can be read, edited and updated by different components. When I say \u0026rsquo;edited\u0026rsquo;, I mean the sync loop edits the status (which contains the conditions), not the rest. The status is a way of communicating between components/sync loops.\u003c/p\u003e\n\u003cp\u003eAs Brian Grant put it,\u003c/p\u003e\n\u003cblockquote class=\"twitter-tweet\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eRather than rigid fine-grained state enumerations that couldn\u0026#39;t be evolved, we initially adopted simple basic states that could report open-ended reasons for being in each state (\u003ca href=\"https://t.co/l5WXSjbg3K\"\u003ehttps://t.co/l5WXSjbg3K\u003c/a\u003e), and later non-orthogonal, extensible conditions (\u003ca href=\"https://t.co/XiwOcgcSGY\"\u003ehttps://t.co/XiwOcgcSGY\u003c/a\u003e).\u003c/p\u003e\u0026mdash; Brian Grant (@bgrant0607) \u003ca href=\"https://twitter.com/bgrant0607/status/1111473660479430656?ref_src=twsrc%5Etfw\"\u003eMarch 29, 2019\u003c/a\u003e\u003c/blockquote\u003e\n\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\n\n\u003ch2 id=\"pod-example\"\u003ePod example\u003c/h2\u003e\n\u003cp\u003eLet\u0026rsquo;s read a Pod manifest:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# kubectl -n cert-manager get pods -oyaml\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ePod\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003elastTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2019-10-22T16:29:24Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;True\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ePodScheduled\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003elastTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2019-10-22T16:29:24Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;True\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eInitialized\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003elastTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2019-10-22T16:29:31Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;True\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eContainersReady\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003elastTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2019-10-22T16:29:31Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;True\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eReady\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econtainerStatuses\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003eimage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003equay.io/jetstack/cert-manager-controller:v0.6.1\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003eready\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003etrue\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estate\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e{\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003erunning\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e{\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"nt\"\u003estartedAt\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2019-10-22T16:29:31Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e}\u003cspan class=\"w\"\u003e \u003c/span\u003e}\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ephase\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eRunning\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA condition contains a Status and a Type. It may also contain a Reason and a Message. For example:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e- \u003cspan class=\"nt\"\u003elastTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2019-10-22T16:29:31Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;True\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eContainersReady\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe \u003ca href=\"https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-conditions\"\u003epod-lifecycle\u003c/a\u003e documentation explains the difference between the \u0026lsquo;phase\u0026rsquo; and \u0026lsquo;conditions:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe top-level \u003ccode\u003ephase\u003c/code\u003e is an aggregated state that answers some user-facing questions such as \u003cem\u003eis my pod in a terminal state?\u003c/em\u003e but has gaps since the actual state is contained in the conditions.\u003c/li\u003e\n\u003cli\u003eThe \u003ccode\u003econditions\u003c/code\u003e array is a set of types (Ready, PodScheduled\u0026hellip;) with a status (True, False or Unknown) that make up the \u0026lsquo;computed state\u0026rsquo; of a Pod at any time. As we will see later, the state is almost always \u0026lsquo;partial\u0026rsquo; (\u003cem\u003eopen-ended conditions\u003c/em\u003e).\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eNow, let\u0026rsquo;s see what I mean by \u0026lsquo;components\u0026rsquo;. The status of a Pod is not updated by a single Sync loop: it is updated by multiple components: the kubelet, and the kube-scheduler. Here is a list of the condition types per component:\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003ePossible condition types for a Pod\u003c/th\u003e\n          \u003cth\u003eComponent that updates this condition type\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/beaf3a2f0/pkg/scheduler/scheduler.go#L435\"\u003ePodScheduled\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/scheduler/scheduler.go#L589-L762\"\u003e\u003ccode\u003escheduleOne\u003c/code\u003e\u003c/a\u003e (kube-scheduler)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/beaf3a2f0/pkg/scheduler/scheduler.go#L615\"\u003eUnschedulable\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/scheduler/scheduler.go#L589-L762\"\u003e\u003ccode\u003escheduleOne\u003c/code\u003e\u003c/a\u003e (kube-scheduler)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/beaf3a2f0/pkg/kubelet/kubelet_pods.go#L1368\"\u003eInitialized\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/kubelet/status/status_manager.go#L514-L567\"\u003e\u003ccode\u003esyncPod\u003c/code\u003e\u003c/a\u003e (kubelet)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/beaf3a2f0/pkg/kubelet/kubelet_pods.go#L1370\"\u003eContainersReady\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/kubelet/status/status_manager.go#L514-L567\"\u003e\u003ccode\u003esyncPod\u003c/code\u003e\u003c/a\u003e (kubelet)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/beaf3a2f0/pkg/kubelet/kubelet_pods.go#L1369\"\u003eReady\u003c/a\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/kubernetes/blob/5bac42bf/pkg/kubelet/status/status_manager.go#L514-L567\"\u003e\u003ccode\u003esyncPod\u003c/code\u003e\u003c/a\u003e (kubelet)\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eAlthough conditions are a good way to convey information to the user, they also serve as a way of communicating between components (e.g., between kube-scheduler and apiserver) but also to external components (e.g. a custom controller that wants to trigger something as soon as a pod becomes \u0026lsquo;Unschedulable\u0026rsquo;, and maybe order more VMs to the cloud provider and add it as a node.\u003c/p\u003e\n\u003cp\u003eAs you will see below, the \u0026lsquo;conditions\u0026rsquo; array is considered to be containing all the \u0026lsquo;ground truth\u0026rsquo;. The \u0026lsquo;phase\u0026rsquo; just an abstraction of these conditions.\u003c/p\u003e\n\u003ch2 id=\"what-other-projects-do\"\u003eWhat other projects do\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/kubernetes-sigs/cluster-api\"\u003ecluster-api\u003c/a\u003e and its providers (e.g., cluster-api-gcp-provider) do not use Conditions at all:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://github.com/kubernetes-sigs/cluster-api/blob/112951ee/docs/proposals/20181121-machine-api.md\"\u003eFeng Min, Nov 2018\u003c/a\u003e) Brian Grant (@bgrant0607) and Eric Tune (@erictune) have indicated that the API pattern of having \u0026ldquo;Conditions\u0026rdquo; lists in object statuses is soon to be deprecated. These have generally been used as a timeline of state transitions for the object\u0026rsquo;s reconciliation, and difficult to consume for clients that just want a meaningful representation of the object\u0026rsquo;s current state. There are no existing examples of the new pattern to follow instead, just the guidance that we should use top-level fields in the status to represent meaningful information. We can revisit the specifics when new patterns start to emerge in core.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eInstead of using a list of conditions, cluster-api projects go like that:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003eready\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"kc\"\u003efalse\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ephase\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Failed\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003efailureReason\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;GcpMachineCrashed\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003efailureMessage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;VM crashed: ...\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/jetstack/cert-manager\"\u003ecert-manager\u003c/a\u003e uses Conditions, but the only type is \u0026lsquo;Ready\u0026rsquo;. The rest of the information is given in Ready\u0026rsquo;s Reason field. That might be unfortunate for users or other components that are willing to use cert-manager\u0026rsquo;s API, similarly to what happens with the PodSchedulable condition and its reason, PodReasonUnschedulable. For example, the \u003ca href=\"https://github.com/jetstack/cert-manager/blob/b91b7d8d3/pkg/controller/issuers/sync.go#L61-L69\"\u003eIssuer\u0026rsquo;s Sync\u003c/a\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eIssuer\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Ready\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;False\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003ereason\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ErrorConfig\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Resource validation failed: ...\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eOpenshift uses conditions a lot but does not use the standard \u0026lsquo;Ready\u0026rsquo; type. For example, cluster-version-operators (CVO) has a \u003ca href=\"https://github.com/openshift/api/blob/b1bcdbc3/config/v1/types_cluster_operator.go#L123-L134\"\u003e\u003ccode\u003ekind: ClusterOperator\u003c/code\u003e\u003c/a\u003e with condition types \u0026lsquo;Available\u0026rsquo;, \u0026lsquo;Progressing\u0026rsquo;, \u0026lsquo;Degraded\u0026rsquo; and \u0026lsquo;Upgradeable\u0026rsquo;.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eHyperconverged Cluster Operator (HCO) uses conditions but in a slightly different way that cert-manager or openshift does. Each condition is set by a different component\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIt\u0026rsquo;s important to point out that the Condition types on the HCO don\u0026rsquo;t represent the condition the HCO is in, rather the condition of the component CRs.\u003c/p\u003e\u003c/blockquote\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eGardener also uses conditions, and like Openshift, it doesn\u0026rsquo;t rely on the standard \u0026lsquo;Ready\u0026rsquo; type. For example, the \u003ca href=\"https://github.com/gardener/gardener/blob/161695ada/pkg/apis/core/v1alpha1/types_controllerinstallation.go\"\u003e\u003ccode\u003ekind: ControllerInstallation\u003c/code\u003e\u003c/a\u003e has conditions types \u0026lsquo;Valid\u0026rsquo; and \u0026lsquo;Installed\u0026rsquo;.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWe see a lot of variance across projects. In late 2017, we saw some uncertainty about Conditions disappearing. In the remaining of this post, I will try to give answers as to why you should use conditions and how to do so.\u003c/p\u003e\n\u003ch2 id=\"conditions-vs-state-machine\"\u003eConditions vs. State machine\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://github.com/kubernetes/community/blob/4c9ef2d/contributors/devel/sig-architecture/api-conventions.md\"\u003eapi-conventions.md\u003c/a\u003e, July 2017) Conditions are observations and not, themselves, state machines.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eSo, what is the difference between a state in a state machine and an observation? A state machine has a known a fixed state. In comparison, conditions offers an \u0026lsquo;open-world\u0026rsquo; perspective with the Unknown value. For example, the status of a Pod is partly constructed by the kube-scheduler, partly by the kubelet.\u003c/p\u003e\n\u003cp\u003eBut when an object gets created, no conditions are present. What does that mean?\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://issues.k8s.io/7856#issuecomment-99657942\"\u003eTim Hockin, May 2015\u003c/a\u003e) The absence of a condition should be interpreted the same as Unknown.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eIn the end, this set of conditions are just a way of communicating changes of state between components, and this state can always be reconstructed by observing the system:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://github.com/kubernetes/community/blob/4c9ef2d/contributors/design-proposals/architecture/principles.md\"\u003eprinciples.md\u003c/a\u003e, 2015) Object status must be 100% reconstructable by observation. Any history kept (E.g., through conditions or other fields in \u0026lsquo;status\u0026rsquo;) must be just an optimization and not required for correct operation.\u003c/p\u003e\n\u003cp\u003eDo not define comprehensive state machines for objects with behaviors associated with state transitions and/or \u0026ldquo;assumed\u0026rdquo; states that cannot be ascertained by observation.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eOne last comment that explains why the Kubernetes docs don\u0026rsquo;t have any state-machine diagram:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://issues.k8s.io/24130\"\u003eTim Hockin, Apr 2016\u003c/a\u003e) This [state-machine-alike diagram representing the Pod states] is not strictly correct though, because a pod can cease to be \u0026ldquo;ready\u0026rdquo; but not die. We\u0026rsquo;ve intentionally NOT drawn this as a state-machine because conditions are really orthogonal concepts. We report a singular status as part of kubectl, so maybe we should document THAT, but it\u0026rsquo;s more complicated than this diagram captures.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"conditions-vs-events\"\u003eConditions vs. Events\u003c/h2\u003e\n\u003cp\u003eEvents are meant to save history (for non-machine consumption, i.e., for humans). The set of conditions describes the \u0026lsquo;current\u0026rsquo; state:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://issues.k8s.io/7856#issuecomment-323196033\"\u003eBrian Grant, Aug 2017\u003c/a\u003e Status, represented as conditions or otherwise, should be complementary to events pertaining to the resource. Events provide additional information for debugging and tracing, akin to log messages, but aren\u0026rsquo;t intended to be used for event-driven automation.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eIt was reminded in 2019:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://issues.k8s.io/51594#issuecomment-334646068\"\u003eKenneth Owens, Oct 2019\u003c/a\u003e) Events are used to express point in time occurrences, and Conditions are used to express the current state of an ongoing process. For instance, Pod creation is an event, Deployment progressing is a condition.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"orthogonality-vs-extensibility\"\u003eOrthogonality vs. Extensibility\u003c/h2\u003e\n\u003cp\u003eIn 2015, the Kubernetes team seemed to be attached to the idea of \u0026lsquo;orthogonality\u0026rsquo; between conditions.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://issues.k8s.io/6951#issuecomment-94203495\"\u003eDavid Oppenheimer, Apr 2015\u003c/a\u003e) To avoid confusion, Conditions should be orthogonal. The ones you suggested \u0026ndash; Instantiated, Initialized, and Terminated \u0026ndash; don\u0026rsquo;t seem to be orthogonal (in fact I would expect a pod to transition from FFF to TFF to TTF to TTT). What you\u0026rsquo;ve described sounds more like a state machine than a set of orthogonal conditions, and I think Conditions should only be used for the latter.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eIn 2017, things start to get confusing: \u003cem\u003eeach condition represents one non-orthogonal \u0026ldquo;state\u0026rdquo; of a resource\u003c/em\u003e?! Conditions are orthogonal to each other, but the states that they represent may be non-orthogonal\u0026hellip;\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://issues.k8s.io/7856#issuecomment-323196033\"\u003eBrian Grant, Aug 2017\u003c/a\u003e) Conditions were created as a way to wean contributors off of the idea of state machines with mutually exclusive states (called \u0026ldquo;phase\u0026rdquo;).\u003c/p\u003e\n\u003cp\u003eEach condition should represent a non-orthogonal \u0026ldquo;state\u0026rdquo; of a resource \u0026ndash; is the resource in that state or not (or unknown).\u003c/p\u003e\n\u003cp\u003eArbitrarily typed/structured status properties specific to a particular resource should just be status fields.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eI did not find anywhere a definition of \u0026lsquo;orthogonal condition\u0026rsquo;; my guess is that two conditions are orthogonal when they explain two uncorrelated parts of the system.\u003c/p\u003e\n\u003cp\u003eBut in 2019, the narrative seems to have changed: Brian Grant talks about \u0026rsquo;non-orthogonal \u0026amp; extensible conditions\u0026rsquo;.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://twitter.com/bgrant0607/status/1111473660479430656\"\u003eBrian Grant, Mar 2019\u003c/a\u003e) Rather than rigid fine-grained state enumerations that couldn\u0026rsquo;t be evolved, we initially adopted simple basic states that could report open-ended reasons for being in each state (\u003ca href=\"http://issues.k8s.io/1146\"\u003ehttp://issues.k8s.io/1146\u003c/a\u003e), and later non-orthogonal, extensible conditions (\u003ca href=\"http://issues.k8s.io/7856\"\u003ehttp://issues.k8s.io/7856\u003c/a\u003e).\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eOrthogonality was hard to implement anyway:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://issues.k8s.io/7856#issuecomment-325978016\"\u003eSteven E. Harris, Aug 2019\u003c/a\u003e) The burden is on the status type author to come up with dimensions that are orthogonal; that required careful thought when writing my own condition types.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eHere is what I think: you should definitely use conditions, but don\u0026rsquo;t bother with orthogonality. Just use conditions that represent important changes for the object, beginning with the \u0026lsquo;Ready\u0026rsquo; condition type. \u0026lsquo;Ready\u0026rsquo; is the strongest condition of all and indicates something 100% operational.\u003c/p\u003e\n\u003ch2 id=\"are-conditions-still-used\"\u003eAre Conditions still used?\u003c/h2\u003e\n\u003cp\u003eThere was \u003ca href=\"https://github.com/kubernetes/kubernetes/issues/7856\"\u003ean extensive discussion\u003c/a\u003e, started in 2015, about removing or keeping the \u0026ldquo;phase\u0026rdquo; field. In 2017, the same thread turned into \u0026ldquo;should we keep using conditions?\u0026rdquo;; \u003ca href=\"https://issues.k8s.io/7856#issuecomment-323196033\"\u003eBrian Grant\u003c/a\u003e found conditions cumbersome (an array is harder to deal with than top-level fields) and confusing because of the open-ended statuses (True, False, Unknown). In late 2017, Brian Grant \u003ca href=\"https://github.com/kubernetes/kubernetes/issues/7856#issuecomment-324219862\"\u003edid a survey\u003c/a\u003e and found out that conditions are still what controller authors should use. In 2019, Daniel Smith reminded us that conditions are not going away:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://issues.k8s.io/7856#issuecomment-492812566\"\u003eDaniel Smith, May 2019\u003c/a\u003e) Conditions are not going to be removed.\u003c/p\u003e\n\u003cp\u003eThe ground truth is set as conditions by the components that are nearby, e.g. kubelet sets \u0026ldquo;DiskPressure = True\u0026rdquo;.\u003c/p\u003e\n\u003cp\u003eThe set of conditions is summarized into phases (or secondary conditions) for consumption by general controllers. E.g., if there is disk pressure, that can be aggregated into \u003ccode\u003econditionSummary.schedulable: false\u003c/code\u003e. The process doing this needs to know all possible gound truth statements; the process of summarizing them isolates the rest of the cluster from needing to know this.\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch2 id=\"conditions-vs-reasons\"\u003eConditions vs. Reasons\u003c/h2\u003e\n\u003cp\u003eDo I really need to bother with this \u003ccode\u003e.status.conditions\u003c/code\u003e array, can I just use \u003ccode\u003e.status.phase\u003c/code\u003e with a simple enum? Or just a \u003ccode\u003ereason\u003c/code\u003e as part of an existing \u0026lsquo;Ready\u0026rsquo; condition?\u003c/p\u003e\n\u003cp\u003eAt first, Kubernetes would rely on many Reasons:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://github.com/kubernetes/community/blob/4c9ef2d/contributors/devel/sig-architecture/api-conventions.md\"\u003eapi-conventions.md\u003c/a\u003e, July 2017) In condition types, and everywhere else they appear in the API, \u003ccode\u003eReason\u003c/code\u003e is intended to be a one-word, CamelCase representation of the category of cause of the current status, and \u003ccode\u003eMessage\u003c/code\u003e is intended to be a human-readable phrase or sentence, which may contain specific details of the individual occurrence.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eReason\u003c/code\u003e is intended to be used in concise output, such as one-line kubectl get output, and in summarizing occurrences of causes, whereas \u003ccode\u003eMessage\u003c/code\u003e is intended to be presented to users in detailed status explanations, such as kubectl describe output.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eLater, they mode to non-orthogonal (read: may-be-corrolated conditions):\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://twitter.com/bgrant0607/status/1111473660479430656\"\u003eBrian Grant, Mar 2019\u003c/a\u003e) Rather than rigid fine-grained state enumerations that couldn\u0026rsquo;t be evolved, we initially adopted simple basic states that could report \u003ca href=\"http://issues.k8s.io/1146\"\u003eopen-ended reasons for being in each state\u003c/a\u003e (2014), and later \u003ca href=\"http://issues.k8s.io/7856\"\u003enon-orthogonal, extensible conditions\u003c/a\u003e (2017).\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eSince the Pod conditions do not have a \u0026lsquo;Reason\u0026rsquo; field (in the previous Pod example), let\u0026rsquo;s take a look at the Node conditions instead:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003ekind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eNode\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eDiskPressure\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;False\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003ereason\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eKubeletHasNoDiskPressure\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ekubelet has no disk pressure\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003elastHeartbeatTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2019-11-17T14:18:26Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003elastTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2019-10-22T16:27:53Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eReady\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;True\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003ereason\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eKubeletReady\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003emessage\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ekubelet is posting ready status. AppArmor enabled\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003elastHeartbeatTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2019-11-17T14:18:26Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003elastTransitionTime\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;2019-10-22T16:27:53Z\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHere, the \u0026lsquo;Ready\u0026rsquo; condition type has an additional \u0026lsquo;Reason\u0026rsquo; field that gives the user more information about the transition. The Reason field is sometimes used by other components: for example, \u003ccode\u003ePodReasonUnschedulable\u003c/code\u003e is a reason of the \u003ccode\u003ePodSchedulable\u003c/code\u003e condition type. This reason is set by the kube-scheduler and is \u0026lsquo;consumed\u0026rsquo; by the kubelet (or the reverse, I can\u0026rsquo;t really tell).\u003c/p\u003e\n\u003cp\u003eSo, Reason of another condition or Condition? If you feel that this state might be interesting to the rest of the system, then use a proper Condition.\u003c/p\u003e\n\u003cp\u003eRegarding the \u0026lsquo;phase\u0026rsquo; top-level field, I would recommend to offer it to your users when the conditions alone cannot help them answer questions such as \u003cem\u003ehas my pod terminated?\u003c/em\u003e.\u003c/p\u003e\n\u003ch2 id=\"how-many-conditions\"\u003eHow many conditions?\u003c/h2\u003e\n\u003cp\u003eIf you think that the \u0026lsquo;Errored\u0026rsquo; state can be useful for other components or the user (e.g. \u003ccode\u003ekubectl wait --for=condition=errored\u003c/code\u003e), then add it. If you think it is important for other components or for the user to know that something is in progress, go ahead and add a \u0026lsquo;InProgress\u0026rsquo; condition.\u003c/p\u003e\n\u003cp\u003eRegarding the naming of condition types, here is some advice:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://github.com/kubernetes/community/blob/4c9ef2d/contributors/devel/sig-architecture/api-conventions.md\"\u003eapi-conventions.md\u003c/a\u003e, July 2017) Condition types should indicate state in the \u0026ldquo;abnormal-true\u0026rdquo; polarity. For example, if the condition indicates when a policy is invalid, the \u0026ldquo;is valid\u0026rdquo; case is probably the norm, so the condition should be called \u0026ldquo;Invalid\u0026rdquo;.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eAlso, remember that these types are part of your API and you should keep in mind that they require maintaining backwards- and forwards-compatibility. Adding a new condition is not free: you must maintain them over time.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e(\u003ca href=\"https://github.com/kubernetes/community/blob/4c9ef2d/contributors/devel/sig-architecture/api-conventions.md\"\u003eapi-conventions.md\u003c/a\u003e, July 2017) The meaning of a Condition can not be changed arbitrarily - it becomes part of the API, and has the same backwards- and forwards-compatibility concerns of any other part of the API.\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eConditions are also a clean way of letting third-party components (such as the cluster-api controller) to add their own \u0026rsquo;named\u0026rsquo; conditions to an existing object, e.g. to a Pod (see \u003ca href=\"https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-readiness-gate\"\u003epod-readiness-gate\u003c/a\u003e):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-yaml\" data-lang=\"yaml\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nt\"\u003eKind\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003ePod\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003espec\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003ereadinessGates\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003econditionType\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;www.example.com/feature-1\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e  \u003c/span\u003e\u003cspan class=\"nt\"\u003econditions\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"l\"\u003eReady\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# this is a builtin PodCondition\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;False\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e    \u003c/span\u003e- \u003cspan class=\"nt\"\u003etype\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;www.example.com/feature-1\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"c\"\u003e# an extra PodCondition\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e      \u003c/span\u003e\u003cspan class=\"nt\"\u003estatus\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;False\u0026#34;\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c!--\nDiscussion is happening here:\n\n\u003cblockquote class=\"twitter-tweet\"\u003e\u003cp lang=\"en\" dir=\"ltr\"\u003eKubernetes custom controllers are awesome, CRDs are great! Still, these Conditions are confusing: is it meant for the user, and what about that \u0026#39;phase\u0026#39; thing?\u003cbr\u003e\u003cbr\u003eHere is my attempt at understanding all that 😅\u003ca href=\"https://t.co/CllGBXtd70\"\u003ehttps://t.co/CllGBXtd70\u003c/a\u003e\u003c/p\u003e\u0026mdash; Maël Valais (@maelvls) \u003ca href=\"https://twitter.com/maelvls/status/1195058503695642627?ref_src=twsrc%5Etfw\"\u003eNovember 14, 2019\u003c/a\u003e\u003c/blockquote\u003e\n\u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e\n\n\n--\u003e\n\u003cp\u003e\u003cstrong\u003eUpdate 20 Dec 2021:\u003c/strong\u003e Xiang Yuxuan kindly nudged me about the fact that I was was saying that the 2017 thread was talking about removing conditions, but it was initially to remove the \u0026lsquo;phase\u0026rsquo; field.\u003c/p\u003e\n","date":1573516800,"description":"Although progress is being made, Kubernetes controllers and operators still require prior knowledge about Kubernetes internals. Information on how to set the status is scattered across comments, issues, PRs and the Kubernetes code itself. Conditions may be a good solution for your controller, but for what?","dir":"2019/kubernetes-conditions/","expirydate":-62135596800,"fuzzywordcount":2500,"images":["kubernetes-conditions/cover-kubernetes-conditions.png"],"keywords":null,"kind":"page","lang":"en","lastmod":1573516800,"objectID":"549ab9bc074dfc4bc6f90cb356030275","permalink":"https://maelvls.dev/do-not-share-yet/kubernetes-conditions/","publishdate":"2019-11-12T00:00:00Z","readingtime":12,"relpermalink":"/do-not-share-yet/kubernetes-conditions/","section":"2019","summary":"\u003cp\u003eWhile building a Kubernetes controller using CRDs, I stumbled across \u0026lsquo;conditions\u0026rsquo; in the status field. What are conditions and how should I implement them in my controller?\u003c/p\u003e\n\u003cp\u003eIn this post, I will explain what \u0026lsquo;status conditions\u0026rsquo; are in Kubernetes and show how they can be used in your own controllers.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eTable of contents:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"#pod-example\"\u003ePod example\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#what-other-projects-do\"\u003eWhat other projects do\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#conditions-vs-state-machine\"\u003eConditions vs. State machine\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#conditions-vs-events\"\u003eConditions vs. Events\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#orthogonality-vs-extensibility\"\u003eOrthogonality vs. Extensibility\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#are-conditions-still-used\"\u003eAre Conditions still used?\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#conditions-vs-reasons\"\u003eConditions vs. Reasons\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#how-many-conditions\"\u003eHow many conditions?\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003cp\u003eIn the following, a \u0026lsquo;component\u0026rsquo; is considered to be one sync loop. A sync loop (also called reconciliation loop) is what must be done in order to synchronize the \u0026lsquo;desired state\u0026rsquo; with the \u0026lsquo;observed state\u0026rsquo;.\u003c/p\u003e","tags":["kubernetes","go","controller"],"title":"What the heck are Conditions in Kubernetes controllers?","type":"2019","url":"https://maelvls.dev/do-not-share-yet/kubernetes-conditions/","weight":0,"wordcount":2453},{"authors":null,"categories":null,"content":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcpdump -i eth0 -U -w - \u003cspan class=\"s1\"\u003e\u0026#39;not port 22\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e wireshark -k -i -\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewireshark -i en9 -k -Y \u003cspan class=\"s2\"\u003e\u0026#34;ip.addr == 35.211.248.124 \u0026amp;\u0026amp; tcp.port == 22\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -v 35.211.248.124 \u003cspan class=\"m\"\u003e22\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1572998400,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1572998400,"objectID":"816d1b0fce34170c356a8b4578449983","permalink":"https://maelvls.dev/do-not-share-yet/notes/wireshark/","publishdate":"2019-11-06T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/wireshark/","section":"notes","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcpdump -i eth0 -U -w - \u003cspan class=\"s1\"\u003e\u0026#39;not port 22\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e wireshark -k -i -\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewireshark -i en9 -k -Y \u003cspan class=\"s2\"\u003e\u0026#34;ip.addr == 35.211.248.124 \u0026amp;\u0026amp; tcp.port == 22\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003enc -v 35.211.248.124 \u003cspan class=\"m\"\u003e22\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[],"title":"Stuff about Wireshark","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/wireshark/","weight":0,"wordcount":30},{"authors":null,"categories":null,"content":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#difference-between-ca-and-cert\"\u003eDifference between CA and cert\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#ssh-authentication-themes\"\u003eSsh authentication themes\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#case-a-unknown-host\"\u003eCase A: unknown host\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#case-b-host-already-in-known_host-but-ip-changed\"\u003eCase B: host already in known_host but ip changed\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#case-c-host-already-known-ipfqdn-in-sshknown_hosts\"\u003eCase C: host already known (ip/fqdn in \u003ccode\u003e~/.ssh/known_hosts\u003c/code\u003e)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#case-d-host-has-clients-pub-key-in-authorized_keys\"\u003eCase D: host has client\u0026rsquo;s pub key in authorized_keys\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#ssh--certificates\"\u003eSsh + certificates\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#reason-why-ssh-host-cmd-not-using-bashrcloginzshrc\"\u003eReason why \u003ccode\u003essh host cmd\u003c/code\u003e not using .bashrc/.login/.zshrc\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#passwordless-connexion-to-a-server\"\u003ePasswordless connexion to a server\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#glossary\"\u003eGlossary\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eWARNING:\u003c/strong\u003e many things in this memo are wrong or very wrong. Do not take any of it as good information.\u003c/p\u003e\n\u003ch2 id=\"difference-between-ca-and-cert\"\u003eDifference between CA and cert\u003c/h2\u003e\n\u003cp\u003eThese confusing names (CA cert, client cert, cert key\u0026hellip;) are due to the fact that you need 4 keys in order to have two parties communicate:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-----------+                                   +-----------+\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|           |-------what\u0026#39;s your ca-cert?-------\u0026gt;|           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|           |                                   |           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|  client   |\u0026lt;------------ca-cert-------------- |  server   |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|           |                                   |           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e|           |------let\u0026#39;s use this sym key-----\u0026gt; |           |\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e+-----------+                                   +-----------+\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003col\u003e\n\u003cli\u003eca-cert is the server pub key that is offered to the client\u003c/li\u003e\n\u003cli\u003ecert (or client-cert) is the client pub key which allows\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eFrom \u003ca href=\"https://docs.gitlab.com/runner/configuration/advanced-configuration.html\"\u003ehttps://docs.gitlab.com/runner/configuration/advanced-configuration.html\u003c/a\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003etls-ca-file certificates is a pub key that is used to \u003cstrong\u003everify\u003c/strong\u003e the remote peer.\u003c/li\u003e\n\u003cli\u003etls-cert-file certificate to \u003cstrong\u003eauthenticate\u003c/strong\u003e with the remote peer\u003c/li\u003e\n\u003cli\u003etls-key-file private key to authenticate with the remote peer\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSo:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ea \u003cstrong\u003eCA\u003c/strong\u003e is a certificate of authority. Example: AlphaSSL CA - SHA256 - G2. I will define a certificate of authority as a certificate that is a root CA (i.e., it is installed in browsers and /etc/ssl) or a sub-CA, i.e., any certificate signed by a root CA.\u003c/li\u003e\n\u003cli\u003ea \u003cstrong\u003ecert\u003c/strong\u003e is a certificate\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ssh-authentication-themes\"\u003eSsh authentication themes\u003c/h2\u003e\n\u003ch3 id=\"case-a-unknown-host\"\u003eCase A: unknown host\u003c/h3\u003e\n\u003cp\u003e\u0026mdash; everything in plain text\u0026mdash;\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: hi server, can you send mme your public key?\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSERVER\u003c/strong\u003e: sure, here you go.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: (Hmm\u0026hellip; should I trust this pub key? This pub key isn\u0026rsquo;t in my \u003ccode\u003e~/.ssh/known_hosts\u003c/code\u003e. Let\u0026rsquo;s ask the user if he recognises the sha256 sum.)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHUMAN\u003c/strong\u003e: whatever I don\u0026rsquo;t care (types \u0026lsquo;yes\u0026rsquo; and enter)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: OK, SERVER, I trust you.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026mdash; only SERVER -\u0026gt; CLIENT encrypted \u0026mdash;\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eSERVER\u003c/strong\u003e: perfect. (SERVER generates a pub/priv key for this specific connexion). Take that id_rsa2.pub I just generated so that you can encrypt stuff to me.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026mdash; both ways encrypted \u0026mdash;\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: Thanks, now we can speak privatly.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"case-b-host-already-in-known_host-but-ip-changed\"\u003eCase B: host already in known_host but ip changed\u003c/h3\u003e\n\u003cp\u003e\u0026mdash; plain text \u0026mdash;\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: Hi SERVER, I don\u0026rsquo;t know you (i.e., I don\u0026rsquo;t have this ip/fqhn in my \u003ccode\u003e~/.ssh/known_hosts\u003c/code\u003e), can you send me your pub key?\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSERVER\u003c/strong\u003e: Sure, here you go.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: (Should I trust him? Oh wait, this pub key already exists in my known hosts! But with a different IP!!! Tell the user to do something)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHUMAN\u003c/strong\u003e: Oh crap, why is ssh throwing this error. Let\u0026rsquo;s remove this faulty line from \u003ccode\u003e~/.ssh/known_hosts\u003c/code\u003e!\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNow, we can go to Case B.\u003c/p\u003e\n\u003ch3 id=\"case-c-host-already-known-ipfqdn-in-sshknown_hosts\"\u003eCase C: host already known (ip/fqdn in \u003ccode\u003e~/.ssh/known_hosts\u003c/code\u003e)\u003c/h3\u003e\n\u003cp\u003e\u0026mdash; only CLIENT -\u0026gt; SERVER encrypted \u0026mdash;\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: Hi again, SERVER. Can you give me a new pub key so that I can tell you stuff secretely?\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSERVER\u003c/strong\u003e: Sure, here you go.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026mdash; both ways encrypted\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: Perfect.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: (Oh! I know this host, lets use the pub key in known_hosts)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"case-d-host-has-clients-pub-key-in-authorized_keys\"\u003eCase D: host has client\u0026rsquo;s pub key in authorized_keys\u003c/h3\u003e\n\u003cp\u003e\u0026mdash; plain text \u0026mdash;\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: Hi, SERVER, remember me?\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026mdash; only SERVER -\u0026gt; CLIENT encrypted \u0026mdash;\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eSERVER\u003c/strong\u003e: (Oh, I know this gay as I have his pub key in my \u003ccode\u003eauthorized_keys\u003c/code\u003e) I guess we can speak privately from now on! Here is a generated a pub key so that you can talk to me privatly!\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u0026mdash; both ways encrypted \u0026mdash;\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCLIENT\u003c/strong\u003e: perfect.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ssh--certificates\"\u003eSsh + certificates\u003c/h2\u003e\n\u003cp\u003eMy take on that:\u003c/p\u003e\n\u003cp\u003eAs we saw in [#case-a-unknown-host], the client has a very basic and quite dumb way of guessing wether or not the server should be trusted: it asks the user if he recognises/trusts the sha256sum of the public key! Here is an example of prompt:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; ssh 123.10.9.23\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eRSA key fingerprint is 96:a9:23:5c:cc:d1:0a:d4:70:22:93:e9:9e:1e:74:2f.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eAre you sure you want to \u003cspan class=\"k\"\u003econtinue\u003c/span\u003e connecting \u003cspan class=\"o\"\u003e(\u003c/span\u003eyes/no\u003cspan class=\"o\"\u003e)\u003c/span\u003e? yes\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNaturally, no one is checking and it is practically impossible to enforce trust in production servers. Users should not be expected to check wether a public key is valid or not, and most importantly, requiring a human prevents automation.\u003c/p\u003e\n\u003cp\u003eThe trick is to use the same system as for standard HTTPS: a chain of trust based on certification entities. A trusted entity will sign the public key so that \u003ccode\u003essh\u003c/code\u003e will be able to check by himself (if root certificates are installed, obviously).\u003c/p\u003e\n\u003cp\u003eNOTE : the root certificate is simple public key (in the gpg sense, not the ssh one) that allows people to check if the signed version (the signature, called \u0026lsquo;certificate\u0026rsquo;) of a public key (i.e., the result of the root entity using his private key to sign the public key of someone else) matches. To sum up,\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e[creating certificate] the root entity creates a signature file (called certificate) using his private key to sign the public key of entity B\u003c/li\u003e\n\u003cli\u003e[checking certificate] a client that wants to check if the pub key of entity B can be trusted will use the public key of the root entity (CA file? pem/crt file?) and will know if the signature of the pub key (= certificate) matches the public key itself (or something like that).\u003c/li\u003e\n\u003cli\u003e[deploying certificate] now, how to make sure every client that wants to connect to entoty B has the pub key of the root entity? These pub keys must be installed somewhere: in /etc/ssl/certs for example.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"reason-why-ssh-host-cmd-not-using-bashrcloginzshrc\"\u003eReason why \u003ccode\u003essh host cmd\u003c/code\u003e not using .bashrc/.login/.zshrc\u003c/h2\u003e\n\u003cp\u003eSee: \u003ca href=\"https://superuser.com/questions/1224938/ssh-host-is-a-login-shell-but-ssh-host-command-is-not\"\u003ehttps://superuser.com/questions/1224938/ssh-host-is-a-login-shell-but-ssh-host-command-is-not\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003essh is using a non-login, non-interactive shell, meaning that\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e.login (for login shell) .bashrc, .zshrc (interactive shell) are not called. In order to have some environment set, I have to use .zshenv (which is called before anything and in any case)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"passwordless-connexion-to-a-server\"\u003ePasswordless connexion to a server\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ ssh-keygen -t rsa -b \u003cspan class=\"m\"\u003e4096\u003c/span\u003e -C \u003cspan class=\"s2\"\u003e\u0026#34;mael.valais@gmail.com\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essh-copy-id -i ~/.ssh/id_rsa.pub \u0026lt;remote_server\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"glossary\"\u003eGlossary\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003efqdn\u003c/strong\u003e: fully-quallified domain name, e.g., dl.bintray.com\u003c/li\u003e\n\u003c/ul\u003e\n","date":1559001600,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":1000,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1559001600,"objectID":"4818b08d0ace8454823dd206915d937d","permalink":"https://maelvls.dev/do-not-share-yet/notes/ssh/","publishdate":"2019-05-28T00:00:00Z","readingtime":5,"relpermalink":"/do-not-share-yet/notes/ssh/","section":"notes","summary":"\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#difference-between-ca-and-cert\"\u003eDifference between CA and cert\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#ssh-authentication-themes\"\u003eSsh authentication themes\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#case-a-unknown-host\"\u003eCase A: unknown host\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#case-b-host-already-in-known_host-but-ip-changed\"\u003eCase B: host already in known_host but ip changed\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#case-c-host-already-known-ipfqdn-in-sshknown_hosts\"\u003eCase C: host already known (ip/fqdn in \u003ccode\u003e~/.ssh/known_hosts\u003c/code\u003e)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#case-d-host-has-clients-pub-key-in-authorized_keys\"\u003eCase D: host has client\u0026rsquo;s pub key in authorized_keys\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#ssh--certificates\"\u003eSsh + certificates\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#reason-why-ssh-host-cmd-not-using-bashrcloginzshrc\"\u003eReason why \u003ccode\u003essh host cmd\u003c/code\u003e not using .bashrc/.login/.zshrc\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#passwordless-connexion-to-a-server\"\u003ePasswordless connexion to a server\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#glossary\"\u003eGlossary\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eWARNING:\u003c/strong\u003e many things in this memo are wrong or very wrong. Do not take any of it as good information.\u003c/p\u003e","tags":[],"title":"How client-server SSH authentication works","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/ssh/","weight":0,"wordcount":972},{"authors":null,"categories":null,"content":"\u003cp\u003eFrom: \u003ca href=\"https://apple.stackexchange.com/questions/220670/run-boot-camp-windows10-partition-inside-virtualbox\"\u003ehttps://apple.stackexchange.com/questions/220670/run-boot-camp-windows10-partition-inside-virtualbox\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFirst, find which disks are EFI and BOOTCAMP with \u003ccode\u003ediskutil list\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ediskutil list\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ediskutil unmount /Volumes/BOOTCAMP\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo chmod \u003cspan class=\"m\"\u003e777\u003c/span\u003e /dev/disk0s1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo chmod \u003cspan class=\"m\"\u003e777\u003c/span\u003e /dev/disk0s3\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo VBoxManage internalcommands createrawvmdk -rawdisk /dev/disk0 -filename win10raw.vmdk -partitions 1,3\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUncheck \u0026ldquo;Enable EFI\u0026rdquo;, uncheck \u0026ldquo;Enable VT-x/AMD-V\u0026rdquo;\u003c/p\u003e\n","date":1555718400,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1555718400,"objectID":"4df8e28d2aaa71f0d9e10b1aadf0b6a7","permalink":"https://maelvls.dev/do-not-share-yet/notes/bootcamp_vm/","publishdate":"2019-04-20T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/bootcamp_vm/","section":"notes","summary":"\u003cp\u003eFrom: \u003ca href=\"https://apple.stackexchange.com/questions/220670/run-boot-camp-windows10-partition-inside-virtualbox\"\u003ehttps://apple.stackexchange.com/questions/220670/run-boot-camp-windows10-partition-inside-virtualbox\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFirst, find which disks are EFI and BOOTCAMP with \u003ccode\u003ediskutil list\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ediskutil list\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ediskutil unmount /Volumes/BOOTCAMP\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo chmod \u003cspan class=\"m\"\u003e777\u003c/span\u003e /dev/disk0s1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo chmod \u003cspan class=\"m\"\u003e777\u003c/span\u003e /dev/disk0s3\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo VBoxManage internalcommands createrawvmdk -rawdisk /dev/disk0 -filename win10raw.vmdk -partitions 1,3\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUncheck \u0026ldquo;Enable EFI\u0026rdquo;, uncheck \u0026ldquo;Enable VT-x/AMD-V\u0026rdquo;\u003c/p\u003e","tags":[],"title":"Use the Bootcamp partition under VirtualBox","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/bootcamp_vm/","weight":0,"wordcount":42},{"authors":null,"categories":null,"content":"\u003cp\u003eI know two main ways of using OAuth2\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003epassword-based client grant (2-leg oauth flow: on the project I worked on, the OAuth client was not third party server, but instead, it was the front-end.)\u003c/li\u003e\n\u003cli\u003eauthorization code based grant (3-legs oauth flow)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"what-is-the-client\"\u003eWhat is \u0026ldquo;the client\u0026rdquo;?\u003c/h2\u003e\n\u003cp\u003eThe \u003ca href=\"https://tools.ietf.org/html/rfc6749\"\u003eRFC 6749\u003c/a\u003e that presents OAuth2 is very readable, but some terms like \u0026ldquo;client\u0026rdquo; or \u0026ldquo;code\u0026rdquo; are confusing. What I found is that trying to understand \u0026ldquo;why\u0026rdquo; the main flow (3-legged oauth, or \u0026ldquo;authorization code flow\u0026rdquo;) has to be like this.\u003c/p\u003e\n\u003cp\u003eThe most important aspect that I had to realize is that \u0026ldquo;client\u0026rdquo; is hidden from the end-user (e.g. as a nodejs server serving /callback). The \u0026ldquo;client\u0026rdquo; has a single purpose: receive the code when /callback is called by the third-party Authorize screen, POST /token to the third party using the \u003ccode\u003eclient_secret\u003c/code\u003e using that code.\u003c/p\u003e\n\u003ch2 id=\"authorization-code-3-legged-oauth\"\u003eAuthorization code (3 legged oauth)\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eUser clicks the \u0026ldquo;Login with Google\u0026rdquo;; this URL is public and forwards the user to an \u0026ldquo;Authorize\u0026rdquo; form.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003eGET\u003c/span\u003e \u003cspan class=\"nn\"\u003e/o/oauth2/auth?client_id=foo\u0026amp;redirect_uri=http%3A%2F%2Flocalhost%3A8042%2Fcallback\u0026amp;response_type=code\u0026amp;scope=calendar.readonly\u0026amp;state=something\u003c/span\u003e \u003cspan class=\"kr\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eHost\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"l\"\u003ehttps://accounts.google.com\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eSince this URL is quite long, let\u0026rsquo;s see what we have:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eaccess_type\u003c/code\u003e is \u003ccode\u003eoffline\u003c/code\u003e (huh??)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eclient_id\u003c/code\u003e (remember that the \u0026ldquo;client\u0026rdquo; is my CLI which asks the permission to Google\u0026rsquo;s servers to access the scopes.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eredirect_uri\u003c/code\u003e is \u003ca href=\"http://localhost:8042/oauth2\"\u003ehttp://localhost:8042/oauth2\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eresponse_type\u003c/code\u003e is \u003ccode\u003ecode\u003c/code\u003e which makes sense since we want a code so that we can, eventually, get a token. The \u003ccode\u003ecode\u003c/code\u003e and \u003ccode\u003estate\u003c/code\u003e values will be given to us in the callback. When pressing \u0026ldquo;Authorize\u0026rdquo; in the Google authentication page, we get something like:\u003c/li\u003e\n\u003c/ul\u003e\n\u003col start=\"2\"\u003e\n\u003cli\u003e\n\u003cp\u003eAfter authorizing, the user is redirected to the \u0026ldquo;client\u0026rdquo; endpoint:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003eGET\u003c/span\u003e \u003cspan class=\"nn\"\u003e/callback?code=f1a2bc\u0026amp;state=something\u0026amp;state=foo\u003c/span\u003e \u003cspan class=\"kr\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eHost\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"l\"\u003ehttp://localhost:8042\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eResponse is\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe client gets the token using the code it received.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-http\" data-lang=\"http\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nf\"\u003ePOST\u003c/span\u003e \u003cspan class=\"nn\"\u003e/token\u003c/span\u003e \u003cspan class=\"kr\"\u003eHTTP\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e1.1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eHost\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"l\"\u003ehttps://oauth2.googleapis.com\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eContent-Type\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"l\"\u003eapplication/x-www-form-urlencoded\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egrant_type=authorization_code\u0026amp;code=f1a2bc\u0026amp;client_id=foo\u0026amp;client_secret=\u0026lt;the_secret\u0026gt;\u0026amp;redirect_url=\u0026lt;same as above\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe token looks like this:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-json\" data-lang=\"json\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;access_token\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ya29.a0AfH6SMCkF6Kd0bZPf60Knhq8XyMKTgmQ6zE5lP9pjdZfW-9ebV5V9wifFagdiioN5JWovHmfVfdukAE0-jcHRmjzsycQCYPj7zzSup55X0n_gz8rkglYGBaeG5Tyde8a8rAIu1CimhtSdsoq0_HCh2VBXOLmrq7oKSg\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;token_type\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Bearer\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;refresh_token\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1//03E6r0qdOHKqrCgYIARAAGAMSNwF-L9Ir37zr9-GH8po_A5XSwsSiEw8XmiHPnCbKPaFHNCckIF-vmJRRKddbjWLbX9ZrbOzffts\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nt\"\u003e\u0026#34;expiry\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;2020-07-21T19:26:47.346143+02:00\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote: when we say \u0026ldquo;an oauth token\u0026rdquo;, what we actually mean is the access token the refresh token.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n","date":1550361600,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":400,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1550361600,"objectID":"6a3ebbb76a77eb586c863984496eb01d","permalink":"https://maelvls.dev/do-not-share-yet/notes/oauth/","publishdate":"2019-02-17T00:00:00Z","readingtime":2,"relpermalink":"/do-not-share-yet/notes/oauth/","section":"notes","summary":"\u003cp\u003eI know two main ways of using OAuth2\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003epassword-based client grant (2-leg oauth flow: on the project I worked on, the OAuth client was not third party server, but instead, it was the front-end.)\u003c/li\u003e\n\u003cli\u003eauthorization code based grant (3-legs oauth flow)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"what-is-the-client\"\u003eWhat is \u0026ldquo;the client\u0026rdquo;?\u003c/h2\u003e\n\u003cp\u003eThe \u003ca href=\"https://tools.ietf.org/html/rfc6749\"\u003eRFC 6749\u003c/a\u003e that presents OAuth2 is very readable, but some terms like \u0026ldquo;client\u0026rdquo; or \u0026ldquo;code\u0026rdquo; are confusing. What I found is that trying to understand \u0026ldquo;why\u0026rdquo; the main flow (3-legged oauth, or \u0026ldquo;authorization code flow\u0026rdquo;) has to be like this.\u003c/p\u003e","tags":[],"title":"Notes on OAuth","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/oauth/","weight":0,"wordcount":319},{"authors":null,"categories":null,"content":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl run --generator\u003cspan class=\"o\"\u003e=\u003c/span\u003erun-pod/v1 tmp-shell --rm -i --tty --image nicolaka/netshoot -- /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud ssh ...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker ps --format\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{{.ID}} {{.Names}}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl run --generator\u003cspan class=\"o\"\u003e=\u003c/span\u003erun-pod/v1 tmp-shell --rm -i --tty --image nicolaka/netshoot -- /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables-save \u0026gt; a \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e vim a \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e sudo iptables-restore \u0026lt; a\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% mvalais@gke-august-period-micro-g961 ~ $ vmstat -SM \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e  \u003cspan class=\"m\"\u003e0\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e    \u003cspan class=\"m\"\u003e104\u003c/span\u003e      \u003cspan class=\"m\"\u003e7\u003c/span\u003e    \u003cspan class=\"m\"\u003e218\u003c/span\u003e    \u003cspan class=\"m\"\u003e0\u003c/span\u003e    \u003cspan class=\"m\"\u003e0\u003c/span\u003e   \u003cspan class=\"m\"\u003e160\u003c/span\u003e    \u003cspan class=\"m\"\u003e57\u003c/span\u003e  \u003cspan class=\"m\"\u003e273\u003c/span\u003e  \u003cspan class=\"m\"\u003e760\u003c/span\u003e  \u003cspan class=\"m\"\u003e2\u003c/span\u003e  \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"m\"\u003e96\u003c/span\u003e  \u003cspan class=\"m\"\u003e1\u003c/span\u003e  \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ek get pods -A --field-selector\u003cspan class=\"o\"\u003e=\u003c/span\u003espec.nodeName\u003cspan class=\"o\"\u003e=\u003c/span\u003egke-august-period-234610-worker-micro-1de60498-g961\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud compute ssh gke-august-period-234610-worker-micro-1de60498-g961 --zone\u003cspan class=\"o\"\u003e=\u003c/span\u003eus-east1-c --command \u003cspan class=\"s2\"\u003e\u0026#34;docker run --rm --net=host corfr/tcpdump -i cbr0 -U -w - \u0026#39;not port 22\u0026#39;\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e wireshark -k -i -\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edmsg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Host B is 10.142.15.201\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Doesn\u0026#39;t work:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#   from the pod on host B, nslookup github.com (tcpdump on pod\u0026#39;s eth0)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e      \u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e    \u003cspan class=\"n\"\u003eDNS\u003c/span\u003e \u003cspan class=\"m\"\u003e98\u003c/span\u003e \u003cspan class=\"n\"\u003eStandard\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e            \u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003egithub.com.traefik.svc.cluster.local\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#   same from host\u0026#39;s eth0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e      \u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e       \u003cspan class=\"n\"\u003eDNS\u003c/span\u003e \u003cspan class=\"m\"\u003e96\u003c/span\u003e \u003cspan class=\"n\"\u003eStandard\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e            \u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003egithub.com.traefik.svc.cluster.local\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Works:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#   from the host B, nslookup github.com 10.27.240.10 (tcpdump on host\u0026#39;s eth0)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e10.142.15.201\u003c/span\u003e   \u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e       \u003cspan class=\"n\"\u003eDNS\u003c/span\u003e \u003cspan class=\"m\"\u003e70\u003c/span\u003e \u003cspan class=\"n\"\u003eStandard\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e            \u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003egithub.com\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e       \u003cspan class=\"m\"\u003e10.142.15.201\u003c/span\u003e   \u003cspan class=\"n\"\u003eDNS\u003c/span\u003e \u003cspan class=\"m\"\u003e86\u003c/span\u003e \u003cspan class=\"n\"\u003eStandard\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e \u003cspan class=\"n\"\u003eresponse\u003c/span\u003e   \u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003egithub.com\u003c/span\u003e \u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"m\"\u003e140.82.113.4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eDumping iptables on host B:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud compute ssh gke-august-period-234610-worker-micro-1de60498-g961 --zone\u003cspan class=\"o\"\u003e=\u003c/span\u003eus-east1-c --command \u003cspan class=\"s2\"\u003e\u0026#34;docker run --rm --net=host --privileged praqma/network-multitool iptables-save\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e pbcopy\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A KUBE-HP-JSWHQ3CPP5EMKPCA -s 10.24.10.2/32 -m comment --comment \u003cspan class=\"s2\"\u003e\u0026#34;akrobateo-traefik-pqkqf_traefik hostport 443\u0026#34;\u003c/span\u003e -j KUBE-MARK-MASQ\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A KUBE-HP-JSWHQ3CPP5EMKPCA -p tcp -m comment --comment \u003cspan class=\"s2\"\u003e\u0026#34;akrobateo-traefik-pqkqf_traefik hostport 443\u0026#34;\u003c/span\u003e -m tcp -j DNAT --to-destination 10.24.10.2:443\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A KUBE-HP-Q34NV5ACWTD24LGG -s 10.24.10.2/32 -m comment --comment \u003cspan class=\"s2\"\u003e\u0026#34;akrobateo-traefik-pqkqf_traefik hostport 80\u0026#34;\u003c/span\u003e -j KUBE-MARK-MASQ\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A KUBE-HP-Q34NV5ACWTD24LGG -p tcp -m comment --comment \u003cspan class=\"s2\"\u003e\u0026#34;akrobateo-traefik-pqkqf_traefik hostport 80\u0026#34;\u003c/span\u003e -m tcp -j DNAT --to-destination 10.24.10.2:80\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eContrack:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# From the container. Since orig dst != reply src, packet is DNAT.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% nslookup github.com\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003emvalais\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003egke\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eaugust\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eperiod\u003c/span\u003e\u003cspan class=\"m\"\u003e-234610\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eworker\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003emicro\u003c/span\u003e\u003cspan class=\"m\"\u003e-1\u003c/span\u003e\u003cspan class=\"n\"\u003ede60498\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eg961\u003c/span\u003e \u003cspan class=\"o\"\u003e~\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e \u003cspan class=\"n\"\u003edocker\u003c/span\u003e \u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003enet\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003eprivileged\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003erm\u003c/span\u003e \u003cspan class=\"n\"\u003emissioncriticalkubernetes\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econntrack\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eL\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003egrep\u003c/span\u003e \u003cspan class=\"m\"\u003e10.24\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003econntrack\u003c/span\u003e \u003cspan class=\"nf\"\u003ev1.4.4 \u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003econntrack\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003etools\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"m\"\u003e52\u003c/span\u003e \u003cspan class=\"n\"\u003eflow\u003c/span\u003e \u003cspan class=\"n\"\u003eentries\u003c/span\u003e \u003cspan class=\"n\"\u003ehave\u003c/span\u003e \u003cspan class=\"n\"\u003ebeen\u003c/span\u003e \u003cspan class=\"n\"\u003eshown.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eudp\u003c/span\u003e \u003cspan class=\"m\"\u003e17\u003c/span\u003e \u003cspan class=\"m\"\u003e26\u003c/span\u003e  \u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e    \u003cspan class=\"n\"\u003edst\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e \u003cspan class=\"n\"\u003esport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57400\u003c/span\u003e \u003cspan class=\"n\"\u003edport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003e[UNREPLIED]\u003c/span\u003e \u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e \u003cspan class=\"n\"\u003edst\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e     \u003cspan class=\"n\"\u003esport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003edport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57400\u003c/span\u003e           \u003cspan class=\"n\"\u003emark\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# From host B. Since orig dst != reply src, packet is DNAT.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% nslookup github.com 10.27.240.10\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003emvalais\u003c/span\u003e\u003cspan class=\"o\"\u003e@\u003c/span\u003e\u003cspan class=\"n\"\u003egke\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eaugust\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eperiod\u003c/span\u003e\u003cspan class=\"m\"\u003e-234610\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eworker\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003emicro\u003c/span\u003e\u003cspan class=\"m\"\u003e-1\u003c/span\u003e\u003cspan class=\"n\"\u003ede60498\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eg961\u003c/span\u003e \u003cspan class=\"o\"\u003e~\u003c/span\u003e \u003cspan class=\"o\"\u003e$\u003c/span\u003e \u003cspan class=\"n\"\u003edocker\u003c/span\u003e \u003cspan class=\"n\"\u003erun\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003enet\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ehost\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003eprivileged\u003c/span\u003e \u003cspan class=\"o\"\u003e--\u003c/span\u003e\u003cspan class=\"n\"\u003erm\u003c/span\u003e \u003cspan class=\"n\"\u003emissioncriticalkubernetes\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003econntrack\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eL\u003c/span\u003e \u003cspan class=\"o\"\u003e|\u003c/span\u003e \u003cspan class=\"n\"\u003egrep\u003c/span\u003e \u003cspan class=\"m\"\u003e10.24\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eudp\u003c/span\u003e \u003cspan class=\"m\"\u003e17\u003c/span\u003e \u003cspan class=\"m\"\u003e175\u003c/span\u003e \u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.142.15.201\u003c/span\u003e \u003cspan class=\"n\"\u003edst\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e \u003cspan class=\"n\"\u003esport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e37337\u003c/span\u003e \u003cspan class=\"n\"\u003edport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e             \u003cspan class=\"n\"\u003esrc\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.26\u003c/span\u003e \u003cspan class=\"n\"\u003edst\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.142.15.201\u003c/span\u003e \u003cspan class=\"n\"\u003esport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003edport\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e37337\u003c/span\u003e \u003cspan class=\"n\"\u003e[ASSURED]\u003c/span\u003e \u003cspan class=\"n\"\u003emark\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003euse\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emvalais@gke-august-period-234610-worker-micro-1de60498-g961 ~ $ docker run -it --rm --net\u003cspan class=\"o\"\u003e=\u003c/span\u003ehost praqma/network-multitool ip route\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault via 10.142.0.1 dev eth0    proto dhcp                src 10.142.15.201 metric \u003cspan class=\"m\"\u003e1024\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault via 10.142.0.1 dev eth0    proto dhcp                                  metric \u003cspan class=\"m\"\u003e1024\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.24.10.0/24          dev cbr0    proto kernel scope link   src 10.24.10.1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.142.0.1             dev eth0    proto dhcp scope   link   src 10.142.15.201 metric \u003cspan class=\"m\"\u003e1024\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.142.0.1             dev eth0    proto dhcp scope   link                     metric \u003cspan class=\"m\"\u003e1024\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e169.254.123.0/24       dev docker0 proto kernel scope link   src 169.254.123.1 linkdown\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWhat\u0026rsquo;s very weird is that ICMP packets are properly routed:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% mvalais@gke-august-period-234610-worker-micro-1de60498-g961 ~ $ docker run --rm -it --net\u003cspan class=\"o\"\u003e=\u003c/span\u003econtainer:9e557d74b06c praqma/network-multitool bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% bash-5.0# ping 10.24.9.3\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePING 10.24.9.3 \u003cspan class=\"o\"\u003e(\u003c/span\u003e10.24.9.3\u003cspan class=\"o\"\u003e)\u003c/span\u003e 56\u003cspan class=\"o\"\u003e(\u003c/span\u003e84\u003cspan class=\"o\"\u003e)\u003c/span\u003e bytes of data.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e bytes from 10.24.9.3: \u003cspan class=\"nv\"\u003eicmp_seq\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"nv\"\u003ettl\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e \u003cspan class=\"nv\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e1.47 ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% bash-5.0# nc -v 10.24.9.21 \u003cspan class=\"m\"\u003e9000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLet\u0026rsquo;s take another pod that is on host A. It\u0026rsquo;s minio, which serves on port 10.24.9.21:9000:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebash-5.0# ping 10.24.9.21\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePING 10.24.9.21 \u003cspan class=\"o\"\u003e(\u003c/span\u003e10.24.9.21\u003cspan class=\"o\"\u003e)\u003c/span\u003e 56\u003cspan class=\"o\"\u003e(\u003c/span\u003e84\u003cspan class=\"o\"\u003e)\u003c/span\u003e bytes of data.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e bytes from 10.24.9.21: \u003cspan class=\"nv\"\u003eicmp_seq\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"nv\"\u003ettl\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e \u003cspan class=\"nv\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e1.16 ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% bash-5.0# nc -v 10.24.9.21 \u003cspan class=\"m\"\u003e9000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThen I found out that host B has a \u0026lsquo;stale kube dns\u0026rsquo;:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emvalais@gke-august-period-234610-worker-micro-1de60498-g961 ~ $ tail /var/log/kube-proxy.log\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0125 12:30:37.882376       \u003cspan class=\"m\"\u003e1\u003c/span\u003e service.go:334\u003cspan class=\"o\"\u003e]\u003c/span\u003e Updating existing service port \u003cspan class=\"s2\"\u003e\u0026#34;traefik/traefik:http\u0026#34;\u003c/span\u003e at 10.27.244.111:80/TCP\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eI0125 12:31:35.093785       \u003cspan class=\"m\"\u003e1\u003c/span\u003e proxier.go:675\u003cspan class=\"o\"\u003e]\u003c/span\u003e Stale udp service kube-system/kube-dns:dns -\u0026gt; 10.27.240.10\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, let\u0026rsquo;s trace in iptables on host B: \u003ca href=\"https://www.opsist.com/blog/2015/08/11/how-do-i-see-what-iptables-is-doing.html\"\u003ehttps://www.opsist.com/blog/2015/08/11/how-do-i-see-what-iptables-is-doing.html\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% sudo iptables -t nat -I PREROUTING \u003cspan class=\"m\"\u003e1\u003c/span\u003e -j LOG\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% sudo iptables -t nat -I POSTROUTING \u003cspan class=\"m\"\u003e1\u003c/span\u003e -j LOG\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% sudo iptables -t nat -I OUTPUT \u003cspan class=\"m\"\u003e1\u003c/span\u003e -j LOG\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% demsg -w\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e89712.445268\u003cspan class=\"o\"\u003e]\u003c/span\u003e                                                 \u003cspan class=\"nv\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ecbr0 \u003cspan class=\"nv\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e                                                     \u003cspan class=\"nv\"\u003ePHYSILEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"nv\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0x00 \u003cspan class=\"nv\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0x00 \u003cspan class=\"nv\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"nv\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e38810\u003c/span\u003e \u003cspan class=\"nv\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eUDP \u003cspan class=\"nv\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e54407\u003c/span\u003e \u003cspan class=\"nv\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"nv\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e89712.463153\u003cspan class=\"o\"\u003e]\u003c/span\u003e                                                 \u003cspan class=\"nv\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ecbr0 \u003cspan class=\"nv\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e                                                     \u003cspan class=\"nv\"\u003ePHYSILEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"nv\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0x00 \u003cspan class=\"nv\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0x00 \u003cspan class=\"nv\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"nv\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e38810\u003c/span\u003e \u003cspan class=\"nv\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eUDP \u003cspan class=\"nv\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e54407\u003c/span\u003e \u003cspan class=\"nv\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"nv\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e89712.481021\u003cspan class=\"o\"\u003e]\u003c/span\u003e                                                 \u003cspan class=\"nv\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003ecbr0 \u003cspan class=\"nv\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e                                                     \u003cspan class=\"nv\"\u003ePHYSILEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"nv\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0x00 \u003cspan class=\"nv\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0x00 \u003cspan class=\"nv\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"nv\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e38810\u003c/span\u003e \u003cspan class=\"nv\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eUDP \u003cspan class=\"nv\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e54407\u003c/span\u003e \u003cspan class=\"nv\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"nv\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e89712.498895\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"nv\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eeth0                                                     \u003cspan class=\"nv\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eveth4a3719bc \u003cspan class=\"nv\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e10.24.10.2 \u003cspan class=\"nv\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e10.24.9.10    \u003cspan class=\"nv\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"nv\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0x00 \u003cspan class=\"nv\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0x00 \u003cspan class=\"nv\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"nv\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e38810\u003c/span\u003e \u003cspan class=\"nv\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eUDP \u003cspan class=\"nv\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e54407\u003c/span\u003e \u003cspan class=\"nv\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"nv\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLet\u0026rsquo;s try again with the TRACE module:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% sudo modprobe ipt_LOG\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003esudo\u003c/span\u003e \u003cspan class=\"n\"\u003eiptables\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eI\u003c/span\u003e \u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"m\"\u003e10.24.0.0\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e16\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% docker run --rm -it --net=container:9e557d74b06c --privileged praqma/network-multitool nslookup github.com\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003edmesg\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ew\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.179725]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                  \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.200327]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e               \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.221171]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.241576]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSERVICES\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e14\u003c/span\u003e                \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.262385]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSVC\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eTCOU7JCQXEZGVUNU\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e     \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.284116]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSEP\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eMQYG7Z5PYI3N6YFY\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e     \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e  \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.305838]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                  \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.326491]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.346973]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e             \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.368068]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.389031]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSERVICES\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e            \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.410253]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.430735]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eDOCKER\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eUSER\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e              \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.451887]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.472366]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eDOCKER\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eISOLATION\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSTAGE\u003c/span\u003e\u003cspan class=\"m\"\u003e-1\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.494488]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e                   \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.515049]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e              \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.531693]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                   \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.547953]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e            \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.564769]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                   \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.580978]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eIP\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eMASQ\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                       \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[90332.596840]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e                 \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth4a3719bc\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e     \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e43592\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e36775\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote that using TRACE is extremely expensive. For example, using \u003ccode\u003e-p icmp\u003c/code\u003e would result in pings going from 1ms (without tracing) to 500ms. I also overloaded one of the nodes by adding a rule that was \u0026ldquo;too wide\u0026rdquo; and nearly killed the entire node. Use tracing filters (\u003ccode\u003e-s\u003c/code\u003e, \u003ccode\u003e-p\u003c/code\u003e, \u003ccode\u003e-d\u003c/code\u003e) as narrow as possible!\u003c/p\u003e\n\u003ch2 id=\"other-experiment-icmp\"\u003eOther experiment: icmp\u003c/h2\u003e\n\u003cp\u003eAt this point, I recreated both nodes which changed all the IP CIDRs.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eHost A CIDR is \u003ccode\u003e10.24.9.0/24\u003c/code\u003e,\u003c/li\u003e\n\u003cli\u003eHost B CIDR is \u003ccode\u003e10.24.11.0/24\u003c/code\u003e,\u003c/li\u003e\n\u003cli\u003eWe use the traefik pod (\u003ccode\u003e10.24.11.7\u003c/code\u003e) on host B for reproducing the connectivity issue.\u003c/li\u003e\n\u003cli\u003eKubeDNS is running on \u003ccode\u003e10.24.9.14\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eHost B:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% docker run --rm -it --net=container:$(docker ps | grep POD_traefik | head -1 | cut -f1 -d\u0026#39; \u0026#39;) --privileged praqma/network-multitool ping 10.24.9.14\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003esudo\u003c/span\u003e \u003cspan class=\"n\"\u003eiptables\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"n\"\u003eicmp\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"m\"\u003e10.24.11.0\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e24\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% sudo iptables -A PREROUTING -p icmp -t raw -d 10.24.11.0/24 -j TRACE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003edmesg\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ew\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5365.769471\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e     \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5365.790765\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e  \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5365.812684\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e     \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5365.834225\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e       \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5365.855880\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e  \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5365.877624\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHost A (that\u0026rsquo;s where KubeDNS\u0026rsquo; \u003ccode\u003e10.24.9.14\u003c/code\u003e is):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% sudo iptables -A PREROUTING -p icmp -t raw -s 10.24.11.0/24 -j TRACE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003esudo\u003c/span\u003e \u003cspan class=\"n\"\u003eiptables\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"n\"\u003eicmp\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"m\"\u003e10.24.11.0\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e24\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% \u003cspan class=\"n\"\u003edmesg\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ew\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5528.648942\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e5\u003c/span\u003e     \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5528.668115\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e  \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5528.687502\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e     \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5528.706928\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e       \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5528.726471\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e  \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e5528.746157\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.14\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e84\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10728\u003c/span\u003e \u003cspan class=\"n\"\u003eDF\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eICMP\u003c/span\u003e \u003cspan class=\"n\"\u003eTYPE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e8\u003c/span\u003e \u003cspan class=\"n\"\u003eCODE\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e0\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"n\"\u003eSEQ\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"lets-try-again-with-udp\"\u003eLet\u0026rsquo;s try again with udp\u003c/h2\u003e\n\u003cp\u003eHost B:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% docker run --rm -it --net=container:$(docker ps | grep POD_traefik | head -1 | cut -f1 -d\u0026#39; \u0026#39;) --privileged praqma/network-multitool nslookup github.com\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003esudo\u003c/span\u003e \u003cspan class=\"n\"\u003eiptables\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"n\"\u003eudp\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ed\u003c/span\u003e \u003cspan class=\"m\"\u003e10.24.11.0\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e24\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% sudo iptables -A PREROUTING -p udp -t raw -s 10.24.11.0/24 -j TRACE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003edmesg\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ew\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.660913\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e7\u003c/span\u003e                  \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.681727\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e               \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.702962\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.723562\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSERVICES\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                 \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.744284\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSVC\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eTCOU7JCQXEZGVUNU\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e     \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.766008\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSEP\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eFNEHYJGPMQEV2RPP\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e     \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.788020\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                  \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.809069\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.829669\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e             \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.850869\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.871663\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSERVICES\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e            \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.893472\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.914059\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eDOCKER\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eUSER\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e              \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.935373\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e                    \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.956083\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eDOCKER\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eISOLATION\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eSTAGE\u003c/span\u003e\u003cspan class=\"m\"\u003e-1\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.978371\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003efilter\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eFORWARD\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e10\u003c/span\u003e                   \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003ecbr0\u003c/span\u003e \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6160.999283\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003emangle\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e              \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6161.016840\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e                   \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6161.033296\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eKUBE\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"kr\"\u003ereturn\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e            \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6161.050267\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                   \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6161.066717\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003eIP\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eMASQ\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003erule\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e                       \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003e[\u003c/span\u003e \u003cspan class=\"m\"\u003e6161.083318\u003c/span\u003e\u003cspan class=\"n\"\u003e]\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003enat\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003ePOSTROUTING\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"n\"\u003epolicy\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\u003cspan class=\"m\"\u003e4\u003c/span\u003e                 \u003cspan class=\"n\"\u003eIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e     \u003cspan class=\"n\"\u003eOUT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eeth0\u003c/span\u003e \u003cspan class=\"n\"\u003ePHYSIN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eveth98b9f376\u003c/span\u003e \u003cspan class=\"n\"\u003eSRC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.11.7\u003c/span\u003e \u003cspan class=\"n\"\u003eDST\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e10.24.9.25\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e82\u003c/span\u003e \u003cspan class=\"n\"\u003eTOS\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003ePREC\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"mh\"\u003e0x00\u003c/span\u003e \u003cspan class=\"n\"\u003eTTL\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"n\"\u003eID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e18335\u003c/span\u003e \u003cspan class=\"n\"\u003ePROTO\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"n\"\u003eUDP\u003c/span\u003e \u003cspan class=\"n\"\u003eSPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e57262\u003c/span\u003e \u003cspan class=\"n\"\u003eDPT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e53\u003c/span\u003e \u003cspan class=\"n\"\u003eLEN\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e62\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHost A:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e% sudo iptables -A PREROUTING -p udp -t raw -d 10.24.11.0/24 -j TRACE\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e%\u003c/span\u003e \u003cspan class=\"n\"\u003esudo\u003c/span\u003e \u003cspan class=\"n\"\u003eiptables\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003ePREROUTING\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"n\"\u003eudp\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003et\u003c/span\u003e \u003cspan class=\"n\"\u003eraw\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003es\u003c/span\u003e \u003cspan class=\"m\"\u003e10.24.11.0\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"m\"\u003e24\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ej\u003c/span\u003e \u003cspan class=\"n\"\u003eTRACE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% \u003cspan class=\"n\"\u003edmesg\u003c/span\u003e \u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003ew\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Nothing!\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"communication-between-two-pods-across-nodes\"\u003eCommunication between two pods across nodes\u003c/h2\u003e\n\u003cp\u003eHost A (10.24.9.26):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kubectl run --generator\u003cspan class=\"o\"\u003e=\u003c/span\u003erun-pod/v1 tmp-host-a --overrides\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;spec\u0026#34;:{\u0026#34;affinity\u0026#34;:{\u0026#34;nodeAffinity\u0026#34;:{\u0026#34;requiredDuringSchedulingIgnoredDuringExecution\u0026#34;:{\u0026#34;nodeSelectorTerms\u0026#34;:[{\u0026#34;matchFields\u0026#34;:[{\u0026#34;key\u0026#34;:\u0026#34;metadata.name\u0026#34;,\u0026#34;operator\u0026#34;:\u0026#34;In\u0026#34;,\u0026#34;values\u0026#34;:[\u0026#34;gke-august-period-234610-worker-96e2b32f-6k31\u0026#34;]}]}]}}}}}\u0026#39;\u003c/span\u003e --rm -i --tty --image nicolaka/netshoot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc -v 10.24.11.21 \u003cspan class=\"m\"\u003e80\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eConnection to 10.24.11.21 \u003cspan class=\"m\"\u003e80\u003c/span\u003e port \u003cspan class=\"o\"\u003e[\u003c/span\u003etcp/http\u003cspan class=\"o\"\u003e]\u003c/span\u003e succeeded!\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eHost B (10.24.11.21):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% kubectl run --generator\u003cspan class=\"o\"\u003e=\u003c/span\u003erun-pod/v1 tmp-host-b --overrides\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;spec\u0026#34;:{\u0026#34;affinity\u0026#34;:{\u0026#34;nodeAffinity\u0026#34;:{\u0026#34;requiredDuringSchedulingIgnoredDuringExecution\u0026#34;:{\u0026#34;nodeSelectorTerms\u0026#34;:[{\u0026#34;matchFields\u0026#34;:[{\u0026#34;key\u0026#34;:\u0026#34;metadata.name\u0026#34;,\u0026#34;operator\u0026#34;:\u0026#34;In\u0026#34;,\u0026#34;values\u0026#34;:[\u0026#34;gke-august-period-234610-worker-micro-2a7d2fc5-f85j\u0026#34;]}]}]}}}}}\u0026#39;\u003c/span\u003e --rm -i --tty --image nicolaka/netshoot\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc -v -l \u003cspan class=\"m\"\u003e80\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eListening on \u003cspan class=\"o\"\u003e[\u003c/span\u003e0.0.0.0\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e(\u003c/span\u003efamily 0, port 80\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eConnection from 10.24.9.26 \u003cspan class=\"m\"\u003e38274\u003c/span\u003e received!\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, using udp:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc -v -u 10.24.11.21 \u003cspan class=\"m\"\u003e80\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eConnection to 10.24.11.21 \u003cspan class=\"m\"\u003e80\u003c/span\u003e port \u003cspan class=\"o\"\u003e[\u003c/span\u003eudp/http\u003cspan class=\"o\"\u003e]\u003c/span\u003e succeeded!\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% tcpdump \u003cspan class=\"p\"\u003e\u0026amp;\u003c/span\u003e nc -u -l \u003cspan class=\"m\"\u003e80\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e[\u003c/span\u003e1\u003cspan class=\"o\"\u003e]\u003c/span\u003e \u003cspan class=\"m\"\u003e32\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcpdump: verbose output suppressed, use -v or -vv \u003cspan class=\"k\"\u003efor\u003c/span\u003e full protocol decode\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elistening on eth0, link-type EN10MB \u003cspan class=\"o\"\u003e(\u003c/span\u003eEthernet\u003cspan class=\"o\"\u003e)\u003c/span\u003e, capture size \u003cspan class=\"m\"\u003e262144\u003c/span\u003e bytes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Nothing\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eDefinitely something wrong with anything else than 80/tcp!\u003c/p\u003e\n\u003ch2 id=\"omg-it-was-a-missing-firewall-rule\"\u003eOMG it was a missing firewall rule\u003c/h2\u003e\n\u003cp\u003eI realised that only 80/tcp, 443/tcp and icmp packets would get routed. It\u0026rsquo;s surprisingly very specific: what if the VPC firewall rules were off. Maybe these 80/tcp and 443/tcp are correspond to the rule \u0026ldquo;akrobateo-fw-traefik\u0026rdquo; I had added when I wanted to load-balance traffic direclty from the cluster (as opposed as external load balancing).\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud compute firewall-rules list\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME                                 NETWORK  DIRECTION  PRIORITY  ALLOW                         DENY  DISABLED\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eakrobateo-fw-traefik                 default  INGRESS    \u003cspan class=\"m\"\u003e1000\u003c/span\u003e      tcp:80,tcp:443                      False\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-icmp                   default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e     icmp                                False\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-internal               default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e     tcp:0-65535,udp:0-65535,icmp        False\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-rdp                    default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e     tcp:3389                            False\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-ssh                    default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e     tcp:22                              False\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNo rule for traffic in \u003ccode\u003e10.24.0.0/14\u003c/code\u003e! This CIDR is the subnet used for distributing CIDRs to each node. So I added a new rule \u0026ldquo;all\u0026rdquo;; here is the new list of rules:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% gcloud compute firewall-rules list\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNAME                                 NETWORK  DIRECTION  PRIORITY  ALLOW                         DENY  DISABLED\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eakrobateo-fw-traefik                 default  INGRESS    \u003cspan class=\"m\"\u003e1000\u003c/span\u003e      tcp:80,tcp:443                      False\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-icmp                   default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e     icmp                                False\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-internal               default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e     tcp:0-65535,udp:0-65535,icmp        False\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-rdp                    default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e     tcp:3389                            False\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edefault-allow-ssh                    default  INGRESS    \u003cspan class=\"m\"\u003e65534\u003c/span\u003e     tcp:22                              False\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egke-august-period-234610-all         default  INGRESS    \u003cspan class=\"m\"\u003e1000\u003c/span\u003e      udp,icmp,esp,ah,sctp,tcp            False\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNow, let\u0026rsquo;s test again:\u003c/p\u003e\n\u003cp\u003ePod \u0026ldquo;tmp-host-b\u0026rdquo; (10.24.11.26) on Host B:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% nc -v -u 10.24.9.27 \u003cspan class=\"m\"\u003e8888\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Exits with 0 and no output\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ePod \u0026ldquo;tmp-host-a\u0026rdquo; (10.24.9.27) on Host A:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% tcpdump\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etcpdump: verbose output suppressed, use -v or -vv \u003cspan class=\"k\"\u003efor\u003c/span\u003e full protocol decode\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elistening on eth0, link-type EN10MB \u003cspan class=\"o\"\u003e(\u003c/span\u003eEthernet\u003cspan class=\"o\"\u003e)\u003c/span\u003e, capture size \u003cspan class=\"m\"\u003e262144\u003c/span\u003e bytes\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21:54:39.787779 IP 10.24.11.26.40760 \u0026gt; tmp-host-a.8888: UDP, length \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21:54:39.787802 IP tmp-host-a \u0026gt; 10.24.11.26: ICMP tmp-host-a udp port \u003cspan class=\"m\"\u003e8888\u003c/span\u003e unreachable, length \u003cspan class=\"m\"\u003e37\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21:54:39.787805 IP 10.24.11.26.40760 \u0026gt; tmp-host-a.8888: UDP, length \u003cspan class=\"m\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e21:54:39.787808 IP tmp-host-a \u0026gt; 10.24.11.26: ICMP tmp-host-a udp port \u003cspan class=\"m\"\u003e8888\u003c/span\u003e unreachable, length \u003cspan class=\"m\"\u003e37\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eYay!\u003c/p\u003e\n","date":1546473600,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":2400,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1546473600,"objectID":"fbd225d1686c128115129c5309a62435","permalink":"https://maelvls.dev/do-not-share-yet/notes/kubectl/","publishdate":"2019-01-03T00:00:00Z","readingtime":12,"relpermalink":"/do-not-share-yet/notes/kubectl/","section":"notes","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl run --generator\u003cspan class=\"o\"\u003e=\u003c/span\u003erun-pod/v1 tmp-shell --rm -i --tty --image nicolaka/netshoot -- /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud ssh ...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker ps --format\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{{.ID}} {{.Names}}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekubectl run --generator\u003cspan class=\"o\"\u003e=\u003c/span\u003erun-pod/v1 tmp-shell --rm -i --tty --image nicolaka/netshoot -- /bin/bash\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo iptables-save \u0026gt; a \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e vim a \u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e sudo iptables-restore \u0026lt; a\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e% mvalais@gke-august-period-micro-g961 ~ $ vmstat -SM \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"m\"\u003e10\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e  \u003cspan class=\"m\"\u003e0\u003c/span\u003e      \u003cspan class=\"m\"\u003e0\u003c/span\u003e    \u003cspan class=\"m\"\u003e104\u003c/span\u003e      \u003cspan class=\"m\"\u003e7\u003c/span\u003e    \u003cspan class=\"m\"\u003e218\u003c/span\u003e    \u003cspan class=\"m\"\u003e0\u003c/span\u003e    \u003cspan class=\"m\"\u003e0\u003c/span\u003e   \u003cspan class=\"m\"\u003e160\u003c/span\u003e    \u003cspan class=\"m\"\u003e57\u003c/span\u003e  \u003cspan class=\"m\"\u003e273\u003c/span\u003e  \u003cspan class=\"m\"\u003e760\u003c/span\u003e  \u003cspan class=\"m\"\u003e2\u003c/span\u003e  \u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"m\"\u003e96\u003c/span\u003e  \u003cspan class=\"m\"\u003e1\u003c/span\u003e  \u003cspan class=\"m\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ek get pods -A --field-selector\u003cspan class=\"o\"\u003e=\u003c/span\u003espec.nodeName\u003cspan class=\"o\"\u003e=\u003c/span\u003egke-august-period-234610-worker-micro-1de60498-g961\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egcloud compute ssh gke-august-period-234610-worker-micro-1de60498-g961 --zone\u003cspan class=\"o\"\u003e=\u003c/span\u003eus-east1-c --command \u003cspan class=\"s2\"\u003e\u0026#34;docker run --rm --net=host corfr/tcpdump -i cbr0 -U -w - \u0026#39;not port 22\u0026#39;\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e wireshark -k -i -\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edmsg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-s\" data-lang=\"s\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Host B is 10.142.15.201\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Doesn\u0026#39;t work:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#   from the pod on host B, nslookup github.com (tcpdump on pod\u0026#39;s eth0)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e      \u003cspan class=\"m\"\u003e10.27.240.10\u003c/span\u003e    \u003cspan class=\"n\"\u003eDNS\u003c/span\u003e \u003cspan class=\"m\"\u003e98\u003c/span\u003e \u003cspan class=\"n\"\u003eStandard\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e            \u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003egithub.com.traefik.svc.cluster.local\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#   same from host\u0026#39;s eth0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e10.24.10.2\u003c/span\u003e      \u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e       \u003cspan class=\"n\"\u003eDNS\u003c/span\u003e \u003cspan class=\"m\"\u003e96\u003c/span\u003e \u003cspan class=\"n\"\u003eStandard\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e            \u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003egithub.com.traefik.svc.cluster.local\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# Works:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#   from the host B, nslookup github.com 10.27.240.10 (tcpdump on host\u0026#39;s eth0)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e10.142.15.201\u003c/span\u003e   \u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e       \u003cspan class=\"n\"\u003eDNS\u003c/span\u003e \u003cspan class=\"m\"\u003e70\u003c/span\u003e \u003cspan class=\"n\"\u003eStandard\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e            \u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003egithub.com\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e10.24.9.3\u003c/span\u003e       \u003cspan class=\"m\"\u003e10.142.15.201\u003c/span\u003e   \u003cspan class=\"n\"\u003eDNS\u003c/span\u003e \u003cspan class=\"m\"\u003e86\u003c/span\u003e \u003cspan class=\"n\"\u003eStandard\u003c/span\u003e \u003cspan class=\"n\"\u003equery\u003c/span\u003e \u003cspan class=\"n\"\u003eresponse\u003c/span\u003e   \u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"n\"\u003egithub.com\u003c/span\u003e \u003cspan class=\"n\"\u003eA\u003c/span\u003e \u003cspan class=\"m\"\u003e140.82.113.4\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eDumping iptables on host B:\u003c/p\u003e","tags":[],"title":"Some kubectl stuff","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/kubectl/","weight":0,"wordcount":2374},{"authors":null,"categories":null,"content":"\u003cp\u003eI installed \u003ca href=\"https://gist.github.com/cybic/6375457\"\u003ehttps://gist.github.com/cybic/6375457\u003c/a\u003e in \u003ccode\u003e~/.bash_completion\u003c/code\u003e (file) to get the bash completion.\u003c/p\u003e\n\u003ch2 id=\"general-shortcuts\"\u003eGeneral shortcuts\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003etmux attach          -\u0026gt; opens tmux\ntmux ls              -\u0026gt; lists open windows\ntmux attach -d 0     -\u0026gt; reopens window 0\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eInside tmux. prefix = ctrl+b\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eprefix d         -\u0026gt; detach window (closes tmux)\nprefix w         -\u0026gt; lists windows\nprefix x         -\u0026gt; close window\nprefix c         -\u0026gt; create window\nprefix ,         -\u0026gt; rename window\nprefix [         -\u0026gt; scroll among history\nprefix arrow     -\u0026gt; move among panes\nprefix \u0026quot;         -\u0026gt; split vertically (up-down); % for horiz\nprefix maj+arrow -\u0026gt; bigger pane\nprefix alt+arrow -\u0026gt; even bigger pane\nprefix z         -\u0026gt; bigger current pane (redo that to resize like before)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI also created a script called \u003ccode\u003emonitor.sh\u003c/code\u003e to know which one of the 6 server I should use for my experiments. The thing is that I don\u0026rsquo;t want the session with 6 htop open to run in background for days.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eprefix ctrl+z    -\u0026gt; suspend the current session\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo scroll stdout history instead of command history with mouse wheel:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eset -g mouse on\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf I want to put an open pane to its own window:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ebreak-pane           # current pane is sent to a new window\njoin-pane -s 0       # -s = source window\njoin-pane -t 0       # -t = destination window\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"gray-not-displaying-zsh\"\u003eGray not displaying (zsh)\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003e\u0026lt;can't remember how to do that\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n","date":1541203200,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":300,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1541203200,"objectID":"f262c827357f96b6fb6a91e08a076a00","permalink":"https://maelvls.dev/do-not-share-yet/notes/tmux/","publishdate":"2018-11-03T00:00:00Z","readingtime":2,"relpermalink":"/do-not-share-yet/notes/tmux/","section":"notes","summary":"\u003cp\u003eI installed \u003ca href=\"https://gist.github.com/cybic/6375457\"\u003ehttps://gist.github.com/cybic/6375457\u003c/a\u003e in \u003ccode\u003e~/.bash_completion\u003c/code\u003e (file) to get the bash completion.\u003c/p\u003e\n\u003ch2 id=\"general-shortcuts\"\u003eGeneral shortcuts\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003etmux attach          -\u0026gt; opens tmux\ntmux ls              -\u0026gt; lists open windows\ntmux attach -d 0     -\u0026gt; reopens window 0\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eInside tmux. prefix = ctrl+b\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eprefix d         -\u0026gt; detach window (closes tmux)\nprefix w         -\u0026gt; lists windows\nprefix x         -\u0026gt; close window\nprefix c         -\u0026gt; create window\nprefix ,         -\u0026gt; rename window\nprefix [         -\u0026gt; scroll among history\nprefix arrow     -\u0026gt; move among panes\nprefix \u0026quot;         -\u0026gt; split vertically (up-down); % for horiz\nprefix maj+arrow -\u0026gt; bigger pane\nprefix alt+arrow -\u0026gt; even bigger pane\nprefix z         -\u0026gt; bigger current pane (redo that to resize like before)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI also created a script called \u003ccode\u003emonitor.sh\u003c/code\u003e to know which one of the 6 server I should use for my experiments. The thing is that I don\u0026rsquo;t want the session with 6 htop open to run in background for days.\u003c/p\u003e","tags":[],"title":"Memo for Tmux","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/tmux/","weight":0,"wordcount":218},{"authors":null,"categories":null,"content":"\u003cp\u003eIf there is a Nvidia card:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003envidia-smi\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOtherwise:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e cat /proc/cpuinfo\n lscpu\n\u003c/code\u003e\u003c/pre\u003e\n","date":1541030400,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1541030400,"objectID":"15339c0f4108a8600b3e7c1400db40da","permalink":"https://maelvls.dev/do-not-share-yet/notes/cpu_gpu/","publishdate":"2018-11-01T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/cpu_gpu/","section":"notes","summary":"\u003cp\u003eIf there is a Nvidia card:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003envidia-smi\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOtherwise:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e cat /proc/cpuinfo\n lscpu\n\u003c/code\u003e\u003c/pre\u003e","tags":[],"title":"Checking info about CPU and Nvidia GPU on Linux","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/cpu_gpu/","weight":0,"wordcount":11},{"authors":null,"categories":null,"content":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo dd \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$HOME\u003c/span\u003e/Downloads/elementaryos-0.4.1-stable.20170814.iso \u003cspan class=\"nv\"\u003eof\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/dev/disk3s1 \u003cspan class=\"nv\"\u003estatus\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eprogress\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edf -h\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ediskutil unmountDisk /dev/...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1538956800,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1538956800,"objectID":"1031fd59622557560850a335b7460343","permalink":"https://maelvls.dev/do-not-share-yet/notes/dd/","publishdate":"2018-10-08T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/dd/","section":"notes","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo dd \u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$HOME\u003c/span\u003e/Downloads/elementaryos-0.4.1-stable.20170814.iso \u003cspan class=\"nv\"\u003eof\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e/dev/disk3s1 \u003cspan class=\"nv\"\u003estatus\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eprogress\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edf -h\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ediskutil unmountDisk /dev/...\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[],"title":"Using dd","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/dd/","weight":0,"wordcount":10},{"authors":null,"categories":null,"content":"\u003ch2 id=\"use-docker-machine-for-remoting-docker\"\u003eUse docker-machine for remoting docker\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker-machine create --driver generic --generic-ip-address\u003cspan class=\"o\"\u003e=\u003c/span\u003e141.115.74.15 --generic-ssh-key ~/.ssh/id_rsa --generic-ssh-user\u003cspan class=\"o\"\u003e=\u003c/span\u003emvalais polatouche-docker-host\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eeval\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003edocker-machine env polatouche-docker-host\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"tunneling\"\u003eTunneling\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker-machine ssh default -L 0.0.0.0:8000:localhost:8000\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"namespaces-cgroups\"\u003eNamespaces, cgroups\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003enamespaces\u003c/li\u003e\n\u003cli\u003ecgroup (systemd-cgls)\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"commands\"\u003eCommands\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run --rm -it ubuntu\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-i\u003c/code\u003e means interactive (stdin will be attached)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-t\u003c/code\u003e (\u003ccode\u003e--tty\u003c/code\u003e) means that this is a pseudo-tty terminal instead of a non-tty (for example, without tty, bash has no prompt; with a tty, it gives a nice prompt such as \u003ccode\u003ebash-4.4#\u003c/code\u003e).\u003c/li\u003e\n\u003c/ul\u003e\n","date":1536796800,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1536796800,"objectID":"a19dd36092f8f3db00ccaa6a6e46e03c","permalink":"https://maelvls.dev/do-not-share-yet/notes/docker/","publishdate":"2018-09-13T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/docker/","section":"notes","summary":"\u003ch2 id=\"use-docker-machine-for-remoting-docker\"\u003eUse docker-machine for remoting docker\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker-machine create --driver generic --generic-ip-address\u003cspan class=\"o\"\u003e=\u003c/span\u003e141.115.74.15 --generic-ssh-key ~/.ssh/id_rsa --generic-ssh-user\u003cspan class=\"o\"\u003e=\u003c/span\u003emvalais polatouche-docker-host\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eeval\u003c/span\u003e \u003cspan class=\"k\"\u003e$(\u003c/span\u003edocker-machine env polatouche-docker-host\u003cspan class=\"k\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"tunneling\"\u003eTunneling\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker-machine ssh default -L 0.0.0.0:8000:localhost:8000\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"namespaces-cgroups\"\u003eNamespaces, cgroups\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003enamespaces\u003c/li\u003e\n\u003cli\u003ecgroup (systemd-cgls)\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"commands\"\u003eCommands\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edocker run --rm -it ubuntu\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-i\u003c/code\u003e means interactive (stdin will be attached)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-t\u003c/code\u003e (\u003ccode\u003e--tty\u003c/code\u003e) means that this is a pseudo-tty terminal instead of a non-tty (for example, without tty, bash has no prompt; with a tty, it gives a nice prompt such as \u003ccode\u003ebash-4.4#\u003c/code\u003e).\u003c/li\u003e\n\u003c/ul\u003e","tags":[],"title":"Remote Docker using docker-machine","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/docker/","weight":0,"wordcount":74},{"authors":null,"categories":null,"content":"\u003cp\u003eFrom \u003ca href=\"https://docs.gitlab.com/runner/install/linux-manually.html\"\u003ehttps://docs.gitlab.com/runner/install/linux-manually.html\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo wget -O /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-amd64\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo chmod +x /usr/local/bin/gitlab-runner\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1531094400,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1531094400,"objectID":"e57940345774c451d7b0828a857b9821","permalink":"https://maelvls.dev/do-not-share-yet/notes/gitlab/","publishdate":"2018-07-09T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/gitlab/","section":"notes","summary":"\u003cp\u003eFrom \u003ca href=\"https://docs.gitlab.com/runner/install/linux-manually.html\"\u003ehttps://docs.gitlab.com/runner/install/linux-manually.html\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo wget -O /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-amd64\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo chmod +x /usr/local/bin/gitlab-runner\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[],"title":"Run the test suite of the Gitlab projet","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/gitlab/","weight":0,"wordcount":11},{"authors":null,"categories":null,"content":"\u003cp\u003eOn macOS, install msmtp:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ebrew install mutt msmtp\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI read this thread: \u003ca href=\"https://www.engadget.com/2010/05/04/msmtp-a-free-tool-to-send-email-from-terminal/\"\u003ehttps://www.engadget.com/2010/05/04/msmtp-a-free-tool-to-send-email-from-terminal/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn order to use msmtp from command-line \u0026lsquo;mail\u0026rsquo;\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eadd to \u003ccode\u003e~/.mailrc\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eset sendmail=/usr/local/bin/msmtp\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn Keychain Access.app, go to File \u0026gt; New Password Item (Cmd+N) and fill it with\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    smtp://smtp.gmail.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    email@gmail.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    mypassword\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn Keychain Access.app, select System Roots, select all certificates and File \u0026gt; Export Items (Shift+Cmd+E) \u0026gt; Privacy Enhanced Mail (.pem) and save it as \u0026lsquo;Certificates.pem\u0026rsquo; in your $HOME.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTest the configuration with\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Hello world\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e mail -s \u003cspan class=\"s2\"\u003e\u0026#34;msmtp test at `date`\u0026#34;\u003c/span\u003e cheprugeph@qwfox.com\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eTroubleshooting:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eCheck in keychain Access.app that there is only ONE Internet password using the \u003ca href=\"mailto:email@gmail.com\"\u003eemail@gmail.com\u003c/a\u003e and smtp://smtp.gmail.com.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIf the SMTP of Google says that you should go to some adress, with the error:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esend-mail: server message: 534-5.7.14 \u0026lt;https://accounts.google.com/signin/continue?sarp=1\u0026amp;scc=1\u0026amp;plt=AKgnsbtk\nsend-mail: server message: 534-5.7.14 z36uL0SoqtWkRHK4lg9Q60tKoOB5B_vNgRZ04wP0SbjkVSvkI3ByYM3aNcsUhrxrskG2Vf\nsend-mail: server message: 534-5.7.14 DEQUXboD5d_Px9ehRUYcaOhSdjo2hgTeUvPFDt7PuYRIZTv9CZ8RSybOQ84OAZAPNkbqhd\nsend-mail: server message: 534-5.7.14 LWOrMuYScmxwWyjg9PsUoUal67TvV2TYMyM9L_9-KcSyp5aZ-SRDH45cKU1vjGMdi7g7yn\nsend-mail: server message: 534-5.7.14 OARlP4_M6aIDqqDF2vbvirlleKMQs\u0026gt; Please log in via your web browser and\nsend-mail: server message: 534-5.7.14 then try again.\nsend-mail: server message: 534-5.7.14  Learn more at\nsend-mail: server message: 534 5.7.14  https://support.google.com/mail/answer/78754 m62sm13851787wmi.19 - gsmtp\nsend-mail: could not send mail (account default from /Users/mvalais/.msmtprc)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ethen you need to go to \u003ca href=\"https://accounts.google.com/b/0/DisplayUnlockCaptcha\"\u003ehttps://accounts.google.com/b/0/DisplayUnlockCaptcha\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"set-up-mutt\"\u003eSet up Mutt\u003c/h2\u003e\n\u003cp\u003eI followed the instructions of \u003ca href=\"https://gist.github.com/chrismytton/3976435\"\u003ehttps://gist.github.com/chrismytton/3976435\u003c/a\u003e except for the keychain stuff:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eWe are going to re-use the Keychain thing we created earlier. In order to show the password, use\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esecurity find-internet-password -s smtp.gmail.com -a email@gmail.com -w\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewhere \u0026lsquo;-w\u0026rsquo; tells him to only show the password, \u0026lsquo;-s\u0026rsquo; means server (in my case I had used \u0026lsquo;smtp://smtp.gmail.com\u0026rsquo; but you must remove the protocol smtp://) and \u0026lsquo;-a\u0026rsquo; means account.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n","date":1530316800,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":300,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1530316800,"objectID":"2f978526feaec6c2b51998c6535b6b5e","permalink":"https://maelvls.dev/do-not-share-yet/notes/msmtp_mutt/","publishdate":"2018-06-30T00:00:00Z","readingtime":2,"relpermalink":"/do-not-share-yet/notes/msmtp_mutt/","section":"notes","summary":"\u003cp\u003eOn macOS, install msmtp:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ebrew install mutt msmtp\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI read this thread: \u003ca href=\"https://www.engadget.com/2010/05/04/msmtp-a-free-tool-to-send-email-from-terminal/\"\u003ehttps://www.engadget.com/2010/05/04/msmtp-a-free-tool-to-send-email-from-terminal/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn order to use msmtp from command-line \u0026lsquo;mail\u0026rsquo;\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eadd to \u003ccode\u003e~/.mailrc\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eset sendmail=/usr/local/bin/msmtp\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn Keychain Access.app, go to File \u0026gt; New Password Item (Cmd+N) and fill it with\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    smtp://smtp.gmail.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    email@gmail.com\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    mypassword\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eIn Keychain Access.app, select System Roots, select all certificates and File \u0026gt; Export Items (Shift+Cmd+E) \u0026gt; Privacy Enhanced Mail (.pem) and save it as \u0026lsquo;Certificates.pem\u0026rsquo; in your $HOME.\u003c/p\u003e","tags":[],"title":"Using mutt and msmtp with Gmail","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/msmtp_mutt/","weight":0,"wordcount":261},{"authors":null,"categories":null,"content":"\u003ch2 id=\"how-is-a-tcp-connection-uniquely-identified\"\u003eHow is a TCP connection uniquely identified\u003c/h2\u003e\n\u003cp\u003eKill a process that is using a TCP port you need:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elsof -n -i :8001\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# copy PID\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ekill\u003c/span\u003e \u003cspan class=\"m\"\u003e43903\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA TCP connection is identified by four things:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esource port\u003c/li\u003e\n\u003cli\u003esource ip\u003c/li\u003e\n\u003cli\u003edest port\u003c/li\u003e\n\u003cli\u003edest ip\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis is why there is no confusion between two requests to a web server on 80 port.\u003c/p\u003e\n\u003ch2 id=\"stateful-vs-stateless-firewall\"\u003eStateful vs. Stateless Firewall\u003c/h2\u003e\n\u003cp\u003eThis only applies to appliances in between two computers, for example a router using some kind of firewall. Is it???? Is it only for NATs or gateways?\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    A -----\u0026gt; Router -----\u0026gt; B\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIf the router manages connection in a stateful way, here is what is going to happen:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eA connects to B via a TCP connection identified by IP_A:PORT_A + IP_B:PORT_B\u003c/li\u003e\n\u003cli\u003eRouter remembers the source port of A so that when B sends things back, it can\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eReferences:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUsing linux iptables to implement a stateless packet filtering firewall: \u003ca href=\"https://security.stackexchange.com/questions/74529\"\u003ehttps://security.stackexchange.com/questions/74529\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eExample:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-A INPUT -p tcp -s 192.168.1.0/24 -m tcp --dport 80 -j ACCEPT\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e-A CHAIN RULE\u003c/code\u003e tells iptables to append this RULE at the end of this CHAIN. A chain is identified by a name such as INPUT or OUTPUT.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-p TCP\u003c/code\u003e means protocol\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-s\u003c/code\u003e is the source. Here, 192.168.1.0/24 means any IP adress that matches with \u003ccode\u003e192.*.*.*\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-m TCP\u003c/code\u003e is for extensions (see \u003ccode\u003eman iptables-extensions\u003c/code\u003e) but I didn\u0026rsquo;t find it\u0026hellip;\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e--dport 80\u003c/code\u003e means the destination port must be 80\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e-j ACCEPT\u003c/code\u003e means that the target is the action \u0026ldquo;ACCEPT\u0026rdquo;\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eQUESTIONS: what is the link between protocol and state?\u003c/p\u003e\n\u003ch2 id=\"sg-vs-acls\"\u003eSG vs. ACLs\u003c/h2\u003e\n\u003cp\u003eSecurity Groups = stateful firewall at the VM level (= iptables) Access Control Lists = stateless firewall at the VPC level.\u003c/p\u003e\n\u003ch2 id=\"protocol-stack\"\u003eProtocol stack\u003c/h2\u003e\n\u003cp\u003eThe protocol stack is the piece of software that implements (among others) the TCP/IP layers. A socket is the internal representation of an instance of this TCP stack. A socket is identified with a number (file descriptor in Unix terms).\u003c/p\u003e\n\u003cp\u003eTCP connection = 2 sockets = from(ip:port) + to(ip:port) TCP socket = internal representation of the \u0026lsquo;from\u0026rsquo; (ip:port)\u003c/p\u003e\n\u003ch2 id=\"the-stack\"\u003eThe stack\u003c/h2\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eOSI\u003c/th\u003e\n          \u003cth\u003eLv\u003c/th\u003e\n          \u003cth\u003eTCP/IP\u003c/th\u003e\n          \u003cth\u003eKeywords\u003c/th\u003e\n          \u003cth\u003e\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eApplica\u003c/td\u003e\n          \u003ctd\u003eL7\u003c/td\u003e\n          \u003ctd\u003eHTTPS\u003c/td\u003e\n          \u003ctd\u003eLB\u003c/td\u003e\n          \u003ctd\u003eDeserialized\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePresent\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eHTTPS\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eSerialized\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eSession\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eHTTPS\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eTranspo\u003c/td\u003e\n          \u003ctd\u003eL4\u003c/td\u003e\n          \u003ctd\u003eTCP,ICMP\u003c/td\u003e\n          \u003ctd\u003eFirewall\u003c/td\u003e\n          \u003ctd\u003eSegments\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eNetwork\u003c/td\u003e\n          \u003ctd\u003eL3\u003c/td\u003e\n          \u003ctd\u003eIP\u003c/td\u003e\n          \u003ctd\u003eRouter\u003c/td\u003e\n          \u003ctd\u003ePackets\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eLink\u003c/td\u003e\n          \u003ctd\u003eL2\u003c/td\u003e\n          \u003ctd\u003eMAC, ARP\u003c/td\u003e\n          \u003ctd\u003eVLAN, Switch\u003c/td\u003e\n          \u003ctd\u003eFrames\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePhysic\u003c/td\u003e\n          \u003ctd\u003eL1\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003e\u003c/td\u003e\n          \u003ctd\u003eBits\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eWarning: HTTP/1.1 and such have intertwined L5, L6 and L7 responsabilities. As an example, HTTP/1.1 carries headers that can be thought of of application data, but the payload (data) also spans over L6 (presentation using json for example). Session is also part of HTTP/1.1.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eL5-L6-L7 (application) protocols\u003c/strong\u003e = HTTP/1.1, HTTP/2, WebSockets\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eL6 serialization formats\u003c/strong\u003e = protobuf, json, avro, xml\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eVLAN\u003c/strong\u003e = just like the good\u0026rsquo;old ethernet between multiple equipments. Switches aliviates some of the issues with the one-cable-for-multiple-pc with a table (forwarding table, NOT an ARP table) that allows a one-to-one link with less noise on each link overall.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTCP\u003c/strong\u003e = handles loss of packets using ACKs and SYN with sequence numbers. SYN = please open a connection. ACK = acknowledge.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eSegments vs packets\u003c/strong\u003e = ??\u003c/p\u003e\n\u003cp\u003egRPC\u003c/p\u003e\n\u003ch2 id=\"cidr-network-masks-subnets\"\u003eCIDR, network masks, subnets\u003c/h2\u003e\n\u003cp\u003e10.0.2.3/16 = 16 first bits (10.0) for subnet.\u003c/p\u003e\n\u003cp\u003eThe idea of subnets: inside of a subnet, we pretty much share the same VLAN. For example, let\u0026rsquo;s say that we have two subnets A and B.\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003e\u003c/th\u003e\n          \u003cth\u003eSubnet A\u003c/th\u003e\n          \u003cth\u003eSubnet B\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCIDR\u003c/td\u003e\n          \u003ctd\u003e10.0.1.0/24\u003c/td\u003e\n          \u003ctd\u003e10.0.2.0/24\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eCount\u003c/td\u003e\n          \u003ctd\u003e254\u003c/td\u003e\n          \u003ctd\u003e254\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eVLAN\u003c/td\u003e\n          \u003ctd\u003eVLAN1\u003c/td\u003e\n          \u003ctd\u003eVLAN2\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"link-between-subnet-l3-and-vlan-l2\"\u003eLink between Subnet (L3) and VLAN (L2)\u003c/h3\u003e\n\u003cp\u003eFirst, let us remember that every machine in a VLAN can communicate with each other at any time. Now, we want to control what goes from/to A and B.\u003c/p\u003e\n\u003cp\u003eIn a VLAN, everything sees everything but it\u0026rsquo;s now really helpful unless we can use protocols like TCP. But TCP needs IPs. And IPs\u003c/p\u003e\n\u003cp\u003eA1 (10.0.1.7) \u0026mdash;-\u0026gt; A2 (10.0.1.13) Same subnet, ARP table says I know the MAC address so no need to route.\u003c/p\u003e\n\u003cp\u003eThe subnet allows a machine to know what is \u0026lsquo;internal\u0026rsquo; traffic and what is routed traffic.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eA1 \u0026mdash;\u0026ndash;\u0026gt; IP inside subnet = A1 asks which MAC has this IP using ARP.\u003c/li\u003e\n\u003cli\u003eA1 \u0026mdash;\u0026ndash;\u0026gt; IP outside subnet = NAT to the gateway (= a router). See \u0026lsquo;Routing\u0026rsquo;.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"routing\"\u003eRouting\u003c/h2\u003e\n\u003cp\u003eThe gateway has routing tables such as\u003c/p\u003e\n\u003ch2 id=\"aws-terms\"\u003eAWS terms\u003c/h2\u003e\n\u003cp\u003eIGW = internet gateway VPC = virtual private cloud. ne VPC is equivalent to a VLAN: everyone can talk to everyone on L2 (MAC level).\u003c/p\u003e\n\u003cp\u003eThe routing in a VPC:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eeach subnet has an ACL (network access control list)\u003c/li\u003e\n\u003cli\u003eeach EC2 has security groups (L4 stateful firewall)\u003c/li\u003e\n\u003c/ul\u003e\n","date":1518998400,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":800,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1518998400,"objectID":"a7e4dfe6e9e4163afc22a9e404b49230","permalink":"https://maelvls.dev/do-not-share-yet/notes/tcp_ports/","publishdate":"2018-02-19T00:00:00Z","readingtime":4,"relpermalink":"/do-not-share-yet/notes/tcp_ports/","section":"notes","summary":"\u003ch2 id=\"how-is-a-tcp-connection-uniquely-identified\"\u003eHow is a TCP connection uniquely identified\u003c/h2\u003e\n\u003cp\u003eKill a process that is using a TCP port you need:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elsof -n -i :8001\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# copy PID\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ekill\u003c/span\u003e \u003cspan class=\"m\"\u003e43903\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eA TCP connection is identified by four things:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esource port\u003c/li\u003e\n\u003cli\u003esource ip\u003c/li\u003e\n\u003cli\u003edest port\u003c/li\u003e\n\u003cli\u003edest ip\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis is why there is no confusion between two requests to a web server on 80 port.\u003c/p\u003e\n\u003ch2 id=\"stateful-vs-stateless-firewall\"\u003eStateful vs. Stateless Firewall\u003c/h2\u003e\n\u003cp\u003eThis only applies to appliances in between two computers, for example a router using some kind of firewall. Is it???? Is it only for NATs or gateways?\u003c/p\u003e","tags":[],"title":"Everything I know about TCP","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/tcp_ports/","weight":0,"wordcount":734},{"authors":null,"categories":null,"content":"\u003cp\u003eMany times, I used \u003ccode\u003egit reset --hard\u003c/code\u003e and found out later that all my changes had disappeared. I think this is because I do not fully understand what \u003ccode\u003egit reset --hard\u003c/code\u003e does:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003emove the branch ref pointer to the given reference\u003c/li\u003e\n\u003cli\u003eset HEAD to this ref\u003c/li\u003e\n\u003cli\u003eDepending on the option:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003e\u0026ndash;soft: working dir and stage are not touched, useful when \u003ccode\u003egit reset --hard HEAD^\u003c/code\u003e to change the content of the commit without having to re-add everything\u003c/li\u003e\n\u003cli\u003e\u0026ndash;mixed: working dir is not touched, but the stage is set to match the HEAD\u003c/li\u003e\n\u003cli\u003e\u0026ndash;hard: stage + working dir are set to match the HEAD\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOn the other side, \u003ccode\u003egit stash\u003c/code\u003e will set stage + working dir to match the HEAD.\u003c/p\u003e\n\u003cp\u003eSo instead of \u003ccode\u003egit reset --hard REF\u003c/code\u003e I should rather do \u003ccode\u003egit stash \u0026amp;\u0026amp; git reset --hard REF\u003c/code\u003e. This would avoid cases where I forgot that I had made changes\u0026hellip; and end up losing them all.\u003c/p\u003e\n\u003cp\u003eIDEAS ON NEW COMMANDS\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eI often have committed something like @~0: edit touist.rb @~1: edit .travis.yml\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eI want to add a command like \u003ccode\u003egit ci --amend~2\u003c/code\u003e that would amend the commit in @~1, not the HEAD. Here is what I must do:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003evim .travis.yml\ngit stash\ngit rb -i @^^ # edit HEAD^\ngit stash pop\ngit add .travis.yml\ngit ci --amend\ngit rb --continue\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFacebook\u0026rsquo;s hg extensions have \u0026lsquo;absorb\u0026rsquo; which does this but on @~1, @~2\u0026hellip; and chooses automatically in which commit it should be amended. See:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/24625411/amend-the-second-to-last-commit\"\u003ehttps://stackoverflow.com/questions/24625411/amend-the-second-to-last-commit\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://blog.filippo.io/git-fixup-amending-an-older-commit/\"\u003ehttps://blog.filippo.io/git-fixup-amending-an-older-commit/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","date":1513728000,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":300,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1513728000,"objectID":"476b11704873e86df7c94d7ca643689e","permalink":"https://maelvls.dev/do-not-share-yet/notes/git/","publishdate":"2017-12-20T00:00:00Z","readingtime":2,"relpermalink":"/do-not-share-yet/notes/git/","section":"notes","summary":"\u003cp\u003eMany times, I used \u003ccode\u003egit reset --hard\u003c/code\u003e and found out later that all my changes had disappeared. I think this is because I do not fully understand what \u003ccode\u003egit reset --hard\u003c/code\u003e does:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003emove the branch ref pointer to the given reference\u003c/li\u003e\n\u003cli\u003eset HEAD to this ref\u003c/li\u003e\n\u003cli\u003eDepending on the option:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cul\u003e\n\u003cli\u003e\u0026ndash;soft: working dir and stage are not touched, useful when \u003ccode\u003egit reset --hard HEAD^\u003c/code\u003e to change the content of the commit without having to re-add everything\u003c/li\u003e\n\u003cli\u003e\u0026ndash;mixed: working dir is not touched, but the stage is set to match the HEAD\u003c/li\u003e\n\u003cli\u003e\u0026ndash;hard: stage + working dir are set to match the HEAD\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eOn the other side, \u003ccode\u003egit stash\u003c/code\u003e will set stage + working dir to match the HEAD.\u003c/p\u003e","tags":[],"title":"git stash vs. git reset --hard","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/git/","weight":0,"wordcount":244},{"authors":null,"categories":null,"content":"\u003col\u003e\n\u003cli\u003e\u003ca href=\"#sign-my-message\"\u003eSign my message\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#things-on-securiry\"\u003eThings on securiry\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#public-key-protocol-is-slow\"\u003ePublic-key protocol is slow\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#errors-i-got\"\u003eErrors I got\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eTo list the keys I have in my keyring, use \u003ccode\u003egpg --list-key\u003c/code\u003e. Here, I can see one public key in the file \u003ccode\u003epubring.pgp\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; gpg --list-key\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/Users/mvalais/.gnupg/pubring.gpg\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-------------------------------\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epub   4096R/27F4C016 2016-03-04\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euid                  Maël Valais \u0026lt;mael.valais@gmail.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esub   4096R/A3D4828E 2016-03-04\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe identifier for my public key is \u003ccode\u003e27F4C016\u003c/code\u003e and the sub identifier \u003ccode\u003eA3D4828E\u003c/code\u003e. 4096R = 4096-bits RSA encrypted.\u003c/p\u003e\n\u003cp\u003eWhen seeing the whole primary key fingerprint:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eF105 E235 8FEB FC3D A4A4 9499 0075 8A3D 27F4 C016\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                        ^^^^^^^^^\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                        identifier\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo export my public key to the keys server:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; gpg --send-keys 27F4C016\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egpg: envoi de la clef 27F4C016 au serveur hkp keys.gnupg.net\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eCheck that my public key has been pushed to the keys server:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; gpg --search-keys \u0026#34;mael.valais@gmail.com\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egpg: recherche de « mael.valais@gmail.com » sur le serveur hkp\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekeys.gnupg.net\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e(1) Maël Valais \u0026lt;mael.valais@gmail.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eTo  4096 bit RSA key 27F4C016, créé : 2016-03-04\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"sign-my-message\"\u003eSign my message\u003c/h2\u003e\n\u003cp\u003eSay I have writen the message in \u003ccode\u003emessage.txt\u003c/code\u003e. Now I want to sign it and I want the signature to be in ASCII-format \u003ccode\u003e.asc\u003c/code\u003e (not a binary mess \u003ccode\u003e.sig\u003c/code\u003e).\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egpg2 --armor --detach-sign message.txt\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis signature will be in text format in \u003ccode\u003emessage.asc\u003c/code\u003e.\u003c/p\u003e\n\u003ch2 id=\"things-on-securiry\"\u003eThings on securiry\u003c/h2\u003e\n\u003cp\u003eencrypt: AES 256 (symetric) salting: hash(pwd+salt), salt is dynamically generated key derivation: PBKDF2 hash: MD5, SHA-1, SHA-256\u003c/p\u003e\n\u003ch2 id=\"public-key-protocol-is-slow\"\u003ePublic-key protocol is slow\u003c/h2\u003e\n\u003cp\u003eWith gpg, the public-key protocol is only used for encrypting the symmetric key and the hash of the message (hash with SHA-256). The message is then encrypted using the symmetric encryption.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egpg:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    rsa public key ---encrypts--\u0026gt; symmetric key --encrpyts--\u0026gt; message\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                   ---encrypts--\u0026gt; SHA-256 hash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWith SSL protocol, the only purpose of the public-key encryption is to encrypt the AES symmetric key.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003essl:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u0026lt;---client---\u0026gt;             \u0026lt;-----server----\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    rsa public key ---sends--\u0026gt; AES symmetric key\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWhat about ssh? Two pairs of pub/priv keys?\u003c/p\u003e\n\u003ch2 id=\"errors-i-got\"\u003eErrors I got\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eError message with pinentry\n\u003col\u003e\n\u003cli\u003eInstall \u003ccode\u003ebrew install pinentry-mac\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eedit ~/.gnupg/gpg-agent.conf to use pinentry-mac instead of pinentry: pinentry-program /usr/local/bin/pinentry-mac\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n","date":1510099200,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":400,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1510099200,"objectID":"8b3190c9e782dbefa1105dbaa66d7ffe","permalink":"https://maelvls.dev/do-not-share-yet/notes/pgp/","publishdate":"2017-11-08T00:00:00Z","readingtime":2,"relpermalink":"/do-not-share-yet/notes/pgp/","section":"notes","summary":"\u003col\u003e\n\u003cli\u003e\u003ca href=\"#sign-my-message\"\u003eSign my message\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#things-on-securiry\"\u003eThings on securiry\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#public-key-protocol-is-slow\"\u003ePublic-key protocol is slow\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#errors-i-got\"\u003eErrors I got\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eTo list the keys I have in my keyring, use \u003ccode\u003egpg --list-key\u003c/code\u003e. Here, I can see one public key in the file \u003ccode\u003epubring.pgp\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u0026gt; gpg --list-key\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e/Users/mvalais/.gnupg/pubring.gpg\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-------------------------------\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epub   4096R/27F4C016 2016-03-04\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003euid                  Maël Valais \u0026lt;mael.valais@gmail.com\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esub   4096R/A3D4828E 2016-03-04\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe identifier for my public key is \u003ccode\u003e27F4C016\u003c/code\u003e and the sub identifier \u003ccode\u003eA3D4828E\u003c/code\u003e. 4096R = 4096-bits RSA encrypted.\u003c/p\u003e\n\u003cp\u003eWhen seeing the whole primary key fingerprint:\u003c/p\u003e","tags":[],"title":"Some stuff about gpg","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/pgp/","weight":0,"wordcount":319},{"authors":null,"categories":null,"content":"\u003cp\u003eThe Epson iPrint soft is producing PDFs in 300dpi but the 300 information does not seem to be stored in the PDF metadata; thus, the PDF reader thinks by default that it is a 72 dpi PDF and thus the huge size:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e87,49 × 123,72 cm\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003einstead of an A4 paper:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e21 × 29,7 cm\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo convert this 300 dpi into a real 300 dpi:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/ebook -dNOPAUSE -dQUIET -dBATCH -dDetectDuplicateImages -dCompressFonts=true -sPAPERSIZE=a4 -dPDFFitPage -sOutputFile=output.pdf input.pdf\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e/screen selects low-resolution output similar to the Acrobat Distiller (up to version X) \u0026ldquo;Screen Optimized\u0026rdquo; setting.\u003c/li\u003e\n\u003cli\u003e/ebook selects medium-resolution output similar to the Acrobat Distiller (up to version X) \u0026ldquo;eBook\u0026rdquo; setting.\u003c/li\u003e\n\u003cli\u003e/printer selects output similar to the Acrobat Distiller \u0026ldquo;Print Optimized\u0026rdquo; (up to version X) setting.\u003c/li\u003e\n\u003cli\u003e/prepress selects output similar to Acrobat Distiller \u0026ldquo;Prepress Optimized\u0026rdquo; (up to version X) setting.\u003c/li\u003e\n\u003cli\u003e/default selects output intended to be useful across a wide variety of uses, possibly at the expense of a larger output file.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSee:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eopen /usr/local/share/ghostscript/9.22/doc/index.html\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003cpre\u003e\u003ccode\u003e(WORKS BUT BIGGER SIZE AFTERWARDS)\nconvert -units PixelsPerInch -density 300 filein.pdf fileout.pdf\nconvert -units PixelsPerInch EPSON004.pdf -density 300 -quality 30 -compress jpeg fileout.pdf\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003ch2 id=\"color-to-grayscale\"\u003eColor to grayscale\u003c/h2\u003e\n\u003cp\u003eFrom: \u003ca href=\"https://superuser.com/questions/104656/convert-a-pdf-to-greyscale-on-the-command-line-in-floss\"\u003ehttps://superuser.com/questions/104656/convert-a-pdf-to-greyscale-on-the-command-line-in-floss\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003ewhile\u003c/span\u003e \u003cspan class=\"nb\"\u003eread\u003c/span\u003e i\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003edo\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    gs -sDEVICE\u003cspan class=\"o\"\u003e=\u003c/span\u003epdfwrite -sColorConversionStrategy\u003cspan class=\"o\"\u003e=\u003c/span\u003eGray -dProcessColorModel\u003cspan class=\"o\"\u003e=\u003c/span\u003e/DeviceGray -dCompatibilityLevel\u003cspan class=\"o\"\u003e=\u003c/span\u003e1.4 -dNOPAUSE -dBATCH -sOutputFile\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e/.pdf/_gray.pdf\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$i\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edone\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;some.pdf\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eUsing ImageMagick (mogrify):\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emogrify -despeckle -fuzz 5% -fill white -opaque white -gamma 0.8 -colorspace gray -depth \u003cspan class=\"m\"\u003e6\u003c/span\u003e -format png \u003cspan class=\"se\"\u003e\\*\u003c/span\u003e.jpg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"ocr\"\u003eOCR\u003c/h2\u003e\n\u003ch2 id=\"to-black-and-white\"\u003eTo black and white\u003c/h2\u003e\n\u003cp\u003eA SO link talking about that: \u003ca href=\"https://stackoverflow.com/questions/15211428/conversion-of-tiff-to-pdf-with-ghostscript\"\u003ehttps://stackoverflow.com/questions/15211428/conversion-of-tiff-to-pdf-with-ghostscript\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egs -dQUIET -dNOPAUSE -r200 -dBATCH -sPAPERSIZE\u003cspan class=\"o\"\u003e=\u003c/span\u003ea4 -sDEVICE\u003cspan class=\"o\"\u003e=\u003c/span\u003etiffg3 -sOutputFile\u003cspan class=\"o\"\u003e=\u003c/span\u003etemp.tiff -sColorConversionStrategy\u003cspan class=\"o\"\u003e=\u003c/span\u003eMono -sColorConversionStrategyForImages\u003cspan class=\"o\"\u003e=\u003c/span\u003e/Mono -dProcessColorModel\u003cspan class=\"o\"\u003e=\u003c/span\u003e/DeviceGray \u003cspan class=\"s2\"\u003e\u0026#34;a.pdf\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etiff2pdf -o out.pdf -p A4 -F temp.tiff\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eOr:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epdfimages -j \u003cspan class=\"s2\"\u003e\u0026#34;some.pdf\u0026#34;\u003c/span\u003e out/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e out/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emogrify -despeckle -fuzz 5% -fill white -opaque white -gamma 0.8 -colorspace gray -depth \u003cspan class=\"m\"\u003e6\u003c/span\u003e -format png \u003cspan class=\"se\"\u003e\\*\u003c/span\u003e.jpg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"remove-noise-created-by-scanning-text-in-jpeg\"\u003eRemove noise created by scanning text in JPEG\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epdfimages -j \u003cspan class=\"s2\"\u003e\u0026#34;some.pdf\u0026#34;\u003c/span\u003e out/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e out/\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emogrify -despeckle -fuzz 5% -fill white -opaque white -gamma 0.8 -colorspace gray -depth \u003cspan class=\"m\"\u003e6\u003c/span\u003e -format png *.jpg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1505174400,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":400,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1505174400,"objectID":"ee4123539c87b72e5875a0b65a98410b","permalink":"https://maelvls.dev/do-not-share-yet/notes/pdf/","publishdate":"2017-09-12T00:00:00Z","readingtime":2,"relpermalink":"/do-not-share-yet/notes/pdf/","section":"notes","summary":"\u003cp\u003eThe Epson iPrint soft is producing PDFs in 300dpi but the 300 information does not seem to be stored in the PDF metadata; thus, the PDF reader thinks by default that it is a 72 dpi PDF and thus the huge size:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e87,49 × 123,72 cm\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003einstead of an A4 paper:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e21 × 29,7 cm\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo convert this 300 dpi into a real 300 dpi:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/ebook -dNOPAUSE -dQUIET -dBATCH -dDetectDuplicateImages -dCompressFonts=true -sPAPERSIZE=a4 -dPDFFitPage -sOutputFile=output.pdf input.pdf\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e/screen selects low-resolution output similar to the Acrobat Distiller (up to version X) \u0026ldquo;Screen Optimized\u0026rdquo; setting.\u003c/li\u003e\n\u003cli\u003e/ebook selects medium-resolution output similar to the Acrobat Distiller (up to version X) \u0026ldquo;eBook\u0026rdquo; setting.\u003c/li\u003e\n\u003cli\u003e/printer selects output similar to the Acrobat Distiller \u0026ldquo;Print Optimized\u0026rdquo; (up to version X) setting.\u003c/li\u003e\n\u003cli\u003e/prepress selects output similar to Acrobat Distiller \u0026ldquo;Prepress Optimized\u0026rdquo; (up to version X) setting.\u003c/li\u003e\n\u003cli\u003e/default selects output intended to be useful across a wide variety of uses, possibly at the expense of a larger output file.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSee:\u003c/p\u003e","tags":[],"title":"Epson scanner, large PDFs and ImageMagick (convert CLI)","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/pdf/","weight":0,"wordcount":313},{"authors":null,"categories":null,"content":"\u003cp\u003eHere: \u003ca href=\"https://unix.stackexchange.com/questions/12195/how-to-avoid-being-asked-passphrase-each-time-i-push-to-bitbucket\"\u003ehttps://unix.stackexchange.com/questions/12195/how-to-avoid-being-asked-passphrase-each-time-i-push-to-bitbucket\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eTwo solutions:\u003c/p\u003e\n\u003ch2 id=\"using-ssh-agent\"\u003eUsing ssh-agent\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003eeval $(ssh-agent)\nssh-add\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"using-keychain-debianubuntu\"\u003eUsing keychain (debian/ubuntu)\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003eapt-get install keychain\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"using-forwardagent-yes-in-sshconfig\"\u003eUsing \u0026lsquo;ForwardAgent yes\u0026rsquo; in .ssh/config\u003c/h2\u003e\n\u003cp\u003eHere: \u003ca href=\"https://developer.github.com/v3/guides/using-ssh-agent-forwarding\"\u003ehttps://developer.github.com/v3/guides/using-ssh-agent-forwarding\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIf it doesn\u0026rsquo;t work at first, check that the key ~/.ssh/id_rsa is added to ssh-agent, i.e., ssh-add has been run. To avoid re-typing \u0026lsquo;ssh-add\u0026rsquo; and password on every startup, run:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003essh-add -K id_rsa\n\u003c/code\u003e\u003c/pre\u003e\n","date":1496275200,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1496275200,"objectID":"a628e4eb87da3a98ad5e3b0d1eab1556","permalink":"https://maelvls.dev/do-not-share-yet/notes/ssh-agent/","publishdate":"2017-06-01T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/ssh-agent/","section":"notes","summary":"\u003cp\u003eHere: \u003ca href=\"https://unix.stackexchange.com/questions/12195/how-to-avoid-being-asked-passphrase-each-time-i-push-to-bitbucket\"\u003ehttps://unix.stackexchange.com/questions/12195/how-to-avoid-being-asked-passphrase-each-time-i-push-to-bitbucket\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eTwo solutions:\u003c/p\u003e\n\u003ch2 id=\"using-ssh-agent\"\u003eUsing ssh-agent\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003eeval $(ssh-agent)\nssh-add\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"using-keychain-debianubuntu\"\u003eUsing keychain (debian/ubuntu)\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003eapt-get install keychain\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"using-forwardagent-yes-in-sshconfig\"\u003eUsing \u0026lsquo;ForwardAgent yes\u0026rsquo; in .ssh/config\u003c/h2\u003e\n\u003cp\u003eHere: \u003ca href=\"https://developer.github.com/v3/guides/using-ssh-agent-forwarding\"\u003ehttps://developer.github.com/v3/guides/using-ssh-agent-forwarding\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIf it doesn\u0026rsquo;t work at first, check that the key ~/.ssh/id_rsa is added to ssh-agent, i.e., ssh-add has been run. To avoid re-typing \u0026lsquo;ssh-add\u0026rsquo; and password on every startup, run:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003essh-add -K id_rsa\n\u003c/code\u003e\u003c/pre\u003e","tags":[],"title":"Avoid typing the SSH passphrase on Ubuntu using ssh-agent","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/ssh-agent/","weight":0,"wordcount":55},{"authors":null,"categories":null,"content":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etlmgr install texliveonfly\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etexliveonfly main.tex\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill install automatically all packages called using \u003ccode\u003e\\usepackage{}\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eTo find a specific file that latex yells it cannot find:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etlmgr search --global --file fullpage.sty\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1495670400,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1495670400,"objectID":"9dc5d8b9caa612c67fff544c82759203","permalink":"https://maelvls.dev/do-not-share-yet/notes/latex_packages/","publishdate":"2017-05-25T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/latex_packages/","section":"notes","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etlmgr install texliveonfly\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etexliveonfly main.tex\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003ewill install automatically all packages called using \u003ccode\u003e\\usepackage{}\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eTo find a specific file that latex yells it cannot find:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etlmgr search --global --file fullpage.sty\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[],"title":"Managing Basic Texlive instead of Full Texlive/Mactex","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/latex_packages/","weight":0,"wordcount":29},{"authors":null,"categories":null,"content":"\u003cp\u003eToken server at IRIT:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ematlab -nodecktop -nodisplay -c 27000@licence.irit.fr\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eor\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eSERVER licence.irit.fr 0050568A1251 27000\nUSE_SERVER\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ein \u003ccode\u003e/Applications/MATLAB_R2016a.app/licenses/irit.lic\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eWhat toolbox can I access? \u003ccode\u003ever\u003c/code\u003e Know what licence file is used: \u003ccode\u003ematlab -e\u003c/code\u003e or \u003ccode\u003ematlab -n\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"which-licenses-at-irit\"\u003eWhich licenses at IRIT\u003c/h2\u003e\n\u003cp\u003econnecto to bali and do\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e /usr/local/matlab/etc/lmstat -a\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"on-cauchymathups-tlsefr\"\u003eOn cauchy.math.ups-tlse.fr\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003e/opt/MATLABR2016a/toolbox/distcomp/bin\n\n./mdce start\n./admincenter\n./nodestatus\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"matlab-r2015a-hangs-at-startup\"\u003eMatlab R2015a hangs at startup\u003c/h2\u003e\n\u003cp\u003eEdit the shell script and go to line\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecd /Applications/MATLAB_R2015a.app/bin/\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI did a \u003ccode\u003ediff matlab matlab_patched\u003c/code\u003e; you can patch it:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epatch matlab \u003cspan class=\"s\"\u003e\u0026lt;\u0026lt; EOF\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e497c497\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e\u0026lt;     arglist=\u0026#34;\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e---\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003e\u0026gt;     arglist=\u0026#34;-c \\$MATLABdefault/licenses/license.lic\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s\"\u003eEOF\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eNote the \u003ccode\u003e\\$\u003c/code\u003e because of the shell treatment.\u003c/p\u003e\n","date":1489968000,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1489968000,"objectID":"58be2466af3e1e869d9c34292513e391","permalink":"https://maelvls.dev/do-not-share-yet/notes/matlab/","publishdate":"2017-03-20T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/matlab/","section":"notes","summary":"\u003cp\u003eToken server at IRIT:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ematlab -nodecktop -nodisplay -c 27000@licence.irit.fr\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eor\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eSERVER licence.irit.fr 0050568A1251 27000\nUSE_SERVER\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ein \u003ccode\u003e/Applications/MATLAB_R2016a.app/licenses/irit.lic\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eWhat toolbox can I access? \u003ccode\u003ever\u003c/code\u003e Know what licence file is used: \u003ccode\u003ematlab -e\u003c/code\u003e or \u003ccode\u003ematlab -n\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"which-licenses-at-irit\"\u003eWhich licenses at IRIT\u003c/h2\u003e\n\u003cp\u003econnecto to bali and do\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e /usr/local/matlab/etc/lmstat -a\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"on-cauchymathups-tlsefr\"\u003eOn cauchy.math.ups-tlse.fr\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003e/opt/MATLABR2016a/toolbox/distcomp/bin\n\n./mdce start\n./admincenter\n./nodestatus\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"matlab-r2015a-hangs-at-startup\"\u003eMatlab R2015a hangs at startup\u003c/h2\u003e\n\u003cp\u003eEdit the shell script and go to line\u003c/p\u003e","tags":[],"title":"Using Matlab at IRIT","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/matlab/","weight":0,"wordcount":97},{"authors":null,"categories":null,"content":"\u003ch2 id=\"warning-ignoring-because-its-extensions-are-not-built\"\u003eWarning \u0026lsquo;Ignoring\u0026hellip; because its extensions are not built\u0026rsquo;\u003c/h2\u003e\n\u003cp\u003eThe message is:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eIgnoring atomic-1.1.101 because its extensions are not built.  Try: gem pristine atomic --version 1.1.101\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTry:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egem 2\u0026gt;\u0026amp;1 | perl -ne '/Try: gem pristine ([^ ]+)/ \u0026amp;\u0026amp; print $1 . \u0026quot; \u0026quot;' | xargs gem pristine\n\u003c/code\u003e\u003c/pre\u003e\n","date":1486252800,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1486252800,"objectID":"08e6ef6c408ceae76a4bb98545aa917b","permalink":"https://maelvls.dev/do-not-share-yet/notes/ruby/","publishdate":"2017-02-05T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/ruby/","section":"notes","summary":"\u003ch2 id=\"warning-ignoring-because-its-extensions-are-not-built\"\u003eWarning \u0026lsquo;Ignoring\u0026hellip; because its extensions are not built\u0026rsquo;\u003c/h2\u003e\n\u003cp\u003eThe message is:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eIgnoring atomic-1.1.101 because its extensions are not built.  Try: gem pristine atomic --version 1.1.101\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTry:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003egem 2\u0026gt;\u0026amp;1 | perl -ne '/Try: gem pristine ([^ ]+)/ \u0026amp;\u0026amp; print $1 . \u0026quot; \u0026quot;' | xargs gem pristine\n\u003c/code\u003e\u003c/pre\u003e","tags":[],"title":"Stuff about managing Ruby \u0026 rvm","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/ruby/","weight":0,"wordcount":46},{"authors":null,"categories":null,"content":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econvert -resample 72x72 -compress JPEG -quality \u003cspan class=\"m\"\u003e20\u003c/span\u003e a.jpg a.pdf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econvert -resample 72x72 -compress JPEG -quality \u003cspan class=\"m\"\u003e20\u003c/span\u003e a.jpg a.pdf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWARNING: convert (imagemagick) often bugs as it uses external tools such as \u003ccode\u003egs\u003c/code\u003e and \u003ccode\u003effmpeg\u003c/code\u003e; reinstalling Ghostcript can help.\u003c/p\u003e\n","date":1485734400,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1485734400,"objectID":"c6af5ab95da966d1303da6ff1cc8dbfe","permalink":"https://maelvls.dev/do-not-share-yet/notes/lighter_pdfs/","publishdate":"2017-01-30T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/lighter_pdfs/","section":"notes","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econvert -resample 72x72 -compress JPEG -quality \u003cspan class=\"m\"\u003e20\u003c/span\u003e a.jpg a.pdf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econvert -resample 72x72 -compress JPEG -quality \u003cspan class=\"m\"\u003e20\u003c/span\u003e a.jpg a.pdf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWARNING: convert (imagemagick) often bugs as it uses external tools such as \u003ccode\u003egs\u003c/code\u003e and \u003ccode\u003effmpeg\u003c/code\u003e; reinstalling Ghostcript can help.\u003c/p\u003e","tags":[],"title":"Get lighter PDFs","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/lighter_pdfs/","weight":0,"wordcount":37},{"authors":null,"categories":null,"content":"\u003cp\u003eOn the university server azteca or inca (must use vpn or sassh through-pass)\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eexport http_proxy=proxy.univ-tlse3.fr:3128\nexport https_proxy=proxy.univ-tlse3.fr:3128\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen,\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eruby -e \u0026quot;$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install)\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eBut on linux with gcc-4.4.7 only, I had also to follow the instructions on \u003ca href=\"https://github.com/Linuxbrew/homebrew-core/issues/4077\"\u003ehttps://github.com/Linuxbrew/homebrew-core/issues/4077\u003c/a\u003e. It will\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003efirst install glibc 2.20\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003einstall gcc-5 and others\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethen upgrade to glibc 2.23\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --only-dependencies glibc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --ignore-dependencies https://raw.githubusercontent.com/Linuxbrew/homebrew-core/6fb5dfd50895416bea3d00628b8d3b41fa1f4f32/Formula/glibc.rb \u003cspan class=\"c1\"\u003e# 2.20\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --ignore-dependencies xz gmp mpfr libmpc isl gcc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew upgrade glibc\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThen I also got on the last \u003ccode\u003ebrew upgrade glibc\u003c/code\u003e an \u0026lsquo;Illegal instruction\u0026rsquo;; the issue is mentionned in\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/Linuxbrew/legacy-linuxbrew/issues/173\"\u003ehttps://github.com/Linuxbrew/legacy-linuxbrew/issues/173\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/Linuxbrew/homebrew-core/issues/4244\"\u003ehttps://github.com/Linuxbrew/homebrew-core/issues/4244\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e(gcc failing) \u003ca href=\"https://github.com/Linuxbrew/brew/issues/488\"\u003ehttps://github.com/Linuxbrew/brew/issues/488\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e(gmp 6.1.2 issue) \u003ca href=\"https://github.com/Linuxbrew/homebrew-core/issues/4261\"\u003ehttps://github.com/Linuxbrew/homebrew-core/issues/4261\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe error was:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-plain\" data-lang=\"plain\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emake[2]: *** [/tmp/glibc-20170921-55100-dli0th/glibc-2.23/build/csu/elf-init.oS] Erreur 1\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elibc-tls.c: In function \u0026#39;__libc_setup_tls\u0026#39;:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003elibc-tls.c:105:1: internal compiler error: Illegal instruction\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e __libc_setup_tls (size_t tcbsize, size_t tcbalign)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e ^\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e../sysdeps/x86/libc-start.c: In function \u0026#39;__libc_start_main\u0026#39;:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e../sysdeps/x86/libc-start.c:20:0: internal compiler error: Illegal instruction\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e # else\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e ^\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e../sysdeps/x86/libc-start.c: In function \u0026#39;apply_irel\u0026#39;:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e../sysdeps/x86/libc-start.c:40:1: internal compiler error: Illegal instruction\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e }\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e ^\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0x7f23a592972f ???\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    /tmp/glibc-20170921-64874-12af6ru/glibc-2.20/signal/../sysdeps/unix/sysv/linux/x86_64/sigaction.c:0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e0x7f23a59167cc __libc_start_main\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    /tmp/glibc-20170921-64874-12af6ru/glibc-2.20/csu/libc-start.c:289\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePlease submit a full bug report,\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ewith preprocessed source if appropriate.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePlease include the complete backtrace with any bug report.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eSee \u0026lt;https://github.com/Homebrew/homebrew/issues\u0026gt; for instructions.\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eTo install gmp 6.1.1:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ebrew install --ignore-dependencies https://raw.githubusercontent.com/Linuxbrew/homebrew-core/58cb0879c8b423ccf7a7cfd8641abc13da5a0753/Formula/gmp.rb\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo avoid \u0026lsquo;brew updating\u0026hellip;\u0026rsquo; all the time:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eexport HOMEBREW_NO_AUTO_UPDATE=1\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNOTE: to install on REHL 6.9 or CentOS6, just use the commands given by sjackman at \u003ca href=\"https://github.com/Linuxbrew/brew/wiki/CentOS6\"\u003ehttps://github.com/Linuxbrew/brew/wiki/CentOS6\u003c/a\u003e\u003c/p\u003e\n","date":1481760000,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":300,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1481760000,"objectID":"3d97682b546d747745551586fd802ec8","permalink":"https://maelvls.dev/do-not-share-yet/notes/linuxbrew/","publishdate":"2016-12-15T00:00:00Z","readingtime":2,"relpermalink":"/do-not-share-yet/notes/linuxbrew/","section":"notes","summary":"\u003cp\u003eOn the university server azteca or inca (must use vpn or sassh through-pass)\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eexport http_proxy=proxy.univ-tlse3.fr:3128\nexport https_proxy=proxy.univ-tlse3.fr:3128\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen,\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eruby -e \u0026quot;$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install)\u0026quot;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eBut on linux with gcc-4.4.7 only, I had also to follow the instructions on \u003ca href=\"https://github.com/Linuxbrew/homebrew-core/issues/4077\"\u003ehttps://github.com/Linuxbrew/homebrew-core/issues/4077\u003c/a\u003e. It will\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003efirst install glibc 2.20\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003einstall gcc-5 and others\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethen upgrade to glibc 2.23\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --only-dependencies glibc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --ignore-dependencies https://raw.githubusercontent.com/Linuxbrew/homebrew-core/6fb5dfd50895416bea3d00628b8d3b41fa1f4f32/Formula/glibc.rb \u003cspan class=\"c1\"\u003e# 2.20\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew install --ignore-dependencies xz gmp mpfr libmpc isl gcc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebrew upgrade glibc\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThen I also got on the last \u003ccode\u003ebrew upgrade glibc\u003c/code\u003e an \u0026lsquo;Illegal instruction\u0026rsquo;; the issue is mentionned in\u003c/p\u003e","tags":[],"title":"Using Linyxbrew on university servers","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/linuxbrew/","weight":0,"wordcount":215},{"authors":null,"categories":null,"content":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eopen -a MacDown README.md    \u003cspan class=\"c1\"\u003e# open README.md in MacDown\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emdfind                       \u003cspan class=\"c1\"\u003e# spotlight\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epbcopy                       \u003cspan class=\"c1\"\u003e# copy from stdin to pb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epbpaste                      \u003cspan class=\"c1\"\u003e# paste from pb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekillall MacDown              \u003cspan class=\"c1\"\u003e# same as kill but with app name\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1476921600,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1476921600,"objectID":"966df6f0799812083648bd0aa168c0be","permalink":"https://maelvls.dev/do-not-share-yet/notes/mac_commands/","publishdate":"2016-10-20T00:00:00Z","readingtime":1,"relpermalink":"/do-not-share-yet/notes/mac_commands/","section":"notes","summary":"\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eopen -a MacDown README.md    \u003cspan class=\"c1\"\u003e# open README.md in MacDown\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emdfind                       \u003cspan class=\"c1\"\u003e# spotlight\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epbcopy                       \u003cspan class=\"c1\"\u003e# copy from stdin to pb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epbpaste                      \u003cspan class=\"c1\"\u003e# paste from pb\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ekillall MacDown              \u003cspan class=\"c1\"\u003e# same as kill but with app name\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","tags":[],"title":"Interesting macOS-specific commands","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/mac_commands/","weight":0,"wordcount":34},{"authors":null,"categories":null,"content":"\u003col\u003e\n\u003cli\u003e\u003ca href=\"#general-information\"\u003eGeneral information\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#sed\"\u003eSed\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#shell-terminal-console-command-line\"\u003eShell, terminal, console, command line\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#bash_profile-vs-bashrc\"\u003e\u003ccode\u003e.bash_profile\u003c/code\u003e vs \u003ccode\u003e.bashrc\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#tty-pty-interactive-vs-non-interactive\"\u003eTty, pty, interactive vs non-interactive\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#login-vs-non-login-shells\"\u003eLogin vs. non-login shells\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#use-bashrc-also-on-login-shell\"\u003eUse \u003ccode\u003ebashrc\u003c/code\u003e also on login shell\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#parallelize-xargs\"\u003eParallelize xargs\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#discrepencies-between-binsh-versions\"\u003eDiscrepencies between /bin/sh versions\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"general-information\"\u003eGeneral information\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eXargs for creating positionnals through stdin \u003ccode\u003eincluded_figures.sh | xargs git add\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAvoid the sub-shell problem when \u003ccode\u003ewhile read a\u003c/code\u003e \u003ccode\u003ewhile read a; do ...; done \u0026lt; \u0026lt;(ls)\u003c/code\u003e pour éviter d\u0026rsquo;avoir le while dans un sous-shell C.f. Process Substitution dans man bash\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eParameter Expansion (man bash -\u0026gt; /Parameter Expansion) \u003ccode\u003e${a:-text}\u003c/code\u003e if $a isn\u0026rsquo;t set, the${} expression returns \u0026ldquo;text\u0026rdquo; \u003ccode\u003e${a:+text}\u003c/code\u003e if $a isn\u0026rsquo;t set, the${} expression returns nothing \u003ccode\u003e${a:=text}\u003c/code\u003e same but $a is also set to \u0026ldquo;text\u0026rdquo; \u003ccode\u003e${a// /_/}\u003c/code\u003e substitutes all spaces to \u003ccode\u003e_\u003c/code\u003e in the content of a\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eiterate on each space-separated elements of a list for e in \u003ccode\u003eecho \u0026quot;a b c d e\u0026quot;\u003c/code\u003e; do echo $e done\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTo know if a variable is empty or not (\u003ccode\u003eman test\u003c/code\u003e): -n STRING the length of STRING is nonzero -z STRING the length of STRING is zero\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"sed\"\u003eSed\u003c/h2\u003e\n\u003cp\u003eSubstitute dots to \u003ccode\u003e_\u003c/code\u003e in filenames:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003efor f in *; do mv \u0026quot;$f\u0026quot; \u0026quot;`echo $f | sed 's/\\(.*\\)\\.\\(.*\\)\\(\\.[a-z]*\\)$/\\1_\\2\\3/g'`\u0026quot;; done\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"shell-terminal-console-command-line\"\u003eShell, terminal, console, command line\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eTerminal text input/output environment (also means a specific file in Unix world) ttys001, ttys002\u0026hellip; are Unix \u0026ldquo;terminal\u0026rdquo; files. These are provided by the kernel\u003c/li\u003e\n\u003cli\u003eVirtual/emulated terminal layer over the plain Unix terminal (iTerm2, etc)\u003c/li\u003e\n\u003cli\u003eConsole local physical terminal (with screen and keyboard)\u003c/li\u003e\n\u003cli\u003eShell when launching a terminal (ttys001\u0026hellip;), it is the program that allows to launch other programs (commands like \u003ccode\u003els\u003c/code\u003e)\u003c/li\u003e\n\u003cli\u003eCommand-line shell A shell specialized for interpreting commands\u003c/li\u003e\n\u003cli\u003eBash one of the many command-line shells\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003etty\u003c/code\u003e: Teletype, meaning interactive terminal, as opposed to tty-less/headless terminal.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003epty\u003c/code\u003e: pseudo-teletype is a tty that does not directly talk to a end-user terminal but instead talks to another terminal. Most terminal emulators such as iTerm2, xterm\u0026hellip; use a pty instead of a tty.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhat happens when I want to launch some bourne-shell commands:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eOpen a terminal emulator\u003c/li\u003e\n\u003cli\u003eThe terminal emulator will open a ttys001 for me\u003c/li\u003e\n\u003cli\u003eThe terminal emulator will then execute a command-line shell (/bin/sh)\u003c/li\u003e\n\u003cli\u003ethen I can type my commands\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"bash_profile-vs-bashrc\"\u003e\u003ccode\u003e.bash_profile\u003c/code\u003e vs \u003ccode\u003e.bashrc\u003c/code\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e.bash_profile\u003c/code\u003e (and \u003ccode\u003e.profile\u003c/code\u003e) when login shell\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e.bashrc\u003c/code\u003e when interactive shell (tty/pty)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eA login shell is a shell where $0 == \u0026ldquo;-\u0026rdquo;\u003c/p\u003e\n\u003ch2 id=\"tty-pty-interactive-vs-non-interactive\"\u003eTty, pty, interactive vs non-interactive\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003enode -p -e \u0026quot;Boolean(process.stdout.isTTY)\u0026quot;\n[ -t 1 ]\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"login-vs-non-login-shells\"\u003eLogin vs. non-login shells\u003c/h2\u003e\n\u003cp\u003eAn interactive login shell is the shell launched when using ssh, iTerm2 or xterm. In interactive login shell, \u003ccode\u003e.profile\u003c/code\u003e and \u003ccode\u003e.bash_profile\u003c/code\u003e are used. To know if you are in a login shell:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-bash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eInteractive non-login shell: \u003ccode\u003e.bashrc\u003c/code\u003e is used\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e$ \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"nv\"\u003e$0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ebash\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"use-bashrc-also-on-login-shell\"\u003eUse \u003ccode\u003ebashrc\u003c/code\u003e also on login shell\u003c/h2\u003e\n\u003cp\u003eWhat I did was to add a simple thing to \u003ccode\u003e.profile\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003e -f ~/.bashrc \u003cspan class=\"o\"\u003e]\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"k\"\u003ethen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    . ~/.bashrc\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efi\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"parallelize-xargs\"\u003eParallelize xargs\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003e/usr/local/bin/code --list-extensions | xargs -L 1 -P 4 /usr/local/bin/code-insiders --install-extension\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"discrepencies-between-binsh-versions\"\u003eDiscrepencies between /bin/sh versions\u003c/h2\u003e\n\u003cp\u003eOn Ubuntu, \u003ccode\u003e/bin/sh\u003c/code\u003e is hard-linked to \u003ccode\u003e/bin/dash\u003c/code\u003e. On macOS, \u003ccode\u003e/bin/sh\u003c/code\u003e is hard-linked to \u003ccode\u003e/bin/bash\u003c/code\u003e. None of them are the original \u0026ldquo;Bourne shell\u0026rdquo;!\u003c/p\u003e\n\u003cp\u003eOn top of that, \u003ccode\u003emake\u003c/code\u003e always uses \u003ccode\u003e/bin/sh\u003c/code\u003e, which means there are discrepancies between Ubuntu and macOS:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ebash knows about \u003ccode\u003e\u0026lt;\u0026lt;\u0026lt;\u003c/code\u003e (here-string), but dash doesn\u0026rsquo;t\u003c/li\u003e\n\u003cli\u003ebash knows about \u003ccode\u003e\u0026lt;()\u003c/code\u003e (process substitution), but dash doesn\u0026rsquo;t\u003c/li\u003e\n\u003cli\u003ebash knows about \u003ccode\u003e${a/b/c}\u003c/code\u003e (glob variable content replace) but dash doesn\u0026rsquo;t\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-sh\" data-lang=\"sh\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e\u0026#39;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003ebar\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s1\"\u003e% dash -c \u0026#39;\u003c/span\u003e\u003cspan class=\"nv\"\u003eA\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003efoo\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"nb\"\u003eecho\u003c/span\u003e \u003cspan class=\"si\"\u003e${\u003c/span\u003e\u003cspan class=\"nv\"\u003eA\u003c/span\u003e\u003cspan class=\"p\"\u003e/foo/bar\u003c/span\u003e\u003cspan class=\"si\"\u003e}\u003c/span\u003e\u003cspan class=\"err\"\u003e\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003edash: 1: Bad substitution\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-mysql\" data-lang=\"mysql\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"n\"\u003eWorkaround\u003c/span\u003e\u003cspan class=\"o\"\u003e**\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eforce\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"n\"\u003emake\u003c/span\u003e\u003cspan class=\"o\"\u003e`\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003eto\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003euse\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ea\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ewell\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eknown\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eshell\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003ee\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eg\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"k\"\u003ein\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eyour\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"n\"\u003eMakefile\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e```\u003c/span\u003e\u003cspan class=\"n\"\u003esh\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"w\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eSHELL\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"w\"\u003e \u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ebin\u003c/span\u003e\u003cspan class=\"o\"\u003e/\u003c/span\u003e\u003cspan class=\"n\"\u003ebash\u003c/span\u003e\u003cspan class=\"w\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e","date":1468022400,"description":"","dir":"notes/","expirydate":-62135596800,"fuzzywordcount":600,"images":null,"keywords":null,"kind":"page","lang":"en","lastmod":1468022400,"objectID":"d494efdf185ef47b08ac62e13f653e4e","permalink":"https://maelvls.dev/do-not-share-yet/notes/shell/","publishdate":"2016-07-09T00:00:00Z","readingtime":3,"relpermalink":"/do-not-share-yet/notes/shell/","section":"notes","summary":"\u003col\u003e\n\u003cli\u003e\u003ca href=\"#general-information\"\u003eGeneral information\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#sed\"\u003eSed\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#shell-terminal-console-command-line\"\u003eShell, terminal, console, command line\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#bash_profile-vs-bashrc\"\u003e\u003ccode\u003e.bash_profile\u003c/code\u003e vs \u003ccode\u003e.bashrc\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#tty-pty-interactive-vs-non-interactive\"\u003eTty, pty, interactive vs non-interactive\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#login-vs-non-login-shells\"\u003eLogin vs. non-login shells\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#use-bashrc-also-on-login-shell\"\u003eUse \u003ccode\u003ebashrc\u003c/code\u003e also on login shell\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#parallelize-xargs\"\u003eParallelize xargs\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#discrepencies-between-binsh-versions\"\u003eDiscrepencies between /bin/sh versions\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"general-information\"\u003eGeneral information\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eXargs for creating positionnals through stdin \u003ccode\u003eincluded_figures.sh | xargs git add\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAvoid the sub-shell problem when \u003ccode\u003ewhile read a\u003c/code\u003e \u003ccode\u003ewhile read a; do ...; done \u0026lt; \u0026lt;(ls)\u003c/code\u003e pour éviter d\u0026rsquo;avoir le while dans un sous-shell C.f. Process Substitution dans man bash\u003c/p\u003e","tags":[],"title":"What I know about shells","type":"notes","url":"https://maelvls.dev/do-not-share-yet/notes/shell/","weight":0,"wordcount":578},{"authors":null,"categories":null,"content":"","date":-62135596800,"description":"","dir":"","expirydate":-62135596800,"fuzzywordcount":100,"images":null,"keywords":null,"kind":"taxonomy","lang":"en","lastmod":-62135596800,"objectID":"https://maelvls.dev/do-not-share-yet/series/","permalink":"https://maelvls.dev/do-not-share-yet/series/","publishdate":"0001-01-01T00:00:00Z","readingtime":0,"relpermalink":"/do-not-share-yet/series/","section":"series","summary":"","tags":null,"title":"Series","type":"series","url":"https://maelvls.dev/do-not-share-yet/series/","weight":0,"wordcount":0}]