<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.64.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=author content="MaÃ«l Valais"><meta name=keywords content="kubernetes,mitmproxy,networking,kind"><meta name=description content="Mitmproxy is an excellent tool that helps us understand what network calls are made by programs. And kubectl is one of these interesting programs, but it uses a mutual TLS authentication which is tricky to get right."><meta property="og:title" content="Using mitmproxy to understand what kubectl does under the hood"><meta property="og:description" content="Mitmproxy is an excellent tool that helps us understand what network calls are made by programs. And kubectl is one of these interesting programs, but it uses a mutual TLS authentication which is tricky to get right."><meta property="og:type" content="article"><meta property="og:url" content="https://maelvls.dev/mitmproxy-kubectl/"><meta property="og:image" content="https://maelvls.dev/mitmproxy-kubectl/cover-mitmproxy-kubectl.png"><meta property="article:published_time" content="2020-07-01T19:17:24+02:00"><meta property="article:modified_time" content="2020-07-01T19:17:24+02:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://maelvls.dev/mitmproxy-kubectl/cover-mitmproxy-kubectl.png"><meta name=twitter:title content="Using mitmproxy to understand what kubectl does under the hood"><meta name=twitter:description content="Mitmproxy is an excellent tool that helps us understand what network calls are made by programs. And kubectl is one of these interesting programs, but it uses a mutual TLS authentication which is tricky to get right."><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=stylesheet type=text/css media=screen href=https://maelvls.dev/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://maelvls.dev/css/main.css><link rel=stylesheet type=text/css media=screen href=https://maelvls.dev/css/all.css><link rel=stylesheet type=text/css media=screen href=https://maelvls.dev/css/maelvls.css><title>Using mitmproxy to understand what kubectl does under the hood | maelvls dev blog</title></head><body><header><div id=avatar><a href=https://maelvls.dev/><img src=/img/mael.jpg alt="maelvls dev blog"></a></div><div id=titletext><h2 id=title><a href=https://maelvls.dev/>maelvls dev blog</a></h2></div><div id=title-description><p id=subtitle>Systems software engineer. I write mostly about Kubernetes and Go. <a href=/about>About</a></p><div id=social><nav><ul><li><a href=https://github.com/maelvls><i title=Github class="icons fab fa-github"></i></a></li><li><a href=https://twitter.com/maelvls><i title=Twitter class="icons fab fa-twitter"></i></a></li></ul></nav></div></div><div id=mainmenu></div></header><main><div class=post><div class=author></div><div class=post-header><div class=meta><div class=date><span class=day>01</span>
<span class=rest>Jul 2020</span></div></div><div class=matter><h1 class=title>Using mitmproxy to understand what kubectl does under the hood</h1></div></div><div class=markdown><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/30a0WrfaS2A style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>In Oct 2019, Ahmet Alp Balkan wrote <a href=https://ahmet.im/blog/kubectl-man-in-the-middle>this blog
post</a> that explains how to
use <code>mitmproxy</code> to observe the requests made by <code>kubectl</code>. But I couldn&rsquo;t
use the tutorial for two reasons:</p><ul><li>I use <code>kind</code> to create local clusters which means I hit the Go <code>net/http</code>
limitation (skips proxying for hosts <code>localhost</code> and <code>127.0.0.1</code>, see
<a href=(https://maelvls.dev/go-ignores-proxy-localhost/)>this blog post</a>)</li><li>I use client certs authentication, which can&rsquo;t work with the method
presented by Ahmet; it can only work for header-based authentication
(e.g. token) but not for client certs.</li></ul><p>In the following, I detail how I managed to make all that work.</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh><span class=c1># Let&#39;s use a separate kubeconfig file to avoid messing with ~/.kube/config.</span>
<span class=nb>export</span> <span class=nv>KUBECONFIG</span><span class=o>=</span>~/.kube/kind-kind

<span class=c1># Now, let&#39;s create a cluster.</span>
kind create cluster

<span class=c1># Let&#39;s see what the content of $KUECONFIG is:</span>
cat <span class=nv>$KUBECONFIG</span>
</code></pre></div><p>We can see that the kubeconfig uses a client cert as a way to authenticate
to the apiserver.</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>apiVersion</span><span class=p>:</span><span class=w> </span>v1<span class=w>
</span><span class=w></span><span class=k>clusters</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=k>cluster</span><span class=p>:</span><span class=w>
</span><span class=w></span><span class=w>    </span><span class=k>certificate-authority-data</span><span class=p>:</span><span class=w> </span>LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUN5RENDQWJDZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJd01EWXlPVEE1TURJeU4xb1hEVE13TURZeU56QTVNREl5TjFvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBS25qCmhmRzBvenZVb05jMXY1STkvYm13dFBqb2QvK0RyczF4TFZOcWgxQjhFcTY1S3lnQjBSbDdQcTJueUhyRVRnTmsKZ2VPQ2RzRURObGpKOE12SC9GbE9nRkUvS0dqK2hwN2hwc0dHRExReWFUOExUY25JN0FNL2t3KzY5R0hidlN3Nwo2V0Y1VERTMDU1RkRqdnRveGdHcERycmZQZTk5bXN5Zmk3aWtteDk5MmRyMHFQd0xxanJpZHNkWU52MUZqU1Y1CndkRlFISGxBS2hBcmlUWmpQMnhNL3poOENBOFhndjF0UUxVVk5IS1hrSG5UYWlkeFY1MkduaUVaQmd0d2tSK3oKQ3hQempVZFAxQ1JRYzU0YmxDYW9FQVdTc0NYTUVPREhTSnowSi9CWHJCU2JaeGZIakd0Y0k0bEhBUmx2aURNawp3U3lOLy9qdE9tbWhDT29BTzBzQ0F3RUFBYU1qTUNFd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFIMDBrYnZpaWNNT3IxdFJoTkQweVpGa3ZkT1AKUzFGOEZKK1BFd1o1WExUTVVyVG1yekVlZmgza21xWkxYUnlyK3c0Snk1a0grK1o3enBpdlp6Q3BGOEtwclJaWAp5N2Z6TkJOeWMrOHFKN3dCek0xZ21BdTRha3BlNVBYbkw3akZIcU9aUmNXTmZKcUpTci9BS05sK2c2SjAzV2pnCmJDc0NQNTNrZ1czSDZYMkRoS1JzZFRWQlc1UGVlek1YRVlON2VYbGpnWE4xcElMdEU1VE5oWVZIcTZaUDVCaDkKMmU2Y1U4bEFuNlhYQ0Ira2RsTkhudGp1cTlSL2lPQVJRaWpVSVlWSFdCT1NyWGp6TnhkTklEakRRd3lKUnViMApDVEhrcDg4eUlNaEV1Nk1OV1VCUU82ZnVqbURHbUJJbTlzdzJpSnI1UlArSUVUVnQyWFc0Q2dHT1cwVT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=<span class=w>
</span><span class=w>    </span><span class=k>server</span><span class=p>:</span><span class=w> </span>https<span class=p>:</span>//<span class=m>127.0</span><span class=m>.0</span><span class=m>.1</span><span class=p>:</span><span class=m>53744</span><span class=w>
</span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span>kind-helix<span class=w>
</span><span class=w></span><span class=k>contexts</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=k>context</span><span class=p>:</span><span class=w>
</span><span class=w></span><span class=w>    </span><span class=k>cluster</span><span class=p>:</span><span class=w> </span>kind-helix<span class=w>
</span><span class=w>    </span><span class=k>user</span><span class=p>:</span><span class=w> </span>kind-helix<span class=w>
</span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span>kind-helix<span class=w>
</span><span class=w></span><span class=k>current-context</span><span class=p>:</span><span class=w> </span>kind-helix<span class=w>
</span><span class=w></span><span class=k>kind</span><span class=p>:</span><span class=w> </span>Config<span class=w>
</span><span class=w></span><span class=k>preferences</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span><span class=w></span><span class=k>users</span><span class=p>:</span><span class=w>
</span><span class=w></span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>kind-helix<span class=w>
</span><span class=w>  </span><span class=k>user</span><span class=p>:</span><span class=w>
</span><span class=w></span><span class=w>    </span><span class=k>client-certificate-data</span><span class=p>:</span><span class=w> </span>LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM4akNDQWRxZ0F3SUJBZ0lJYTZXc25HT0RGZW93RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TURBMk1qa3dPVEF5TWpkYUZ3MHlNVEEyTWprd09UQXlNekJhTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXRkbkxsb0V1cnFoSmRrMGgKME5VcXpFSHhUbmVHS040QTNtWDBobmFLcE1TT3hISlBQcTB6V0t4WEVxNTZPTkdhSkhvS0VTRUM2Yjh2MGcwTQo5dXVGOXJyQ1VORkpXMmdHcFArRG96TEpVS3RtN2F0WFZRYXNVQ2tjbFRtQ003aHlqOGZTTlRDd2lxT3RNOUFvCnFVVTJYd1k0a2xhL0RuMkRBc1V1VmNiUTdITDA1N0tFbjZvVzlFVy9mQ2hMVE5OTWhmelpkNzFISGs3MFNOZDMKTG5jTXNjNmp2eS9kN2MwbjM4ek45SjVzWVZOTjNsS1YvOU5MT2FaTEQ0bSsyVU5XV1FVazRuci8rZjlaZk1IMwphVlFibDZSWEZwaW1jYWg4UjRJTmhRNkhYbmVEbUI2dUl3RGdjQnhhQUtoNFVPVlZwODB1Uy9pYUVLV1VSWE1PCkg4YXBZUUlEQVFBQm95Y3dKVEFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFJaWtmbis5TkJQc2FNSzNVMU5pWmtBaWxsM1pWVXJDdzNsWgpIeGRGbm9MZGxZYmtPeFVEN25EK3lrNXhZWW4yaDc3WUU4NlU5czJ3aitkdFJTR2Ezc3p4WVJQbkt5MDN3L1M4CkhqZzhwSkZOZFhHWlNPUWJDQTBmT1BONXl5MlpYRlVWd0JwZ3VTMC9nTkNUUkRPUDl3QmNjQXhiSGRmSjMxQzQKa2hCemF4QXI5UEliMVBzUlhqS2ZSRnkvcllwYWRBYVhhYmZMOFRvbTJ4cGpLVDYreGxoL3lJb2tZbVhxSnlXRgp1SGFmWG1qUEdyRDFoZUo2UnR5U0xRM0dKUXQxWmVPK3BaYlJlRjcxU0ZRSjRQdFhtTHhGMjZQL3dlV3F0NWFJClhTK0ZnanRYbzZqUG1mWWRweDZ3bWp3UHRaZ1pRdXhSL2tsejVvQnErNnFaYUZDWXg4RT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=<span class=w>
</span><span class=w>    </span><span class=k>client-key-data</span><span class=p>:</span><span class=w> </span>LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBdGRuTGxvRXVycWhKZGswaDBOVXF6RUh4VG5lR0tONEEzbVgwaG5hS3BNU094SEpQClBxMHpXS3hYRXE1Nk9OR2FKSG9LRVNFQzZiOHYwZzBNOXV1RjlyckNVTkZKVzJnR3BQK0RvekxKVUt0bTdhdFgKVlFhc1VDa2NsVG1DTTdoeWo4ZlNOVEN3aXFPdE05QW9xVVUyWHdZNGtsYS9EbjJEQXNVdVZjYlE3SEwwNTdLRQpuNm9XOUVXL2ZDaExUTk5NaGZ6WmQ3MUhIazcwU05kM0xuY01zYzZqdnkvZDdjMG4zOHpOOUo1c1lWTk4zbEtWCi85TkxPYVpMRDRtKzJVTldXUVVrNG5yLytmOVpmTUgzYVZRYmw2UlhGcGltY2FoOFI0SU5oUTZIWG5lRG1CNnUKSXdEZ2NCeGFBS2g0VU9WVnA4MHVTL2lhRUtXVVJYTU9IOGFwWVFJREFRQUJBb0lCQVFDVkNJOXZJeVB0QkFKZwpyOG44NmhhUEc2UDFtTU1jandUTFAyZHRJNDF3aDU0eHBUVUl1czJQNkgzYjA1NWJIbnhqVkprWGZLUjBpTGxhClBsUFhzU0l6R00vVGlCSEVsYmFNVnRPOVZndml6dllsNWZ4R3RKZFhncm5vR2g5NDM3c1Qxc0dSMGZ0OVE3TFkKK2NtNUgvMzFWcFhhYUxsZjJNRWI3aG1STnNWV1lXWm9MUHJ2QUJPemVmUnpKU0RONHU0M3M0eVpnNHJoL3IzWQo3YUhYOS9CSHpJRk93WTRNL1BRQzdYaFhDMXBIeWNPY2lSWVhFTkpuMTdQN2NOSkdoMnJ4dnc2OVQ1QW9rdXY5Ckcxd2lUNmVrVmZuaVYrSlVnL1lwcTNSRGxNdVFETDRZdCtGNG1zVGJtN3NFZk5yVVMzWGZFMFdmcjB2Wk1YN2sKMnE3dXkxNEJBb0dCQU5jb1BxVHNBa3N5YzR6UWtmQmNzb0Y1ekdJM3NQTUFGTHRSMGF6S2x1Q1V3VGMzYVk5dgpiTE05OTBVK3VpVzdtRHF0VHpZMVNVSzZGNW0yMzJoSW5hTnBCTUVJcDZHQ0I3dis5WWZIQURVSkljaVdodmJhCmpIY0M5Qjl4SG5uUTBydU5aNUErdWVtRE9EZkRKUllIVUhrMEh3MlJpTE1qRFhVRmhBanJBUGJ4QW9HQkFOaGUKL3BHb2FWOWtUREtNOWZwTTZUQkZwMFVtb2lSb3crVG9TWjhWeVBmMkl1VlNpa0dtaXUydHU3MzZCZkJtVzNtQgpGWmFRc01rNkMydExkK1NBQ0lSbktQTUN4czYzR05WNkJ0aXRIRFlBaGNtRCtvU3VpaFRrd3l1WXlpQml4aFovCms1UDY3UHFKVkQ2YnhkNDV6YlFsS2VNaUVtMUhnQUVGSEF0UFBqbHhBb0dBYzNnaHhwankwakNOV3ZGRW9WN2UKWGlaanpnSmRjTXlHVTlHaFdiNlFJbzh5OHROR1Q3aFkrZ2t6ZjNJZXJNbDA5V2kxcmo0Q3gxRGdBWnJuWXl3MQpqZEY2djY1SmFLQkVUbHlTb1AvbjJJN0NGc2pTUGdFa2lXcUlZYWR2MTZoK3NERS9kMlp5bUNQWU0vVURIa05tCnFPV1VGTkFhTVNtS3UxYnVlV3JGNWNFQ2dZQnJvNTVySWVnQjM2aVVnVkdoU24rN1Z2dG15RmhqV29jUnFvbHQKamUzamhWeEl6eTRlaU5hV2RSWnY1U0R0UGs2RmZMVWJxVEY1ZWRuU2I4SGVOOStFMXJrbFk1MDVteGJNcEo4aApUY1U2RERxQ1RKamxSdHRFbDZXTVc3ODZLMGsyU2hORnk4LzJ0empreUtPLzhPdW5rZEZyd0RpQWl0QmdNWVdKCkRzdjYwUUtCZ1FDR2htYnZrODRaYm1sdERxYW9hOVR6YU5UT3FrN3dtb0tDby9FVEg5NEtNVVZMVmk3bHhpN1kKcXFQYUdiSm9aYkZGd0NvWW12Rk5jU21nYk9SNjdCVVBkdUEzMHo0VythV1pmQVkwZGpUR08yTC8zVVhoWHdHegpVUGpZTXZZQU5sdzFmZTVmZmk3UExJSGJvZXFhTmhhaDliRVJXdFNRbm95NnYzV2hlNTh6VkE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=<span class=w>
</span></code></pre></div><p>Let&rsquo;s run mitmproxy using the above client cert and keys:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>mitmproxy -p <span class=m>9000</span> --ssl-insecure --set <span class=nv>client_certs</span><span class=o>=</span>&lt;<span class=o>(</span>kubectl config view --minify --flatten -o<span class=o>=</span>go-template<span class=o>=</span><span class=s1>&#39;{{(index (index .users 0).user &#34;client-key-data&#34;)}}&#39;</span> <span class=p>|</span> base64 -d <span class=o>&amp;&amp;</span> kubectl config view --minify --flatten -o<span class=o>=</span>go-template<span class=o>=</span><span class=s1>&#39;{{(index (index .users 0).user &#34;client-certificate-data&#34;)}}&#39;</span> <span class=p>|</span> base64 -d<span class=o>)</span>
</code></pre></div><p>Now, let&rsquo;s make sure that we have some DNS alias to 127.0.0.1 to work
around <a href=https://maelvls.dev/go-ignores-proxy-localhost/>the Go proxy
limitation</a> which skips
proxying for <code>127.0.0.1</code> and <code>localhost</code>:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>grep <span class=s2>&#34;</span><span class=s2>^127.0.0.1.*local</span>$<span class=s2>&#34;</span> /etc/hosts <span class=o>||</span> sudo bash -c <span class=s1>&#39;echo &#34;127.0.0.1 local&#34; &gt;&gt; /etc/hosts&#39;</span>
</code></pre></div><p>Finally you can run <code>kubectl</code> to see the logs of <code>kube-scheduler</code>:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>% <span class=nv>HTTPS_PROXY</span><span class=o>=</span>:9000 kubectl --kubeconfig<span class=o>=</span>&lt;<span class=o>(</span>sed <span class=s2>&#34;s|127.0.0.1|local|&#34;</span> <span class=nv>$KUBECONFIG</span><span class=o>)</span> --insecure-skip-tls-verify logs -n kube-system -l <span class=nv>component</span><span class=o>=</span>kube-scheduler,tier<span class=o>=</span>control-plane
I0701 11:11:11.585249       <span class=m>1</span> registry.go:150<span class=o>]</span> Registering EvenPodsSpread predicate and priority <span class=k>function</span>
I0701 11:11:11.585329       <span class=m>1</span> registry.go:150<span class=o>]</span> Registering EvenPodsSpread predicate and priority <span class=k>function</span>
I0701 11:11:12.976581       <span class=m>1</span> serving.go:313<span class=o>]</span> Generated self-signed cert in-memory
W0701 11:11:17.407371       <span class=m>1</span> authentication.go:349<span class=o>]</span> Unable to get configmap/extension-apiserver-authentication in kube-system.  Usually fixed by <span class=s1>&#39;kubectl create rolebinding -n kube-system ROLEBINDING_NAME --role=extension-apiserver-authentication-reader --serviceaccount=YOUR_NS:YOUR_SA&#39;</span>
W0701 11:11:17.407465       <span class=m>1</span> authentication.go:297<span class=o>]</span> Error looking up in-cluster authentication configuration: configmaps <span class=s2>&#34;extension-apiserver-authentication&#34;</span> is forbidden: User <span class=s2>&#34;system:kube-scheduler&#34;</span> cannot get resource <span class=s2>&#34;configmaps&#34;</span> in API group <span class=s2>&#34;&#34;</span> in the namespace <span class=s2>&#34;kube-system&#34;</span>
W0701 11:11:17.407483       <span class=m>1</span> authentication.go:298<span class=o>]</span> Continuing without authentication configuration. This may treat all requests as anonymous.
W0701 11:11:17.407513       <span class=m>1</span> authentication.go:299<span class=o>]</span> To require authentication configuration lookup to succeed, <span class=nb>set</span> --authentication-tolerate-lookup-failure<span class=o>=</span><span class=nb>false</span>
I0701 11:11:17.478349       <span class=m>1</span> registry.go:150<span class=o>]</span> Registering EvenPodsSpread predicate and priority <span class=k>function</span>
I0701 11:11:17.478483       <span class=m>1</span> registry.go:150<span class=o>]</span> Registering EvenPodsSpread predicate and priority <span class=k>function</span>
W0701 11:11:17.491616       <span class=m>1</span> authorization.go:47<span class=o>]</span> Authorization is disabled
W0701 11:11:17.491729       <span class=m>1</span> authentication.go:40<span class=o>]</span> Authentication is disabled
I0701 11:11:17.491883       <span class=m>1</span> deprecated_insecure_serving.go:51<span class=o>]</span> Serving healthz insecurely on <span class=o>[</span>::<span class=o>]</span>:10251
I0701 11:11:17.500576       <span class=m>1</span> secure_serving.go:178<span class=o>]</span> Serving securely on 127.0.0.1:10259
I0701 11:11:17.500678       <span class=m>1</span> tlsconfig.go:240<span class=o>]</span> Starting DynamicServingCertificateController
I0701 11:11:17.500919       <span class=m>1</span> configmap_cafile_content.go:202<span class=o>]</span> Starting client-ca::kube-system::extension-apiserver-authentication::client-ca-file
I0701 11:11:17.500931       <span class=m>1</span> shared_informer.go:223<span class=o>]</span> Waiting <span class=k>for</span> caches to sync <span class=k>for</span> client-ca::kube-system::extension-apiserver-authentication::client-ca-file
I0701 11:11:17.718085       <span class=m>1</span> shared_informer.go:230<span class=o>]</span> Caches are synced <span class=k>for</span> client-ca::kube-system::extension-apiserver-authentication::client-ca-file
I0701 11:11:17.801300       <span class=m>1</span> leaderelection.go:242<span class=o>]</span> attempting to acquire leader lease  kube-system/kube-scheduler...
I0701 11:11:34.659176       <span class=m>1</span> leaderelection.go:252<span class=o>]</span> successfully acquired lease kube-system/kube-scheduler
</code></pre></div><p>It works!! Here is what mitmproxy is showing:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>18:17:42 GET  HTTPS   <span class=nb>local</span> /api/v1/namespaces/kube-system/pods/kube-scheduler-helix-control-plane      <span class=m>200</span> â¦plication/json  5.2k 119ms
18:17:42 GET  HTTPS   <span class=nb>local</span> /api/v1/namespaces/kube-system/pods/kube-scheduler-helix-control-plane/log  <span class=m>200</span>      text/plain 2.46k 227ms
</code></pre></div></div><a href=https://github.com/maelvls/maelvls.github.io/edit/source/content/2020/mitmproxy-kubectl/index.md>ð Edit this page and propose a change!</a><div class=tags><div style=float:right><p>Tags:
<a href=/tags/kind/>kind</a>
<a href=/tags/kubernetes/>kubernetes</a>
<a href=/tags/mitmproxy/>mitmproxy</a>
<a href=/tags/networking/>networking</a></div><div class=clearit></div></div><script src=https://utteranc.es/client.js repo=maelvls/maelvls.github.io issue-term=pathname label=ð¬ theme=github-light crossorigin=anonymous async></script></div></main><footer><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-88710120-3','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></footer></body></html>